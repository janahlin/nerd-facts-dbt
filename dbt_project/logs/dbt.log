[0m09:24:30.192729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe31be7c970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe31cc7acb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe31cc7ac20>]}


============================== 09:24:30.195763 | 4fa17a17-1716-422e-a50f-f4f59a1287af ==============================
[0m09:24:30.195763 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:24:30.196171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'log_path': 'logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:24:30.205833 [info ] [MainThread]: dbt version: 1.9.3
[0m09:24:30.206201 [info ] [MainThread]: python version: 3.10.12
[0m09:24:30.206450 [info ] [MainThread]: python path: /home/janne/nerd-facts-dbt/venv/bin/python3
[0m09:24:30.206691 [info ] [MainThread]: os info: Linux-5.15.0-134-generic-x86_64-with-glibc2.35
[0m09:24:30.207136 [error] [MainThread]: Encountered an error:
local variable 'summary_message' referenced before assignment
[0m09:24:30.208393 [error] [MainThread]: Traceback (most recent call last):
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/main.py", line 414, in debug
    results = task.run()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 114, in run
    load_profile_status: SubtaskStatus = self._load_profile()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 201, in _load_profile
    profile_names, summary_message = self._choose_profile_names()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 276, in _choose_profile_names
    return profiles, summary_message
UnboundLocalError: local variable 'summary_message' referenced before assignment

[0m09:24:30.209450 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.01886777, "process_in_blocks": "32064", "process_kernel_time": 0.063574, "process_mem_max_rss": "85644", "process_out_blocks": "16", "process_user_time": 0.970532}
[0m09:24:30.209813 [debug] [MainThread]: Command `dbt debug` failed at 09:24:30.209723 after 0.02 seconds
[0m09:24:30.210115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe31be7c970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe31cc7b9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe31ae3f5e0>]}
[0m09:24:30.210404 [debug] [MainThread]: Flushing usage events
[0m09:24:30.599013 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:25:00.934211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00f08a4820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00f1817b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00f1817ac0>]}


============================== 09:25:00.937212 | eff28e44-ace8-40e6-be51-ab5030d1e08c ==============================
[0m09:25:00.937212 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:25:00.937670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:25:00.950777 [info ] [MainThread]: dbt version: 1.9.2
[0m09:25:00.951159 [info ] [MainThread]: python version: 3.10.12
[0m09:25:00.951424 [info ] [MainThread]: python path: /usr/bin/python3
[0m09:25:00.951666 [info ] [MainThread]: os info: Linux-5.15.0-134-generic-x86_64-with-glibc2.35
[0m09:25:00.952120 [error] [MainThread]: Encountered an error:
local variable 'summary_message' referenced before assignment
[0m09:25:00.953487 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/dbt/cli/main.py", line 414, in debug
    results = task.run()
  File "/usr/local/lib/python3.10/dist-packages/dbt/task/debug.py", line 114, in run
    load_profile_status: SubtaskStatus = self._load_profile()
  File "/usr/local/lib/python3.10/dist-packages/dbt/task/debug.py", line 201, in _load_profile
    profile_names, summary_message = self._choose_profile_names()
  File "/usr/local/lib/python3.10/dist-packages/dbt/task/debug.py", line 276, in _choose_profile_names
    return profiles, summary_message
UnboundLocalError: local variable 'summary_message' referenced before assignment

[0m09:25:00.954202 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.022016058, "process_in_blocks": "29432", "process_kernel_time": 0.061838, "process_mem_max_rss": "84820", "process_out_blocks": "16", "process_user_time": 0.960141}
[0m09:25:00.954623 [debug] [MainThread]: Command `dbt debug` failed at 09:25:00.954545 after 0.02 seconds
[0m09:25:00.954891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00f08a4820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00f1817a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00efa680a0>]}
[0m09:25:00.955181 [debug] [MainThread]: Flushing usage events
[0m09:25:01.387100 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:25:50.858270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdec1b8880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdecf8abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdecf8ab60>]}


============================== 09:25:50.860484 | c5e11c67-e008-4f34-bde7-6c38fa570137 ==============================
[0m09:25:50.860484 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:25:50.860907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'version_check': 'True', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug --config-dir', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:25:50.866255 [info ] [MainThread]: To view your profiles.yml file, run:

xdg-open /home/janne/nerd-facts-dbt/dbt_project
[0m09:25:50.867032 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.010643467, "process_in_blocks": "0", "process_kernel_time": 0.032158, "process_mem_max_rss": "85412", "process_out_blocks": "16", "process_user_time": 0.904295}
[0m09:25:50.867375 [debug] [MainThread]: Command `dbt debug` succeeded at 09:25:50.867298 after 0.01 seconds
[0m09:25:50.867656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdec1b8880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdecf8ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdecf8abc0>]}
[0m09:25:50.867940 [debug] [MainThread]: Flushing usage events
[0m09:25:51.256496 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:27:03.526809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c20764850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c21566b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c21566b30>]}


============================== 09:27:03.529409 | f6b013c3-8f75-4d2f-8fe8-58ed5fd93b3e ==============================
[0m09:27:03.529409 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:27:03.529973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --config-dir', 'send_anonymous_usage_stats': 'True'}
[0m09:27:03.535937 [info ] [MainThread]: To view your profiles.yml file, run:

xdg-open /home/janne/nerd-facts-dbt/dbt_project
[0m09:27:03.536768 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.011985836, "process_in_blocks": "0", "process_kernel_time": 0.036019, "process_mem_max_rss": "85456", "process_out_blocks": "8", "process_user_time": 0.887775}
[0m09:27:03.537198 [debug] [MainThread]: Command `dbt debug` succeeded at 09:27:03.537106 after 0.01 seconds
[0m09:27:03.537556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c20764850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c21566ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c21566b90>]}
[0m09:27:03.537937 [debug] [MainThread]: Flushing usage events
[0m09:27:03.941871 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:27:08.811573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6761b8970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff676f8acb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff676f8ac50>]}


============================== 09:27:08.813901 | e6f9c77f-9a83-43f4-9e6c-0e1d619f77e7 ==============================
[0m09:27:08.813901 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:27:08.814309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'debug': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m09:27:08.819564 [info ] [MainThread]: dbt version: 1.9.3
[0m09:27:08.819878 [info ] [MainThread]: python version: 3.10.12
[0m09:27:08.820117 [info ] [MainThread]: python path: /home/janne/nerd-facts-dbt/venv/bin/python3
[0m09:27:08.820352 [info ] [MainThread]: os info: Linux-5.15.0-134-generic-x86_64-with-glibc2.35
[0m09:27:08.820797 [error] [MainThread]: Encountered an error:
local variable 'summary_message' referenced before assignment
[0m09:27:08.821493 [error] [MainThread]: Traceback (most recent call last):
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/main.py", line 414, in debug
    results = task.run()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 114, in run
    load_profile_status: SubtaskStatus = self._load_profile()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 201, in _load_profile
    profile_names, summary_message = self._choose_profile_names()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 276, in _choose_profile_names
    return profiles, summary_message
UnboundLocalError: local variable 'summary_message' referenced before assignment

[0m09:27:08.822166 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.012489452, "process_in_blocks": "0", "process_kernel_time": 0.031999, "process_mem_max_rss": "85596", "process_out_blocks": "8", "process_user_time": 0.931124}
[0m09:27:08.822499 [debug] [MainThread]: Command `dbt debug` failed at 09:27:08.822410 after 0.01 seconds
[0m09:27:08.822764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6761b8970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff676f8b9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6770335e0>]}
[0m09:27:08.823053 [debug] [MainThread]: Flushing usage events
[0m09:27:09.212482 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:28:08.104523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fda2288e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdb02ec20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdb02ebc0>]}


============================== 09:28:08.106793 | fe349e36-04b7-4c81-889d-c69b87b72496 ==============================
[0m09:28:08.106793 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:28:08.107223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:28:08.112478 [info ] [MainThread]: dbt version: 1.9.3
[0m09:28:08.112812 [info ] [MainThread]: python version: 3.10.12
[0m09:28:08.113080 [info ] [MainThread]: python path: /home/janne/nerd-facts-dbt/venv/bin/python3
[0m09:28:08.113317 [info ] [MainThread]: os info: Linux-5.15.0-134-generic-x86_64-with-glibc2.35
[0m09:28:08.114001 [error] [MainThread]: Encountered an error:
local variable 'summary_message' referenced before assignment
[0m09:28:08.114671 [error] [MainThread]: Traceback (most recent call last):
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/main.py", line 414, in debug
    results = task.run()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 114, in run
    load_profile_status: SubtaskStatus = self._load_profile()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 201, in _load_profile
    profile_names, summary_message = self._choose_profile_names()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 276, in _choose_profile_names
    return profiles, summary_message
UnboundLocalError: local variable 'summary_message' referenced before assignment

[0m09:28:08.115380 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.012873661, "process_in_blocks": "0", "process_kernel_time": 0.048112, "process_mem_max_rss": "85756", "process_out_blocks": "16", "process_user_time": 0.876172}
[0m09:28:08.115742 [debug] [MainThread]: Command `dbt debug` failed at 09:28:08.115634 after 0.01 seconds
[0m09:28:08.116046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fda2288e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdb0d7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdb0d73d0>]}
[0m09:28:08.116331 [debug] [MainThread]: Flushing usage events
[0m09:28:08.521045 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:28:23.625544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44ffa8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb450d7acb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb450d7ac50>]}


============================== 09:28:23.628055 | 7df280e9-92f8-47fc-9f75-fcdf40fe0a80 ==============================
[0m09:28:23.628055 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:28:23.628711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:28:23.636910 [info ] [MainThread]: dbt version: 1.9.3
[0m09:28:23.637394 [info ] [MainThread]: python version: 3.10.12
[0m09:28:23.637844 [info ] [MainThread]: python path: /home/janne/nerd-facts-dbt/venv/bin/python3
[0m09:28:23.638193 [info ] [MainThread]: os info: Linux-5.15.0-134-generic-x86_64-with-glibc2.35
[0m09:28:23.639280 [error] [MainThread]: Encountered an error:
local variable 'summary_message' referenced before assignment
[0m09:28:23.640386 [error] [MainThread]: Traceback (most recent call last):
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/main.py", line 414, in debug
    results = task.run()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 114, in run
    load_profile_status: SubtaskStatus = self._load_profile()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 201, in _load_profile
    profile_names, summary_message = self._choose_profile_names()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 276, in _choose_profile_names
    return profiles, summary_message
UnboundLocalError: local variable 'summary_message' referenced before assignment

[0m09:28:23.641547 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.018077997, "process_in_blocks": "0", "process_kernel_time": 0.063977, "process_mem_max_rss": "85612", "process_out_blocks": "16", "process_user_time": 0.859905}
[0m09:28:23.642172 [debug] [MainThread]: Command `dbt debug` failed at 09:28:23.642033 after 0.02 seconds
[0m09:28:23.642632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44ffa8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb450e274c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb450e27460>]}
[0m09:28:23.643139 [debug] [MainThread]: Flushing usage events
[0m09:28:24.027068 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:29:28.521066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee27974880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee287e5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee287e56f0>]}


============================== 09:29:28.523147 | 2479a3f7-036e-4cd2-9922-4cb189e05f48 ==============================
[0m09:29:28.523147 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:29:28.523589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'log_path': 'logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:29:28.528935 [info ] [MainThread]: dbt version: 1.9.3
[0m09:29:28.529267 [info ] [MainThread]: python version: 3.10.12
[0m09:29:28.529561 [info ] [MainThread]: python path: /home/janne/nerd-facts-dbt/venv/bin/python3
[0m09:29:28.529803 [info ] [MainThread]: os info: Linux-5.15.0-134-generic-x86_64-with-glibc2.35
[0m09:29:28.592653 [info ] [MainThread]: Using profiles dir at /home/janne/nerd-facts-dbt/dbt_project
[0m09:29:28.593068 [info ] [MainThread]: Using profiles.yml file at /home/janne/nerd-facts-dbt/dbt_project/profiles.yml
[0m09:29:28.593465 [info ] [MainThread]: Using dbt_project.yml file at /home/janne/nerd-facts-dbt/dbt_project/dbt_project.yml
[0m09:29:28.594147 [info ] [MainThread]: adapter type: postgres
[0m09:29:28.594417 [info ] [MainThread]: adapter version: 1.9.0
[0m09:29:28.594888 [info ] [MainThread]: Configuration:
[0m09:29:28.595130 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:29:28.595354 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m09:29:28.595571 [info ] [MainThread]: Required dependencies:
[0m09:29:28.595807 [debug] [MainThread]: Executing "git --help"
[0m09:29:28.597077 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:29:28.597438 [debug] [MainThread]: STDERR: "b''"
[0m09:29:28.597694 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:29:28.597954 [info ] [MainThread]: Connection:
[0m09:29:28.598199 [info ] [MainThread]:   host: localhost
[0m09:29:28.598412 [info ] [MainThread]:   port: 5432
[0m09:29:28.598622 [info ] [MainThread]:   user: dbt_user
[0m09:29:28.598839 [info ] [MainThread]:   database: nerd_facts
[0m09:29:28.599050 [info ] [MainThread]:   schema: public
[0m09:29:28.599270 [info ] [MainThread]:   connect_timeout: 10
[0m09:29:28.599482 [info ] [MainThread]:   role: None
[0m09:29:28.599699 [info ] [MainThread]:   search_path: None
[0m09:29:28.599914 [info ] [MainThread]:   keepalives_idle: 0
[0m09:29:28.600140 [info ] [MainThread]:   sslmode: None
[0m09:29:28.600351 [info ] [MainThread]:   sslcert: None
[0m09:29:28.600565 [info ] [MainThread]:   sslkey: None
[0m09:29:28.600775 [info ] [MainThread]:   sslrootcert: None
[0m09:29:28.600986 [info ] [MainThread]:   application_name: dbt
[0m09:29:28.601213 [info ] [MainThread]:   retries: 1
[0m09:29:28.601554 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:29:28.669510 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:29:28.691643 [debug] [MainThread]: Using postgres connection "debug"
[0m09:29:28.692020 [debug] [MainThread]: On debug: select 1 as id
[0m09:29:28.692327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:29:28.705123 [debug] [MainThread]: SQL status: SELECT 1 in 0.013 seconds
[0m09:29:28.706105 [debug] [MainThread]: On debug: Close
[0m09:29:28.706569 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:29:28.707194 [info ] [MainThread]: [31m1 check failed:[0m
[0m09:29:28.707705 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  dbt_project.yml does not parse to a dictionary


[0m09:29:28.708885 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.23143281, "process_in_blocks": "16160", "process_kernel_time": 0.091378, "process_mem_max_rss": "100440", "process_out_blocks": "24", "process_user_time": 1.069261}
[0m09:29:28.709324 [debug] [MainThread]: Command `dbt debug` failed at 09:29:28.709228 after 0.23 seconds
[0m09:29:28.709678 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:29:28.709985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee27974880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee287e5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee26145ab0>]}
[0m09:29:28.710338 [debug] [MainThread]: Flushing usage events
[0m09:29:29.100913 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:30:24.068104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2eff0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2fe6bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2fe6bd90>]}


============================== 09:30:24.070508 | b80b5078-dd5f-4fc6-b48b-18fd3336fdd4 ==============================
[0m09:30:24.070508 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:30:24.071036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:30:24.076922 [info ] [MainThread]: dbt version: 1.9.3
[0m09:30:24.077311 [info ] [MainThread]: python version: 3.10.12
[0m09:30:24.077669 [info ] [MainThread]: python path: /home/janne/nerd-facts-dbt/venv/bin/python3
[0m09:30:24.077988 [info ] [MainThread]: os info: Linux-5.15.0-134-generic-x86_64-with-glibc2.35
[0m09:30:24.124238 [info ] [MainThread]: Using profiles dir at /home/janne/nerd-facts-dbt/dbt_project
[0m09:30:24.124723 [info ] [MainThread]: Using profiles.yml file at /home/janne/nerd-facts-dbt/dbt_project/profiles.yml
[0m09:30:24.125078 [info ] [MainThread]: Using dbt_project.yml file at /home/janne/nerd-facts-dbt/dbt_project/dbt_project.yml
[0m09:30:24.125563 [info ] [MainThread]: adapter type: postgres
[0m09:30:24.125874 [info ] [MainThread]: adapter version: 1.9.0
[0m09:30:24.213143 [info ] [MainThread]: Configuration:
[0m09:30:24.213654 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:30:24.214004 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:30:24.214310 [info ] [MainThread]: Required dependencies:
[0m09:30:24.214628 [debug] [MainThread]: Executing "git --help"
[0m09:30:24.216058 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:30:24.216400 [debug] [MainThread]: STDERR: "b''"
[0m09:30:24.216681 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:30:24.216988 [info ] [MainThread]: Connection:
[0m09:30:24.217310 [info ] [MainThread]:   host: localhost
[0m09:30:24.217634 [info ] [MainThread]:   port: 5432
[0m09:30:24.217920 [info ] [MainThread]:   user: dbt_user
[0m09:30:24.218201 [info ] [MainThread]:   database: nerd_facts
[0m09:30:24.218491 [info ] [MainThread]:   schema: public
[0m09:30:24.218777 [info ] [MainThread]:   connect_timeout: 10
[0m09:30:24.219057 [info ] [MainThread]:   role: None
[0m09:30:24.219333 [info ] [MainThread]:   search_path: None
[0m09:30:24.219615 [info ] [MainThread]:   keepalives_idle: 0
[0m09:30:24.219895 [info ] [MainThread]:   sslmode: None
[0m09:30:24.220176 [info ] [MainThread]:   sslcert: None
[0m09:30:24.220454 [info ] [MainThread]:   sslkey: None
[0m09:30:24.220730 [info ] [MainThread]:   sslrootcert: None
[0m09:30:24.221015 [info ] [MainThread]:   application_name: dbt
[0m09:30:24.221293 [info ] [MainThread]:   retries: 1
[0m09:30:24.221730 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:30:24.302145 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:30:24.323516 [debug] [MainThread]: Using postgres connection "debug"
[0m09:30:24.323899 [debug] [MainThread]: On debug: select 1 as id
[0m09:30:24.324198 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:30:24.334255 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m09:30:24.335202 [debug] [MainThread]: On debug: Close
[0m09:30:24.335658 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:30:24.336271 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:30:24.337375 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.3124077, "process_in_blocks": "0", "process_kernel_time": 0.068366, "process_mem_max_rss": "102600", "process_out_blocks": "24", "process_user_time": 1.214409}
[0m09:30:24.337984 [debug] [MainThread]: Command `dbt debug` succeeded at 09:30:24.337887 after 0.31 seconds
[0m09:30:24.338313 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:30:24.338644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2eff0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2fe0f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2eebd270>]}
[0m09:30:24.339012 [debug] [MainThread]: Flushing usage events
[0m09:30:24.722972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:16:46.368836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdae4cd07c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdae5c826e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdae5c82680>]}


============================== 10:16:46.371167 | 5c816e66-1b75-48a4-b9a8-3f297bce627d ==============================
[0m10:16:46.371167 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:16:46.371690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:16:46.376082 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m10:16:46.376589 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "nerd_facts_dbt", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!
[0m10:16:46.377324 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.053926922, "process_in_blocks": "0", "process_kernel_time": 0.031927, "process_mem_max_rss": "85140", "process_out_blocks": "8", "process_user_time": 1.003708}
[0m10:16:46.377828 [debug] [MainThread]: Command `dbt run` failed at 10:16:46.377741 after 0.05 seconds
[0m10:16:46.378146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdae4cd07c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdae5c17a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdae5c17910>]}
[0m10:16:46.378514 [debug] [MainThread]: Flushing usage events
[0m10:16:46.812409 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:17:04.519505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bf30087c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bf2172350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bf21723b0>]}


============================== 10:17:04.521872 | a049bf12-938c-4b2d-8df1-ca202db10477 ==============================
[0m10:17:04.521872 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:17:04.522428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:17:04.526769 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m10:17:04.527249 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "nerd_facts_dbt", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!
[0m10:17:04.527950 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05624714, "process_in_blocks": "0", "process_kernel_time": 0.028019, "process_mem_max_rss": "85048", "process_out_blocks": "8", "process_user_time": 0.931854}
[0m10:17:04.528405 [debug] [MainThread]: Command `dbt run` failed at 10:17:04.528319 after 0.06 seconds
[0m10:17:04.528732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bf30087c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bf3f4fa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bf3f4f8e0>]}
[0m10:17:04.529076 [debug] [MainThread]: Flushing usage events
[0m10:17:04.949489 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:18:33.449734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651f7f08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6520667b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6520667be0>]}


============================== 10:18:33.452013 | 9735f254-4160-4bde-adbc-d36f91b09d31 ==============================
[0m10:18:33.452013 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:18:33.452440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:18:33.579375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9735f254-4160-4bde-adbc-d36f91b09d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65207ca710>]}
[0m10:18:33.628021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9735f254-4160-4bde-adbc-d36f91b09d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6520667b50>]}
[0m10:18:33.628743 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:18:33.715798 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:18:33.716452 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:18:33.716840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9735f254-4160-4bde-adbc-d36f91b09d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651de4b310>]}
[0m10:18:34.533416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9735f254-4160-4bde-adbc-d36f91b09d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651dd184c0>]}
[0m10:18:34.585864 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m10:18:34.587988 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m10:18:34.607091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9735f254-4160-4bde-adbc-d36f91b09d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651d550700>]}
[0m10:18:34.607601 [info ] [MainThread]: Found 1 model, 433 macros
[0m10:18:34.607977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9735f254-4160-4bde-adbc-d36f91b09d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651d550790>]}
[0m10:18:34.609285 [info ] [MainThread]: 
[0m10:18:34.609669 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:18:34.609984 [info ] [MainThread]: 
[0m10:18:34.610488 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:18:34.611916 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m10:18:34.643209 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m10:18:34.643606 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m10:18:34.643916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:34.657094 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m10:18:34.658348 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m10:18:34.661219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_raw)
[0m10:18:34.667166 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_raw"
[0m10:18:34.667555 [debug] [ThreadPool]: On list_nerd_facts_raw: BEGIN
[0m10:18:34.667855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:34.680103 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:18:34.680516 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_raw"
[0m10:18:34.680846 [debug] [ThreadPool]: On list_nerd_facts_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_raw"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m10:18:34.683232 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:18:34.684449 [debug] [ThreadPool]: On list_nerd_facts_raw: ROLLBACK
[0m10:18:34.684877 [debug] [ThreadPool]: On list_nerd_facts_raw: Close
[0m10:18:34.690398 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:34.690772 [debug] [MainThread]: On master: BEGIN
[0m10:18:34.691066 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:18:34.703394 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:18:34.703820 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:34.704197 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:18:34.711990 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m10:18:34.713180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9735f254-4160-4bde-adbc-d36f91b09d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651df3cdc0>]}
[0m10:18:34.713694 [debug] [MainThread]: On master: ROLLBACK
[0m10:18:34.714163 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:34.714460 [debug] [MainThread]: On master: BEGIN
[0m10:18:34.714929 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:18:34.715225 [debug] [MainThread]: On master: COMMIT
[0m10:18:34.715517 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:34.715792 [debug] [MainThread]: On master: COMMIT
[0m10:18:34.716150 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:18:34.716433 [debug] [MainThread]: On master: Close
[0m10:18:34.720435 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.pokemon
[0m10:18:34.721015 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.pokemon ........................................ [RUN]
[0m10:18:34.721547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_raw, now model.nerd_facts_dbt.pokemon)
[0m10:18:34.721900 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.pokemon
[0m10:18:34.729469 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.pokemon"
[0m10:18:34.730284 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.pokemon
[0m10:18:34.763752 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.pokemon"
[0m10:18:34.764506 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m10:18:34.764894 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: BEGIN
[0m10:18:34.765227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:34.777443 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m10:18:34.777901 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m10:18:34.778276 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */

  create view "nerd_facts"."raw"."pokemon__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM raw.pokeapi_pokemon
)

SELECT 
    id,
    name,
    height,
    weight,
    ROUND(weight / (height * height), 2) AS bmi
FROM source
  );
[0m10:18:34.779148 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: text * text
LINE 16:     ROUND(weight / (height * height), 2) AS bmi
                                    ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m10:18:34.779515 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: ROLLBACK
[0m10:18:34.780013 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: Close
[0m10:18:34.783418 [debug] [Thread-1 (]: Database Error in model pokemon (models/pokemon.sql)
  operator does not exist: text * text
  LINE 16:     ROUND(weight / (height * height), 2) AS bmi
                                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/pokemon.sql
[0m10:18:34.785235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9735f254-4160-4bde-adbc-d36f91b09d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6520a84a60>]}
[0m10:18:34.785930 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.pokemon ............................... [[31mERROR[0m in 0.06s]
[0m10:18:34.786555 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.pokemon
[0m10:18:34.787093 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.pokemon' to be skipped because of status 'error'.  Reason: Database Error in model pokemon (models/pokemon.sql)
  operator does not exist: text * text
  LINE 16:     ROUND(weight / (height * height), 2) AS bmi
                                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/pokemon.sql.
[0m10:18:34.788652 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:34.788975 [debug] [MainThread]: On master: BEGIN
[0m10:18:34.789255 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:18:34.801373 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:18:34.801830 [debug] [MainThread]: On master: COMMIT
[0m10:18:34.802172 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:34.802459 [debug] [MainThread]: On master: COMMIT
[0m10:18:34.802844 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:18:34.803128 [debug] [MainThread]: On master: Close
[0m10:18:34.803613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:18:34.803837 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.pokemon' was properly closed.
[0m10:18:34.804074 [info ] [MainThread]: 
[0m10:18:34.804329 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m10:18:34.804817 [debug] [MainThread]: Command end result
[0m10:18:34.820759 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m10:18:34.822086 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m10:18:34.827835 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m10:18:34.828154 [info ] [MainThread]: 
[0m10:18:34.828483 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:18:34.828756 [info ] [MainThread]: 
[0m10:18:34.829054 [error] [MainThread]:   Database Error in model pokemon (models/pokemon.sql)
  operator does not exist: text * text
  LINE 16:     ROUND(weight / (height * height), 2) AS bmi
                                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/pokemon.sql
[0m10:18:34.829301 [info ] [MainThread]: 
[0m10:18:34.829576 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:18:34.830272 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4229543, "process_in_blocks": "2272", "process_kernel_time": 0.06774, "process_mem_max_rss": "110600", "process_out_blocks": "2536", "process_user_time": 2.209926}
[0m10:18:34.830648 [debug] [MainThread]: Command `dbt run` failed at 10:18:34.830571 after 1.42 seconds
[0m10:18:34.830947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651f7f08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65207ca710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651dceffa0>]}
[0m10:18:34.831277 [debug] [MainThread]: Flushing usage events
[0m10:18:35.228893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:19:26.272202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf25e0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf34537c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf3453820>]}


============================== 10:19:26.274327 | e6b5d28a-e2d9-438b-8ff2-0707ffc56bef ==============================
[0m10:19:26.274327 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:19:26.274753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:19:26.400214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6b5d28a-e2d9-438b-8ff2-0707ffc56bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf33f0b80>]}
[0m10:19:26.448951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6b5d28a-e2d9-438b-8ff2-0707ffc56bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf33afd30>]}
[0m10:19:26.449623 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:19:26.521704 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:19:26.591518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:19:26.591866 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:19:26.613605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6b5d28a-e2d9-438b-8ff2-0707ffc56bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf0854130>]}
[0m10:19:26.661993 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m10:19:26.663893 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m10:19:26.672093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6b5d28a-e2d9-438b-8ff2-0707ffc56bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf08551e0>]}
[0m10:19:26.672554 [info ] [MainThread]: Found 1 model, 433 macros
[0m10:19:26.672844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6b5d28a-e2d9-438b-8ff2-0707ffc56bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf0855900>]}
[0m10:19:26.674216 [info ] [MainThread]: 
[0m10:19:26.674548 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:19:26.674775 [info ] [MainThread]: 
[0m10:19:26.675140 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:19:26.675940 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m10:19:26.706260 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m10:19:26.706630 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m10:19:26.706876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:26.719813 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m10:19:26.720845 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m10:19:26.722041 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_raw'
[0m10:19:26.727777 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_raw"
[0m10:19:26.728195 [debug] [ThreadPool]: On list_nerd_facts_raw: BEGIN
[0m10:19:26.728501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:26.740716 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:19:26.741098 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_raw"
[0m10:19:26.741355 [debug] [ThreadPool]: On list_nerd_facts_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_raw"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m10:19:26.743683 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:19:26.744688 [debug] [ThreadPool]: On list_nerd_facts_raw: ROLLBACK
[0m10:19:26.745080 [debug] [ThreadPool]: On list_nerd_facts_raw: Close
[0m10:19:26.749930 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.750300 [debug] [MainThread]: On master: BEGIN
[0m10:19:26.750532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:26.762693 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:19:26.763069 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.763353 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:19:26.770742 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m10:19:26.771656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6b5d28a-e2d9-438b-8ff2-0707ffc56bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf0872110>]}
[0m10:19:26.772063 [debug] [MainThread]: On master: ROLLBACK
[0m10:19:26.772476 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.772799 [debug] [MainThread]: On master: BEGIN
[0m10:19:26.773187 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:19:26.773438 [debug] [MainThread]: On master: COMMIT
[0m10:19:26.773671 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.773908 [debug] [MainThread]: On master: COMMIT
[0m10:19:26.774279 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:19:26.774512 [debug] [MainThread]: On master: Close
[0m10:19:26.776948 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.pokemon
[0m10:19:26.777457 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.pokemon ........................................ [RUN]
[0m10:19:26.778039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_raw, now model.nerd_facts_dbt.pokemon)
[0m10:19:26.778357 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.pokemon
[0m10:19:26.784297 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.pokemon"
[0m10:19:26.784812 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.pokemon
[0m10:19:26.813936 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.pokemon"
[0m10:19:26.814587 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m10:19:26.814947 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: BEGIN
[0m10:19:26.815208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:26.827470 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m10:19:26.827893 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m10:19:26.828180 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */

  create view "nerd_facts"."raw"."pokemon__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM raw.pokeapi_pokemon
)

SELECT 
    id,
    name,
    height,
    weight,
    ROUND(weight / (height * height), 2) AS bmi
FROM source
  );
[0m10:19:26.828986 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: text * text
LINE 16:     ROUND(weight / (height * height), 2) AS bmi
                                    ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m10:19:26.829284 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: ROLLBACK
[0m10:19:26.829838 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: Close
[0m10:19:26.831531 [debug] [Thread-1 (]: Database Error in model pokemon (models/pokemon.sql)
  operator does not exist: text * text
  LINE 16:     ROUND(weight / (height * height), 2) AS bmi
                                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/pokemon.sql
[0m10:19:26.833038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6b5d28a-e2d9-438b-8ff2-0707ffc56bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf27023e0>]}
[0m10:19:26.833890 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.pokemon ............................... [[31mERROR[0m in 0.05s]
[0m10:19:26.834547 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.pokemon
[0m10:19:26.835115 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.pokemon' to be skipped because of status 'error'.  Reason: Database Error in model pokemon (models/pokemon.sql)
  operator does not exist: text * text
  LINE 16:     ROUND(weight / (height * height), 2) AS bmi
                                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/pokemon.sql.
[0m10:19:26.836534 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.836814 [debug] [MainThread]: On master: BEGIN
[0m10:19:26.837031 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:19:26.849044 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:19:26.849515 [debug] [MainThread]: On master: COMMIT
[0m10:19:26.849867 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.850136 [debug] [MainThread]: On master: COMMIT
[0m10:19:26.850515 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:19:26.850810 [debug] [MainThread]: On master: Close
[0m10:19:26.851396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:26.851748 [debug] [MainThread]: Connection 'list_nerd_facts' was properly closed.
[0m10:19:26.852062 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.pokemon' was properly closed.
[0m10:19:26.852413 [info ] [MainThread]: 
[0m10:19:26.852779 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m10:19:26.853565 [debug] [MainThread]: Command end result
[0m10:19:26.872684 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m10:19:26.874153 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m10:19:26.879473 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m10:19:26.879848 [info ] [MainThread]: 
[0m10:19:26.880249 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:19:26.880578 [info ] [MainThread]: 
[0m10:19:26.880947 [error] [MainThread]:   Database Error in model pokemon (models/pokemon.sql)
  operator does not exist: text * text
  LINE 16:     ROUND(weight / (height * height), 2) AS bmi
                                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/pokemon.sql
[0m10:19:26.881248 [info ] [MainThread]: 
[0m10:19:26.881592 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:19:26.882382 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6551281, "process_in_blocks": "0", "process_kernel_time": 0.091696, "process_mem_max_rss": "108044", "process_out_blocks": "1712", "process_user_time": 1.530676}
[0m10:19:26.882757 [debug] [MainThread]: Command `dbt run` failed at 10:19:26.882673 after 0.66 seconds
[0m10:19:26.883111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf25e0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf33f0b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf249e410>]}
[0m10:19:26.883468 [debug] [MainThread]: Flushing usage events
[0m10:19:27.265711 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:20:52.502193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8409bf08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840aa637c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840aa63820>]}


============================== 10:20:52.504542 | 89dbec8a-d7e6-4284-b60e-fa8003117cde ==============================
[0m10:20:52.504542 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:20:52.505074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:20:52.638514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89dbec8a-d7e6-4284-b60e-fa8003117cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840abca710>]}
[0m10:20:52.690532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89dbec8a-d7e6-4284-b60e-fa8003117cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840aa63790>]}
[0m10:20:52.691237 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:20:52.771304 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:20:52.845997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:20:52.846617 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/pokemon.sql
[0m10:20:53.046831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89dbec8a-d7e6-4284-b60e-fa8003117cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8407de27d0>]}
[0m10:20:53.102171 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m10:20:53.104392 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m10:20:53.112896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89dbec8a-d7e6-4284-b60e-fa8003117cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8407dbd510>]}
[0m10:20:53.113394 [info ] [MainThread]: Found 1 model, 433 macros
[0m10:20:53.113792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89dbec8a-d7e6-4284-b60e-fa8003117cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8407dbcaf0>]}
[0m10:20:53.115208 [info ] [MainThread]: 
[0m10:20:53.115575 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:20:53.115877 [info ] [MainThread]: 
[0m10:20:53.116355 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:20:53.117157 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m10:20:53.148073 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m10:20:53.148537 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m10:20:53.148860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:53.162035 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m10:20:53.163229 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m10:20:53.165836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_raw)
[0m10:20:53.171270 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_raw"
[0m10:20:53.171688 [debug] [ThreadPool]: On list_nerd_facts_raw: BEGIN
[0m10:20:53.171998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:20:53.184348 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:20:53.184723 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_raw"
[0m10:20:53.184985 [debug] [ThreadPool]: On list_nerd_facts_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_raw"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m10:20:53.187305 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:20:53.188307 [debug] [ThreadPool]: On list_nerd_facts_raw: ROLLBACK
[0m10:20:53.188670 [debug] [ThreadPool]: On list_nerd_facts_raw: Close
[0m10:20:53.192525 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:53.192857 [debug] [MainThread]: On master: BEGIN
[0m10:20:53.193100 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:20:53.205186 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:20:53.205564 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:53.205865 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:20:53.213122 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m10:20:53.214060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89dbec8a-d7e6-4284-b60e-fa8003117cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8407de2fe0>]}
[0m10:20:53.214459 [debug] [MainThread]: On master: ROLLBACK
[0m10:20:53.214886 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:53.215148 [debug] [MainThread]: On master: BEGIN
[0m10:20:53.215530 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:20:53.215766 [debug] [MainThread]: On master: COMMIT
[0m10:20:53.215989 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:53.216197 [debug] [MainThread]: On master: COMMIT
[0m10:20:53.216474 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:20:53.216701 [debug] [MainThread]: On master: Close
[0m10:20:53.218640 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.pokemon
[0m10:20:53.219141 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.pokemon ........................................ [RUN]
[0m10:20:53.219569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_raw, now model.nerd_facts_dbt.pokemon)
[0m10:20:53.219860 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.pokemon
[0m10:20:53.225228 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.pokemon"
[0m10:20:53.225753 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.pokemon
[0m10:20:53.255249 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.pokemon"
[0m10:20:53.255956 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m10:20:53.256298 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: BEGIN
[0m10:20:53.256585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:53.268776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m10:20:53.269196 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m10:20:53.269521 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */

  create view "nerd_facts"."raw"."pokemon__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM raw.pokeapi_pokemon
)

SELECT 
    id,
    name,
    CAST(height AS NUMERIC) AS height,  -- ✅ Convert to numeric
    CAST(weight AS NUMERIC) AS weight,  -- ✅ Convert to numeric
    ROUND(CAST(weight AS NUMERIC) / (CAST(height AS NUMERIC) * CAST(height AS NUMERIC)), 2) AS bmi  -- ✅ Calculate BMI
FROM source
  );
[0m10:20:53.271476 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:20:53.312281 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m10:20:53.312690 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */
alter table "nerd_facts"."raw"."pokemon__dbt_tmp" rename to "pokemon"
[0m10:20:53.313408 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:20:53.324302 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: COMMIT
[0m10:20:53.324682 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m10:20:53.324965 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: COMMIT
[0m10:20:53.331372 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m10:20:53.336701 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."raw"."pokemon__dbt_backup"
[0m10:20:53.340361 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m10:20:53.340726 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */
drop view if exists "nerd_facts"."raw"."pokemon__dbt_backup" cascade
[0m10:20:53.341240 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:20:53.343217 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: Close
[0m10:20:53.344754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89dbec8a-d7e6-4284-b60e-fa8003117cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8406c7f010>]}
[0m10:20:53.345351 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw.pokemon ................................... [[32mCREATE VIEW[0m in 0.12s]
[0m10:20:53.345875 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.pokemon
[0m10:20:53.346942 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:53.347227 [debug] [MainThread]: On master: BEGIN
[0m10:20:53.347455 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:20:53.359402 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:20:53.359813 [debug] [MainThread]: On master: COMMIT
[0m10:20:53.360094 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:53.360333 [debug] [MainThread]: On master: COMMIT
[0m10:20:53.360655 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:20:53.360906 [debug] [MainThread]: On master: Close
[0m10:20:53.361370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:20:53.361671 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.pokemon' was properly closed.
[0m10:20:53.361946 [info ] [MainThread]: 
[0m10:20:53.362341 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m10:20:53.363036 [debug] [MainThread]: Command end result
[0m10:20:53.379265 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m10:20:53.380581 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m10:20:53.386065 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m10:20:53.386379 [info ] [MainThread]: 
[0m10:20:53.386732 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:20:53.387000 [info ] [MainThread]: 
[0m10:20:53.387268 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:20:53.387935 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9309484, "process_in_blocks": "0", "process_kernel_time": 0.095683, "process_mem_max_rss": "111104", "process_out_blocks": "2536", "process_user_time": 1.733626}
[0m10:20:53.388284 [debug] [MainThread]: Command `dbt run` succeeded at 10:20:53.388191 after 0.93 seconds
[0m10:20:53.388599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8409bf08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8409a89f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8407dbc280>]}
[0m10:20:53.388890 [debug] [MainThread]: Flushing usage events
[0m10:20:53.787307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:48:33.661100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8369b988b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8368b4d870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8368b4d810>]}


============================== 12:48:33.663967 | f944e282-6c0b-4ade-9af5-bad02966a972 ==============================
[0m12:48:33.663967 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:48:33.664405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:48:33.669866 [info ] [MainThread]: dbt version: 1.9.3
[0m12:48:33.670196 [info ] [MainThread]: python version: 3.10.12
[0m12:48:33.670454 [info ] [MainThread]: python path: /home/janne/nerd-facts-dbt/venv/bin/python3
[0m12:48:33.670684 [info ] [MainThread]: os info: Linux-5.15.0-134-generic-x86_64-with-glibc2.35
[0m12:48:33.712654 [info ] [MainThread]: Using profiles dir at /home/janne/nerd-facts-dbt/dbt_project
[0m12:48:33.713076 [info ] [MainThread]: Using profiles.yml file at /home/janne/nerd-facts-dbt/dbt_project/profiles.yml
[0m12:48:33.713351 [info ] [MainThread]: Using dbt_project.yml file at /home/janne/nerd-facts-dbt/dbt_project/dbt_project.yml
[0m12:48:33.713739 [info ] [MainThread]: adapter type: postgres
[0m12:48:33.713984 [info ] [MainThread]: adapter version: 1.9.0
[0m12:48:33.797316 [info ] [MainThread]: Configuration:
[0m12:48:33.797824 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:48:33.798179 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:48:33.798492 [info ] [MainThread]: Required dependencies:
[0m12:48:33.798816 [debug] [MainThread]: Executing "git --help"
[0m12:48:33.800321 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:48:33.800669 [debug] [MainThread]: STDERR: "b''"
[0m12:48:33.800952 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:48:33.801274 [info ] [MainThread]: Connection:
[0m12:48:33.801625 [info ] [MainThread]:   host: localhost
[0m12:48:33.801920 [info ] [MainThread]:   port: 5432
[0m12:48:33.802208 [info ] [MainThread]:   user: dbt_user
[0m12:48:33.802490 [info ] [MainThread]:   database: nerd_facts
[0m12:48:33.802783 [info ] [MainThread]:   schema: public
[0m12:48:33.803067 [info ] [MainThread]:   connect_timeout: 10
[0m12:48:33.803353 [info ] [MainThread]:   role: None
[0m12:48:33.803629 [info ] [MainThread]:   search_path: None
[0m12:48:33.803916 [info ] [MainThread]:   keepalives_idle: 0
[0m12:48:33.804194 [info ] [MainThread]:   sslmode: None
[0m12:48:33.804482 [info ] [MainThread]:   sslcert: None
[0m12:48:33.804765 [info ] [MainThread]:   sslkey: None
[0m12:48:33.805053 [info ] [MainThread]:   sslrootcert: None
[0m12:48:33.805334 [info ] [MainThread]:   application_name: dbt
[0m12:48:33.805630 [info ] [MainThread]:   retries: 1
[0m12:48:33.806046 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:48:33.887743 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:48:33.908945 [debug] [MainThread]: Using postgres connection "debug"
[0m12:48:33.909337 [debug] [MainThread]: On debug: select 1 as id
[0m12:48:33.909662 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:33.922479 [debug] [MainThread]: SQL status: SELECT 1 in 0.013 seconds
[0m12:48:33.923457 [debug] [MainThread]: On debug: Close
[0m12:48:33.923983 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:48:33.924625 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:48:33.925751 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.31863078, "process_in_blocks": "32", "process_kernel_time": 0.063884, "process_mem_max_rss": "100936", "process_out_blocks": "24", "process_user_time": 1.153817}
[0m12:48:33.926286 [debug] [MainThread]: Command `dbt debug` succeeded at 12:48:33.926171 after 0.32 seconds
[0m12:48:33.926647 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:48:33.926973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8369b988b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836a9e5630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8369a69930>]}
[0m12:48:33.927340 [debug] [MainThread]: Flushing usage events
[0m12:48:34.329539 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:48:43.992391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbd3a4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbe2177c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbe217820>]}


============================== 12:48:43.994559 | 65757145-758a-49a2-8d78-60db90f70258 ==============================
[0m12:48:43.994559 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:48:43.994987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:48:44.129950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65757145-758a-49a2-8d78-60db90f70258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbe1c22f0>]}
[0m12:48:44.178211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65757145-758a-49a2-8d78-60db90f70258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbc41c4f0>]}
[0m12:48:44.178896 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:48:44.252141 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:48:44.306570 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:48:44.307006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '65757145-758a-49a2-8d78-60db90f70258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbcb319c0>]}
[0m12:48:45.069602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65757145-758a-49a2-8d78-60db90f70258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbb89b8e0>]}
[0m12:48:45.122264 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:48:45.124401 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:48:45.134326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65757145-758a-49a2-8d78-60db90f70258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbb9ff730>]}
[0m12:48:45.134803 [info ] [MainThread]: Found 1 model, 433 macros
[0m12:48:45.135189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65757145-758a-49a2-8d78-60db90f70258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbc6db370>]}
[0m12:48:45.136409 [info ] [MainThread]: 
[0m12:48:45.136735 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:48:45.136975 [info ] [MainThread]: 
[0m12:48:45.137360 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:48:45.138165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m12:48:45.168016 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m12:48:45.168421 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m12:48:45.168684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:45.182893 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m12:48:45.183944 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m12:48:45.185161 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public'
[0m12:48:45.190361 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:48:45.190695 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m12:48:45.190939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:45.204115 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:48:45.204542 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:48:45.204830 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:48:45.207312 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m12:48:45.208280 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m12:48:45.208692 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m12:48:45.212411 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:45.212800 [debug] [MainThread]: On master: BEGIN
[0m12:48:45.213046 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:45.225193 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:48:45.225580 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:45.225887 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:48:45.234227 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m12:48:45.235241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65757145-758a-49a2-8d78-60db90f70258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbb0fe2c0>]}
[0m12:48:45.235659 [debug] [MainThread]: On master: ROLLBACK
[0m12:48:45.236048 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:45.236295 [debug] [MainThread]: On master: BEGIN
[0m12:48:45.236754 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:48:45.237006 [debug] [MainThread]: On master: COMMIT
[0m12:48:45.237247 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:45.237487 [debug] [MainThread]: On master: COMMIT
[0m12:48:45.237799 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:48:45.238031 [debug] [MainThread]: On master: Close
[0m12:48:45.241566 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.pokemon
[0m12:48:45.242106 [info ] [Thread-1 (]: 1 of 1 START sql view model public.pokemon ..................................... [RUN]
[0m12:48:45.242542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.pokemon)
[0m12:48:45.242829 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.pokemon
[0m12:48:45.248288 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.pokemon"
[0m12:48:45.248857 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.pokemon
[0m12:48:45.278798 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.pokemon"
[0m12:48:45.279450 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m12:48:45.279794 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: BEGIN
[0m12:48:45.280053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:45.292380 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m12:48:45.292860 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m12:48:45.293170 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */

  create view "nerd_facts"."public"."pokemon__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM raw.pokeapi_pokemon
)

SELECT 
    id,
    name,
    CAST(height AS NUMERIC) AS height,  -- ✅ Convert to numeric
    CAST(weight AS NUMERIC) AS weight,  -- ✅ Convert to numeric
    ROUND(CAST(weight AS NUMERIC) / (CAST(height AS NUMERIC) * CAST(height AS NUMERIC)), 2) AS bmi
FROM source
  );
[0m12:48:45.295801 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:48:45.301772 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m12:48:45.302136 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */
alter table "nerd_facts"."public"."pokemon__dbt_tmp" rename to "pokemon"
[0m12:48:45.303044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:48:45.314497 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: COMMIT
[0m12:48:45.314887 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m12:48:45.315174 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: COMMIT
[0m12:48:45.322049 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m12:48:45.327346 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."pokemon__dbt_backup"
[0m12:48:45.330715 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m12:48:45.331059 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */
drop view if exists "nerd_facts"."public"."pokemon__dbt_backup" cascade
[0m12:48:45.331637 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:48:45.333813 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: Close
[0m12:48:45.335600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65757145-758a-49a2-8d78-60db90f70258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bba579c00>]}
[0m12:48:45.336360 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.pokemon ................................ [[32mCREATE VIEW[0m in 0.09s]
[0m12:48:45.336892 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.pokemon
[0m12:48:45.337890 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:45.338178 [debug] [MainThread]: On master: BEGIN
[0m12:48:45.338404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:48:45.350664 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:48:45.351060 [debug] [MainThread]: On master: COMMIT
[0m12:48:45.351323 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:45.351547 [debug] [MainThread]: On master: COMMIT
[0m12:48:45.351851 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:48:45.352096 [debug] [MainThread]: On master: Close
[0m12:48:45.352578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:45.352878 [debug] [MainThread]: Connection 'list_nerd_facts' was properly closed.
[0m12:48:45.353138 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.pokemon' was properly closed.
[0m12:48:45.353467 [info ] [MainThread]: 
[0m12:48:45.353898 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m12:48:45.354526 [debug] [MainThread]: Command end result
[0m12:48:45.370546 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:48:45.371869 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:48:45.376959 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m12:48:45.377310 [info ] [MainThread]: 
[0m12:48:45.377673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:48:45.377935 [info ] [MainThread]: 
[0m12:48:45.378203 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:48:45.378881 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4310274, "process_in_blocks": "3536", "process_kernel_time": 0.100062, "process_mem_max_rss": "110580", "process_out_blocks": "2536", "process_user_time": 2.176167}
[0m12:48:45.379234 [debug] [MainThread]: Command `dbt run` succeeded at 12:48:45.379153 after 1.43 seconds
[0m12:48:45.379523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbd3a4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbb683610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbe1c22f0>]}
[0m12:48:45.379818 [debug] [MainThread]: Flushing usage events
[0m12:48:45.766728 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:57:57.955438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc06d64970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc07c07760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc07c077c0>]}


============================== 12:57:57.958533 | 7199ce64-8df0-4a0c-b47f-2ea8170c05d0 ==============================
[0m12:57:57.958533 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:57:57.958977 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:57:58.096068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7199ce64-8df0-4a0c-b47f-2ea8170c05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc05e0f340>]}
[0m12:57:58.142484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7199ce64-8df0-4a0c-b47f-2ea8170c05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc07b67ac0>]}
[0m12:57:58.143467 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:57:58.217070 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:57:58.305350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:57:58.305887 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/pokemon.sql
[0m12:57:58.491290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7199ce64-8df0-4a0c-b47f-2ea8170c05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc04f86860>]}
[0m12:57:58.538635 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:57:58.540866 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:57:58.554423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7199ce64-8df0-4a0c-b47f-2ea8170c05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc04fc0970>]}
[0m12:57:58.554910 [info ] [MainThread]: Found 1 model, 433 macros
[0m12:57:58.555217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7199ce64-8df0-4a0c-b47f-2ea8170c05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc04fc0910>]}
[0m12:57:58.556503 [info ] [MainThread]: 
[0m12:57:58.556822 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:57:58.557051 [info ] [MainThread]: 
[0m12:57:58.557443 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:57:58.558205 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m12:57:58.594584 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m12:57:58.594973 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m12:57:58.595227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:58.610359 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m12:57:58.611563 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m12:57:58.613028 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public'
[0m12:57:58.619307 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:57:58.619692 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m12:57:58.619992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:58.632599 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:57:58.633026 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:57:58.633372 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:57:58.636211 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m12:57:58.637339 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m12:57:58.637801 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m12:57:58.642737 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:58.643130 [debug] [MainThread]: On master: BEGIN
[0m12:57:58.643426 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:58.655854 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:57:58.656268 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:58.656662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:57:58.665014 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m12:57:58.666214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7199ce64-8df0-4a0c-b47f-2ea8170c05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc04f5e170>]}
[0m12:57:58.666692 [debug] [MainThread]: On master: ROLLBACK
[0m12:57:58.667135 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:58.667448 [debug] [MainThread]: On master: BEGIN
[0m12:57:58.667911 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:57:58.668200 [debug] [MainThread]: On master: COMMIT
[0m12:57:58.668502 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:58.668778 [debug] [MainThread]: On master: COMMIT
[0m12:57:58.669133 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:57:58.669415 [debug] [MainThread]: On master: Close
[0m12:57:58.673007 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.pokemon
[0m12:57:58.673645 [info ] [Thread-1 (]: 1 of 1 START sql table model public.pokemon .................................... [RUN]
[0m12:57:58.674175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.pokemon)
[0m12:57:58.674530 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.pokemon
[0m12:57:58.682086 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.pokemon"
[0m12:57:58.682657 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.pokemon
[0m12:57:58.720937 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.pokemon"
[0m12:57:58.721697 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m12:57:58.722122 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: BEGIN
[0m12:57:58.722459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:58.735103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m12:57:58.735571 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m12:57:58.735954 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */

  
    

  create  table "nerd_facts"."public"."pokemon__dbt_tmp"
  
  
    as
  
  (
    

WITH source AS (
    SELECT * FROM raw.pokeapi_pokemon
)

SELECT 
    id,
    name,
    CAST(height AS NUMERIC) AS height,  -- ✅ Convert to numeric
    CAST(weight AS NUMERIC) AS weight,  -- ✅ Convert to numeric
    ROUND(CAST(weight AS NUMERIC) / (CAST(height AS NUMERIC) * CAST(height AS NUMERIC)), 2) AS bmi
FROM source
  );
  
[0m12:57:58.747749 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.011 seconds
[0m12:57:58.789578 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m12:57:58.789980 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */
alter table "nerd_facts"."public"."pokemon__dbt_tmp" rename to "pokemon"
[0m12:57:58.790673 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:57:58.805287 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: COMMIT
[0m12:57:58.805717 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m12:57:58.806002 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: COMMIT
[0m12:57:58.812039 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m12:57:58.817389 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."pokemon__dbt_backup"
[0m12:57:58.820751 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m12:57:58.821105 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */
drop table if exists "nerd_facts"."public"."pokemon__dbt_backup" cascade
[0m12:57:58.821637 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:57:58.823612 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: Close
[0m12:57:58.825740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7199ce64-8df0-4a0c-b47f-2ea8170c05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc07fb6d10>]}
[0m12:57:58.826493 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.pokemon ............................... [[32mSELECT 10[0m in 0.15s]
[0m12:57:58.827062 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.pokemon
[0m12:57:58.828123 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:58.828435 [debug] [MainThread]: On master: BEGIN
[0m12:57:58.828669 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:58.840921 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:57:58.841315 [debug] [MainThread]: On master: COMMIT
[0m12:57:58.841607 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:58.841845 [debug] [MainThread]: On master: COMMIT
[0m12:57:58.842179 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:57:58.842426 [debug] [MainThread]: On master: Close
[0m12:57:58.842870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:58.843094 [debug] [MainThread]: Connection 'list_nerd_facts' was properly closed.
[0m12:57:58.843283 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.pokemon' was properly closed.
[0m12:57:58.843511 [info ] [MainThread]: 
[0m12:57:58.843764 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m12:57:58.844351 [debug] [MainThread]: Command end result
[0m12:57:58.860081 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:57:58.861485 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:57:58.866759 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m12:57:58.867130 [info ] [MainThread]: 
[0m12:57:58.867477 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:57:58.867750 [info ] [MainThread]: 
[0m12:57:58.868019 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:57:58.869113 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9574552, "process_in_blocks": "68480", "process_kernel_time": 0.111841, "process_mem_max_rss": "110876", "process_out_blocks": "2536", "process_user_time": 1.768886}
[0m12:57:58.869502 [debug] [MainThread]: Command `dbt run` succeeded at 12:57:58.869406 after 0.96 seconds
[0m12:57:58.869788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc06d64970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc06be6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc052e55d0>]}
[0m12:57:58.870082 [debug] [MainThread]: Flushing usage events
[0m12:57:59.259740 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:06:42.512832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2fb3c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae30b1e740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae30b1e6e0>]}


============================== 11:06:42.515500 | 3765f1c5-b50b-4096-9c77-2b3592b5078f ==============================
[0m11:06:42.515500 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:06:42.515949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:06:42.519926 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m11:06:42.520326 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "nerd_facts_dbt", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!
[0m11:06:42.521454 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.053266954, "process_in_blocks": "32744", "process_kernel_time": 0.09489, "process_mem_max_rss": "84924", "process_out_blocks": "16", "process_user_time": 0.945292}
[0m11:06:42.521928 [debug] [MainThread]: Command `dbt run` failed at 11:06:42.521824 after 0.05 seconds
[0m11:06:42.522257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2fb3c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae30ab3a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae30b1e920>]}
[0m11:06:42.522564 [debug] [MainThread]: Flushing usage events
[0m11:06:42.954812 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:07:42.921719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cafb4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cbe5f880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cbe5f8e0>]}


============================== 11:07:42.924450 | 56ba4d59-0281-4bcf-833e-9653127158e8 ==============================
[0m11:07:42.924450 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:07:42.924993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:07:43.033042 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'raw', 'schema': 'raw', 'tables': [{'name': 'swapi_people'}, {'name': 'swapi_planets'}, {'name': 'swapi_starships'}, {'name': 'swapi_vehicles'}, {'name': 'swapi_species'}, {'name': 'swapi_films'}, {'name': 'pokeapi_pokemon'}, {'name': 'pokeapi_types'}, {'name': 'pokeapi_abilities'}, {'name': 'pokeapi_moves'}, {'name': 'pokeapi_items'}]}] is not of type 'object'

Error encountered in /home/janne/nerd-facts-dbt/dbt_project/dbt_project.yml
[0m11:07:43.034013 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.15678445, "process_in_blocks": "27696", "process_kernel_time": 0.080984, "process_mem_max_rss": "92012", "process_out_blocks": "8", "process_user_time": 1.080477}
[0m11:07:43.034441 [debug] [MainThread]: Command `dbt run` failed at 11:07:43.034334 after 0.16 seconds
[0m11:07:43.034803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cafb4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ca7a53f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ca31ae00>]}
[0m11:07:43.035176 [debug] [MainThread]: Flushing usage events
[0m11:07:43.446375 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:10:51.959857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aac4588b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aad3fb7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aad3fb850>]}


============================== 11:10:51.962134 | 5a3646a3-8349-4c8f-a535-7ad48571958f ==============================
[0m11:10:51.962134 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:10:51.962575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:10:52.084759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a3646a3-8349-4c8f-a535-7ad48571958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aab503f10>]}
[0m11:10:52.131455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a3646a3-8349-4c8f-a535-7ad48571958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aab500520>]}
[0m11:10:52.141101 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:10:52.217609 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:10:52.273908 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:10:52.274350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5a3646a3-8349-4c8f-a535-7ad48571958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aabc0ad40>]}
[0m11:10:53.005040 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_swapi_people (models/swapi/stg_swapi_people.sql)
  invalid syntax for function call expression
    line 1
      {{ config(
[0m11:10:53.006019 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0907583, "process_in_blocks": "2384", "process_kernel_time": 0.088138, "process_mem_max_rss": "99560", "process_out_blocks": "16", "process_user_time": 1.948717}
[0m11:10:53.006470 [debug] [MainThread]: Command `dbt run` failed at 11:10:53.006369 after 1.09 seconds
[0m11:10:53.006832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aac4588b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aaa776ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aaa776e00>]}
[0m11:10:53.007199 [debug] [MainThread]: Flushing usage events
[0m11:10:53.395144 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:12:24.722009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb1b848e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb29fb7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb29fb850>]}


============================== 11:12:24.724251 | 8af75105-8af1-4637-927c-d9b4fbb8511a ==============================
[0m11:12:24.724251 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:12:24.724692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:12:24.852879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8af75105-8af1-4637-927c-d9b4fbb8511a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb0ebb700>]}
[0m11:12:24.900635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8af75105-8af1-4637-927c-d9b4fbb8511a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb0bfc7f0>]}
[0m11:12:24.901317 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:12:24.974835 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:12:25.033166 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:12:25.033618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8af75105-8af1-4637-927c-d9b4fbb8511a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb1354c40>]}
[0m11:12:25.910875 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.nerd_facts_dbt.marts
- models.nerd_facts_dbt.staging
[0m11:12:25.921980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8af75105-8af1-4637-927c-d9b4fbb8511a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbaf7fc0a0>]}
[0m11:12:25.994565 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:12:25.996924 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:12:26.010240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8af75105-8af1-4637-927c-d9b4fbb8511a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbaf7ff100>]}
[0m11:12:26.010732 [info ] [MainThread]: Found 5 models, 11 sources, 433 macros
[0m11:12:26.011118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8af75105-8af1-4637-927c-d9b4fbb8511a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb029b5e0>]}
[0m11:12:26.012665 [info ] [MainThread]: 
[0m11:12:26.013025 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:12:26.013342 [info ] [MainThread]: 
[0m11:12:26.013865 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:12:26.017671 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m11:12:26.052110 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m11:12:26.052555 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m11:12:26.052875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:26.067034 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m11:12:26.068256 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m11:12:26.069120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now create_nerd_facts_public_public)
[0m11:12:26.069725 [debug] [ThreadPool]: Creating schema "database: "nerd_facts"
schema: "public_public"
"
[0m11:12:26.075655 [debug] [ThreadPool]: Using postgres connection "create_nerd_facts_public_public"
[0m11:12:26.076004 [debug] [ThreadPool]: On create_nerd_facts_public_public: BEGIN
[0m11:12:26.076301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:12:26.089667 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m11:12:26.090147 [debug] [ThreadPool]: Using postgres connection "create_nerd_facts_public_public"
[0m11:12:26.090479 [debug] [ThreadPool]: On create_nerd_facts_public_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "create_nerd_facts_public_public"} */
create schema if not exists "public_public"
[0m11:12:26.091630 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m11:12:26.092531 [debug] [ThreadPool]: On create_nerd_facts_public_public: COMMIT
[0m11:12:26.092880 [debug] [ThreadPool]: Using postgres connection "create_nerd_facts_public_public"
[0m11:12:26.093177 [debug] [ThreadPool]: On create_nerd_facts_public_public: COMMIT
[0m11:12:26.099404 [debug] [ThreadPool]: SQL status: COMMIT in 0.006 seconds
[0m11:12:26.099764 [debug] [ThreadPool]: On create_nerd_facts_public_public: Close
[0m11:12:26.101694 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public_public'
[0m11:12:26.108035 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:12:26.108423 [debug] [ThreadPool]: On list_nerd_facts_public_public: BEGIN
[0m11:12:26.108720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:26.122108 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m11:12:26.122487 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:12:26.122794 [debug] [ThreadPool]: On list_nerd_facts_public_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m11:12:26.125411 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m11:12:26.126363 [debug] [ThreadPool]: On list_nerd_facts_public_public: ROLLBACK
[0m11:12:26.126773 [debug] [ThreadPool]: On list_nerd_facts_public_public: Close
[0m11:12:26.130960 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:26.131364 [debug] [MainThread]: On master: BEGIN
[0m11:12:26.131628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:12:26.144534 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m11:12:26.144922 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:26.145219 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:12:26.152061 [debug] [MainThread]: SQL status: SELECT 28 in 0.006 seconds
[0m11:12:26.153483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8af75105-8af1-4637-927c-d9b4fbb8511a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbaec77b80>]}
[0m11:12:26.153920 [debug] [MainThread]: On master: ROLLBACK
[0m11:12:26.154448 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:26.154708 [debug] [MainThread]: On master: BEGIN
[0m11:12:26.155126 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:12:26.155384 [debug] [MainThread]: On master: COMMIT
[0m11:12:26.155620 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:26.155844 [debug] [MainThread]: On master: COMMIT
[0m11:12:26.156132 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:12:26.156372 [debug] [MainThread]: On master: Close
[0m11:12:26.159145 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_swapi_people
[0m11:12:26.159577 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:12:26.161004 [info ] [Thread-2 (]: 2 of 5 START sql view model public_public.stg_swapi_planets .................... [RUN]
[0m11:12:26.160512 [info ] [Thread-1 (]: 1 of 5 START sql view model public_public.stg_swapi_people ..................... [RUN]
[0m11:12:26.161932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public_public, now model.nerd_facts_dbt.stg_swapi_people)
[0m11:12:26.161536 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly create_nerd_facts_public_public, now model.nerd_facts_dbt.stg_swapi_planets)
[0m11:12:26.162581 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_planets
[0m11:12:26.160068 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:12:26.162270 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_people
[0m11:12:26.169722 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:12:26.174268 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:12:26.170421 [info ] [Thread-3 (]: 3 of 5 START sql view model public_public.stg_swapi_starships .................. [RUN]
[0m11:12:26.175329 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_swapi_planets
[0m11:12:26.175664 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_swapi_people
[0m11:12:26.176168 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_starships'
[0m11:12:26.211668 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:12:26.213260 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_starships
[0m11:12:26.212789 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:12:26.216320 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:12:26.217129 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_starships
[0m11:12:26.220295 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:12:26.220944 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:12:26.221408 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:12:26.221821 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:12:26.222877 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: BEGIN
[0m11:12:26.222535 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: BEGIN
[0m11:12:26.223190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:26.222114 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: BEGIN
[0m11:12:26.224352 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:12:26.223545 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:12:26.249056 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m11:12:26.249765 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:12:26.250277 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */

  create view "nerd_facts"."public_public"."stg_swapi_planets__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    climate,
    terrain,
    diameter::INTEGER AS diameter,
    population::BIGINT AS population,
    gravity,
    orbital_period::INTEGER AS orbital_period,
    rotation_period::INTEGER AS rotation_period,
    surface_water::INTEGER AS surface_water,
    url
FROM "nerd_facts"."raw"."swapi_planets"
  );
[0m11:12:26.253233 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:12:26.262504 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:12:26.263152 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
alter table "nerd_facts"."public_public"."stg_swapi_planets__dbt_tmp" rename to "stg_swapi_planets"
[0m11:12:26.264137 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m11:12:26.265194 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:12:26.263771 [debug] [Thread-3 (]: SQL status: BEGIN in 0.039 seconds
[0m11:12:26.264825 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:12:26.265568 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */

  create view "nerd_facts"."public_public"."stg_swapi_people__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    height::DECIMAL AS height,
    mass::DECIMAL AS mass,
    hair_color,
    skin_color,
    eye_color,
    birth_year,
    gender,
    homeworld::INTEGER AS homeworld_id, -- Convert homeworld URL to integer UID
    species::JSONB AS species_ids, -- Store multiple species as JSONB
    url
FROM "nerd_facts"."raw"."swapi_people"
  );
[0m11:12:26.265917 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:12:26.280672 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: COMMIT
[0m11:12:26.281219 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */

  create view "nerd_facts"."public_public"."stg_swapi_starships__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    model,
    manufacturer,

    -- ✅ Use NULLIF to avoid errors if value is empty ('')
    NULLIF(cost_in_credits, '')::BIGINT AS cost_in_credits,
    NULLIF(length, '')::DECIMAL AS length,
    NULLIF(max_atmosphering_speed, '')::INTEGER AS max_atmosphering_speed,
    NULLIF(crew, '')::INTEGER AS crew,
    NULLIF(passengers, '')::INTEGER AS passengers,
    NULLIF(cargo_capacity, '')::BIGINT AS cargo_capacity,
    
    consumables,

    NULLIF(hyperdrive_rating, '')::DECIMAL AS hyperdrive_rating,
    NULLIF(MGLT, '')::INTEGER AS MGLT,
    
    starship_class,

    -- ✅ Ensure pilots column is always valid JSONB
    CASE 
        WHEN pilots IS NULL OR pilots = '' THEN '[]'::JSONB
        ELSE pilots::JSONB
    END AS pilot_ids,

    url

FROM "nerd_facts"."raw"."swapi_starships"
  );
[0m11:12:26.284665 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:12:26.282100 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:12:26.287778 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:12:26.281690 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "species" does not exist
LINE 20:     species::JSONB AS species_ids, -- Store multiple species...
             ^

[0m11:12:26.288207 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: COMMIT
[0m11:12:26.288954 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: ROLLBACK
[0m11:12:26.288590 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
alter table "nerd_facts"."public_public"."stg_swapi_starships__dbt_tmp" rename to "stg_swapi_starships"
[0m11:12:26.289644 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: Close
[0m11:12:26.290952 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:12:26.293066 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: COMMIT
[0m11:12:26.293525 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m11:12:26.294003 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:12:26.300339 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_planets__dbt_backup"
[0m11:12:26.301002 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: COMMIT
[0m11:12:26.305365 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:12:26.306125 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_planets__dbt_backup" cascade
[0m11:12:26.306930 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:12:26.309741 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: Close
[0m11:12:26.310313 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m11:12:26.314008 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_starships__dbt_backup"
[0m11:12:26.316519 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:12:26.316934 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8af75105-8af1-4637-927c-d9b4fbb8511a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbaec327d0>]}
[0m11:12:26.317566 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_starships__dbt_backup" cascade
[0m11:12:26.318213 [debug] [Thread-1 (]: Database Error in model stg_swapi_people (models/swapi/stg_swapi_people.sql)
  column "species" does not exist
  LINE 20:     species::JSONB AS species_ids, -- Store multiple species...
               ^
  compiled code at target/run/nerd_facts_dbt/models/swapi/stg_swapi_people.sql
[0m11:12:26.319425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8af75105-8af1-4637-927c-d9b4fbb8511a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbaeb501c0>]}
[0m11:12:26.318883 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_public.stg_swapi_planets ............... [[32mCREATE VIEW[0m in 0.15s]
[0m11:12:26.320243 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model public_public.stg_swapi_people ............ [[31mERROR[0m in 0.16s]
[0m11:12:26.321691 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_swapi_people
[0m11:12:26.320684 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:12:26.322183 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_people' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_people (models/swapi/stg_swapi_people.sql)
  column "species" does not exist
  LINE 20:     species::JSONB AS species_ids, -- Store multiple species...
               ^
  compiled code at target/run/nerd_facts_dbt/models/swapi/stg_swapi_people.sql.
[0m11:12:26.321180 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:12:26.323449 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: Close
[0m11:12:26.324742 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.dim_people
[0m11:12:26.325301 [info ] [Thread-4 (]: 4 of 5 SKIP relation public_public.dim_people .................................. [[33mSKIP[0m]
[0m11:12:26.325972 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.dim_people
[0m11:12:26.328375 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8af75105-8af1-4637-927c-d9b4fbb8511a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbaec32860>]}
[0m11:12:26.329060 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public_public.stg_swapi_starships ............. [[32mCREATE VIEW[0m in 0.15s]
[0m11:12:26.329658 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:12:26.330399 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m11:12:26.330810 [info ] [Thread-2 (]: 5 of 5 SKIP relation public_public.fact_starships .............................. [[33mSKIP[0m]
[0m11:12:26.331289 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m11:12:26.332402 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:26.332714 [debug] [MainThread]: On master: BEGIN
[0m11:12:26.332973 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:12:26.345620 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m11:12:26.346088 [debug] [MainThread]: On master: COMMIT
[0m11:12:26.346450 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:26.346752 [debug] [MainThread]: On master: COMMIT
[0m11:12:26.347155 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:12:26.347482 [debug] [MainThread]: On master: Close
[0m11:12:26.348119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:12:26.348467 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_planets' was properly closed.
[0m11:12:26.348781 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_people' was properly closed.
[0m11:12:26.349082 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_starships' was properly closed.
[0m11:12:26.349559 [info ] [MainThread]: 
[0m11:12:26.350039 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m11:12:26.351098 [debug] [MainThread]: Command end result
[0m11:12:26.374790 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:12:26.376309 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:12:26.382464 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m11:12:26.382880 [info ] [MainThread]: 
[0m11:12:26.383240 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:12:26.383547 [info ] [MainThread]: 
[0m11:12:26.383860 [error] [MainThread]:   Database Error in model stg_swapi_people (models/swapi/stg_swapi_people.sql)
  column "species" does not exist
  LINE 20:     species::JSONB AS species_ids, -- Store multiple species...
               ^
  compiled code at target/run/nerd_facts_dbt/models/swapi/stg_swapi_people.sql
[0m11:12:26.384119 [info ] [MainThread]: 
[0m11:12:26.384384 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
[0m11:12:26.385096 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7062106, "process_in_blocks": "2688", "process_kernel_time": 0.143554, "process_mem_max_rss": "114428", "process_out_blocks": "2752", "process_user_time": 2.499896}
[0m11:12:26.385460 [debug] [MainThread]: Command `dbt run` failed at 11:12:26.385364 after 1.71 seconds
[0m11:12:26.385757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb1b848e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbaf848280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb0eba500>]}
[0m11:12:26.386074 [debug] [MainThread]: Flushing usage events
[0m11:12:26.776766 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:18:52.106440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4cd90910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4bd519c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4bd51960>]}


============================== 11:18:52.108540 | af8aacb8-fec5-4910-8e79-62dfa81b3d8e ==============================
[0m11:18:52.108540 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:18:52.108970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m11:18:52.234082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af8aacb8-fec5-4910-8e79-62dfa81b3d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4be3aad0>]}
[0m11:18:52.285613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af8aacb8-fec5-4910-8e79-62dfa81b3d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4be384f0>]}
[0m11:18:52.286324 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:18:52.362283 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:18:52.459025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m11:18:52.459594 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/swapi/swapi_people_species.sql
[0m11:18:52.459977 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/swapi/people_with_species.sql
[0m11:18:52.460370 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/swapi/stg_swapi_people.sql
[0m11:18:52.692499 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.nerd_facts_dbt.marts
- models.nerd_facts_dbt.staging
[0m11:18:52.704971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af8aacb8-fec5-4910-8e79-62dfa81b3d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4afd5540>]}
[0m11:18:52.766207 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:18:52.768273 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:18:52.776610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af8aacb8-fec5-4910-8e79-62dfa81b3d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4aff27a0>]}
[0m11:18:52.777062 [info ] [MainThread]: Found 7 models, 11 sources, 433 macros
[0m11:18:52.777369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af8aacb8-fec5-4910-8e79-62dfa81b3d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4b1e56c0>]}
[0m11:18:52.778846 [info ] [MainThread]: 
[0m11:18:52.779173 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:18:52.779451 [info ] [MainThread]: 
[0m11:18:52.779857 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:18:52.783578 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public_public'
[0m11:18:52.815666 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:18:52.816142 [debug] [ThreadPool]: On list_nerd_facts_public_public: BEGIN
[0m11:18:52.816458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:52.829694 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m11:18:52.830109 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:18:52.830378 [debug] [ThreadPool]: On list_nerd_facts_public_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m11:18:52.833503 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m11:18:52.834590 [debug] [ThreadPool]: On list_nerd_facts_public_public: ROLLBACK
[0m11:18:52.835003 [debug] [ThreadPool]: On list_nerd_facts_public_public: Close
[0m11:18:52.842057 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:52.842502 [debug] [MainThread]: On master: BEGIN
[0m11:18:52.842893 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:18:52.855956 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m11:18:52.856352 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:52.856679 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:18:52.864646 [debug] [MainThread]: SQL status: SELECT 30 in 0.008 seconds
[0m11:18:52.866229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af8aacb8-fec5-4910-8e79-62dfa81b3d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4d032830>]}
[0m11:18:52.866649 [debug] [MainThread]: On master: ROLLBACK
[0m11:18:52.867034 [debug] [MainThread]: On master: Close
[0m11:18:52.869106 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_swapi_people
[0m11:18:52.869979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public_public, now model.nerd_facts_dbt.stg_swapi_people)
[0m11:18:52.870699 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_people
[0m11:18:52.870331 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:18:52.869576 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:18:52.876514 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.swapi_people_species
[0m11:18:52.878679 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:18:52.879312 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_starships'
[0m11:18:52.879772 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_planets'
[0m11:18:52.880197 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.swapi_people_species'
[0m11:18:52.881272 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.swapi_people_species
[0m11:18:52.880926 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_planets
[0m11:18:52.880634 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_starships
[0m11:18:52.881672 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_swapi_people
[0m11:18:52.921777 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.swapi_people_species"
[0m11:18:52.924501 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:18:52.927120 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:18:52.927897 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_swapi_people
[0m11:18:52.928722 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.swapi_people_species
[0m11:18:52.929449 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_swapi_planets
[0m11:18:52.930264 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.swapi_people_species
[0m11:18:52.930682 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_starships
[0m11:18:52.931952 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:18:52.932396 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.people_with_species
[0m11:18:52.932805 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_starships, now model.nerd_facts_dbt.people_with_species)
[0m11:18:52.933511 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.people_with_species
[0m11:18:52.933118 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m11:18:52.931275 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:18:52.936412 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.people_with_species"
[0m11:18:52.936913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_people, now model.nerd_facts_dbt.fact_starships)
[0m11:18:52.937569 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.dim_people
[0m11:18:52.937974 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m11:18:52.938370 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.swapi_people_species, now model.nerd_facts_dbt.dim_people)
[0m11:18:52.938646 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.people_with_species
[0m11:18:52.942804 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.people_with_species
[0m11:18:52.941807 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m11:18:52.942215 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.dim_people
[0m11:18:52.946110 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_people"
[0m11:18:52.946530 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m11:18:52.946970 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.dim_people
[0m11:18:52.947514 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m11:18:52.948097 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.dim_people
[0m11:18:52.949095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:52.949367 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_starships' was properly closed.
[0m11:18:52.949608 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.people_with_species' was properly closed.
[0m11:18:52.949810 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_planets' was properly closed.
[0m11:18:52.950005 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_people' was properly closed.
[0m11:18:52.951050 [debug] [MainThread]: Command end result
[0m11:18:52.969570 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:18:52.971020 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:18:52.976920 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m11:18:52.977754 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.915231, "process_in_blocks": "0", "process_kernel_time": 0.059807, "process_mem_max_rss": "111188", "process_out_blocks": "2784", "process_user_time": 1.748966}
[0m11:18:52.978126 [debug] [MainThread]: Command `dbt compile` succeeded at 11:18:52.978046 after 0.92 seconds
[0m11:18:52.978423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4cd90910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4db21120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4cb08ca0>]}
[0m11:18:52.978723 [debug] [MainThread]: Flushing usage events
[0m11:18:53.430654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:18:59.765807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cc2188b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cd08b7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cd08b850>]}


============================== 11:18:59.767871 | 0e321986-aeff-40d7-b400-9ad1a68091cf ==============================
[0m11:18:59.767871 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:18:59.768291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:18:59.898641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cb293f10>]}
[0m11:18:59.946416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cb290520>]}
[0m11:18:59.947124 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:19:00.033491 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:19:00.186554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:19:00.187118 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:19:00.195090 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.nerd_facts_dbt.marts
- models.nerd_facts_dbt.staging
[0m11:19:00.234230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ca4b9990>]}
[0m11:19:00.301011 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:19:00.302883 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:19:00.311879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ca4b82b0>]}
[0m11:19:00.312400 [info ] [MainThread]: Found 7 models, 11 sources, 433 macros
[0m11:19:00.312789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ca4b8370>]}
[0m11:19:00.314479 [info ] [MainThread]: 
[0m11:19:00.314904 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:19:00.315220 [info ] [MainThread]: 
[0m11:19:00.315725 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:19:00.320027 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m11:19:00.351728 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m11:19:00.352175 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m11:19:00.352495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:00.367995 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.015 seconds
[0m11:19:00.369511 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m11:19:00.372928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_public_public)
[0m11:19:00.380266 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:19:00.380691 [debug] [ThreadPool]: On list_nerd_facts_public_public: BEGIN
[0m11:19:00.381003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:19:00.393601 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m11:19:00.394022 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:19:00.394385 [debug] [ThreadPool]: On list_nerd_facts_public_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m11:19:00.397058 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m11:19:00.398290 [debug] [ThreadPool]: On list_nerd_facts_public_public: ROLLBACK
[0m11:19:00.398733 [debug] [ThreadPool]: On list_nerd_facts_public_public: Close
[0m11:19:00.404388 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:00.404766 [debug] [MainThread]: On master: BEGIN
[0m11:19:00.405066 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:19:00.417572 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:19:00.418009 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:00.418386 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:19:00.425910 [debug] [MainThread]: SQL status: SELECT 30 in 0.007 seconds
[0m11:19:00.427595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ca5f0d60>]}
[0m11:19:00.428062 [debug] [MainThread]: On master: ROLLBACK
[0m11:19:00.428501 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:00.428803 [debug] [MainThread]: On master: BEGIN
[0m11:19:00.429299 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:19:00.429612 [debug] [MainThread]: On master: COMMIT
[0m11:19:00.429904 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:00.430183 [debug] [MainThread]: On master: COMMIT
[0m11:19:00.430551 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:19:00.430840 [debug] [MainThread]: On master: Close
[0m11:19:00.434769 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_swapi_people
[0m11:19:00.435301 [info ] [Thread-1 (]: 1 of 7 START sql view model public_public.stg_swapi_people ..................... [RUN]
[0m11:19:00.435787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public_public, now model.nerd_facts_dbt.stg_swapi_people)
[0m11:19:00.436066 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_people
[0m11:19:00.442767 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:19:00.443123 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:19:00.443399 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.swapi_people_species
[0m11:19:00.444494 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:19:00.445051 [info ] [Thread-2 (]: 2 of 7 START sql view model public_public.stg_swapi_planets .................... [RUN]
[0m11:19:00.445457 [info ] [Thread-3 (]: 3 of 7 START sql view model public_public.stg_swapi_starships .................. [RUN]
[0m11:19:00.445827 [info ] [Thread-4 (]: 4 of 7 START sql table model public_public.swapi_people_species ................ [RUN]
[0m11:19:00.446702 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_planets'
[0m11:19:00.447208 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_starships'
[0m11:19:00.447629 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.swapi_people_species'
[0m11:19:00.448079 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_planets
[0m11:19:00.448491 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_swapi_people
[0m11:19:00.448808 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_starships
[0m11:19:00.449097 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.swapi_people_species
[0m11:19:00.451771 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:19:00.475046 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:19:00.487402 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.swapi_people_species"
[0m11:19:00.488020 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:19:00.488770 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_starships
[0m11:19:00.493156 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:19:00.489746 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.swapi_people_species
[0m11:19:00.489279 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_swapi_planets
[0m11:19:00.493859 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:19:00.507033 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:19:00.512906 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:19:00.513296 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: BEGIN
[0m11:19:00.516271 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.swapi_people_species"
[0m11:19:00.516847 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: BEGIN
[0m11:19:00.518162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:19:00.517583 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:19:00.518944 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: BEGIN
[0m11:19:00.519214 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:19:00.518514 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:19:00.517221 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:19:00.523870 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: BEGIN
[0m11:19:00.529723 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:19:00.545261 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m11:19:00.545798 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:19:00.546376 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */

  create view "nerd_facts"."public_public"."stg_swapi_people__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    height::DECIMAL AS height,
    mass::DECIMAL AS mass,
    hair_color,
    skin_color,
    eye_color,
    birth_year,
    gender,
    homeworld::INTEGER AS homeworld_id, -- Convert homeworld URL to integer UID    
    url
FROM "nerd_facts"."raw"."swapi_people"
  );
[0m11:19:00.546817 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m11:19:00.547515 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:19:00.547859 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */

  create view "nerd_facts"."public_public"."stg_swapi_planets__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    climate,
    terrain,
    diameter::INTEGER AS diameter,
    population::BIGINT AS population,
    gravity,
    orbital_period::INTEGER AS orbital_period,
    rotation_period::INTEGER AS rotation_period,
    surface_water::INTEGER AS surface_water,
    url
FROM "nerd_facts"."raw"."swapi_planets"
  );
[0m11:19:00.548983 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:19:00.547133 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m11:19:00.555355 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:19:00.554631 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m11:19:00.554956 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m11:19:00.558938 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:19:00.555730 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */

  create view "nerd_facts"."public_public"."stg_swapi_starships__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    model,
    manufacturer,

    -- ✅ Use NULLIF to avoid errors if value is empty ('')
    NULLIF(cost_in_credits, '')::BIGINT AS cost_in_credits,
    NULLIF(length, '')::DECIMAL AS length,
    NULLIF(max_atmosphering_speed, '')::INTEGER AS max_atmosphering_speed,
    NULLIF(crew, '')::INTEGER AS crew,
    NULLIF(passengers, '')::INTEGER AS passengers,
    NULLIF(cargo_capacity, '')::BIGINT AS cargo_capacity,
    
    consumables,

    NULLIF(hyperdrive_rating, '')::DECIMAL AS hyperdrive_rating,
    NULLIF(MGLT, '')::INTEGER AS MGLT,
    
    starship_class,

    -- ✅ Ensure pilots column is always valid JSONB
    CASE 
        WHEN pilots IS NULL OR pilots = '' THEN '[]'::JSONB
        ELSE pilots::JSONB
    END AS pilot_ids,

    url

FROM "nerd_facts"."raw"."swapi_starships"
  );
[0m11:19:00.558331 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:19:00.559864 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
alter table "nerd_facts"."public_public"."stg_swapi_planets" rename to "stg_swapi_planets__dbt_backup"
[0m11:19:00.560482 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:19:00.554250 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:19:00.559323 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.swapi_people_species"} */

  
    

  create  table "nerd_facts"."public_public"."swapi_people_species__dbt_tmp"
  
  
    as
  
  (
    

WITH species_data AS (
    SELECT
        id AS species_id,
        jsonb_array_elements_text(people)::INTEGER AS person_id  -- Extract JSONB array
    FROM "nerd_facts"."raw"."swapi_species"
)

SELECT
    person_id,
    species_id
FROM species_data
WHERE person_id IS NOT NULL
  );
  
[0m11:19:00.599855 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.040 seconds
[0m11:19:00.600893 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:19:00.601466 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */
alter table "nerd_facts"."public_public"."stg_swapi_people__dbt_tmp" rename to "stg_swapi_people"
[0m11:19:00.606061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:19:00.604934 [debug] [Thread-4 (]: Postgres adapter: Postgres error: function jsonb_array_elements_text(text) does not exist
LINE 17:         jsonb_array_elements_text(people)::INTEGER AS person...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m11:19:00.616859 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: ROLLBACK
[0m11:19:00.619071 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: Close
[0m11:19:00.605321 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
alter table "nerd_facts"."public_public"."stg_swapi_planets__dbt_tmp" rename to "stg_swapi_planets"
[0m11:19:00.618167 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: COMMIT
[0m11:19:00.604391 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:19:00.624437 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
alter table "nerd_facts"."public_public"."stg_swapi_starships" rename to "stg_swapi_starships__dbt_backup"
[0m11:19:00.623541 [debug] [Thread-4 (]: Database Error in model swapi_people_species (models/swapi/swapi_people_species.sql)
  function jsonb_array_elements_text(text) does not exist
  LINE 17:         jsonb_array_elements_text(people)::INTEGER AS person...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/swapi/swapi_people_species.sql
[0m11:19:00.624025 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:19:00.622277 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:19:00.625319 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:19:00.626458 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: COMMIT
[0m11:19:00.627570 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37c984eec0>]}
[0m11:19:00.634825 [error] [Thread-4 (]: 4 of 7 ERROR creating sql table model public_public.swapi_people_species ....... [[31mERROR[0m in 0.18s]
[0m11:19:00.633962 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:19:00.635408 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.swapi_people_species
[0m11:19:00.631010 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: COMMIT
[0m11:19:00.635798 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
alter table "nerd_facts"."public_public"."stg_swapi_starships__dbt_tmp" rename to "stg_swapi_starships"
[0m11:19:00.636353 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.swapi_people_species' to be skipped because of status 'error'.  Reason: Database Error in model swapi_people_species (models/swapi/swapi_people_species.sql)
  function jsonb_array_elements_text(text) does not exist
  LINE 17:         jsonb_array_elements_text(people)::INTEGER AS person...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/swapi/swapi_people_species.sql.
[0m11:19:00.636796 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:19:00.637111 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m11:19:00.637982 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:19:00.645315 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: COMMIT
[0m11:19:00.643895 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_people__dbt_backup"
[0m11:19:00.645703 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:19:00.638824 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: COMMIT
[0m11:19:00.649162 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:19:00.650229 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_people__dbt_backup" cascade
[0m11:19:00.649601 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: COMMIT
[0m11:19:00.650869 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:19:00.653471 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: Close
[0m11:19:00.654716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cd456c50>]}
[0m11:19:00.655556 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public_public.stg_swapi_people ................ [[32mCREATE VIEW[0m in 0.22s]
[0m11:19:00.656259 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_swapi_people
[0m11:19:00.653876 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m11:19:00.659442 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_planets__dbt_backup"
[0m11:19:00.659990 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m11:19:00.660864 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:19:00.661231 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.people_with_species
[0m11:19:00.664506 [info ] [Thread-4 (]: 5 of 7 SKIP relation public_public.people_with_species ......................... [[33mSKIP[0m]
[0m11:19:00.664103 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_planets__dbt_backup" cascade
[0m11:19:00.664921 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.people_with_species
[0m11:19:00.663690 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_starships__dbt_backup"
[0m11:19:00.666631 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:19:00.667031 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_starships__dbt_backup" cascade
[0m11:19:00.669296 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m11:19:00.670696 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: Close
[0m11:19:00.671498 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37c97e5ae0>]}
[0m11:19:00.672327 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public_public.stg_swapi_planets ............... [[32mCREATE VIEW[0m in 0.22s]
[0m11:19:00.673132 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:19:00.674078 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m11:19:00.675397 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: Close
[0m11:19:00.676132 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ca509780>]}
[0m11:19:00.676906 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public_public.stg_swapi_starships ............. [[32mCREATE VIEW[0m in 0.23s]
[0m11:19:00.677597 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:19:00.678711 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.dim_people
[0m11:19:00.679057 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m11:19:00.679538 [info ] [Thread-1 (]: 6 of 7 START sql table model public_public.dim_people .......................... [RUN]
[0m11:19:00.679963 [info ] [Thread-4 (]: 7 of 7 START sql table model public_public.fact_starships ...................... [RUN]
[0m11:19:00.680566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_people, now model.nerd_facts_dbt.dim_people)
[0m11:19:00.680975 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.swapi_people_species, now model.nerd_facts_dbt.fact_starships)
[0m11:19:00.681337 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.dim_people
[0m11:19:00.681724 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m11:19:00.686399 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_people"
[0m11:19:00.689698 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m11:19:00.690391 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.dim_people
[0m11:19:00.690974 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m11:19:00.694615 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_people"
[0m11:19:00.698230 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m11:19:00.698983 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:19:00.699509 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m11:19:00.699927 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:19:00.700223 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:19:00.700557 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: BEGIN
[0m11:19:00.701095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:19:00.722267 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m11:19:00.722750 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m11:19:00.723172 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:19:00.723587 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:19:00.723962 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  
    

  create  table "nerd_facts"."public_public"."fact_starships__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    s.id AS starship_id,
    s.name AS starship_name,
    s.model,
    s.manufacturer,
    s.cost_in_credits,
    s.length,
    s.max_atmosphering_speed,
    s.crew,
    s.passengers,
    s.cargo_capacity,
    s.hyperdrive_rating,
    s.starship_class,
    p.id AS pilot_id,
    p.name AS pilot_name
FROM "nerd_facts"."public_public"."stg_swapi_starships" s
LEFT JOIN "nerd_facts"."public_public"."stg_swapi_people" p
ON p.id = ANY(ARRAY(SELECT jsonb_array_elements_text(s.pilot_ids)::INTEGER))
  );
  
[0m11:19:00.724342 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_people"} */

  
    

  create  table "nerd_facts"."public_public"."dim_people__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    p.id AS person_id,
    p.name,
    p.gender,
    p.skin_color,
    p.hair_color,
    p.height,
    p.eye_color,
    p.mass,
    pl.name AS homeworld_name,
    p.birth_year
FROM "nerd_facts"."public_public"."stg_swapi_people" p
LEFT JOIN "nerd_facts"."public_public"."stg_swapi_planets" pl
ON p.homeworld_id = pl.id
  );
  
[0m11:19:00.734411 [debug] [Thread-4 (]: Postgres adapter: Postgres error: invalid input syntax for type integer: "1000km"

[0m11:19:00.734996 [debug] [Thread-1 (]: Postgres adapter: Postgres error: invalid input syntax for type numeric: "unknown"

[0m11:19:00.735395 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_starships: ROLLBACK
[0m11:19:00.735788 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: ROLLBACK
[0m11:19:00.736372 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m11:19:00.736772 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: Close
[0m11:19:00.740813 [debug] [Thread-4 (]: Database Error in model fact_starships (models/swapi/fact_starships.sql)
  invalid input syntax for type integer: "1000km"
  compiled code at target/run/nerd_facts_dbt/models/swapi/fact_starships.sql
[0m11:19:00.741533 [debug] [Thread-1 (]: Database Error in model dim_people (models/swapi/dim_people.sql)
  invalid input syntax for type numeric: "unknown"
  compiled code at target/run/nerd_facts_dbt/models/swapi/dim_people.sql
[0m11:19:00.742043 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ca4cf0d0>]}
[0m11:19:00.742561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ca4b8580>]}
[0m11:19:00.743209 [error] [Thread-4 (]: 7 of 7 ERROR creating sql table model public_public.fact_starships ............. [[31mERROR[0m in 0.06s]
[0m11:19:00.743932 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model public_public.dim_people ................. [[31mERROR[0m in 0.06s]
[0m11:19:00.744520 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m11:19:00.745555 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_starships' to be skipped because of status 'error'.  Reason: Database Error in model fact_starships (models/swapi/fact_starships.sql)
  invalid input syntax for type integer: "1000km"
  compiled code at target/run/nerd_facts_dbt/models/swapi/fact_starships.sql.
[0m11:19:00.745024 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.dim_people
[0m11:19:00.746147 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.dim_people' to be skipped because of status 'error'.  Reason: Database Error in model dim_people (models/swapi/dim_people.sql)
  invalid input syntax for type numeric: "unknown"
  compiled code at target/run/nerd_facts_dbt/models/swapi/dim_people.sql.
[0m11:19:00.747372 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:00.747654 [debug] [MainThread]: On master: BEGIN
[0m11:19:00.747930 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:19:00.760495 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:19:00.760994 [debug] [MainThread]: On master: COMMIT
[0m11:19:00.761346 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:00.761605 [debug] [MainThread]: On master: COMMIT
[0m11:19:00.762004 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:19:00.762255 [debug] [MainThread]: On master: Close
[0m11:19:00.762742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:19:00.762982 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_people' was properly closed.
[0m11:19:00.763183 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_planets' was properly closed.
[0m11:19:00.763396 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_starships' was properly closed.
[0m11:19:00.763620 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_starships' was properly closed.
[0m11:19:00.763976 [info ] [MainThread]: 
[0m11:19:00.764338 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m11:19:00.765411 [debug] [MainThread]: Command end result
[0m11:19:00.784100 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:19:00.785403 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:19:00.790714 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m11:19:00.791065 [info ] [MainThread]: 
[0m11:19:00.791396 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m11:19:00.791690 [info ] [MainThread]: 
[0m11:19:00.791984 [error] [MainThread]:   Database Error in model swapi_people_species (models/swapi/swapi_people_species.sql)
  function jsonb_array_elements_text(text) does not exist
  LINE 17:         jsonb_array_elements_text(people)::INTEGER AS person...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/swapi/swapi_people_species.sql
[0m11:19:00.792229 [info ] [MainThread]: 
[0m11:19:00.792494 [error] [MainThread]:   Database Error in model fact_starships (models/swapi/fact_starships.sql)
  invalid input syntax for type integer: "1000km"
  compiled code at target/run/nerd_facts_dbt/models/swapi/fact_starships.sql
[0m11:19:00.792716 [info ] [MainThread]: 
[0m11:19:00.793005 [error] [MainThread]:   Database Error in model dim_people (models/swapi/dim_people.sql)
  invalid input syntax for type numeric: "unknown"
  compiled code at target/run/nerd_facts_dbt/models/swapi/dim_people.sql
[0m11:19:00.793228 [info ] [MainThread]: 
[0m11:19:00.793482 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=1 TOTAL=7
[0m11:19:00.794178 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.072439, "process_in_blocks": "0", "process_kernel_time": 0.088131, "process_mem_max_rss": "110568", "process_out_blocks": "1984", "process_user_time": 1.90333}
[0m11:19:00.794527 [debug] [MainThread]: Command `dbt run` failed at 11:19:00.794448 after 1.07 seconds
[0m11:19:00.794821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cc2188b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ca641360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cc094160>]}
[0m11:19:00.795143 [debug] [MainThread]: Flushing usage events
[0m11:19:01.257118 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:20:57.121801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b24f48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b14a77c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b14a7820>]}


============================== 11:20:57.123896 | a92cee78-5d0f-43ba-b3da-cb61fcb7715b ==============================
[0m11:20:57.123896 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:20:57.124325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:20:57.254630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b1859e70>]}
[0m11:20:57.303012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b159c7c0>]}
[0m11:20:57.303769 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:20:57.388958 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:20:57.479212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m11:20:57.479800 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/swapi/dim_people.sql
[0m11:20:57.480157 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/swapi/swapi_people_species.sql
[0m11:20:57.480457 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/swapi/fact_starships.sql
[0m11:20:57.682597 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.nerd_facts_dbt.staging
- models.nerd_facts_dbt.marts
[0m11:20:57.695347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b07254e0>]}
[0m11:20:57.759183 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:20:57.761260 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:20:57.770569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b0762860>]}
[0m11:20:57.771074 [info ] [MainThread]: Found 7 models, 11 sources, 433 macros
[0m11:20:57.771384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b0762530>]}
[0m11:20:57.772913 [info ] [MainThread]: 
[0m11:20:57.773236 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:20:57.773520 [info ] [MainThread]: 
[0m11:20:57.773939 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:20:57.778130 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m11:20:57.807251 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m11:20:57.807703 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m11:20:57.808081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:57.821674 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.013 seconds
[0m11:20:57.823044 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m11:20:57.825273 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public_public'
[0m11:20:57.831451 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:20:57.831829 [debug] [ThreadPool]: On list_nerd_facts_public_public: BEGIN
[0m11:20:57.832130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:57.845281 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m11:20:57.845681 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:20:57.845950 [debug] [ThreadPool]: On list_nerd_facts_public_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m11:20:57.848781 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m11:20:57.849874 [debug] [ThreadPool]: On list_nerd_facts_public_public: ROLLBACK
[0m11:20:57.850313 [debug] [ThreadPool]: On list_nerd_facts_public_public: Close
[0m11:20:57.854621 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:57.854991 [debug] [MainThread]: On master: BEGIN
[0m11:20:57.855246 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:20:57.867575 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:20:57.868002 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:57.868306 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:20:57.875350 [debug] [MainThread]: SQL status: SELECT 31 in 0.007 seconds
[0m11:20:57.877393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b0199030>]}
[0m11:20:57.877909 [debug] [MainThread]: On master: ROLLBACK
[0m11:20:57.878467 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:57.878734 [debug] [MainThread]: On master: BEGIN
[0m11:20:57.879157 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:20:57.879400 [debug] [MainThread]: On master: COMMIT
[0m11:20:57.879690 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:57.879910 [debug] [MainThread]: On master: COMMIT
[0m11:20:57.880199 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:20:57.880441 [debug] [MainThread]: On master: Close
[0m11:20:57.882416 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.dim_people
[0m11:20:57.882939 [info ] [Thread-1 (]: 1 of 7 START sql view model public_public.dim_people ........................... [RUN]
[0m11:20:57.883380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public_public, now model.nerd_facts_dbt.dim_people)
[0m11:20:57.883723 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.dim_people
[0m11:20:57.924147 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m11:20:57.924753 [info ] [Thread-2 (]: 2 of 7 START sql view model public_public.fact_starships ....................... [RUN]
[0m11:20:57.925246 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_people
[0m11:20:57.925721 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_nerd_facts, now model.nerd_facts_dbt.fact_starships)
[0m11:20:57.926017 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:20:57.926958 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m11:20:57.926583 [info ] [Thread-3 (]: 3 of 7 START sql view model public_public.stg_swapi_people ..................... [RUN]
[0m11:20:57.931534 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_people"
[0m11:20:57.932132 [info ] [Thread-4 (]: 4 of 7 START sql view model public_public.stg_swapi_planets .................... [RUN]
[0m11:20:57.935036 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m11:20:57.935655 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_people'
[0m11:20:57.936335 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_planets'
[0m11:20:57.936910 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.dim_people
[0m11:20:57.937712 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_people
[0m11:20:57.938202 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_planets
[0m11:20:57.949695 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m11:20:57.953703 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:20:57.962751 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:20:57.988688 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_people"
[0m11:20:57.989762 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi_planets
[0m11:20:57.990531 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:20:57.994208 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:20:57.994549 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_people
[0m11:20:57.997252 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m11:20:57.997657 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: BEGIN
[0m11:20:57.998237 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:20:58.001690 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:20:58.002328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:20:58.002782 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: BEGIN
[0m11:20:58.004297 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:20:58.003424 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:20:58.003789 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:20:58.006563 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m11:20:58.006916 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:20:58.006099 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: BEGIN
[0m11:20:58.010899 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:20:58.029308 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m11:20:58.033634 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m11:20:58.034051 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:20:58.034499 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:20:58.034829 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m11:20:58.035159 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m11:20:58.035475 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */

  create view "nerd_facts"."public_public"."stg_swapi_planets__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    climate,
    terrain,
    diameter::INTEGER AS diameter,
    population::BIGINT AS population,
    gravity,
    orbital_period::INTEGER AS orbital_period,
    rotation_period::INTEGER AS rotation_period,
    surface_water::INTEGER AS surface_water,
    url
FROM "nerd_facts"."raw"."swapi_planets"
  );
[0m11:20:58.035869 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_people"} */

  create view "nerd_facts"."public_public"."dim_people__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    -- ✅ Convert `height` safely
    CASE 
        WHEN height ~ '^\d+$' THEN height::DECIMAL
        ELSE NULL
    END AS height,
    -- ✅ Convert `mass` safely
    CASE 
        WHEN mass ~ '^\d+$' THEN mass::DECIMAL
        ELSE NULL
    END AS mass,
    hair_color,
    skin_color,
    eye_color,
    birth_year,
    gender,
    homeworld::INTEGER AS homeworld_id,
    url
FROM "nerd_facts"."raw"."swapi_people"
  );
[0m11:20:58.036242 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:20:58.036536 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:20:58.038694 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:20:58.039119 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:20:58.039532 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  create view "nerd_facts"."public_public"."fact_starships__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    model,
    manufacturer,
    cost_in_credits::BIGINT AS cost_in_credits,
    length::DECIMAL AS length,
    -- ✅ Convert `max_atmosphering_speed` safely
    CASE
        WHEN max_atmosphering_speed ~ '^\d+$' THEN max_atmosphering_speed::INTEGER
        ELSE NULL
    END AS max_atmosphering_speed,  
    crew::INTEGER AS crew,
    passengers::INTEGER AS passengers,
    cargo_capacity::BIGINT AS cargo_capacity,
    consumables,
    hyperdrive_rating::DECIMAL AS hyperdrive_rating,
    MGLT::INTEGER AS MGLT,
    starship_class,
    pilots::JSONB AS pilot_ids, -- JSONB for linked pilots
    url
FROM "nerd_facts"."raw"."swapi_starships"
  );
[0m11:20:58.039988 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */

  create view "nerd_facts"."public_public"."stg_swapi_people__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    height::DECIMAL AS height,
    mass::DECIMAL AS mass,
    hair_color,
    skin_color,
    eye_color,
    birth_year,
    gender,
    homeworld::INTEGER AS homeworld_id, -- Convert homeworld URL to integer UID    
    url
FROM "nerd_facts"."raw"."swapi_people"
  );
[0m11:20:58.045506 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:20:58.048310 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:20:58.051707 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_people"} */
alter table "nerd_facts"."public_public"."dim_people__dbt_tmp" rename to "dim_people"
[0m11:20:58.050854 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:20:58.050451 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:20:58.051297 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
alter table "nerd_facts"."public_public"."stg_swapi_planets" rename to "stg_swapi_planets__dbt_backup"
[0m11:20:58.054484 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:20:58.054906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:20:58.058217 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:20:58.058899 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */
alter table "nerd_facts"."public_public"."fact_starships__dbt_tmp" rename to "fact_starships"
[0m11:20:58.059263 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:20:58.070747 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */
alter table "nerd_facts"."public_public"."stg_swapi_people" rename to "stg_swapi_people__dbt_backup"
[0m11:20:58.070330 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: COMMIT
[0m11:20:58.074662 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:20:58.073995 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:20:58.074300 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:20:58.073537 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:20:58.075004 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: COMMIT
[0m11:20:58.076345 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: COMMIT
[0m11:20:58.078958 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:20:58.079455 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
alter table "nerd_facts"."public_public"."stg_swapi_planets__dbt_tmp" rename to "stg_swapi_planets"
[0m11:20:58.080011 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:20:58.080443 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */
alter table "nerd_facts"."public_public"."stg_swapi_people__dbt_tmp" rename to "stg_swapi_people"
[0m11:20:58.080892 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: COMMIT
[0m11:20:58.081524 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:20:58.086235 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: COMMIT
[0m11:20:58.087560 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:20:58.087166 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m11:20:58.086806 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m11:20:58.087989 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: COMMIT
[0m11:20:58.088353 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m11:20:58.097842 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public_public"."fact_starships__dbt_backup"
[0m11:20:58.094063 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public_public"."dim_people__dbt_backup"
[0m11:20:58.095432 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: COMMIT
[0m11:20:58.103267 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:20:58.102175 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m11:20:58.102879 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:20:58.106247 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_people"} */
drop view if exists "nerd_facts"."public_public"."dim_people__dbt_backup" cascade
[0m11:20:58.103655 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: COMMIT
[0m11:20:58.105756 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_people__dbt_backup"
[0m11:20:58.101788 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:20:58.107295 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:20:58.108350 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_people__dbt_backup" cascade
[0m11:20:58.107978 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */
drop view if exists "nerd_facts"."public_public"."fact_starships__dbt_backup" cascade
[0m11:20:58.107683 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:20:58.109417 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:20:58.109779 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m11:20:58.112067 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: Close
[0m11:20:58.112528 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m11:20:58.120171 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: Close
[0m11:20:58.116705 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_planets__dbt_backup"
[0m11:20:58.121640 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:20:58.113763 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m11:20:58.122618 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b35f44c0>]}
[0m11:20:58.123232 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public_public.fact_starships .................. [[32mCREATE VIEW[0m in 0.20s]
[0m11:20:58.123823 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m11:20:58.124240 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:20:58.124778 [info ] [Thread-2 (]: 5 of 7 START sql view model public_public.stg_swapi_starships .................. [RUN]
[0m11:20:58.125220 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_starships, now model.nerd_facts_dbt.stg_swapi_starships)
[0m11:20:58.125557 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_starships
[0m11:20:58.128462 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:20:58.120885 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b34de710>]}
[0m11:20:58.129225 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public_public.stg_swapi_people ................ [[32mCREATE VIEW[0m in 0.19s]
[0m11:20:58.121999 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_planets__dbt_backup" cascade
[0m11:20:58.118772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b01981f0>]}
[0m11:20:58.129755 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_people
[0m11:20:58.130521 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public_public.dim_people ...................... [[32mCREATE VIEW[0m in 0.23s]
[0m11:20:58.131220 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.swapi_people_species
[0m11:20:58.132677 [info ] [Thread-3 (]: 6 of 7 START sql table model public_public.swapi_people_species ................ [RUN]
[0m11:20:58.132229 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.dim_people
[0m11:20:58.131788 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_swapi_starships
[0m11:20:58.133157 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:20:58.133603 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_people, now model.nerd_facts_dbt.swapi_people_species)
[0m11:20:58.138819 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.swapi_people_species
[0m11:20:58.138431 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: Close
[0m11:20:58.142145 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b0756e00>]}
[0m11:20:58.142694 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public_public.stg_swapi_planets ............... [[32mCREATE VIEW[0m in 0.21s]
[0m11:20:58.143353 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:20:58.137162 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:20:58.144147 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:20:58.141379 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.swapi_people_species"
[0m11:20:58.144582 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_starships: BEGIN
[0m11:20:58.145138 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.swapi_people_species
[0m11:20:58.145450 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:20:58.163892 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.swapi_people_species"
[0m11:20:58.164790 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:20:58.165145 [debug] [Thread-3 (]: On model.nerd_facts_dbt.swapi_people_species: BEGIN
[0m11:20:58.165448 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:20:58.178529 [debug] [Thread-2 (]: SQL status: BEGIN in 0.033 seconds
[0m11:20:58.179133 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:20:58.179558 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m11:20:58.179930 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */

  create view "nerd_facts"."public_public"."stg_swapi_starships__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    model,
    manufacturer,

    -- ✅ Use NULLIF to avoid errors if value is empty ('')
    NULLIF(cost_in_credits, '')::BIGINT AS cost_in_credits,
    NULLIF(length, '')::DECIMAL AS length,
    NULLIF(max_atmosphering_speed, '')::INTEGER AS max_atmosphering_speed,
    NULLIF(crew, '')::INTEGER AS crew,
    NULLIF(passengers, '')::INTEGER AS passengers,
    NULLIF(cargo_capacity, '')::BIGINT AS cargo_capacity,
    
    consumables,

    NULLIF(hyperdrive_rating, '')::DECIMAL AS hyperdrive_rating,
    NULLIF(MGLT, '')::INTEGER AS MGLT,
    
    starship_class,

    -- ✅ Ensure pilots column is always valid JSONB
    CASE 
        WHEN pilots IS NULL OR pilots = '' THEN '[]'::JSONB
        ELSE pilots::JSONB
    END AS pilot_ids,

    url

FROM "nerd_facts"."raw"."swapi_starships"
  );
[0m11:20:58.180320 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:20:58.180747 [debug] [Thread-3 (]: On model.nerd_facts_dbt.swapi_people_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.swapi_people_species"} */

  
    

  create  table "nerd_facts"."public_public"."swapi_people_species__dbt_tmp"
  
  
    as
  
  (
    

WITH species_data AS (
    SELECT
        id AS species_id,
        jsonb_array_elements_text(people::JSONB)::INTEGER AS person_id  -- ✅ Cast TEXT to JSONB
    FROM "nerd_facts"."raw"."swapi_species"
)

SELECT
    person_id,
    species_id
FROM species_data
WHERE person_id IS NOT NULL
  );
  
[0m11:20:58.182531 [debug] [Thread-3 (]: SQL status: SELECT 50 in 0.001 seconds
[0m11:20:58.183002 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:20:58.186050 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:20:58.189151 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:20:58.189631 [debug] [Thread-3 (]: On model.nerd_facts_dbt.swapi_people_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.swapi_people_species"} */
alter table "nerd_facts"."public_public"."swapi_people_species__dbt_tmp" rename to "swapi_people_species"
[0m11:20:58.189986 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
alter table "nerd_facts"."public_public"."stg_swapi_starships" rename to "stg_swapi_starships__dbt_backup"
[0m11:20:58.190689 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:20:58.191042 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:20:58.195597 [debug] [Thread-3 (]: On model.nerd_facts_dbt.swapi_people_species: COMMIT
[0m11:20:58.199202 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:20:58.199711 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:20:58.200071 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
alter table "nerd_facts"."public_public"."stg_swapi_starships__dbt_tmp" rename to "stg_swapi_starships"
[0m11:20:58.200441 [debug] [Thread-3 (]: On model.nerd_facts_dbt.swapi_people_species: COMMIT
[0m11:20:58.201168 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:20:58.202483 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_starships: COMMIT
[0m11:20:58.202898 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:20:58.203267 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m11:20:58.203656 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_starships: COMMIT
[0m11:20:58.205685 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public_public"."swapi_people_species__dbt_backup"
[0m11:20:58.208278 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:20:58.208720 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m11:20:58.209142 [debug] [Thread-3 (]: On model.nerd_facts_dbt.swapi_people_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.swapi_people_species"} */
drop table if exists "nerd_facts"."public_public"."swapi_people_species__dbt_backup" cascade
[0m11:20:58.211268 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_starships__dbt_backup"
[0m11:20:58.212119 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:20:58.212436 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_starships__dbt_backup" cascade
[0m11:20:58.212814 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m11:20:58.214111 [debug] [Thread-3 (]: On model.nerd_facts_dbt.swapi_people_species: Close
[0m11:20:58.215751 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:20:58.216953 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_starships: Close
[0m11:20:58.217539 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b0199c60>]}
[0m11:20:58.218442 [info ] [Thread-3 (]: 6 of 7 OK created sql table model public_public.swapi_people_species ........... [[32mSELECT 50[0m in 0.08s]
[0m11:20:58.219141 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.swapi_people_species
[0m11:20:58.220435 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b35f44c0>]}
[0m11:20:58.220816 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.people_with_species
[0m11:20:58.221345 [info ] [Thread-1 (]: 7 of 7 START sql view model public_public.people_with_species .................. [RUN]
[0m11:20:58.221773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_people, now model.nerd_facts_dbt.people_with_species)
[0m11:20:58.222067 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.people_with_species
[0m11:20:58.225061 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.people_with_species"
[0m11:20:58.226189 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.people_with_species
[0m11:20:58.225739 [info ] [Thread-2 (]: 5 of 7 OK created sql view model public_public.stg_swapi_starships ............. [[32mCREATE VIEW[0m in 0.10s]
[0m11:20:58.229811 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.people_with_species"
[0m11:20:58.230370 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:20:58.231135 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:20:58.231481 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: BEGIN
[0m11:20:58.231770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:20:58.244355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m11:20:58.244848 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:20:58.245201 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.people_with_species"} */

  create view "nerd_facts"."public_public"."people_with_species__dbt_tmp"
    
    
  as (
    

SELECT
    p.id,
    p.name,
    s.species_id
FROM "nerd_facts"."public_public"."stg_swapi_people" p
LEFT JOIN "nerd_facts"."public_public"."swapi_people_species" s ON p.id = s.person_id
  );
[0m11:20:58.246815 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m11:20:58.249596 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:20:58.249984 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.people_with_species"} */
alter table "nerd_facts"."public_public"."people_with_species__dbt_tmp" rename to "people_with_species"
[0m11:20:58.250623 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:20:58.251885 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: COMMIT
[0m11:20:58.252253 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:20:58.252586 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: COMMIT
[0m11:20:58.255148 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:20:58.257755 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public_public"."people_with_species__dbt_backup"
[0m11:20:58.258497 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:20:58.258865 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.people_with_species"} */
drop view if exists "nerd_facts"."public_public"."people_with_species__dbt_backup" cascade
[0m11:20:58.259454 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:20:58.260680 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: Close
[0m11:20:58.261505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b0199c60>]}
[0m11:20:58.262352 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public_public.people_with_species ............. [[32mCREATE VIEW[0m in 0.04s]
[0m11:20:58.263159 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.people_with_species
[0m11:20:58.264589 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:58.264890 [debug] [MainThread]: On master: BEGIN
[0m11:20:58.265177 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:20:58.277686 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:20:58.278204 [debug] [MainThread]: On master: COMMIT
[0m11:20:58.278557 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:58.278858 [debug] [MainThread]: On master: COMMIT
[0m11:20:58.279248 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:20:58.279565 [debug] [MainThread]: On master: Close
[0m11:20:58.280204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:20:58.280558 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_starships' was properly closed.
[0m11:20:58.280891 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.people_with_species' was properly closed.
[0m11:20:58.281203 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.swapi_people_species' was properly closed.
[0m11:20:58.281559 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_planets' was properly closed.
[0m11:20:58.282016 [info ] [MainThread]: 
[0m11:20:58.282556 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m11:20:58.284042 [debug] [MainThread]: Command end result
[0m11:20:58.305042 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:20:58.306448 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:20:58.312184 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m11:20:58.312563 [info ] [MainThread]: 
[0m11:20:58.312881 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:20:58.313144 [info ] [MainThread]: 
[0m11:20:58.313410 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m11:20:58.314139 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2359911, "process_in_blocks": "0", "process_kernel_time": 0.104852, "process_mem_max_rss": "114188", "process_out_blocks": "2888", "process_user_time": 2.064331}
[0m11:20:58.314511 [debug] [MainThread]: Command `dbt run` succeeded at 11:20:58.314403 after 1.24 seconds
[0m11:20:58.314811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b24f48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b238df30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b0784ac0>]}
[0m11:20:58.315121 [debug] [MainThread]: Flushing usage events
[0m11:20:58.800666 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:25:05.224832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9a5c8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9957fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9957fd60>]}


============================== 11:25:05.227256 | 1933344c-7b00-440b-9811-f51768ab0f0c ==============================
[0m11:25:05.227256 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:25:05.227840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m11:25:05.318135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1933344c-7b00-440b-9811-f51768ab0f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9b5174f0>]}
[0m11:25:05.327935 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.14595011, "process_in_blocks": "8", "process_kernel_time": 0.047938, "process_mem_max_rss": "88712", "process_out_blocks": "8", "process_user_time": 1.070898}
[0m11:25:05.328505 [debug] [MainThread]: Command `dbt clean` succeeded at 11:25:05.328378 after 0.15 seconds
[0m11:25:05.328957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9a5c8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9b5152d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce99584250>]}
[0m11:25:05.329473 [debug] [MainThread]: Flushing usage events
[0m11:25:05.730760 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:25:10.122343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184c82c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184d645990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184d645930>]}


============================== 11:25:10.124612 | bf46cf0f-d09e-4250-acfd-2b46709348a5 ==============================
[0m11:25:10.124612 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:25:10.125024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:25:10.248417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184d63eb00>]}
[0m11:25:10.298230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184c59ca90>]}
[0m11:25:10.298929 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:25:10.372353 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:25:10.372929 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:25:10.373251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184af458a0>]}
[0m11:25:11.288482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184a62e7a0>]}
[0m11:25:11.356758 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:25:11.358740 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:25:11.367811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184c6c0880>]}
[0m11:25:11.368263 [info ] [MainThread]: Found 7 models, 11 sources, 433 macros
[0m11:25:11.368580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184a606500>]}
[0m11:25:11.370093 [info ] [MainThread]: 
[0m11:25:11.370419 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:25:11.370690 [info ] [MainThread]: 
[0m11:25:11.371108 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:25:11.375096 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m11:25:11.403993 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m11:25:11.404436 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m11:25:11.404749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:11.418179 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m11:25:11.419312 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m11:25:11.420057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now create_nerd_facts_public_public)
[0m11:25:11.420505 [debug] [ThreadPool]: Creating schema "database: "nerd_facts"
schema: "public_public"
"
[0m11:25:11.425252 [debug] [ThreadPool]: Using postgres connection "create_nerd_facts_public_public"
[0m11:25:11.425640 [debug] [ThreadPool]: On create_nerd_facts_public_public: BEGIN
[0m11:25:11.425888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:25:11.438193 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m11:25:11.438579 [debug] [ThreadPool]: Using postgres connection "create_nerd_facts_public_public"
[0m11:25:11.438849 [debug] [ThreadPool]: On create_nerd_facts_public_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "create_nerd_facts_public_public"} */
create schema if not exists "public_public"
[0m11:25:11.439485 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m11:25:11.440240 [debug] [ThreadPool]: On create_nerd_facts_public_public: COMMIT
[0m11:25:11.440502 [debug] [ThreadPool]: Using postgres connection "create_nerd_facts_public_public"
[0m11:25:11.440728 [debug] [ThreadPool]: On create_nerd_facts_public_public: COMMIT
[0m11:25:11.443113 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m11:25:11.443373 [debug] [ThreadPool]: On create_nerd_facts_public_public: Close
[0m11:25:11.444792 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public_public'
[0m11:25:11.450322 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:25:11.450674 [debug] [ThreadPool]: On list_nerd_facts_public_public: BEGIN
[0m11:25:11.450910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:11.463200 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m11:25:11.463606 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:25:11.463882 [debug] [ThreadPool]: On list_nerd_facts_public_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m11:25:11.466525 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m11:25:11.467444 [debug] [ThreadPool]: On list_nerd_facts_public_public: ROLLBACK
[0m11:25:11.467837 [debug] [ThreadPool]: On list_nerd_facts_public_public: Close
[0m11:25:11.471619 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:11.471978 [debug] [MainThread]: On master: BEGIN
[0m11:25:11.472233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:25:11.484903 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m11:25:11.485327 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:11.485677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:25:11.493302 [debug] [MainThread]: SQL status: SELECT 28 in 0.007 seconds
[0m11:25:11.494754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184d6fd120>]}
[0m11:25:11.495198 [debug] [MainThread]: On master: ROLLBACK
[0m11:25:11.495611 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:11.495901 [debug] [MainThread]: On master: BEGIN
[0m11:25:11.496302 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:25:11.496582 [debug] [MainThread]: On master: COMMIT
[0m11:25:11.496828 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:11.497052 [debug] [MainThread]: On master: COMMIT
[0m11:25:11.497342 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:25:11.497601 [debug] [MainThread]: On master: Close
[0m11:25:11.499728 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.dim_people
[0m11:25:11.500703 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m11:25:11.500331 [info ] [Thread-1 (]: 1 of 7 START sql view model public_public.dim_people ........................... [RUN]
[0m11:25:11.502385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public_public, now model.nerd_facts_dbt.dim_people)
[0m11:25:11.502683 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.dim_people
[0m11:25:11.501844 [info ] [Thread-2 (]: 2 of 7 START sql view model public_public.fact_starships ....................... [RUN]
[0m11:25:11.501470 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:25:11.501172 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_people
[0m11:25:11.509856 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_people"
[0m11:25:11.511473 [info ] [Thread-3 (]: 3 of 7 START sql view model public_public.stg_swapi_people ..................... [RUN]
[0m11:25:11.510966 [info ] [Thread-4 (]: 4 of 7 START sql view model public_public.stg_swapi_planets .................... [RUN]
[0m11:25:11.510449 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly create_nerd_facts_public_public, now model.nerd_facts_dbt.fact_starships)
[0m11:25:11.512930 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m11:25:11.512576 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_planets'
[0m11:25:11.512147 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_people'
[0m11:25:11.516564 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_people
[0m11:25:11.516207 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_planets
[0m11:25:11.515760 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m11:25:11.516881 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.dim_people
[0m11:25:11.519385 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:25:11.522087 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:25:11.538103 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m11:25:11.549925 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi_planets
[0m11:25:11.549572 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_people"
[0m11:25:11.550343 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_people
[0m11:25:11.560324 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:25:11.557251 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:25:11.554461 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m11:25:11.561270 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:25:11.561724 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:25:11.563066 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: BEGIN
[0m11:25:11.562395 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: BEGIN
[0m11:25:11.563669 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:25:11.563338 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:25:11.562066 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:25:11.564539 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m11:25:11.564844 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:25:11.562769 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:25:11.565589 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: BEGIN
[0m11:25:11.572179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:11.587028 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m11:25:11.587460 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:25:11.587898 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */

  create view "nerd_facts"."public_public"."stg_swapi_people__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    height::DECIMAL AS height,
    mass::DECIMAL AS mass,
    hair_color,
    skin_color,
    eye_color,
    birth_year,
    gender,
    homeworld::INTEGER AS homeworld_id, -- Convert homeworld URL to integer UID    
    url
FROM "nerd_facts"."raw"."swapi_people"
  );
[0m11:25:11.589819 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:25:11.596691 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:25:11.597285 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */
alter table "nerd_facts"."public_public"."stg_swapi_people__dbt_tmp" rename to "stg_swapi_people"
[0m11:25:11.598129 [debug] [Thread-4 (]: SQL status: BEGIN in 0.034 seconds
[0m11:25:11.598897 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:25:11.598441 [debug] [Thread-2 (]: SQL status: BEGIN in 0.034 seconds
[0m11:25:11.597778 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m11:25:11.599198 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:25:11.599483 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */

  create view "nerd_facts"."public_public"."stg_swapi_planets__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    climate,
    terrain,
    diameter::INTEGER AS diameter,
    population::BIGINT AS population,
    gravity,
    orbital_period::INTEGER AS orbital_period,
    rotation_period::INTEGER AS rotation_period,
    surface_water::INTEGER AS surface_water,
    url
FROM "nerd_facts"."raw"."swapi_planets"
  );
[0m11:25:11.599893 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:25:11.614587 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  create view "nerd_facts"."public_public"."fact_starships__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    model,
    manufacturer,
    cost_in_credits::BIGINT AS cost_in_credits,
    length::DECIMAL AS length,
    -- ✅ Convert `max_atmosphering_speed` safely
    CASE
        WHEN max_atmosphering_speed ~ '^\d+$' THEN max_atmosphering_speed::INTEGER
        ELSE NULL
    END AS max_atmosphering_speed,  
    crew::INTEGER AS crew,
    passengers::INTEGER AS passengers,
    cargo_capacity::BIGINT AS cargo_capacity,
    consumables,
    hyperdrive_rating::DECIMAL AS hyperdrive_rating,
    MGLT::INTEGER AS MGLT,
    starship_class,
    pilots::JSONB AS pilot_ids, -- JSONB for linked pilots
    url
FROM "nerd_facts"."raw"."swapi_starships"
  );
[0m11:25:11.616094 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:25:11.600228 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:25:11.613974 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: COMMIT
[0m11:25:11.619120 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:25:11.619550 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m11:25:11.619937 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_people"} */

  create view "nerd_facts"."public_public"."dim_people__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    -- ✅ Convert `height` safely
    CASE 
        WHEN height ~ '^\d+$' THEN height::DECIMAL
        ELSE NULL
    END AS height,
    -- ✅ Convert `mass` safely
    CASE 
        WHEN mass ~ '^\d+$' THEN mass::DECIMAL
        ELSE NULL
    END AS mass,
    hair_color,
    skin_color,
    eye_color,
    birth_year,
    gender,
    homeworld::INTEGER AS homeworld_id,
    url
FROM "nerd_facts"."raw"."swapi_people"
  );
[0m11:25:11.620402 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:25:11.624591 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: COMMIT
[0m11:25:11.624044 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:25:11.624939 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */
alter table "nerd_facts"."public_public"."fact_starships__dbt_tmp" rename to "fact_starships"
[0m11:25:11.625571 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:25:11.620964 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
alter table "nerd_facts"."public_public"."stg_swapi_planets__dbt_tmp" rename to "stg_swapi_planets"
[0m11:25:11.627162 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: COMMIT
[0m11:25:11.627578 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:25:11.628105 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:25:11.628401 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:25:11.636379 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: COMMIT
[0m11:25:11.634071 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m11:25:11.634536 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: COMMIT
[0m11:25:11.633229 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:25:11.636938 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:25:11.645020 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_people__dbt_backup"
[0m11:25:11.645909 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_people"} */
alter table "nerd_facts"."public_public"."dim_people__dbt_tmp" rename to "dim_people"
[0m11:25:11.646353 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: COMMIT
[0m11:25:11.650378 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:25:11.650843 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m11:25:11.651643 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:25:11.652062 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_people__dbt_backup" cascade
[0m11:25:11.654728 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public_public"."fact_starships__dbt_backup"
[0m11:25:11.655305 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m11:25:11.656528 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: COMMIT
[0m11:25:11.659887 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_planets__dbt_backup"
[0m11:25:11.657441 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:25:11.660210 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:25:11.660607 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:25:11.661247 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:25:11.661682 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */
drop view if exists "nerd_facts"."public_public"."fact_starships__dbt_backup" cascade
[0m11:25:11.663832 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: Close
[0m11:25:11.666494 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18498f0d00>]}
[0m11:25:11.664683 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_planets__dbt_backup" cascade
[0m11:25:11.667360 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:25:11.664309 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: COMMIT
[0m11:25:11.668749 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: Close
[0m11:25:11.669997 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m11:25:11.671250 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m11:25:11.669321 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public_public.stg_swapi_people ................ [[32mCREATE VIEW[0m in 0.15s]
[0m11:25:11.673556 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18498f1ed0>]}
[0m11:25:11.673990 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m11:25:11.674566 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_people
[0m11:25:11.678407 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:25:11.677871 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public_public"."dim_people__dbt_backup"
[0m11:25:11.679697 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:25:11.675028 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1849809e40>]}
[0m11:25:11.680598 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public_public.fact_starships .................. [[32mCREATE VIEW[0m in 0.16s]
[0m11:25:11.680029 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_people"} */
drop view if exists "nerd_facts"."public_public"."dim_people__dbt_backup" cascade
[0m11:25:11.675645 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public_public.stg_swapi_planets ............... [[32mCREATE VIEW[0m in 0.16s]
[0m11:25:11.681659 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:25:11.678967 [info ] [Thread-3 (]: 5 of 7 START sql view model public_public.stg_swapi_starships .................. [RUN]
[0m11:25:11.682908 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_people, now model.nerd_facts_dbt.stg_swapi_starships)
[0m11:25:11.683233 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_starships
[0m11:25:11.682473 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:25:11.687656 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: Close
[0m11:25:11.688326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18497b69b0>]}
[0m11:25:11.682045 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.swapi_people_species
[0m11:25:11.688870 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public_public.dim_people ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m11:25:11.689858 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.dim_people
[0m11:25:11.689333 [info ] [Thread-4 (]: 6 of 7 START sql table model public_public.swapi_people_species ................ [RUN]
[0m11:25:11.686396 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:25:11.690488 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_planets, now model.nerd_facts_dbt.swapi_people_species)
[0m11:25:11.690992 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.swapi_people_species
[0m11:25:11.681070 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m11:25:11.691323 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_starships
[0m11:25:11.694042 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.swapi_people_species"
[0m11:25:11.698477 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:25:11.699150 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.swapi_people_species
[0m11:25:11.715019 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:25:11.718304 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.swapi_people_species"
[0m11:25:11.718757 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: BEGIN
[0m11:25:11.719293 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:25:11.719669 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:25:11.720202 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: BEGIN
[0m11:25:11.720513 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:25:11.733234 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m11:25:11.733878 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:25:11.734215 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m11:25:11.734689 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */

  create view "nerd_facts"."public_public"."stg_swapi_starships__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    model,
    manufacturer,

    -- ✅ Use NULLIF to avoid errors if value is empty ('')
    NULLIF(cost_in_credits, '')::BIGINT AS cost_in_credits,
    NULLIF(length, '')::DECIMAL AS length,
    NULLIF(max_atmosphering_speed, '')::INTEGER AS max_atmosphering_speed,
    NULLIF(crew, '')::INTEGER AS crew,
    NULLIF(passengers, '')::INTEGER AS passengers,
    NULLIF(cargo_capacity, '')::BIGINT AS cargo_capacity,
    
    consumables,

    NULLIF(hyperdrive_rating, '')::DECIMAL AS hyperdrive_rating,
    NULLIF(MGLT, '')::INTEGER AS MGLT,
    
    starship_class,

    -- ✅ Ensure pilots column is always valid JSONB
    CASE 
        WHEN pilots IS NULL OR pilots = '' THEN '[]'::JSONB
        ELSE pilots::JSONB
    END AS pilot_ids,

    url

FROM "nerd_facts"."raw"."swapi_starships"
  );
[0m11:25:11.735119 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:25:11.735586 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.swapi_people_species"} */

  
    

  create  table "nerd_facts"."public_public"."swapi_people_species__dbt_tmp"
  
  
    as
  
  (
    

WITH species_data AS (
    SELECT
        id AS species_id,
        jsonb_array_elements_text(people::JSONB)::INTEGER AS person_id  -- ✅ Cast TEXT to JSONB
    FROM "nerd_facts"."raw"."swapi_species"
)

SELECT
    person_id,
    species_id
FROM species_data
WHERE person_id IS NOT NULL
  );
  
[0m11:25:11.737180 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:25:11.737641 [debug] [Thread-4 (]: SQL status: SELECT 50 in 0.002 seconds
[0m11:25:11.740294 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:25:11.742999 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:25:11.743410 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
alter table "nerd_facts"."public_public"."stg_swapi_starships__dbt_tmp" rename to "stg_swapi_starships"
[0m11:25:11.743774 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.swapi_people_species"} */
alter table "nerd_facts"."public_public"."swapi_people_species__dbt_tmp" rename to "swapi_people_species"
[0m11:25:11.744448 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:25:11.744751 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:25:11.748865 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: COMMIT
[0m11:25:11.750186 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: COMMIT
[0m11:25:11.750669 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:25:11.751082 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:25:11.751415 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: COMMIT
[0m11:25:11.751753 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: COMMIT
[0m11:25:11.754521 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m11:25:11.757145 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public_public"."swapi_people_species__dbt_backup"
[0m11:25:11.757623 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m11:25:11.759786 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:25:11.762029 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_starships__dbt_backup"
[0m11:25:11.762506 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.swapi_people_species"} */
drop table if exists "nerd_facts"."public_public"."swapi_people_species__dbt_backup" cascade
[0m11:25:11.763204 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:25:11.763655 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_starships__dbt_backup" cascade
[0m11:25:11.764035 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m11:25:11.764382 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:25:11.765575 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: Close
[0m11:25:11.766664 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: Close
[0m11:25:11.769645 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18498f0d00>]}
[0m11:25:11.770332 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1849844a60>]}
[0m11:25:11.770993 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public_public.stg_swapi_starships ............. [[32mCREATE VIEW[0m in 0.09s]
[0m11:25:11.771770 [info ] [Thread-4 (]: 6 of 7 OK created sql table model public_public.swapi_people_species ........... [[32mSELECT 50[0m in 0.08s]
[0m11:25:11.772345 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:25:11.772822 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.swapi_people_species
[0m11:25:11.773662 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.people_with_species
[0m11:25:11.774087 [info ] [Thread-1 (]: 7 of 7 START sql view model public_public.people_with_species .................. [RUN]
[0m11:25:11.774497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_people, now model.nerd_facts_dbt.people_with_species)
[0m11:25:11.774790 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.people_with_species
[0m11:25:11.777552 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.people_with_species"
[0m11:25:11.778063 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.people_with_species
[0m11:25:11.781879 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.people_with_species"
[0m11:25:11.782428 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:25:11.782724 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: BEGIN
[0m11:25:11.782977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:11.795361 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m11:25:11.795790 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:25:11.796101 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.people_with_species"} */

  create view "nerd_facts"."public_public"."people_with_species__dbt_tmp"
    
    
  as (
    

SELECT
    p.id,
    p.name,
    s.species_id
FROM "nerd_facts"."public_public"."stg_swapi_people" p
LEFT JOIN "nerd_facts"."public_public"."swapi_people_species" s ON p.id = s.person_id
  );
[0m11:25:11.797814 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m11:25:11.800500 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:25:11.800838 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.people_with_species"} */
alter table "nerd_facts"."public_public"."people_with_species__dbt_tmp" rename to "people_with_species"
[0m11:25:11.801447 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:25:11.802544 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: COMMIT
[0m11:25:11.802860 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:25:11.803121 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: COMMIT
[0m11:25:11.805536 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:25:11.807476 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public_public"."people_with_species__dbt_backup"
[0m11:25:11.808135 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:25:11.808422 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.people_with_species"} */
drop view if exists "nerd_facts"."public_public"."people_with_species__dbt_backup" cascade
[0m11:25:11.808892 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:25:11.809955 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: Close
[0m11:25:11.810534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18486dc040>]}
[0m11:25:11.811068 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public_public.people_with_species ............. [[32mCREATE VIEW[0m in 0.04s]
[0m11:25:11.811647 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.people_with_species
[0m11:25:11.812997 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:11.813393 [debug] [MainThread]: On master: BEGIN
[0m11:25:11.813692 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:25:11.825997 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:25:11.826393 [debug] [MainThread]: On master: COMMIT
[0m11:25:11.826705 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:11.826963 [debug] [MainThread]: On master: COMMIT
[0m11:25:11.827315 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:25:11.827615 [debug] [MainThread]: On master: Close
[0m11:25:11.828127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:25:11.828358 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_starships' was properly closed.
[0m11:25:11.828568 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.people_with_species' was properly closed.
[0m11:25:11.828765 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_starships' was properly closed.
[0m11:25:11.828950 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.swapi_people_species' was properly closed.
[0m11:25:11.829252 [info ] [MainThread]: 
[0m11:25:11.829772 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m11:25:11.831016 [debug] [MainThread]: Command end result
[0m11:25:11.895132 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:25:11.896687 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:25:11.902293 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m11:25:11.902623 [info ] [MainThread]: 
[0m11:25:11.902941 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:25:11.903195 [info ] [MainThread]: 
[0m11:25:11.903449 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m11:25:11.904180 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8399521, "process_in_blocks": "0", "process_kernel_time": 0.076366, "process_mem_max_rss": "114836", "process_out_blocks": "2888", "process_user_time": 2.702949}
[0m11:25:11.904540 [debug] [MainThread]: Command `dbt run` succeeded at 11:25:11.904462 after 1.84 seconds
[0m11:25:11.904822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184c82c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184a62f880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184ccc6020>]}
[0m11:25:11.905118 [debug] [MainThread]: Flushing usage events
[0m11:25:12.368786 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:27:02.368660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf9e5cc8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf9f477d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf9f477dc0>]}


============================== 11:27:02.370756 | 06986961-811e-4cb7-9fe5-5d47e0dab419 ==============================
[0m11:27:02.370756 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:27:02.371174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:27:02.466100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06986961-811e-4cb7-9fe5-5d47e0dab419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf9ddbf910>]}
[0m11:27:02.475313 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.15169033, "process_in_blocks": "0", "process_kernel_time": 0.056024, "process_mem_max_rss": "88792", "process_out_blocks": "8", "process_user_time": 1.028115}
[0m11:27:02.475898 [debug] [MainThread]: Command `dbt clean` succeeded at 11:27:02.475778 after 0.15 seconds
[0m11:27:02.476342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf9e5cc8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf9dc34e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf9d628b50>]}
[0m11:27:02.476818 [debug] [MainThread]: Flushing usage events
[0m11:27:02.877514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:27:05.446066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b40604880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b414258d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b41425870>]}


============================== 11:27:05.448472 | abc4febd-373a-4860-adac-95a3139fa563 ==============================
[0m11:27:05.448472 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:27:05.449005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:27:05.579660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b415de6b0>]}
[0m11:27:05.629831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b41455f30>]}
[0m11:27:05.630627 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:27:05.717951 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:27:05.718615 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:27:05.719009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3eb49450>]}
[0m11:27:06.615159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3e4226e0>]}
[0m11:27:06.678279 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:27:06.680102 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:27:06.689149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b40499900>]}
[0m11:27:06.689638 [info ] [MainThread]: Found 7 models, 11 sources, 433 macros
[0m11:27:06.689953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3e3c2d40>]}
[0m11:27:06.691519 [info ] [MainThread]: 
[0m11:27:06.691905 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:27:06.692184 [info ] [MainThread]: 
[0m11:27:06.692619 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:27:06.696391 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m11:27:06.704925 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m11:27:06.726472 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m11:27:06.726899 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m11:27:06.727205 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m11:27:06.727501 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m11:27:06.727832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:06.728093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:06.742960 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m11:27:06.743392 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m11:27:06.744442 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m11:27:06.745501 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m11:27:06.748453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now create_nerd_facts_public_public)
[0m11:27:06.749075 [debug] [ThreadPool]: Creating schema "database: "nerd_facts"
schema: "public_public"
"
[0m11:27:06.753860 [debug] [ThreadPool]: Using postgres connection "create_nerd_facts_public_public"
[0m11:27:06.754239 [debug] [ThreadPool]: On create_nerd_facts_public_public: BEGIN
[0m11:27:06.754487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:27:06.766891 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m11:27:06.767275 [debug] [ThreadPool]: Using postgres connection "create_nerd_facts_public_public"
[0m11:27:06.767542 [debug] [ThreadPool]: On create_nerd_facts_public_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "create_nerd_facts_public_public"} */
create schema if not exists "public_public"
[0m11:27:06.768185 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m11:27:06.768887 [debug] [ThreadPool]: On create_nerd_facts_public_public: COMMIT
[0m11:27:06.769161 [debug] [ThreadPool]: Using postgres connection "create_nerd_facts_public_public"
[0m11:27:06.769390 [debug] [ThreadPool]: On create_nerd_facts_public_public: COMMIT
[0m11:27:06.771735 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m11:27:06.771997 [debug] [ThreadPool]: On create_nerd_facts_public_public: Close
[0m11:27:06.773372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nerd_facts_public_public, now list_nerd_facts_public)
[0m11:27:06.773854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_public_public)
[0m11:27:06.778932 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m11:27:06.781572 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:27:06.781946 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m11:27:06.782278 [debug] [ThreadPool]: On list_nerd_facts_public_public: BEGIN
[0m11:27:06.782544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:27:06.782864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:27:06.798210 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m11:27:06.798817 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m11:27:06.799142 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m11:27:06.799428 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:27:06.799737 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:27:06.800021 [debug] [ThreadPool]: On list_nerd_facts_public_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m11:27:06.803886 [debug] [ThreadPool]: SQL status: SELECT 95 in 0.004 seconds
[0m11:27:06.806323 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m11:27:06.806761 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m11:27:06.807068 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m11:27:06.815317 [debug] [ThreadPool]: On list_nerd_facts_public_public: ROLLBACK
[0m11:27:06.820521 [debug] [ThreadPool]: On list_nerd_facts_public_public: Close
[0m11:27:06.826618 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:06.826986 [debug] [MainThread]: On master: BEGIN
[0m11:27:06.827250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:27:06.839557 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:27:06.839944 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:06.840238 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:27:06.846908 [debug] [MainThread]: SQL status: SELECT 28 in 0.006 seconds
[0m11:27:06.851879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b414d9060>]}
[0m11:27:06.852315 [debug] [MainThread]: On master: ROLLBACK
[0m11:27:06.852711 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:06.852949 [debug] [MainThread]: On master: BEGIN
[0m11:27:06.853323 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:27:06.853573 [debug] [MainThread]: On master: COMMIT
[0m11:27:06.853795 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:06.854004 [debug] [MainThread]: On master: COMMIT
[0m11:27:06.854375 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:27:06.854649 [debug] [MainThread]: On master: Close
[0m11:27:06.856616 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.dim_people
[0m11:27:06.857139 [info ] [Thread-1 (]: 1 of 7 START sql view model public.dim_people .................................. [RUN]
[0m11:27:06.857603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public_public, now model.nerd_facts_dbt.dim_people)
[0m11:27:06.857896 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.dim_people
[0m11:27:06.864518 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_people"
[0m11:27:06.864965 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m11:27:06.865375 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_people
[0m11:27:06.866410 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:27:06.865960 [info ] [Thread-2 (]: 2 of 7 START sql view model public.fact_starships .............................. [RUN]
[0m11:27:06.867739 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.dim_people
[0m11:27:06.866911 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_swapi_people ............................ [RUN]
[0m11:27:06.884232 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_people'
[0m11:27:06.894865 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_people
[0m11:27:06.900465 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:27:06.868327 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.fact_starships)
[0m11:27:06.897237 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_people"
[0m11:27:06.867350 [info ] [Thread-4 (]: 4 of 7 START sql view model public_public.stg_swapi_planets .................... [RUN]
[0m11:27:06.901716 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_planets'
[0m11:27:06.902042 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_planets
[0m11:27:06.904965 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:27:06.901044 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m11:27:06.907799 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m11:27:06.908282 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_people
[0m11:27:06.908618 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:27:06.908919 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi_planets
[0m11:27:06.913389 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:27:06.919155 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:27:06.919587 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: BEGIN
[0m11:27:06.918391 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:27:06.913979 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m11:27:06.914500 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: BEGIN
[0m11:27:06.919924 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:27:06.920380 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:27:06.925949 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: BEGIN
[0m11:27:06.926233 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:27:06.925379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:06.924942 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m11:27:06.938310 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:27:06.938749 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m11:27:06.939053 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:27:06.944724 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m11:27:06.945204 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:27:06.945567 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */

  create view "nerd_facts"."public"."stg_swapi_people__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    height::DECIMAL AS height,
    mass::DECIMAL AS mass,
    hair_color,
    skin_color,
    eye_color,
    birth_year,
    gender,
    homeworld::INTEGER AS homeworld_id, -- Convert homeworld URL to integer UID    
    url
FROM "nerd_facts"."raw"."swapi_people"
  );
[0m11:27:06.948151 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:27:06.959317 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:27:06.959787 [debug] [Thread-4 (]: SQL status: BEGIN in 0.034 seconds
[0m11:27:06.960245 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */
alter table "nerd_facts"."public"."stg_swapi_people__dbt_tmp" rename to "stg_swapi_people"
[0m11:27:06.960581 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:27:06.962327 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */

  create view "nerd_facts"."public_public"."stg_swapi_planets__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    climate,
    terrain,
    diameter::INTEGER AS diameter,
    population::BIGINT AS population,
    gravity,
    orbital_period::INTEGER AS orbital_period,
    rotation_period::INTEGER AS rotation_period,
    surface_water::INTEGER AS surface_water,
    url
FROM "nerd_facts"."raw"."swapi_planets"
  );
[0m11:27:06.960898 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m11:27:06.962775 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:27:06.963081 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_people"} */

  create view "nerd_facts"."public"."dim_people__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    -- ✅ Convert `height` safely
    CASE 
        WHEN height ~ '^\d+$' THEN height::DECIMAL
        ELSE NULL
    END AS height,
    -- ✅ Convert `mass` safely
    CASE 
        WHEN mass ~ '^\d+$' THEN mass::DECIMAL
        ELSE NULL
    END AS mass,
    hair_color,
    skin_color,
    eye_color,
    birth_year,
    gender,
    homeworld::INTEGER AS homeworld_id,
    url
FROM "nerd_facts"."raw"."swapi_people"
  );
[0m11:27:06.962025 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:27:06.961382 [debug] [Thread-2 (]: SQL status: BEGIN in 0.022 seconds
[0m11:27:06.969918 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m11:27:06.976457 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:27:06.975909 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: COMMIT
[0m11:27:06.970270 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m11:27:06.982267 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:27:06.979478 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  create view "nerd_facts"."public"."fact_starships__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    model,
    manufacturer,
    cost_in_credits::BIGINT AS cost_in_credits,
    length::DECIMAL AS length,
    -- ✅ Convert `max_atmosphering_speed` safely
    CASE
        WHEN max_atmosphering_speed ~ '^\d+$' THEN max_atmosphering_speed::INTEGER
        ELSE NULL
    END AS max_atmosphering_speed,  
    crew::INTEGER AS crew,
    passengers::INTEGER AS passengers,
    cargo_capacity::BIGINT AS cargo_capacity,
    consumables,
    hyperdrive_rating::DECIMAL AS hyperdrive_rating,
    MGLT::INTEGER AS MGLT,
    starship_class,
    pilots::JSONB AS pilot_ids, -- JSONB for linked pilots
    url
FROM "nerd_facts"."raw"."swapi_starships"
  );
[0m11:27:06.979916 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:27:06.979058 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:27:06.982579 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_people"} */
alter table "nerd_facts"."public"."dim_people__dbt_tmp" rename to "dim_people"
[0m11:27:06.984993 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
alter table "nerd_facts"."public_public"."stg_swapi_planets__dbt_tmp" rename to "stg_swapi_planets"
[0m11:27:06.984604 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: COMMIT
[0m11:27:06.985801 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:27:06.986096 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:27:06.994598 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: COMMIT
[0m11:27:06.995173 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m11:27:06.996603 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: COMMIT
[0m11:27:06.997236 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:27:06.997739 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m11:27:07.000800 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:27:07.008037 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */
alter table "nerd_facts"."public"."fact_starships__dbt_tmp" rename to "fact_starships"
[0m11:27:07.001264 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:27:07.008559 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: COMMIT
[0m11:27:07.001633 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: COMMIT
[0m11:27:07.007598 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."stg_swapi_people__dbt_backup"
[0m11:27:07.009343 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:27:07.013565 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:27:07.015186 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: COMMIT
[0m11:27:07.015597 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m11:27:07.015991 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */
drop view if exists "nerd_facts"."public"."stg_swapi_people__dbt_backup" cascade
[0m11:27:07.016717 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m11:27:07.016371 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:27:07.019232 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."dim_people__dbt_backup"
[0m11:27:07.024035 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:27:07.022080 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:27:07.022470 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: COMMIT
[0m11:27:07.024409 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_people"} */
drop view if exists "nerd_facts"."public"."dim_people__dbt_backup" cascade
[0m11:27:07.021746 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_planets__dbt_backup"
[0m11:27:07.026772 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: Close
[0m11:27:07.030320 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b41842c20>]}
[0m11:27:07.031286 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_swapi_people ....................... [[32mCREATE VIEW[0m in 0.14s]
[0m11:27:07.027791 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:27:07.032087 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_people
[0m11:27:07.032466 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m11:27:07.036201 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."fact_starships__dbt_backup"
[0m11:27:07.032841 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_planets__dbt_backup" cascade
[0m11:27:07.037569 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:27:07.033156 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m11:27:07.039960 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: Close
[0m11:27:07.038791 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: Close
[0m11:27:07.036923 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:27:07.033593 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:27:07.043371 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */
drop view if exists "nerd_facts"."public"."fact_starships__dbt_backup" cascade
[0m11:27:07.044089 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3c4a02b0>]}
[0m11:27:07.044672 [info ] [Thread-3 (]: 5 of 7 START sql view model public.stg_swapi_starships ......................... [RUN]
[0m11:27:07.046951 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_people, now model.nerd_facts_dbt.stg_swapi_starships)
[0m11:27:07.047306 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_starships
[0m11:27:07.046460 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public_public.stg_swapi_planets ............... [[32mCREATE VIEW[0m in 0.14s]
[0m11:27:07.051240 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:27:07.045226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3ce05870>]}
[0m11:27:07.045888 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:27:07.053687 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m11:27:07.054275 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3cdad420>]}
[0m11:27:07.054802 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.fact_starships ......................... [[32mCREATE VIEW[0m in 0.19s]
[0m11:27:07.055314 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m11:27:07.050648 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:27:07.055858 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_starships
[0m11:27:07.052320 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.dim_people ............................. [[32mCREATE VIEW[0m in 0.19s]
[0m11:27:07.061126 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.dim_people
[0m11:27:07.051656 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.swapi_people_species
[0m11:27:07.060438 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:27:07.061778 [info ] [Thread-4 (]: 6 of 7 START sql table model public.swapi_people_species ....................... [RUN]
[0m11:27:07.062375 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_planets, now model.nerd_facts_dbt.swapi_people_species)
[0m11:27:07.062747 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:27:07.063068 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.swapi_people_species
[0m11:27:07.063368 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: BEGIN
[0m11:27:07.066583 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.swapi_people_species"
[0m11:27:07.067071 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:27:07.067800 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.swapi_people_species
[0m11:27:07.096322 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.swapi_people_species"
[0m11:27:07.097033 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:27:07.097394 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m11:27:07.097798 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: BEGIN
[0m11:27:07.098194 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:27:07.098588 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:27:07.099023 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */

  create view "nerd_facts"."public"."stg_swapi_starships__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    model,
    manufacturer,

    -- ✅ Use NULLIF to avoid errors if value is empty ('')
    NULLIF(cost_in_credits, '')::BIGINT AS cost_in_credits,
    NULLIF(length, '')::DECIMAL AS length,
    NULLIF(max_atmosphering_speed, '')::INTEGER AS max_atmosphering_speed,
    NULLIF(crew, '')::INTEGER AS crew,
    NULLIF(passengers, '')::INTEGER AS passengers,
    NULLIF(cargo_capacity, '')::BIGINT AS cargo_capacity,
    
    consumables,

    NULLIF(hyperdrive_rating, '')::DECIMAL AS hyperdrive_rating,
    NULLIF(MGLT, '')::INTEGER AS MGLT,
    
    starship_class,

    -- ✅ Ensure pilots column is always valid JSONB
    CASE 
        WHEN pilots IS NULL OR pilots = '' THEN '[]'::JSONB
        ELSE pilots::JSONB
    END AS pilot_ids,

    url

FROM "nerd_facts"."raw"."swapi_starships"
  );
[0m11:27:07.101899 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:27:07.104973 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:27:07.105481 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
alter table "nerd_facts"."public"."stg_swapi_starships__dbt_tmp" rename to "stg_swapi_starships"
[0m11:27:07.106251 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:27:07.107472 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: COMMIT
[0m11:27:07.107867 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:27:07.108205 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: COMMIT
[0m11:27:07.110727 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m11:27:07.113783 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."stg_swapi_starships__dbt_backup"
[0m11:27:07.114545 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:27:07.114899 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
drop view if exists "nerd_facts"."public"."stg_swapi_starships__dbt_backup" cascade
[0m11:27:07.115207 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m11:27:07.115687 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:27:07.116000 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:27:07.116339 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.swapi_people_species"} */

  
    

  create  table "nerd_facts"."public"."swapi_people_species__dbt_tmp"
  
  
    as
  
  (
    

WITH species_data AS (
    SELECT
        id AS species_id,
        jsonb_array_elements_text(people::JSONB)::INTEGER AS person_id  -- ✅ Cast TEXT to JSONB
    FROM "nerd_facts"."raw"."swapi_species"
)

SELECT
    person_id,
    species_id
FROM species_data
WHERE person_id IS NOT NULL
  );
  
[0m11:27:07.117490 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: Close
[0m11:27:07.119340 [debug] [Thread-4 (]: SQL status: SELECT 50 in 0.001 seconds
[0m11:27:07.165569 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3c348700>]}
[0m11:27:07.167136 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:27:07.168342 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.swapi_people_species"} */
alter table "nerd_facts"."public"."swapi_people_species__dbt_tmp" rename to "swapi_people_species"
[0m11:27:07.167925 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public.stg_swapi_starships .................... [[32mCREATE VIEW[0m in 0.12s]
[0m11:27:07.169033 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:27:07.169355 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:27:07.173417 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: COMMIT
[0m11:27:07.173815 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:27:07.174091 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: COMMIT
[0m11:27:07.176749 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m11:27:07.178904 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."swapi_people_species__dbt_backup"
[0m11:27:07.180992 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:27:07.181324 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.swapi_people_species"} */
drop table if exists "nerd_facts"."public"."swapi_people_species__dbt_backup" cascade
[0m11:27:07.181869 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m11:27:07.182915 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: Close
[0m11:27:07.185499 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3c52ffd0>]}
[0m11:27:07.186145 [info ] [Thread-4 (]: 6 of 7 OK created sql table model public.swapi_people_species .................. [[32mSELECT 50[0m in 0.12s]
[0m11:27:07.186654 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.swapi_people_species
[0m11:27:07.187391 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.people_with_species
[0m11:27:07.187917 [info ] [Thread-2 (]: 7 of 7 START sql view model public.people_with_species ......................... [RUN]
[0m11:27:07.188461 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_starships, now model.nerd_facts_dbt.people_with_species)
[0m11:27:07.188744 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.people_with_species
[0m11:27:07.191970 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.people_with_species"
[0m11:27:07.192542 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.people_with_species
[0m11:27:07.198818 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.people_with_species"
[0m11:27:07.199585 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:27:07.200060 [debug] [Thread-2 (]: On model.nerd_facts_dbt.people_with_species: BEGIN
[0m11:27:07.200401 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:27:07.213680 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m11:27:07.214171 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:27:07.214567 [debug] [Thread-2 (]: On model.nerd_facts_dbt.people_with_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.people_with_species"} */

  create view "nerd_facts"."public"."people_with_species__dbt_tmp"
    
    
  as (
    

SELECT
    p.id,
    p.name,
    s.species_id
FROM "nerd_facts"."public"."stg_swapi_people" p
LEFT JOIN "nerd_facts"."public"."swapi_people_species" s ON p.id = s.person_id
  );
[0m11:27:07.216392 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m11:27:07.219400 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:27:07.219797 [debug] [Thread-2 (]: On model.nerd_facts_dbt.people_with_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.people_with_species"} */
alter table "nerd_facts"."public"."people_with_species__dbt_tmp" rename to "people_with_species"
[0m11:27:07.220474 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:27:07.222089 [debug] [Thread-2 (]: On model.nerd_facts_dbt.people_with_species: COMMIT
[0m11:27:07.222533 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:27:07.222880 [debug] [Thread-2 (]: On model.nerd_facts_dbt.people_with_species: COMMIT
[0m11:27:07.225616 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m11:27:07.228495 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."people_with_species__dbt_backup"
[0m11:27:07.229347 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:27:07.229769 [debug] [Thread-2 (]: On model.nerd_facts_dbt.people_with_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.people_with_species"} */
drop view if exists "nerd_facts"."public"."people_with_species__dbt_backup" cascade
[0m11:27:07.230354 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:27:07.231585 [debug] [Thread-2 (]: On model.nerd_facts_dbt.people_with_species: Close
[0m11:27:07.232570 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3fdfd690>]}
[0m11:27:07.233400 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.people_with_species .................... [[32mCREATE VIEW[0m in 0.04s]
[0m11:27:07.234095 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.people_with_species
[0m11:27:07.235696 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:07.236043 [debug] [MainThread]: On master: BEGIN
[0m11:27:07.236331 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:27:07.251437 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m11:27:07.252004 [debug] [MainThread]: On master: COMMIT
[0m11:27:07.252333 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:07.252629 [debug] [MainThread]: On master: COMMIT
[0m11:27:07.253031 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:27:07.253332 [debug] [MainThread]: On master: Close
[0m11:27:07.256081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:27:07.256443 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.people_with_species' was properly closed.
[0m11:27:07.256724 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_people' was properly closed.
[0m11:27:07.256999 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_starships' was properly closed.
[0m11:27:07.257263 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.swapi_people_species' was properly closed.
[0m11:27:07.257675 [info ] [MainThread]: 
[0m11:27:07.258029 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m11:27:07.259410 [debug] [MainThread]: Command end result
[0m11:27:07.282785 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:27:07.284381 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:27:07.290477 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m11:27:07.290841 [info ] [MainThread]: 
[0m11:27:07.291257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:27:07.291610 [info ] [MainThread]: 
[0m11:27:07.291952 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m11:27:07.292741 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.893422, "process_in_blocks": "0", "process_kernel_time": 0.111823, "process_mem_max_rss": "115548", "process_out_blocks": "2880", "process_user_time": 2.68294}
[0m11:27:07.293151 [debug] [MainThread]: Command `dbt run` succeeded at 11:27:07.293056 after 1.89 seconds
[0m11:27:07.293512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b40604880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3e3ef130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3e366e90>]}
[0m11:27:07.293892 [debug] [MainThread]: Flushing usage events
[0m11:27:07.758050 [debug] [MainThread]: An error was encountered while trying to flush usage events

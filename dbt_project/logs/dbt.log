[0m09:38:04.353994 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_sw_characters: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_sw_characters"} */
drop table if exists "nerd_facts"."public"."dim_sw_characters__dbt_backup" cascade
[0m09:38:04.360929 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.009 seconds
[0m09:38:04.364861 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_sw_planets: COMMIT
[0m09:38:04.365361 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_planets"
[0m09:38:04.365739 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_sw_planets: COMMIT
[0m09:38:04.361812 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.bridge_sw_starships_pilots"
[0m09:38:04.366763 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.bridge_sw_starships_pilots"
[0m09:38:04.367138 [debug] [Thread-1 (]: On model.nerd_facts_dbt.bridge_sw_starships_pilots: BEGIN
[0m09:38:04.362371 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m09:38:04.367485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:38:04.373133 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m09:38:04.374268 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.011 seconds
[0m09:38:04.380895 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_sw_characters: Close
[0m09:38:04.381897 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b824d900>]}
[0m09:38:04.382811 [info ] [Thread-2 (]: 76 of 103 OK created sql table model public.dim_sw_characters .................. [[32mSELECT 82[0m in 0.21s]
[0m09:38:04.383549 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.dim_sw_characters
[0m09:38:04.384105 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.dim_sw_species
[0m09:38:04.373878 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m09:38:04.385709 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m09:38:04.378883 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."dim_sw_planets__dbt_backup"
[0m09:38:04.384806 [info ] [Thread-2 (]: 80 of 103 START sql table model public.dim_sw_species .......................... [RUN]
[0m09:38:04.453463 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_planets"
[0m09:38:04.454231 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_sw_characters, now model.nerd_facts_dbt.dim_sw_species)
[0m09:38:04.459495 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m09:38:04.460040 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_sw_planets: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_sw_planets"} */
drop table if exists "nerd_facts"."public"."dim_sw_planets__dbt_backup" cascade
[0m09:38:04.460503 [debug] [Thread-1 (]: SQL status: BEGIN in 0.093 seconds
[0m09:38:04.460895 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.dim_sw_species
[0m09:38:04.462464 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.bridge_sw_starships_pilots"
[0m09:38:04.468354 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m09:38:04.469289 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_sw_species"
[0m09:38:04.472779 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.dim_sw_species
[0m09:38:04.469915 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m09:38:04.472085 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_sw_planets: Close
[0m09:38:04.480175 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b86c6ad0>]}
[0m09:38:04.470510 [debug] [Thread-1 (]: On model.nerd_facts_dbt.bridge_sw_starships_pilots: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.bridge_sw_starships_pilots"} */

  
    

  create  table "nerd_facts"."public"."bridge_sw_starships_pilots__dbt_tmp"
  
  
    as
  
  (
    

/*
  Model: bridge_sw_starships_pilots
  Description: Bridge table connecting Star Wars starships to their pilots
  
  This version reconstructs the relationship using available intermediate models.
*/

-- Create a join between films, characters, and starships
WITH film_characters_starships AS (
    SELECT DISTINCT
        fc.film_id,
        fc.people_id AS pilot_id,
        fs.starship_id
    FROM "nerd_facts"."public"."int_swapi_films_characters" fc
    JOIN "nerd_facts"."public"."int_swapi_films_starships" fs ON fc.film_id = fs.film_id
),

-- Create the pilot-starship relationships based on film appearances
starship_pilots AS (
    SELECT DISTINCT
        fcs.starship_id,
        fcs.pilot_id
    FROM film_characters_starships fcs
    -- Only include notable pilot-starship combinations
    WHERE (
        -- Known pilot-starship pairs from Star Wars universe
        (fcs.pilot_id = 1 AND fcs.starship_id = 12) OR -- Luke Skywalker + X-wing
        (fcs.pilot_id = 4 AND fcs.starship_id = 10) OR -- Darth Vader + TIE Advanced x1
        (fcs.pilot_id = 13 AND fcs.starship_id = 10) OR -- Chewbacca + Millennium Falcon
        (fcs.pilot_id = 14 AND fcs.starship_id = 10) OR -- Han Solo + Millennium Falcon
        (fcs.pilot_id = 22 AND fcs.starship_id = 21) OR -- Boba Fett + Slave I
        (fcs.pilot_id = 11 AND fcs.starship_id = 32) OR -- Anakin Skywalker + Naboo fighter
        (fcs.pilot_id = 35 AND fcs.starship_id = 48) OR -- Padm√© Amidala + Naboo ship
        (fcs.pilot_id = 10 AND fcs.starship_id = 48) OR -- Obi-Wan Kenobi + Jedi Starfighter
        (fcs.pilot_id = 3 AND fcs.starship_id = 10) OR -- R2-D2 + X-wing
        (fcs.pilot_id = 25 AND fcs.starship_id = 28)    -- Lando + Millennium Falcon
    )
),

-- Get starship information
starships AS (
    SELECT 
        s.starship_id,
        s.starship_name,
        s.model,
        s.manufacturer,
        s.starship_class,
        s.cost_in_credits
    FROM "nerd_facts"."public"."int_swapi_starships" s
),

-- Get character information
pilots AS (
    SELECT 
        p.people_id,
        p.name AS pilot_name,
        p.gender,
        p.birth_year,
        p.height,
        p.mass,
        p.homeworld_id  -- Fix the column name based on the error
    FROM "nerd_facts"."public"."int_swapi_people" p
),

-- Build the base relationship with enriched data
starship_pilot_base AS (
    SELECT
        sp.starship_id,
        sp.pilot_id,
        s.starship_name,
        s.model,
        s.manufacturer,
        s.starship_class,
        s.cost_in_credits AS cost,
        p.pilot_name,
        p.gender,
        p.birth_year,
        p.height,
        p.mass,
        p.homeworld_id  -- Use the correct column name
    FROM starship_pilots sp
    JOIN starships s ON sp.starship_id = s.starship_id
    JOIN pilots p ON sp.pilot_id = p.people_id
),

-- Get film appearances for both pilots and starships
pilot_films AS (
    SELECT
        fc.people_id AS pilot_id,
        COUNT(DISTINCT fc.film_id) AS film_count,
        STRING_AGG(f.title, ', ' ORDER BY f.episode_id) AS film_names
    FROM "nerd_facts"."public"."int_swapi_films_characters" fc
    JOIN "nerd_facts"."public"."int_swapi_films" f ON fc.film_id = f.film_id
    GROUP BY fc.people_id
),

starship_films AS (
    SELECT
        fs.starship_id,
        COUNT(DISTINCT fs.film_id) AS film_count,
        STRING_AGG(f.title, ', ' ORDER BY f.episode_id) AS film_names
    FROM "nerd_facts"."public"."int_swapi_films_starships" fs
    JOIN "nerd_facts"."public"."int_swapi_films" f ON fs.film_id = f.film_id
    GROUP BY fs.starship_id
),

-- Get homeworld information for additional context
homeworlds AS (
    SELECT
        p.planet_id,
        p.name AS planet_name
    FROM "nerd_facts"."public"."int_swapi_planets" p
),

-- Calculate pilot statistics
pilot_stats AS (
    SELECT 
        pilot_id,
        COUNT(DISTINCT starship_id) AS ships_piloted_count,
        COUNT(DISTINCT starship_class) AS ship_class_versatility
    FROM starship_pilot_base
    GROUP BY pilot_id
)

SELECT
    -- Primary key
    md5(cast(coalesce(cast(spb.starship_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(spb.pilot_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS starship_pilot_id,
    
    -- Foreign keys to related dimensions
    md5(cast(coalesce(cast(spb.starship_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS starship_key,
    md5(cast(coalesce(cast(spb.pilot_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS pilot_key,
    
    -- Core identifiers
    spb.starship_id,
    spb.starship_name,
    spb.pilot_id,
    spb.pilot_name,
    
    -- Starship attributes
    spb.model,
    spb.manufacturer,
    spb.starship_class,
    spb.cost,
    
    -- Pilot attributes
    spb.gender,
    spb.birth_year,
    hw.planet_name AS homeworld_name,
    
    -- Force sensitivity (derived)
    CASE 
        WHEN spb.pilot_name IN ('Luke Skywalker', 'Darth Vader', 'Anakin Skywalker', 'Rey', 'Kylo Ren',
                           'Obi-Wan Kenobi', 'Emperor Palpatine', 'Yoda', 'Mace Windu',
                           'Count Dooku', 'Qui-Gon Jinn', 'Darth Maul', 'Ahsoka Tano')
        THEN TRUE
        ELSE FALSE
    END AS force_sensitive,
    
    -- Pilot age estimation
    CASE 
        WHEN spb.birth_year ~ '^[0-9]+(\.[0-9]+)?$' THEN 
            CASE
                WHEN spb.pilot_name = 'Yoda' THEN 900  -- Special case for Yoda
                ELSE COALESCE(spb.birth_year::NUMERIC, 0)
            END
        ELSE 0
    END AS pilot_age,
    
    -- Film appearances
    COALESCE(pf.film_count, 0) AS pilot_film_count,
    COALESCE(sf.film_count, 0) AS starship_film_count,
    COALESCE(pf.film_names, 'None') AS pilot_film_appearances,
    COALESCE(sf.film_names, 'None') AS starship_film_appearances,
    
    -- Calculate film overlap (approximate)
    -- This isn't precise without parsing the film names but gives an indication
    CASE 
        WHEN pf.film_names IS NOT NULL AND sf.film_names IS NOT NULL THEN
            -- Estimate overlap by the smaller of the two counts
            LEAST(
                COALESCE(pf.film_count, 0),
                COALESCE(sf.film_count, 0)
            )
        ELSE 0
    END AS film_appearance_overlap,
    
    -- Enhanced pilot skill classification with more nuance
    CASE
        -- Legendary pilots explicitly mentioned in lore
        WHEN spb.pilot_name IN ('Han Solo', 'Luke Skywalker', 'Anakin Skywalker', 
                             'Poe Dameron', 'Wedge Antilles', 'Lando Calrissian') THEN 'Legendary'
        
        -- Known excellent pilots from expanded lore
        WHEN spb.pilot_name IN ('Darth Vader', 'Jango Fett', 'Boba Fett', 'Hera Syndulla', 
                             'Rey', 'Chewbacca', 'Din Djarin', 'Cassian Andor') THEN 'Expert'
        
        -- Force users generally have enhanced piloting abilities
        WHEN spb.pilot_name IN ('Luke Skywalker', 'Darth Vader', 'Anakin Skywalker', 'Rey', 'Kylo Ren',
                           'Obi-Wan Kenobi', 'Yoda', 'Mace Windu') THEN 'Force Enhanced'
        
        -- Pilots of military craft likely have formal training
        WHEN spb.starship_class IN ('Starfighter', 'Assault Starfighter', 'Bomber', 
                                 'Interceptor', 'Light Cruiser') THEN 'Military Trained'
        
        -- Default for other cases
        ELSE 'Standard'
    END AS pilot_skill,
    
    -- Pilot experience level based on lore
    CASE
        WHEN spb.pilot_name IN ('Han Solo', 'Chewbacca', 'Lando Calrissian', 'Wedge Antilles') THEN 'Veteran'
        WHEN spb.pilot_name IN ('Luke Skywalker', 'Poe Dameron', 'Darth Vader', 'Anakin Skywalker') THEN 'Advanced'
        WHEN spb.pilot_name IN ('Rey', 'Finn', 'Din Djarin') THEN 'Intermediate'
        ELSE 'Basic'
    END AS pilot_experience,
    
    -- Get calculated pilot stats
    COALESCE(ps.ships_piloted_count, 0) AS ships_piloted_count,
    COALESCE(ps.ship_class_versatility, 0) AS ship_class_versatility,
    
    -- Flag notable starship-pilot combinations
    CASE
        WHEN (spb.pilot_name = 'Han Solo' AND spb.starship_name LIKE '%Millennium Falcon%') THEN TRUE
        WHEN (spb.pilot_name = 'Luke Skywalker' AND spb.starship_name LIKE '%X-wing%') THEN TRUE
        WHEN (spb.pilot_name = 'Darth Vader' AND spb.starship_name LIKE '%TIE Advanced%') THEN TRUE
        WHEN (spb.pilot_name = 'Boba Fett' AND spb.starship_name LIKE '%Slave I%') THEN TRUE
        WHEN (spb.pilot_name = 'Anakin Skywalker' AND spb.starship_name LIKE '%Jedi Starfighter%') THEN TRUE
        WHEN (spb.pilot_name = 'Poe Dameron' AND spb.starship_name LIKE '%T-70 X-wing%') THEN TRUE
        WHEN (spb.pilot_name = 'Rey' AND spb.starship_name LIKE '%Millennium Falcon%') THEN TRUE
        WHEN (spb.pilot_name = 'Din Djarin' AND spb.starship_name LIKE '%Razor Crest%') THEN TRUE
        WHEN (spb.pilot_name = 'Lando Calrissian' AND spb.starship_name LIKE '%Millennium Falcon%') THEN TRUE
        WHEN (spb.pilot_name = 'Jango Fett' AND spb.starship_name LIKE '%Slave I%') THEN TRUE
        ELSE FALSE
    END AS is_iconic_pairing,
    
    -- Calculate if this is the pilot's "signature ship" based on film appearances
    CASE 
        WHEN ps.ships_piloted_count = 1 THEN TRUE
        WHEN (spb.pilot_name = 'Han Solo' AND spb.starship_name LIKE '%Millennium Falcon%') THEN TRUE
        WHEN (spb.pilot_name = 'Luke Skywalker' AND spb.starship_name LIKE '%X-wing%') THEN TRUE
        WHEN (spb.pilot_name = 'Boba Fett' AND spb.starship_name LIKE '%Slave I%') THEN TRUE
        ELSE FALSE
    END AS is_signature_ship,
    
    -- Affiliation based on pilot
    CASE
        WHEN spb.pilot_name IN ('Luke Skywalker', 'Leia Organa', 'Han Solo', 'Chewbacca', 
                             'Lando Calrissian', 'Wedge Antilles', 'Poe Dameron', 
                             'Finn', 'Rey') THEN 'Rebellion/Resistance'
        WHEN spb.pilot_name IN ('Darth Vader', 'Emperor Palpatine', 'General Grievous',
                             'Darth Maul', 'Count Dooku', 'Kylo Ren') THEN 'Empire/First Order/Sith'
        WHEN spb.pilot_name IN ('Anakin Skywalker', 'Obi-Wan Kenobi', 'Mace Windu', 
                             'Yoda', 'Qui-Gon Jinn', 'Padm√© Amidala') THEN 'Republic/Jedi'
        WHEN spb.pilot_name IN ('Jango Fett', 'Boba Fett', 'Din Djarin') THEN 'Bounty Hunter/Independent'
        ELSE 'Unknown'
    END AS pilot_affiliation,
    
    -- Starship role classification
    CASE
        WHEN spb.starship_class IN ('Starfighter', 'Interceptor', 'Bomber', 'Assault Starfighter') THEN 'Combat'
        WHEN spb.starship_class IN ('Light freighter', 'Medium freighter', 'Heavy freighter') THEN 'Transport'
        WHEN spb.starship_class IN ('Yacht', 'Patrol craft', 'Sail barge', 'Speeder') THEN 'Personal'
        WHEN spb.starship_class IN ('Star Destroyer', 'Battlecruiser', 'Cruiser', 'Star Dreadnought') THEN 'Capital Ship'
        ELSE 'Utility'
    END AS starship_role,
    
    -- Era classification (simplified)
    CASE
        WHEN spb.pilot_name IN ('Anakin Skywalker', 'Obi-Wan Kenobi', 'Padm√© Amidala', 
                             'Qui-Gon Jinn', 'Mace Windu', 'Count Dooku', 'General Grievous') THEN 'Prequel Era'
        WHEN spb.pilot_name IN ('Luke Skywalker', 'Han Solo', 'Leia Organa', 'Darth Vader', 
                             'Chewbacca', 'Lando Calrissian') THEN 'Original Trilogy Era'
        WHEN spb.pilot_name IN ('Rey', 'Finn', 'Poe Dameron', 'Kylo Ren') THEN 'Sequel Era'
        WHEN spb.pilot_name IN ('Din Djarin') THEN 'Mandalorian Era'
        ELSE 'Unknown Era'
    END AS story_era,
    
    -- Data tracking field
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM starship_pilot_base spb
LEFT JOIN pilot_films pf ON spb.pilot_id = pf.pilot_id
LEFT JOIN starship_films sf ON spb.starship_id = sf.starship_id
LEFT JOIN homeworlds hw ON spb.homeworld_id::INTEGER = hw.planet_id  -- Add explicit type cast to INTEGER
LEFT JOIN pilot_stats ps ON spb.pilot_id = ps.pilot_id
WHERE spb.pilot_id IS NOT NULL AND spb.starship_id IS NOT NULL
ORDER BY spb.starship_name, pilot_skill DESC, spb.pilot_name
  );
  
[0m09:38:04.478163 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m09:38:04.477619 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_sw_species"
[0m09:38:04.481075 [info ] [Thread-3 (]: 77 of 103 OK created sql table model public.dim_sw_planets ..................... [[32mSELECT 60[0m in 0.24s]
[0m09:38:04.482766 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.dim_sw_planets
[0m09:38:04.483166 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.dim_sw_films
[0m09:38:04.483649 [info ] [Thread-3 (]: 81 of 103 START sql table model public.dim_sw_films ............................ [RUN]
[0m09:38:04.484202 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_sw_planets, now model.nerd_facts_dbt.dim_sw_films)
[0m09:38:04.484602 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.dim_sw_films
[0m09:38:04.482060 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:38:04.491566 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_sw_films"
[0m09:38:04.493045 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_species"
[0m09:38:04.493521 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_sw_species: BEGIN
[0m09:38:04.496104 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:38:04.495689 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.dim_sw_films
[0m09:38:04.505009 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_sw_films"
[0m09:38:04.505480 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.024 seconds
[0m09:38:04.512187 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.bridge_sw_starships_pilots"
[0m09:38:04.512769 [debug] [Thread-1 (]: On model.nerd_facts_dbt.bridge_sw_starships_pilots: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.bridge_sw_starships_pilots"} */
alter table "nerd_facts"."public"."bridge_sw_starships_pilots" rename to "bridge_sw_starships_pilots__dbt_backup"
[0m09:38:04.513634 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:38:04.518789 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.bridge_sw_starships_pilots"
[0m09:38:04.519965 [debug] [Thread-1 (]: On model.nerd_facts_dbt.bridge_sw_starships_pilots: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.bridge_sw_starships_pilots"} */
alter table "nerd_facts"."public"."bridge_sw_starships_pilots__dbt_tmp" rename to "bridge_sw_starships_pilots"
[0m09:38:04.519320 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m09:38:04.520516 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_species"
[0m09:38:04.521233 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_films"
[0m09:38:04.521681 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_sw_species: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_sw_species"} */

  
    

  create  table "nerd_facts"."public"."dim_sw_species__dbt_tmp"
  
  
    as
  
  (
    

/*
  Model: dim_sw_species
  Description: Species dimension table with enriched attributes and classifications
*/

WITH species_base AS (
    SELECT
        s.species_id,
        s.species_name,  -- Using species_name directly instead of s.name
        s.classification,
        s.designation,
        s.average_height,
        s.skin_colors,
        s.hair_colors,
        s.eye_colors,
        s.average_lifespan,
        s.language,
        s.homeworld AS homeworld_id  -- Use homeworld instead of homeworld_id
    FROM "nerd_facts"."public"."int_swapi_species" s
),

-- Film appearances
film_appearances AS (
    SELECT
        fs.species_id,
        COUNT(DISTINCT fs.film_id) AS film_count
    FROM "nerd_facts"."public"."int_swapi_films_species" fs
    GROUP BY fs.species_id
),

-- Character counts - estimate based on species mentions in films
-- Since we don't have direct access to character-species relationships
character_counts AS (
    SELECT
        fs.species_id,
        COUNT(DISTINCT fc.people_id) AS character_count
    FROM "nerd_facts"."public"."int_swapi_films_species" fs
    JOIN "nerd_facts"."public"."int_swapi_films_characters" fc ON fs.film_id = fc.film_id
    GROUP BY fs.species_id
),

-- Enriched species data
species_enriched AS (
    SELECT
        sb.*,
        COALESCE(fa.film_count, 0) AS film_count,
        COALESCE(cc.character_count, 0) AS character_count
    FROM species_base sb
    LEFT JOIN film_appearances fa ON sb.species_id = fa.species_id
    LEFT JOIN character_counts cc ON sb.species_id = cc.species_id
)

SELECT
    -- Primary Key
    md5(cast(coalesce(cast(se.species_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS species_key,
    
    -- Natural Key
    se.species_id,
    
    -- Species Attributes
    se.species_name,
    se.classification,
    se.designation,
    se.average_height,
    se.skin_colors,
    se.hair_colors,
    se.eye_colors,
    se.average_lifespan,
    se.language,
    se.homeworld_id,
    
    -- Related Dimensions
    md5(cast(coalesce(cast(se.homeworld_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS homeworld_key,
    
    -- Appearance Metrics
    se.film_count,
    se.character_count,
    
    -- Species Classifications
    CASE
        WHEN se.classification ILIKE '%mammal%' THEN 'Mammalian'
        WHEN se.classification ILIKE '%reptile%' THEN 'Reptilian'
        WHEN se.classification ILIKE '%amphibian%' THEN 'Amphibian'
        WHEN se.classification ILIKE '%insect%' THEN 'Insectoid'
        WHEN se.classification ILIKE '%sentient%' THEN 'Sentient'
        ELSE se.classification
    END AS species_type,
    
    -- Sentience level
    CASE
        WHEN se.designation ILIKE '%sentient%' THEN 'Sentient'
        ELSE 'Non-sentient'
    END AS sentience_level,
    
    -- Size classification based on average_height
    CASE
        WHEN se.average_height::NUMERIC > 200 THEN 'Tall'
        WHEN se.average_height::NUMERIC BETWEEN 150 AND 200 THEN 'Medium'
        WHEN se.average_height::NUMERIC > 0 AND se.average_height::NUMERIC < 150 THEN 'Short'
        ELSE 'Unknown'
    END AS size_classification,
    
    -- Longevity based on average_lifespan
    CASE
        WHEN se.average_lifespan::NUMERIC > 500 THEN 'Very Long-Lived'
        WHEN se.average_lifespan::NUMERIC > 150 THEN 'Long-Lived'
        WHEN se.average_lifespan::NUMERIC > 70 THEN 'Standard'
        WHEN se.average_lifespan::NUMERIC > 0 THEN 'Short-Lived'
        ELSE 'Unknown'
    END AS longevity_classification,
    
    -- Notable Species flag
    CASE 
        WHEN se.species_name IN ('Human', 'Wookiee', 'Droid', 'Hutt', 'Yoda''s species', 
                              'Zabrak', 'Twi''lek', 'Mon Calamari', 'Ewok', 'Gungan') 
            OR se.film_count >= 3  
        THEN TRUE
        ELSE FALSE
    END AS is_notable_species,
    
    -- Force sensitivity prevalence
    CASE 
        WHEN se.species_name IN ('Yoda''s species') THEN 'High'
        WHEN se.species_name IN ('Human', 'Zabrak', 'Togruta') THEN 'Medium'
        ELSE 'Low/Unknown'
    END AS force_sensitivity_prevalence,
    
    -- Narrative importance
    CASE
        WHEN se.film_count >= 3 THEN 'Major'
        WHEN se.film_count >= 2 THEN 'Significant'
        WHEN se.film_count = 1 THEN 'Featured'
        ELSE 'Minor'
    END AS narrative_importance,
    
    -- Data Tracking
    CURRENT_TIMESTAMP AS dbt_loaded_at

FROM species_enriched se
  );
  
[0m09:38:04.522430 [debug] [Thread-4 (]: SQL status: BEGIN in 0.040 seconds
[0m09:38:04.524337 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m09:38:04.524816 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  
    

  create  table "nerd_facts"."public"."fact_starships__dbt_tmp"
  
  
    as
  
  (
    

/*
  Model: fact_starships (simplified)
  Description: Fact table for Star Wars starships with basic fields
*/

WITH starships AS (
    SELECT
        s.starship_id,
        s.starship_name,
        s.model,
        s.manufacturer,
        s.cost_in_credits,
        s.length,
        s.max_atmosphering_speed,
        s.crew,
        s.passengers,
        s.cargo_capacity,
        s.consumables,
        s.hyperdrive_rating,
        s.MGLT,
        s.starship_class
    FROM "nerd_facts"."public"."int_swapi_starships" s
    WHERE s.starship_id IS NOT NULL
),

-- Get film data for starships
starship_films AS (
    SELECT
        fs.starship_id,
        COUNT(DISTINCT fs.film_id) AS film_count,
        STRING_AGG(f.title, ', ' ORDER BY f.episode_id) AS film_names
    FROM "nerd_facts"."public"."int_swapi_films_starships" fs
    JOIN "nerd_facts"."public"."int_swapi_films" f ON fs.film_id = f.film_id
    GROUP BY fs.starship_id
)

SELECT
    -- Primary key
    md5(cast(coalesce(cast(s.starship_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS starship_key,
    
    -- Core identifiers
    s.starship_id,
    s.starship_name,
    s.model,
    s.manufacturer,
    
    -- Classification
    s.starship_class,
    
    -- Basic metrics with safe type handling
    CASE WHEN s.cost_in_credits::TEXT ~ '^[0-9]+$' THEN s.cost_in_credits::NUMERIC ELSE NULL END AS cost_credits,
    CASE WHEN s.length::TEXT ~ '^[0-9]+(\.[0-9]+)?$' THEN s.length::NUMERIC ELSE NULL END AS length_m,
    CASE WHEN s.max_atmosphering_speed::TEXT ~ '^[0-9]+$' THEN s.max_atmosphering_speed::NUMERIC ELSE NULL END AS max_speed,
    CASE WHEN s.hyperdrive_rating::TEXT ~ '^[0-9]+(\.[0-9]+)?$' THEN s.hyperdrive_rating::NUMERIC ELSE NULL END AS hyperdrive,
    CASE WHEN s.MGLT::TEXT ~ '^[0-9]+$' THEN s.MGLT::NUMERIC ELSE NULL END AS MGLT,
    
    -- Film appearances
    COALESCE(sf.film_count, 0) AS film_count,
    COALESCE(sf.film_names, 'None') AS film_appearances,
    
    -- Data tracking field
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM starships s
LEFT JOIN starship_films sf ON s.starship_id = sf.starship_id
ORDER BY s.starship_id
  );
  
[0m09:38:04.522900 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:38:04.526553 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.bridge_sw_starships_pilots"
[0m09:38:04.526929 [debug] [Thread-1 (]: On model.nerd_facts_dbt.bridge_sw_starships_pilots: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.bridge_sw_starships_pilots"} */

    create  index if not exists
  "84192f4df33b9cd48d14f60956319df2"
  on "nerd_facts"."public"."bridge_sw_starships_pilots" 
  (starship_id)
  
[0m09:38:04.523453 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_sw_films: BEGIN
[0m09:38:04.527346 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:38:04.537162 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m09:38:04.537701 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_films"
[0m09:38:04.538155 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_sw_films: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_sw_films"} */

  
    

  create  table "nerd_facts"."public"."dim_sw_films__dbt_tmp"
  
  
    as
  
  (
    

/*
  Model: dim_sw_films
  Description: Film dimension table with enriched attributes
*/

WITH film_base AS (
  SELECT
    f.film_id,
    f.title,
    f.episode_id,
    f.opening_crawl,
    f.director,
    f.producer,
    f.release_date
  FROM "nerd_facts"."public"."int_swapi_films" f
),

-- Character counts
character_counts AS (
  SELECT
    fc.film_id,
    COUNT(DISTINCT fc.people_id) AS character_count
  FROM "nerd_facts"."public"."int_swapi_films_characters" fc
  GROUP BY fc.film_id
),

-- Planet counts
planet_counts AS (
  SELECT
    fp.film_id,
    COUNT(DISTINCT fp.planet_id) AS planet_count
  FROM "nerd_facts"."public"."int_swapi_films_planets" fp
  GROUP BY fp.film_id
),

-- Vehicle counts
vehicle_counts AS (
  SELECT
    fv.film_id,
    COUNT(DISTINCT fv.vehicle_id) AS vehicle_count
  FROM "nerd_facts"."public"."int_swapi_films_vehicles" fv
  GROUP BY fv.film_id
),

-- Starship counts
starship_counts AS (
  SELECT
    fs.film_id,
    COUNT(DISTINCT fs.starship_id) AS starship_count
  FROM "nerd_facts"."public"."int_swapi_films_starships" fs
  GROUP BY fs.film_id
),

-- Species counts
species_counts AS (
  SELECT
    fsp.film_id,
    COUNT(DISTINCT fsp.species_id) AS species_count
  FROM "nerd_facts"."public"."int_swapi_films_species" fsp
  GROUP BY fsp.film_id
)

SELECT
  -- Primary Key
  md5(cast(coalesce(cast(fb.film_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS film_key,
  
  -- Natural Key
  fb.film_id,
  
  -- Film Attributes
  fb.title AS film_title,
  fb.episode_id,
  fb.opening_crawl,
  fb.director,
  fb.producer,
  fb.release_date,
  
  -- Film Classification
  CASE
    WHEN fb.episode_id BETWEEN 1 AND 3 THEN 'Prequel Trilogy'
    WHEN fb.episode_id BETWEEN 4 AND 6 THEN 'Original Trilogy'
    WHEN fb.episode_id BETWEEN 7 AND 9 THEN 'Sequel Trilogy'
    ELSE 'Anthology Films'
  END AS film_saga,
  
  CASE
    WHEN fb.episode_id BETWEEN 1 AND 3 THEN 'Republic Era'
    WHEN fb.episode_id BETWEEN 4 AND 6 THEN 'Imperial Era'
    WHEN fb.episode_id BETWEEN 7 AND 9 THEN 'New Republic Era'
    ELSE 'Various'
  END AS era,
  
  -- Release information
  EXTRACT(YEAR FROM fb.release_date) AS release_year,
  
  -- Entity counts
  COALESCE(cc.character_count, 0) AS character_count,
  COALESCE(pc.planet_count, 0) AS planet_count,
  COALESCE(vc.vehicle_count, 0) AS vehicle_count,
  COALESCE(sc.starship_count, 0) AS starship_count,
  COALESCE(spc.species_count, 0) AS species_count,
  
  -- Calculated metrics
  COALESCE(cc.character_count, 0) + 
  COALESCE(pc.planet_count, 0) + 
  COALESCE(vc.vehicle_count, 0) + 
  COALESCE(sc.starship_count, 0) + 
  COALESCE(spc.species_count, 0) AS total_entity_count,
  
  -- Cast size classification
  CASE
    WHEN COALESCE(cc.character_count, 0) <= 10 THEN 'Small Cast'
    WHEN COALESCE(cc.character_count, 0) <= 25 THEN 'Medium Cast'
    ELSE 'Large Cast'
  END AS cast_size_category,
  
  -- Film importance
  CASE
    WHEN fb.episode_id IN (4, 5, 6) THEN 'Foundational'
    WHEN fb.episode_id IN (1, 2, 3, 7, 8, 9) THEN 'Main Saga'
    ELSE 'Extended Universe'
  END AS film_importance,
  
  -- Time Dimension
  CURRENT_TIMESTAMP AS dbt_loaded_at

FROM film_base fb
LEFT JOIN character_counts cc ON fb.film_id = cc.film_id
LEFT JOIN planet_counts pc ON fb.film_id = pc.film_id
LEFT JOIN vehicle_counts vc ON fb.film_id = vc.film_id
LEFT JOIN starship_counts sc ON fb.film_id = sc.film_id
LEFT JOIN species_counts spc ON fb.film_id = spc.film_id
ORDER BY fb.episode_id
  );
  
[0m09:38:04.539000 [debug] [Thread-4 (]: SQL status: SELECT 36 in 0.014 seconds
[0m09:38:04.545478 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m09:38:04.545998 [debug] [Thread-2 (]: SQL status: SELECT 37 in 0.022 seconds
[0m09:38:04.546361 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.019 seconds
[0m09:38:04.546662 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */
alter table "nerd_facts"."public"."fact_starships" rename to "fact_starships__dbt_backup"
[0m09:38:04.550694 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_species"
[0m09:38:04.551164 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.013 seconds
[0m09:38:04.552808 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.bridge_sw_starships_pilots"
[0m09:38:04.553764 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_sw_species: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_sw_species"} */
alter table "nerd_facts"."public"."dim_sw_species" rename to "dim_sw_species__dbt_backup"
[0m09:38:04.554152 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:04.558181 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_films"
[0m09:38:04.558660 [debug] [Thread-1 (]: On model.nerd_facts_dbt.bridge_sw_starships_pilots: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.bridge_sw_starships_pilots"} */

    create  index if not exists
  "eba0c55d7b72ce3bb296a22768c190ed"
  on "nerd_facts"."public"."bridge_sw_starships_pilots" 
  (pilot_id)
  
[0m09:38:04.563239 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m09:38:04.563778 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:38:04.564174 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_sw_films: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_sw_films"} */
alter table "nerd_facts"."public"."dim_sw_films" rename to "dim_sw_films__dbt_backup"
[0m09:38:04.565319 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */
alter table "nerd_facts"."public"."fact_starships__dbt_tmp" rename to "fact_starships"
[0m09:38:04.568584 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_species"
[0m09:38:04.569282 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_sw_species: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_sw_species"} */
alter table "nerd_facts"."public"."dim_sw_species__dbt_tmp" rename to "dim_sw_species"
[0m09:38:04.569916 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:04.570330 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.006 seconds
[0m09:38:04.570762 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:04.572420 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m09:38:04.572906 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:38:04.574480 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.bridge_sw_starships_pilots"
[0m09:38:04.575968 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_species"
[0m09:38:04.576404 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

    create  index if not exists
  "3c14088ffe93de9f05123e751a95b379"
  on "nerd_facts"."public"."fact_starships" 
  (starship_id)
  
[0m09:38:04.579824 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_films"
[0m09:38:04.580384 [debug] [Thread-1 (]: On model.nerd_facts_dbt.bridge_sw_starships_pilots: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.bridge_sw_starships_pilots"} */

    create  index if not exists
  "cb0907abc662a8f221d21984b5a1dfea"
  on "nerd_facts"."public"."bridge_sw_starships_pilots" 
  (starship_pilot_id)
  
[0m09:38:04.580769 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_sw_species: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_sw_species"} */

    create  index if not exists
  "08febf21fbb4a57061b27b3726793eeb"
  on "nerd_facts"."public"."dim_sw_species" 
  (species_key)
  
[0m09:38:04.581758 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_sw_films: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_sw_films"} */
alter table "nerd_facts"."public"."dim_sw_films__dbt_tmp" rename to "dim_sw_films"
[0m09:38:04.583252 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:38:04.584925 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_films"
[0m09:38:04.585333 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_sw_films: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_sw_films"} */

    create  index if not exists
  "c90b5683f5481af7d7aef9045ae89ccc"
  on "nerd_facts"."public"."dim_sw_films" 
  (film_key)
  
[0m09:38:04.589796 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.009 seconds
[0m09:38:04.591679 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m09:38:04.592122 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

    create  index if not exists
  "f27b662617830b621db717800632845a"
  on "nerd_facts"."public"."fact_starships" 
  (starship_class)
  
[0m09:38:04.593638 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.011 seconds
[0m09:38:04.594095 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.012 seconds
[0m09:38:04.596210 [debug] [Thread-1 (]: On model.nerd_facts_dbt.bridge_sw_starships_pilots: COMMIT
[0m09:38:04.598174 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_species"
[0m09:38:04.598631 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.013 seconds
[0m09:38:04.598972 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.006 seconds
[0m09:38:04.599367 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.bridge_sw_starships_pilots"
[0m09:38:04.599779 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_sw_species: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_sw_species"} */

    create  index if not exists
  "7f7a41239c1b0e38cfa91a7a0666e8b4"
  on "nerd_facts"."public"."dim_sw_species" 
  (species_id)
  
[0m09:38:04.601296 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_films"
[0m09:38:04.603908 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_sw_films: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_sw_films"} */

    create  index if not exists
  "8f91e2db78cfec6cb7219aebcbefb305"
  on "nerd_facts"."public"."dim_sw_films" 
  (film_id)
  
[0m09:38:04.603324 [debug] [Thread-1 (]: On model.nerd_facts_dbt.bridge_sw_starships_pilots: COMMIT
[0m09:38:04.602914 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_starships: COMMIT
[0m09:38:04.605273 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m09:38:04.610587 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_starships: COMMIT
[0m09:38:04.611009 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m09:38:04.614962 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."bridge_sw_starships_pilots__dbt_backup"
[0m09:38:04.615780 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.012 seconds
[0m09:38:04.615412 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m09:38:04.616748 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.bridge_sw_starships_pilots"
[0m09:38:04.618810 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_sw_species: COMMIT
[0m09:38:04.619291 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.015 seconds
[0m09:38:04.624652 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."fact_starships__dbt_backup"
[0m09:38:04.625670 [debug] [Thread-1 (]: On model.nerd_facts_dbt.bridge_sw_starships_pilots: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.bridge_sw_starships_pilots"} */
drop table if exists "nerd_facts"."public"."bridge_sw_starships_pilots__dbt_backup" cascade
[0m09:38:04.626416 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_species"
[0m09:38:04.629108 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_sw_films: COMMIT
[0m09:38:04.630288 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m09:38:04.631674 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_sw_species: COMMIT
[0m09:38:04.632198 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_films"
[0m09:38:04.632633 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */
drop table if exists "nerd_facts"."public"."fact_starships__dbt_backup" cascade
[0m09:38:04.633206 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_sw_films: COMMIT
[0m09:38:04.634171 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m09:38:04.636108 [debug] [Thread-1 (]: On model.nerd_facts_dbt.bridge_sw_starships_pilots: Close
[0m09:38:04.636623 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m09:38:04.642153 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."dim_sw_species__dbt_backup"
[0m09:38:04.642951 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m09:38:04.643334 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m09:38:04.643738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b83b7550>]}
[0m09:38:04.644439 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_species"
[0m09:38:04.645700 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m09:38:04.648259 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."dim_sw_films__dbt_backup"
[0m09:38:04.650465 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_films"
[0m09:38:04.649641 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_sw_species: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_sw_species"} */
drop table if exists "nerd_facts"."public"."dim_sw_species__dbt_backup" cascade
[0m09:38:04.650840 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_sw_films: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_sw_films"} */
drop table if exists "nerd_facts"."public"."dim_sw_films__dbt_backup" cascade
[0m09:38:04.649043 [info ] [Thread-1 (]: 78 of 103 OK created sql table model public.bridge_sw_starships_pilots ......... [[32mSELECT 10[0m in 0.32s]
[0m09:38:04.653327 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.bridge_sw_starships_pilots
[0m09:38:04.653885 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.dim_sw_vehicles
[0m09:38:04.654935 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b8261e70>]}
[0m09:38:04.655363 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:38:04.659023 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_sw_species: Close
[0m09:38:04.656001 [info ] [Thread-1 (]: 82 of 103 START sql table model public.dim_sw_vehicles ......................... [RUN]
[0m09:38:04.657604 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m09:38:04.657268 [info ] [Thread-4 (]: 79 of 103 OK created sql table model public.fact_starships ..................... [[32mSELECT 36[0m in 0.30s]
[0m09:38:04.660003 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b86bad70>]}
[0m09:38:04.662194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.bridge_sw_starships_pilots, now model.nerd_facts_dbt.dim_sw_vehicles)
[0m09:38:04.663832 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_sw_films: Close
[0m09:38:04.664490 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m09:38:04.666258 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.fact_sw_films
[0m09:38:04.665739 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.dim_sw_vehicles
[0m09:38:04.665163 [info ] [Thread-2 (]: 80 of 103 OK created sql table model public.dim_sw_species ..................... [[32mSELECT 37[0m in 0.21s]
[0m09:38:04.674305 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.dim_sw_species
[0m09:38:04.673590 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b86c6ad0>]}
[0m09:38:04.666726 [info ] [Thread-4 (]: 83 of 103 START sql table model public.fact_sw_films ........................... [RUN]
[0m09:38:04.675869 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_starships, now model.nerd_facts_dbt.fact_sw_films)
[0m09:38:04.672785 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_sw_vehicles"
[0m09:38:04.677243 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.dim_sw_vehicles
[0m09:38:04.676271 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.fact_sw_films
[0m09:38:04.674719 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.fct_test_directories
[0m09:38:04.675335 [info ] [Thread-3 (]: 81 of 103 OK created sql table model public.dim_sw_films ....................... [[32mSELECT 6[0m in 0.19s]
[0m09:38:04.683366 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_sw_vehicles"
[0m09:38:04.689942 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_sw_films"
[0m09:38:04.690490 [info ] [Thread-2 (]: 84 of 103 START sql view model public.fct_test_directories ..................... [RUN]
[0m09:38:04.691276 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.dim_sw_films
[0m09:38:04.693055 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.int_all_dag_relationships
[0m09:38:04.692594 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_sw_species, now model.dbt_project_evaluator.fct_test_directories)
[0m09:38:04.692037 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_vehicles"
[0m09:38:04.694107 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.fact_sw_films
[0m09:38:04.693619 [info ] [Thread-3 (]: 85 of 103 START sql view model public.int_all_dag_relationships ................ [RUN]
[0m09:38:04.694518 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.fct_test_directories
[0m09:38:04.694869 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_sw_vehicles: BEGIN
[0m09:38:04.701927 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_sw_films"
[0m09:38:04.702509 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_sw_films, now model.dbt_project_evaluator.int_all_dag_relationships)
[0m09:38:04.707005 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_test_directories"
[0m09:38:04.709578 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.fct_test_directories
[0m09:38:04.708168 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.int_all_dag_relationships
[0m09:38:04.708712 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_sw_films"
[0m09:38:04.707635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:38:04.715778 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_test_directories"
[0m09:38:04.729518 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.int_all_dag_relationships"
[0m09:38:04.731234 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.int_all_dag_relationships
[0m09:38:04.730046 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_sw_films: BEGIN
[0m09:38:04.742940 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:38:04.742508 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m09:38:04.743792 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_test_directories: BEGIN
[0m09:38:04.744136 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:38:04.744799 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m09:38:04.745125 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_vehicles"
[0m09:38:04.745502 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_sw_vehicles: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_sw_vehicles"} */

  
    

  create  table "nerd_facts"."public"."dim_sw_vehicles__dbt_tmp"
  
  
    as
  
  (
    

-- Get vehicle data from intermediate layer
WITH vehicle_film_data AS (
  SELECT
    fv.vehicle_id,
    COUNT(DISTINCT fv.film_id) AS film_count,
    STRING_AGG(f.title, ', ' ORDER BY f.episode_id) AS film_appearances
  FROM "nerd_facts"."public"."int_swapi_films_vehicles" fv
  JOIN "nerd_facts"."public"."int_swapi_films" f ON fv.film_id = f.film_id
  GROUP BY fv.vehicle_id
),

-- Add context data without trying numeric conversions
vehicle_context AS (
  SELECT
    v.vehicle_id,
    v.vehicle_name,  -- Already using vehicle_name
    v.model,
    v.manufacturer,
    v.vehicle_class,
    v.consumables,
    COALESCE(vfd.film_count, 0) AS film_appearances_count,
    COALESCE(vfd.film_appearances, 'None') AS film_appearances,
    
    -- Size classification based on known vehicle classes
    CASE
      WHEN v.vehicle_class ILIKE '%walker%' THEN 'Very Large'
      WHEN v.vehicle_class ILIKE '%transport%' THEN 'Large'
      WHEN v.vehicle_class ILIKE '%speeder%' THEN 'Medium'
      WHEN v.vehicle_class ILIKE '%bike%' OR v.vehicle_class ILIKE '%pod%' THEN 'Small'
      ELSE 'Medium'
    END AS vehicle_size,
    
    -- Purpose classification
    CASE 
      WHEN v.vehicle_class ILIKE '%combat%' OR 
           v.vehicle_class ILIKE '%assault%' OR
           v.vehicle_class ILIKE '%walker%' OR
           v.vehicle_class ILIKE '%fighter%' THEN 'Military'
      WHEN v.vehicle_class ILIKE '%transport%' OR
           v.vehicle_class ILIKE '%cargo%' THEN 'Transport'
      WHEN v.vehicle_class ILIKE '%speeder%' THEN 'Civilian'
      ELSE 'Multipurpose'
    END AS vehicle_purpose,
    
    -- Terrain capability
    CASE
      WHEN v.vehicle_class ILIKE '%speeder%' AND v.vehicle_class ILIKE '%snow%' THEN 'Snow'
      WHEN v.vehicle_class ILIKE '%speeder%' THEN 'Ground'
      WHEN v.vehicle_class ILIKE '%submarine%' THEN 'Water'
      WHEN v.vehicle_class ILIKE '%walker%' THEN 'All-Terrain'
      WHEN v.vehicle_class ILIKE '%airspeeder%' THEN 'Air'
      ELSE 'Ground'
    END AS terrain_capability,
    
    -- Notable vehicles
    CASE 
      WHEN v.vehicle_name IN ('AT-AT', 'AT-ST', 'Snowspeeder', 'Speeder bike',
                     'Imperial Speeder Bike', 'Sand Crawler', 'TIE bomber',
                     'TIE fighter', 'X-34 landspeeder') THEN TRUE
      ELSE FALSE
    END AS is_notable_vehicle,
    
    -- Move faction affiliation calculation to the CTE so it's available for ORDER BY
    CASE
      WHEN LOWER(v.vehicle_name) LIKE '%imperial%' OR
           LOWER(v.vehicle_name) IN ('at-at', 'at-st', 'at-dp', 'tie bomber',
                                 'tie fighter', 'tie interceptor') THEN 'Imperial'
      WHEN LOWER(v.vehicle_name) LIKE '%republic%' THEN 'Republic'
      WHEN LOWER(v.vehicle_name) LIKE '%rebel%' OR
           LOWER(v.vehicle_name) IN ('snowspeeder', 'x-34 landspeeder') THEN 'Rebel Alliance'
      ELSE 'Civilian/Neutral'
    END AS faction_affiliation
    
  FROM "nerd_facts"."public"."int_swapi_vehicles" v
  LEFT JOIN vehicle_film_data vfd ON v.vehicle_id = vfd.vehicle_id
)

-- Final output with surrogate key and enriched attributes
SELECT 
  md5(cast(coalesce(cast(v.vehicle_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS vehicle_key,
  v.vehicle_id,
  v.vehicle_name,
  v.model,
  v.manufacturer,
  
  -- Technical classifications
  v.vehicle_class,
  v.vehicle_size,
  v.vehicle_purpose,
  v.terrain_capability,
  v.consumables,
  
  -- Film information
  v.film_appearances_count,
  v.film_appearances,
  
  -- Star Wars universe context - using the pre-calculated field
  v.faction_affiliation,
  
  -- Calculate effectiveness rating
  CASE 
    WHEN v.vehicle_purpose = 'Military' THEN
      GREATEST(1, LEAST(10, 5 + 
        CASE
          WHEN v.vehicle_size = 'Very Large' THEN 3
          WHEN v.vehicle_size = 'Large' THEN 2
          WHEN v.vehicle_size = 'Medium' THEN 1
          WHEN v.vehicle_size = 'Small' THEN 0
          ELSE 0
        END
      ))
    WHEN v.vehicle_purpose = 'Transport' THEN 5
    ELSE 3
  END AS effectiveness_rating,
  
  -- Notable flag
  v.is_notable_vehicle AS is_iconic,
  
  -- Time dimension
  CURRENT_TIMESTAMP AS dbt_loaded_at
  
FROM vehicle_context v
WHERE v.vehicle_id IS NOT NULL
ORDER BY v.faction_affiliation, v.vehicle_name
  );
  
[0m09:38:04.741752 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project_evaluator.int_all_dag_relationships"
[0m09:38:04.746697 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m09:38:04.747230 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_all_dag_relationships: BEGIN
[0m09:38:04.747523 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:38:04.759849 [debug] [Thread-1 (]: SQL status: SELECT 39 in 0.014 seconds
[0m09:38:04.763982 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_vehicles"
[0m09:38:04.764448 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_sw_vehicles: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_sw_vehicles"} */
alter table "nerd_facts"."public"."dim_sw_vehicles" rename to "dim_sw_vehicles__dbt_backup"
[0m09:38:04.764885 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m09:38:04.765240 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m09:38:04.765571 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_test_directories: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_directories"} */

  create view "nerd_facts"."public"."fct_test_directories__dbt_tmp"
    
    
  as (
    with

resources as (

    select * from "nerd_facts"."public"."int_all_graph_resources"
    where not is_excluded

),

relationships as (

    select * from "nerd_facts"."public"."int_direct_relationships"

),

models_per_test as (

    select
        resource_name as test_name,
        resource_id as test_id,
        direct_parent_id as parent_model_id
    from relationships
    where resource_type = 'test'
    and is_primary_test_relationship

),

model_file_paths as (

    select
        resources.resource_id as model_id,
        resources.resource_name as model_name,
        resources.directory_path as model_directory_path,
        models_per_test.test_id,
        models_per_test.parent_model_id
    from resources
    inner join models_per_test
    on models_per_test.parent_model_id = resources.resource_id
    where resource_type = 'model'

),

test_file_paths as (

    select
        resource_id as test_id,
        resource_name as test_name,
        file_name as test_yml_name,
        directory_path as test_yml_directory_path
    from resources
    where 
        resource_type = 'test'
        and is_generic_test

),

all_file_paths as (

    select
        test_file_paths.test_id,
        test_file_paths.test_name,
        test_file_paths.test_yml_directory_path,
        test_file_paths.test_yml_name,
        model_file_paths.model_id,
        model_file_paths.model_name,
        model_file_paths.model_directory_path
    from model_file_paths
    inner join test_file_paths
    on model_file_paths.test_id = test_file_paths.test_id

),

different_directories as (

    select
        test_name,
        model_name,
        test_yml_directory_path as current_test_directory,
        model_directory_path as change_test_directory_to
    from all_file_paths
    where model_directory_path != test_yml_directory_path

)

select * from different_directories



    

    
    

    

    


  );
[0m09:38:04.766358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:38:04.769698 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_vehicles"
[0m09:38:04.770044 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:38:04.770386 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_sw_vehicles: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_sw_vehicles"} */
alter table "nerd_facts"."public"."dim_sw_vehicles__dbt_tmp" rename to "dim_sw_vehicles"
[0m09:38:04.773910 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m09:38:04.774379 [debug] [Thread-4 (]: SQL status: BEGIN in 0.031 seconds
[0m09:38:04.776224 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_sw_films"
[0m09:38:04.776625 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_sw_films: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_sw_films"} */

  
    

  create  table "nerd_facts"."public"."fact_sw_films__dbt_tmp"
  
  
    as
  
  (
    

/*
  Model: fact_sw_films
  Description: Film fact table with metrics about characters, planets, vehicles, starships and species
*/

-- Film base information
WITH film_base AS (
  SELECT
    f.film_id,
    f.title,
    f.episode_id,
    f.release_date,
    EXTRACT(YEAR FROM f.release_date) AS release_year
  FROM "nerd_facts"."public"."int_swapi_films" f
),

-- Character counts with gender breakdown
character_metrics AS (
  SELECT 
    fc.film_id,
    COUNT(DISTINCT fc.people_id) AS total_characters,
    SUM(CASE WHEN p.gender = 'male' THEN 1 ELSE 0 END) AS male_characters,
    SUM(CASE WHEN p.gender = 'female' THEN 1 ELSE 0 END) AS female_characters,
    SUM(CASE WHEN p.gender NOT IN ('male', 'female') OR p.gender IS NULL THEN 1 ELSE 0 END) AS other_gender_characters,
    -- Force users
    SUM(CASE 
      WHEN p.name IN ('Luke Skywalker', 'Darth Vader', 'Anakin Skywalker', 'Rey', 'Kylo Ren',
                    'Obi-Wan Kenobi', 'Emperor Palpatine', 'Yoda', 'Mace Windu',
                    'Count Dooku', 'Qui-Gon Jinn', 'Darth Maul', 'Ahsoka Tano')
      THEN 1 ELSE 0 
    END) AS force_users
  FROM "nerd_facts"."public"."int_swapi_films_characters" fc
  JOIN "nerd_facts"."public"."int_swapi_people" p ON fc.people_id = p.people_id
  GROUP BY fc.film_id
),

-- Planet counts
planet_metrics AS (
  SELECT 
    fp.film_id,
    COUNT(DISTINCT fp.planet_id) AS total_planets
  FROM "nerd_facts"."public"."int_swapi_films_planets" fp
  GROUP BY fp.film_id
),

-- Vehicle counts
vehicle_metrics AS (
  SELECT 
    fv.film_id,
    COUNT(DISTINCT fv.vehicle_id) AS total_vehicles
  FROM "nerd_facts"."public"."int_swapi_films_vehicles" fv
  GROUP BY fv.film_id
),

-- Starship counts
starship_metrics AS (
  SELECT 
    fs.film_id,
    COUNT(DISTINCT fs.starship_id) AS total_starships
  FROM "nerd_facts"."public"."int_swapi_films_starships" fs
  GROUP BY fs.film_id
),

-- Species counts
species_metrics AS (
  SELECT 
    fsp.film_id,
    COUNT(DISTINCT fsp.species_id) AS total_species
  FROM "nerd_facts"."public"."int_swapi_films_species" fsp
  GROUP BY fsp.film_id
)

SELECT
  -- Primary Key (same as dim_films)
  md5(cast(coalesce(cast(fb.film_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS film_key,
  
  -- Natural Key
  fb.film_id,
  
  -- Film Identifiers
  fb.title AS film_title,
  fb.episode_id,
  fb.release_date,
  fb.release_year,
  
  -- Character Metrics
  COALESCE(cm.total_characters, 0) AS character_count,
  COALESCE(cm.male_characters, 0) AS male_character_count,
  COALESCE(cm.female_characters, 0) AS female_character_count,
  COALESCE(cm.other_gender_characters, 0) AS other_gender_character_count,
  COALESCE(cm.force_users, 0) AS force_user_count,
  
  -- Gender diversity ratio (percentage of non-male characters)
  CASE 
    WHEN COALESCE(cm.total_characters, 0) > 0 
    THEN ROUND((COALESCE(cm.female_characters, 0) * 100.0 / COALESCE(cm.total_characters, 1)), 1)
    ELSE 0
  END AS female_character_percentage,
  
  -- Force user ratio
  CASE 
    WHEN COALESCE(cm.total_characters, 0) > 0 
    THEN ROUND((COALESCE(cm.force_users, 0) * 100.0 / COALESCE(cm.total_characters, 1)), 1)
    ELSE 0
  END AS force_user_percentage,
  
  -- Planet Metrics
  COALESCE(pm.total_planets, 0) AS planet_count,
  
  -- Vehicle Metrics
  COALESCE(vm.total_vehicles, 0) AS vehicle_count,
  
  -- Starship Metrics
  COALESCE(sm.total_starships, 0) AS starship_count,
  
  -- Species Metrics
  COALESCE(spm.total_species, 0) AS species_count,
  
  -- Total Entity Count
  (COALESCE(cm.total_characters, 0) + COALESCE(pm.total_planets, 0) + 
   COALESCE(vm.total_vehicles, 0) + COALESCE(sm.total_starships, 0) +
   COALESCE(spm.total_species, 0)) AS total_entity_count,
  
  -- Vehicle to Character Ratio
  CASE 
    WHEN COALESCE(cm.total_characters, 0) > 0
    THEN ROUND(((COALESCE(vm.total_vehicles, 0) + COALESCE(sm.total_starships, 0)) * 1.0 / 
           NULLIF(COALESCE(cm.total_characters, 0), 0)), 2)
    ELSE 0
  END AS vehicle_character_ratio,
  
  -- Time Dimension
  CURRENT_TIMESTAMP AS dbt_loaded_at

FROM film_base fb
LEFT JOIN character_metrics cm ON fb.film_id = cm.film_id
LEFT JOIN planet_metrics pm ON fb.film_id = pm.film_id
LEFT JOIN vehicle_metrics vm ON fb.film_id = vm.film_id
LEFT JOIN starship_metrics sm ON fb.film_id = sm.film_id
LEFT JOIN species_metrics spm ON fb.film_id = spm.film_id
ORDER BY fb.episode_id
  );
  
[0m09:38:04.775179 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_test_directories: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_directories"} */
alter table "nerd_facts"."public"."fct_test_directories__dbt_tmp" rename to "fct_test_directories"
[0m09:38:04.775559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:04.778354 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_vehicles"
[0m09:38:04.778726 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_sw_vehicles: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_sw_vehicles"} */

    create  index if not exists
  "faf98c68d19a91b1aa5a358997453910"
  on "nerd_facts"."public"."dim_sw_vehicles" 
  (vehicle_id)
  
[0m09:38:04.775884 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m09:38:04.779704 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m09:38:04.780313 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_all_dag_relationships: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_dag_relationships"} */

  create view "nerd_facts"."public"."int_all_dag_relationships__dbt_tmp"
    
    
  as (
    -- creates a cte called all_relationships that will either use "with recursive" or loops depending on the DW


with recursive direct_relationships as (
    select
        *
    from "nerd_facts"."public"."int_direct_relationships"
    where resource_type <> 'test'
),

-- should this be a fct_ model?

-- recursive CTE
-- one record for every resource and each of its downstream children (including itself)
all_relationships (
    parent_id,
    parent,
    parent_resource_type,
    parent_model_type,
    parent_materialized,
    parent_access,
    parent_is_public,
    parent_source_name,
    parent_file_path,
    parent_directory_path,
    parent_file_name,
    parent_is_excluded,
    child_id,
    child,
    child_resource_type,
    child_model_type,
    child_materialized,
    child_access,
    child_is_public,
    child_source_name,
    child_file_path,
    child_directory_path,
    child_file_name,
    child_is_excluded,
    distance,
    path,
    is_dependent_on_chain_of_views
) as (
    -- anchor
    select distinct
        resource_id as parent_id,
        resource_name as parent,
        resource_type as parent_resource_type,
        model_type as parent_model_type,
        materialized as parent_materialized,
        access as parent_access,
        is_public as parent_is_public,
        source_name as parent_source_name,
        file_path as parent_file_path,
        directory_path as parent_directory_path,
        file_name as parent_file_name,
        is_excluded as parent_is_excluded,
        resource_id as child_id,
        resource_name as child,
        resource_type as child_resource_type,
        model_type as child_model_type,
        materialized as child_materialized,
        access as child_access,
        is_public as child_is_public,
        source_name as child_source_name,
        file_path as child_file_path,
        directory_path as child_directory_path,
        file_name as child_file_name,
        is_excluded as child_is_excluded,
        0 as distance,
        
    array[ resource_name ]
     as path,
        cast(null as boolean) as is_dependent_on_chain_of_views

    from direct_relationships
    -- where direct_parent_id is null 

    union all

    -- recursive clause
    select
        all_relationships.parent_id as parent_id,
        all_relationships.parent as parent,
        all_relationships.parent_resource_type as parent_resource_type,
        all_relationships.parent_model_type as parent_model_type,
        all_relationships.parent_materialized as parent_materialized,
        all_relationships.parent_access as parent_access,
        all_relationships.parent_is_public as parent_is_public,
        all_relationships.parent_source_name as parent_source_name,
        all_relationships.parent_file_path as parent_file_path,
        all_relationships.parent_directory_path as parent_directory_path,
        all_relationships.parent_file_name as parent_file_name,
        all_relationships.parent_is_excluded as parent_is_excluded,
        direct_relationships.resource_id as child_id,
        direct_relationships.resource_name as child,
        direct_relationships.resource_type as child_resource_type,
        direct_relationships.model_type as child_model_type,
        direct_relationships.materialized as child_materialized,
        direct_relationships.access as child_access,
        direct_relationships.is_public as child_is_public,
        direct_relationships.source_name as child_source_name,
        direct_relationships.file_path as child_file_path,
        direct_relationships.directory_path as child_directory_path,
        direct_relationships.file_name as child_file_name,
        direct_relationships.is_excluded as child_is_excluded,
        all_relationships.distance+1 as distance,
        array_append(all_relationships.path, direct_relationships.resource_name) as path,
        case
            when
                all_relationships.child_materialized in ('view', 'ephemeral')
                and coalesce(all_relationships.is_dependent_on_chain_of_views, true)
                then true
            else false
        end as is_dependent_on_chain_of_views

    from direct_relationships
    inner join all_relationships
        on all_relationships.child_id = direct_relationships.direct_parent_id

    

)



select * from all_relationships
order by parent, distance
  );
[0m09:38:04.784366 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m09:38:04.786047 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_test_directories: COMMIT
[0m09:38:04.786491 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m09:38:04.786796 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_test_directories: COMMIT
[0m09:38:04.787175 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:38:04.790603 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m09:38:04.791279 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.012 seconds
[0m09:38:04.791662 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_all_dag_relationships: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_dag_relationships"} */
alter table "nerd_facts"."public"."int_all_dag_relationships__dbt_tmp" rename to "int_all_dag_relationships"
[0m09:38:04.793107 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_vehicles"
[0m09:38:04.793928 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_sw_vehicles: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_sw_vehicles"} */

    create  index if not exists
  "bcc83234fb3e91c63813f5c56c8c692c"
  on "nerd_facts"."public"."dim_sw_vehicles" 
  (vehicle_name)
  
[0m09:38:04.793451 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m09:38:04.798751 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."fct_test_directories__dbt_backup"
[0m09:38:04.794465 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:04.799213 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.022 seconds
[0m09:38:04.804379 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_all_dag_relationships: COMMIT
[0m09:38:04.800861 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.007 seconds
[0m09:38:04.800394 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m09:38:04.808338 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_sw_films"
[0m09:38:04.808895 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m09:38:04.810653 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_sw_vehicles: COMMIT
[0m09:38:04.811108 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_test_directories: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_directories"} */
drop view if exists "nerd_facts"."public"."fct_test_directories__dbt_backup" cascade
[0m09:38:04.811516 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_sw_films: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_sw_films"} */
alter table "nerd_facts"."public"."fact_sw_films" rename to "fact_sw_films__dbt_backup"
[0m09:38:04.811963 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_all_dag_relationships: COMMIT
[0m09:38:04.812355 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_vehicles"
[0m09:38:04.813015 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_sw_vehicles: COMMIT
[0m09:38:04.813611 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:04.813992 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:38:04.817902 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_sw_films"
[0m09:38:04.818365 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m09:38:04.820588 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_sw_films: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_sw_films"} */
alter table "nerd_facts"."public"."fact_sw_films__dbt_tmp" rename to "fact_sw_films"
[0m09:38:04.820158 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_test_directories: Close
[0m09:38:04.823522 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."dim_sw_vehicles__dbt_backup"
[0m09:38:04.825083 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_sw_vehicles"
[0m09:38:04.825601 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_sw_vehicles: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_sw_vehicles"} */
drop table if exists "nerd_facts"."public"."dim_sw_vehicles__dbt_backup" cascade
[0m09:38:04.818693 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m09:38:04.830180 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."int_all_dag_relationships__dbt_backup"
[0m09:38:04.830711 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m09:38:04.831938 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m09:38:04.831552 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m09:38:04.835958 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_all_dag_relationships: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_dag_relationships"} */
drop view if exists "nerd_facts"."public"."int_all_dag_relationships__dbt_backup" cascade
[0m09:38:04.834179 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_sw_films"
[0m09:38:04.835479 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_sw_vehicles: Close
[0m09:38:04.832631 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b836eda0>]}
[0m09:38:04.838045 [info ] [Thread-2 (]: 84 of 103 OK created sql view model public.fct_test_directories ................ [[32mCREATE VIEW[0m in 0.14s]
[0m09:38:04.838892 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.fct_test_directories
[0m09:38:04.839472 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.int_model_test_summary
[0m09:38:04.836716 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_sw_films: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_sw_films"} */

    create  index if not exists
  "e2bb4bddb5cc5354e5a7580b61b507ad"
  on "nerd_facts"."public"."fact_sw_films" 
  (film_key)
  
[0m09:38:04.837144 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:38:04.843463 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_all_dag_relationships: Close
[0m09:38:04.841780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82bd3676d0>]}
[0m09:38:04.840172 [info ] [Thread-2 (]: 86 of 103 START sql view model public.int_model_test_summary ................... [RUN]
[0m09:38:04.847100 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b83a8e20>]}
[0m09:38:04.847742 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.007 seconds
[0m09:38:04.848405 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_test_directories, now model.dbt_project_evaluator.int_model_test_summary)
[0m09:38:04.850198 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_sw_films: COMMIT
[0m09:38:04.850698 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.int_model_test_summary
[0m09:38:04.851107 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_sw_films"
[0m09:38:04.860015 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.int_model_test_summary"
[0m09:38:04.860552 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_sw_films: COMMIT
[0m09:38:04.861264 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.int_model_test_summary
[0m09:38:04.867710 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project_evaluator.int_model_test_summary"
[0m09:38:04.868219 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m09:38:04.868977 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m09:38:04.871528 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."fact_sw_films__dbt_backup"
[0m09:38:04.871999 [debug] [Thread-2 (]: On model.dbt_project_evaluator.int_model_test_summary: BEGIN
[0m09:38:04.872722 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_sw_films"
[0m09:38:04.873112 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:38:04.873429 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_sw_films: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_sw_films"} */
drop table if exists "nerd_facts"."public"."fact_sw_films__dbt_backup" cascade
[0m09:38:04.877203 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m09:38:04.878689 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_sw_films: Close
[0m09:38:04.880174 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b8261e70>]}
[0m09:38:04.887323 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m09:38:04.887849 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m09:38:04.888319 [debug] [Thread-2 (]: On model.dbt_project_evaluator.int_model_test_summary: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_model_test_summary"} */

  create view "nerd_facts"."public"."int_model_test_summary__dbt_tmp"
    
    
  as (
    with 

all_graph_resources as (
    select * from "nerd_facts"."public"."int_all_graph_resources"
    where not is_excluded
),

relationships as (
    select * from "nerd_facts"."public"."int_direct_relationships"
),

count_column_tests as (
    
    select 
        relationships.direct_parent_id, 
        all_graph_resources.column_name,
        sum(case
                when all_graph_resources.is_test_unique
                then 1
                else 0
            end
         ) as test_unique_count,count(distinct case when 
                all_graph_resources.is_test_unique or  
                all_graph_resources.is_test_not_null
            then relationships.resource_id else null end
        ) as primary_key_method_1_count,count(distinct case when 
                all_graph_resources.is_test_unique_combination_of_columns
            then relationships.resource_id else null end
        ) as primary_key_method_2_count,
        count(distinct relationships.resource_id) as tests_count
    from all_graph_resources
    left join relationships
        on all_graph_resources.resource_id = relationships.resource_id
    where all_graph_resources.resource_type = 'test'
    and relationships.is_primary_test_relationship
    group by 1,2
),

count_column_constraints as (

    select
        node_unique_id as direct_parent_id,
        name as column_name,
        case
            when has_not_null_constraint
            then 1
            else 0
        end as constraint_not_null_count,
        constraints_count
    from "nerd_facts"."public"."base_node_columns"

),

combine_column_counts as (

    select
        count_column_tests.*,
        count_column_tests.test_unique_count + count_column_constraints.constraint_not_null_count as primary_key_mixed_method_count,
        count_column_constraints.constraints_count
    from count_column_tests
    left join count_column_constraints
        on count_column_tests.direct_parent_id = count_column_constraints.direct_parent_id
        and count_column_tests.column_name = count_column_constraints.column_name

),

agg_test_relationships as (

    select 
        direct_parent_id, 
        cast(sum(case 
                when (
                    primary_key_method_1_count >= 2
                        or
                    primary_key_method_2_count >= 1
                        or
                    primary_key_mixed_method_count >= 2
                ) then 1 
                else 0 
            end
        ) >= 1 as boolean) as is_primary_key_tested,
        cast(sum(tests_count) as integer) as number_of_tests_on_model,
        cast(sum(constraints_count) as integer) as number_of_constraints_on_model
    from combine_column_counts
    group by 1

),

final as (
    select 
        all_graph_resources.resource_name,
        all_graph_resources.resource_type,
        all_graph_resources.model_type,
        cast(coalesce(agg_test_relationships.is_primary_key_tested, FALSE) as boolean) as is_primary_key_tested,
        cast(coalesce(agg_test_relationships.number_of_tests_on_model, 0) as integer) as number_of_tests_on_model,
        cast(coalesce(agg_test_relationships.number_of_constraints_on_model, 0) as integer) as number_of_constraints_on_model
    from all_graph_resources
    left join agg_test_relationships
        on all_graph_resources.resource_id = agg_test_relationships.direct_parent_id
    where
        all_graph_resources.resource_type in ('model', 'seed', 'source', 'snapshot')
)

select * from final
  );
[0m09:38:04.893275 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:38:04.896415 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m09:38:04.896849 [debug] [Thread-2 (]: On model.dbt_project_evaluator.int_model_test_summary: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_model_test_summary"} */
alter table "nerd_facts"."public"."int_model_test_summary__dbt_tmp" rename to "int_model_test_summary"
[0m09:38:04.898049 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:04.899272 [debug] [Thread-2 (]: On model.dbt_project_evaluator.int_model_test_summary: COMMIT
[0m09:38:04.899644 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m09:38:04.899977 [debug] [Thread-2 (]: On model.dbt_project_evaluator.int_model_test_summary: COMMIT
[0m09:38:04.902729 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:38:04.905592 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."int_model_test_summary__dbt_backup"
[0m09:38:04.906421 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m09:38:04.906850 [debug] [Thread-2 (]: On model.dbt_project_evaluator.int_model_test_summary: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_model_test_summary"} */
drop view if exists "nerd_facts"."public"."int_model_test_summary__dbt_backup" cascade
[0m09:38:04.907540 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:38:04.908910 [debug] [Thread-2 (]: On model.dbt_project_evaluator.int_model_test_summary: Close
[0m09:38:04.909656 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82bb957f40>]}
[0m09:38:05.544282 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m09:38:05.545277 [info ] [Thread-1 (]: 82 of 103 OK created sql table model public.dim_sw_vehicles .................... [[32mSELECT 39[0m in 0.18s]
[0m09:38:05.546594 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.dim_sw_vehicles
[0m09:38:05.545813 [info ] [Thread-3 (]: 85 of 103 OK created sql view model public.int_all_dag_relationships ........... [[32mCREATE VIEW[0m in 0.14s]
[0m09:38:05.547200 [info ] [Thread-4 (]: 83 of 103 OK created sql table model public.fact_sw_films ...................... [[32mSELECT 6[0m in 0.20s]
[0m09:38:05.548489 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.int_all_dag_relationships
[0m09:38:05.547778 [info ] [Thread-2 (]: 86 of 103 OK created sql view model public.int_model_test_summary .............. [[32mCREATE VIEW[0m in 0.06s]
[0m09:38:05.549059 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.fact_sw_films
[0m09:38:05.549760 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.int_model_test_summary
[0m09:38:05.550405 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.fct_chained_views_dependencies
[0m09:38:05.550842 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.fct_direct_join_to_source
[0m09:38:05.551199 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.fct_exposure_parents_materializations
[0m09:38:05.551672 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.fct_exposures_dependent_on_private_models
[0m09:38:05.552438 [info ] [Thread-1 (]: 87 of 103 START sql view model public.fct_chained_views_dependencies ........... [RUN]
[0m09:38:05.553033 [info ] [Thread-4 (]: 88 of 103 START sql table model public.fct_direct_join_to_source ............... [RUN]
[0m09:38:05.553534 [info ] [Thread-3 (]: 89 of 103 START sql view model public.fct_exposure_parents_materializations .... [RUN]
[0m09:38:05.554030 [info ] [Thread-2 (]: 90 of 103 START sql view model public.fct_exposures_dependent_on_private_models  [RUN]
[0m09:38:05.554559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_sw_vehicles, now model.dbt_project_evaluator.fct_chained_views_dependencies)
[0m09:38:05.555015 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_sw_films, now model.dbt_project_evaluator.fct_direct_join_to_source)
[0m09:38:05.555426 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.int_all_dag_relationships, now model.dbt_project_evaluator.fct_exposure_parents_materializations)
[0m09:38:05.555884 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.int_model_test_summary, now model.dbt_project_evaluator.fct_exposures_dependent_on_private_models)
[0m09:38:05.556262 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.fct_chained_views_dependencies
[0m09:38:05.556781 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.fct_direct_join_to_source
[0m09:38:05.557110 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.fct_exposure_parents_materializations
[0m09:38:05.557439 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.fct_exposures_dependent_on_private_models
[0m09:38:05.562418 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m09:38:05.567162 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m09:38:05.571669 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m09:38:05.575131 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m09:38:05.575914 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.fct_chained_views_dependencies
[0m09:38:05.576588 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.fct_exposure_parents_materializations
[0m09:38:05.577144 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.fct_direct_join_to_source
[0m09:38:05.582459 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m09:38:05.588652 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m09:38:05.595172 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m09:38:05.595679 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.fct_exposures_dependent_on_private_models
[0m09:38:05.596514 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m09:38:05.597216 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m09:38:05.597626 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m09:38:05.604342 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m09:38:05.604857 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: BEGIN
[0m09:38:05.605298 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_direct_join_to_source: BEGIN
[0m09:38:05.605704 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_chained_views_dependencies: BEGIN
[0m09:38:05.606446 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m09:38:05.606818 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:38:05.607188 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:38:05.607551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:38:05.607975 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: BEGIN
[0m09:38:05.611516 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:38:05.637868 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m09:38:05.638638 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m09:38:05.639311 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposure_parents_materializations"} */

  create view "nerd_facts"."public"."fct_exposure_parents_materializations__dbt_tmp"
    
    
  as (
    with 

direct_exposure_relationships as (
    select * from "nerd_facts"."public"."int_all_dag_relationships"
    where 
        distance = 1
        and child_resource_type = 'exposure'
        and ((
                parent_resource_type = 'model'
                and parent_materialized in ('view', 'ephemeral')
            )
            or (
                parent_resource_type = 'source'
            )
        )
        -- no test on child_is_excluded because exposures are never excluded
        and not parent_is_excluded
),

final as (

    select 
        parent_resource_type,
        parent as parent_resource_name,
        child as exposure_name,
        parent_materialized as parent_model_materialization

    from direct_exposure_relationships

)

select * from final



    

    
    

    

    


  );
[0m09:38:05.639833 [debug] [Thread-4 (]: SQL status: BEGIN in 0.033 seconds
[0m09:38:05.643345 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m09:38:05.642880 [debug] [Thread-2 (]: SQL status: BEGIN in 0.029 seconds
[0m09:38:05.640284 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m09:38:05.643800 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:38:05.644187 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_direct_join_to_source: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_direct_join_to_source"} */

  
    

  create  table "nerd_facts"."public"."fct_direct_join_to_source__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a model has a reference to both a model and a source

with direct_model_relationships as (
    select  
        *
    from "nerd_facts"."public"."int_all_dag_relationships"
    where child_resource_type = 'model'
    and distance = 1
    and not parent_is_excluded
    and not child_is_excluded
),

model_and_source_joined as (
    select
        child,
        case 
            when (
                sum(case when parent_resource_type = 'model' then 1 else 0 end) > 0 
                and sum(case when parent_resource_type = 'source' then 1 else 0 end) > 0
            ) 
            then true
            else false 
        end as keep_row 
    from direct_model_relationships
    group by 1
),

final as (
    select 
        direct_model_relationships.parent,
        direct_model_relationships.parent_resource_type,
        direct_model_relationships.child,
        direct_model_relationships.child_resource_type,
        direct_model_relationships.distance
    from direct_model_relationships
    inner join model_and_source_joined
        on direct_model_relationships.child = model_and_source_joined.child
    where model_and_source_joined.keep_row
    order by direct_model_relationships.child
)

select * from final



    

    
    

    

    


  );
  
[0m09:38:05.644632 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m09:38:05.649298 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"} */

  create view "nerd_facts"."public"."fct_exposures_dependent_on_private_models__dbt_tmp"
    
    
  as (
    with 

direct_exposure_relationships as (
    select * from "nerd_facts"."public"."int_all_dag_relationships"
    where 
        distance = 1
        and child_resource_type = 'exposure'
        and not (
                parent_resource_type = 'model'
                and parent_is_public
            )
        and not parent_is_excluded
),

final as (

    select 
        child as exposure_name,
        parent as parent_resource_name,
        parent_access,
        parent_resource_type

    from direct_exposure_relationships

)

select * from final



    

    
    

    

    


  );
[0m09:38:05.652941 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:38:05.645008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m09:38:05.648660 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m09:38:05.657739 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m09:38:05.658330 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_chained_views_dependencies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_chained_views_dependencies"} */

  create view "nerd_facts"."public"."fct_chained_views_dependencies__dbt_tmp"
    
    
  as (
    with all_relationships as (
    select  
        *
    from "nerd_facts"."public"."int_all_dag_relationships"
    where distance <> 0
    and not parent_is_excluded
    and not child_is_excluded
),

final as (
    select
        parent,
        child, -- the model with potentially long run time / compilation time, improve performance by breaking the upstream chain of views
        distance,
        path
    from all_relationships
    where is_dependent_on_chain_of_views
    and child_resource_type = 'model'
    and distance > 5
)

select * from final



    

    
    

    

    



order by distance desc
  );
[0m09:38:05.658835 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposure_parents_materializations"} */
alter table "nerd_facts"."public"."fct_exposure_parents_materializations__dbt_tmp" rename to "fct_exposure_parents_materializations"
[0m09:38:05.659268 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"} */
alter table "nerd_facts"."public"."fct_exposures_dependent_on_private_models__dbt_tmp" rename to "fct_exposures_dependent_on_private_models"
[0m09:38:05.660462 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:05.662223 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: COMMIT
[0m09:38:05.662723 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:38:05.665252 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: COMMIT
[0m09:38:05.663328 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m09:38:05.666282 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:38:05.665826 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m09:38:05.666750 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: COMMIT
[0m09:38:05.671486 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m09:38:05.671929 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.023 seconds
[0m09:38:05.672398 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: COMMIT
[0m09:38:05.673089 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_chained_views_dependencies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_chained_views_dependencies"} */
alter table "nerd_facts"."public"."fct_chained_views_dependencies__dbt_tmp" rename to "fct_chained_views_dependencies"
[0m09:38:05.678693 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m09:38:05.680911 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_direct_join_to_source: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_direct_join_to_source"} */
alter table "nerd_facts"."public"."fct_direct_join_to_source" rename to "fct_direct_join_to_source__dbt_backup"
[0m09:38:05.680518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:05.679291 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m09:38:05.682732 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_chained_views_dependencies: COMMIT
[0m09:38:05.686849 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m09:38:05.686036 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."fct_exposure_parents_materializations__dbt_backup"
[0m09:38:05.686401 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:38:05.683214 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m09:38:05.690692 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m09:38:05.693666 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_direct_join_to_source: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_direct_join_to_source"} */
alter table "nerd_facts"."public"."fct_direct_join_to_source__dbt_tmp" rename to "fct_direct_join_to_source"
[0m09:38:05.693231 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."fct_exposures_dependent_on_private_models__dbt_backup"
[0m09:38:05.687978 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m09:38:05.695092 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposure_parents_materializations"} */
drop view if exists "nerd_facts"."public"."fct_exposure_parents_materializations__dbt_backup" cascade
[0m09:38:05.694672 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m09:38:05.687217 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_chained_views_dependencies: COMMIT
[0m09:38:05.695571 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:38:05.695997 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:38:05.696328 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"} */
drop view if exists "nerd_facts"."public"."fct_exposures_dependent_on_private_models__dbt_backup" cascade
[0m09:38:05.698123 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_direct_join_to_source: COMMIT
[0m09:38:05.699606 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: Close
[0m09:38:05.700044 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:38:05.703558 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."fct_chained_views_dependencies__dbt_backup"
[0m09:38:05.704704 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m09:38:05.705182 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_chained_views_dependencies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_chained_views_dependencies"} */
drop view if exists "nerd_facts"."public"."fct_chained_views_dependencies__dbt_backup" cascade
[0m09:38:05.705934 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:38:05.700925 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:38:05.700546 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m09:38:05.707501 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_chained_views_dependencies: Close
[0m09:38:05.710723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b8237490>]}
[0m09:38:05.711663 [info ] [Thread-1 (]: 87 of 103 OK created sql view model public.fct_chained_views_dependencies ...... [[32mCREATE VIEW[0m in 0.16s]
[0m09:38:05.712486 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.fct_chained_views_dependencies
[0m09:38:05.708895 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: Close
[0m09:38:05.713074 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source
[0m09:38:05.709484 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b83638b0>]}
[0m09:38:05.709905 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_direct_join_to_source: COMMIT
[0m09:38:05.717478 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82bb957f40>]}
[0m09:38:05.716081 [info ] [Thread-1 (]: 91 of 103 START sql table model public.fct_marts_or_intermediate_dependent_on_source  [RUN]
[0m09:38:05.716895 [info ] [Thread-3 (]: 89 of 103 OK created sql view model public.fct_exposure_parents_materializations  [[32mCREATE VIEW[0m in 0.15s]
[0m09:38:05.718604 [info ] [Thread-2 (]: 90 of 103 OK created sql view model public.fct_exposures_dependent_on_private_models  [[32mCREATE VIEW[0m in 0.16s]
[0m09:38:05.720948 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.fct_exposures_dependent_on_private_models
[0m09:38:05.720395 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.fct_exposure_parents_materializations
[0m09:38:05.719555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_chained_views_dependencies, now model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source)
[0m09:38:05.721531 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m09:38:05.721930 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.fct_model_directories
[0m09:38:05.728112 [info ] [Thread-2 (]: 92 of 103 START sql view model public.fct_model_directories .................... [RUN]
[0m09:38:05.722902 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source
[0m09:38:05.727360 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."fct_direct_join_to_source__dbt_backup"
[0m09:38:05.728774 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_exposures_dependent_on_private_models, now model.dbt_project_evaluator.fct_model_directories)
[0m09:38:05.722443 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.fct_model_fanout
[0m09:38:05.732824 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m09:38:05.735846 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source
[0m09:38:05.734412 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.fct_model_directories
[0m09:38:05.735000 [info ] [Thread-3 (]: 93 of 103 START sql table model public.fct_model_fanout ........................ [RUN]
[0m09:38:05.750266 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_exposure_parents_materializations, now model.dbt_project_evaluator.fct_model_fanout)
[0m09:38:05.750739 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.fct_model_fanout
[0m09:38:05.749621 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_model_directories"
[0m09:38:05.733981 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m09:38:05.757559 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_direct_join_to_source: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_direct_join_to_source"} */
drop table if exists "nerd_facts"."public"."fct_direct_join_to_source__dbt_backup" cascade
[0m09:38:05.756700 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_model_fanout"
[0m09:38:05.758440 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.fct_model_fanout
[0m09:38:05.743035 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m09:38:05.764569 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m09:38:05.766363 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_model_fanout"
[0m09:38:05.769703 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m09:38:05.768392 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_direct_join_to_source: Close
[0m09:38:05.768981 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m09:38:05.771541 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: BEGIN
[0m09:38:05.772054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:38:05.770994 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b8261e70>]}
[0m09:38:05.766857 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.fct_model_directories
[0m09:38:05.770082 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_fanout: BEGIN
[0m09:38:05.774896 [info ] [Thread-4 (]: 88 of 103 OK created sql table model public.fct_direct_join_to_source .......... [[32mSELECT 0[0m in 0.22s]
[0m09:38:05.787190 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.fct_direct_join_to_source
[0m09:38:05.781247 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:38:05.787870 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.fct_multiple_sources_joined
[0m09:38:05.789212 [info ] [Thread-4 (]: 94 of 103 START sql table model public.fct_multiple_sources_joined ............. [RUN]
[0m09:38:05.790345 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_direct_join_to_source, now model.dbt_project_evaluator.fct_multiple_sources_joined)
[0m09:38:05.790742 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.fct_multiple_sources_joined
[0m09:38:05.786521 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_model_directories"
[0m09:38:05.801252 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m09:38:05.802568 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_model_directories: BEGIN
[0m09:38:05.802235 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m09:38:05.806227 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m09:38:05.806625 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_fanout: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_fanout"} */

  
    

  create  table "nerd_facts"."public"."fct_model_fanout__dbt_tmp"
  
  
    as
  
  (
    with all_dag_relationships as (
    select  
        *
    from "nerd_facts"."public"."int_all_dag_relationships"
    where not parent_is_excluded
    and not child_is_excluded
),

-- find all models without children
models_without_children as (
    select
        parent
    from all_dag_relationships
    where parent_resource_type = 'model'
    group by 1
    having max(distance) = 0
),

-- all parents with more direct children than the threshold for fanout (determined by variable models_fanout_threshold, default 3)
    -- Note: only counts "leaf children" - direct chilren that are models AND are child-less (are at the right-most-point in the DAG)
model_fanout as (
    select 
        all_dag_relationships.parent,
        all_dag_relationships.parent_model_type,
        all_dag_relationships.child
    from all_dag_relationships
    inner join models_without_children
        on all_dag_relationships.child = models_without_children.parent
    where all_dag_relationships.distance = 1 and all_dag_relationships.child_resource_type = 'model'
    group by 1, 2, 3
    -- we order the CTE so that listagg returns values correctly sorted for some warehouses
    order by 1, 2, 3
),

model_fanout_agg as (
    select
        parent,
        parent_model_type,
        
    string_agg(
        child,
        ', '
        
        ) as leaf_children
    from model_fanout
    group by 1, 2
    having count(*) >= 3
)

select * from model_fanout_agg



    

    
    

    

    


  );
  
[0m09:38:05.801856 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m09:38:05.807182 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m09:38:05.807723 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"} */

  
    

  create  table "nerd_facts"."public"."fct_marts_or_intermediate_dependent_on_source__dbt_tmp"
  
  
    as
  
  (
    -- cases where a marts/intermediate model directly references a raw source
with direct_relationships as (
    select  
        *
    from "nerd_facts"."public"."int_all_dag_relationships"
    where distance = 1
    and not parent_is_excluded
    and not child_is_excluded
),
final as (
    select
        parent,
        parent_resource_type,
        child,
        child_model_type
    from direct_relationships
    where parent_resource_type = 'source'
    and child_model_type in ('marts', 'intermediate')
)
select * from final



    

    
    

    

    


  );
  
[0m09:38:05.805828 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:38:05.805381 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m09:38:05.809271 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.fct_multiple_sources_joined
[0m09:38:05.824320 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m09:38:05.825198 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m09:38:05.825656 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_multiple_sources_joined: BEGIN
[0m09:38:05.826017 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:38:05.833052 [debug] [Thread-2 (]: SQL status: BEGIN in 0.027 seconds
[0m09:38:05.833732 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m09:38:05.834359 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_model_directories: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_directories"} */

  create view "nerd_facts"."public"."fct_model_directories__dbt_tmp"
    
    
  as (
    -- This model finds all cases where a model is NOT in the appropriate subdirectory:
    -- For staging models: The files should be in nested in the staging folder in a subfolder that matches their source parent's name.
    -- For non-staging models: The files should be nested closest to their appropriate folder.  

 
with all_graph_resources as (
    select * from "nerd_facts"."public"."int_all_graph_resources"
    where not is_excluded
),

folders as (
    select * from "nerd_facts"."public"."stg_naming_convention_folders"
), 

all_dag_relationships as (
    select * from "nerd_facts"."public"."int_all_dag_relationships"
    where not child_is_excluded
),

staging_models as (
    select  
        child,
        child_resource_type,
        child_model_type,
        child_file_path,
        child_directory_path,
        child_file_name,
        parent_source_name
    from all_dag_relationships
    where parent_resource_type = 'source'
    and child_resource_type = 'model'
    and child_model_type = 'staging'
),

-- find all staging models that are NOT in their source parent's subdirectory
inappropriate_subdirectories_staging as (
    select distinct -- must do distinct to avoid duplicates when staging model has multiple paths to a given source
        child as resource_name,
        child_resource_type as resource_type,
        child_model_type as model_type,
        child_file_path as current_file_path,
        'models/' || 'staging' || '/' || parent_source_name || '/' || child_file_name as change_file_path_to
    from staging_models
    where child_directory_path not like '%' || parent_source_name || '%'
),

-- find all non-staging models that are NOT nested closest to their appropriate folder
innappropriate_subdirectories_non_staging_models as (
    select 
        all_graph_resources.resource_name,
        all_graph_resources.resource_type,
        all_graph_resources.model_type,
        all_graph_resources.file_path as current_file_path,
        'models' || '/.../' || folders.folder_name_value || '/.../' || all_graph_resources.file_name as change_file_path_to
    from all_graph_resources
    left join folders 
        on folders.model_type = all_graph_resources.model_type 
    -- either appropriate folder_name is not in the current_directory_path or a inappropriate folder name is closer to the file_name
    where all_graph_resources.model_type <> all_graph_resources.model_type_folder 
),

unioned as (
    select * from inappropriate_subdirectories_staging
    union all
    select * from innappropriate_subdirectories_non_staging_models
)

select * from unioned



    

    
    

    

    


  );
[0m09:38:05.840588 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.032 seconds
[0m09:38:05.846881 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.040 seconds
[0m09:38:05.852416 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m09:38:05.913791 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.079 seconds
[0m09:38:05.852912 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_fanout: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_fanout"} */
alter table "nerd_facts"."public"."fct_model_fanout" rename to "fct_model_fanout__dbt_backup"
[0m09:38:05.915305 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m09:38:05.918207 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m09:38:05.918572 [debug] [Thread-4 (]: SQL status: BEGIN in 0.093 seconds
[0m09:38:05.919205 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"} */
alter table "nerd_facts"."public"."fct_marts_or_intermediate_dependent_on_source" rename to "fct_marts_or_intermediate_dependent_on_source__dbt_backup"
[0m09:38:05.919709 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:05.920069 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_model_directories: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_directories"} */
alter table "nerd_facts"."public"."fct_model_directories__dbt_tmp" rename to "fct_model_directories"
[0m09:38:05.920474 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m09:38:05.924293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:38:05.923906 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m09:38:05.925015 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_multiple_sources_joined: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_multiple_sources_joined"} */

  
    

  create  table "nerd_facts"."public"."fct_multiple_sources_joined__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a model references more than one source
with direct_source_relationships as (
    select distinct
        child,
        parent
    from "nerd_facts"."public"."int_all_dag_relationships"
    where distance = 1
    and parent_resource_type = 'source'
    and not parent_is_excluded
    and not child_is_excluded
    -- we order the CTE so that listagg returns values correctly sorted for some warehouses
    order by 1, 2
),

multiple_sources_joined as (
    select
        child,
        
    string_agg(
        parent,
        ', '
        
        ) as source_parents
    from direct_source_relationships
    group by 1
    having count(*) > 1
)

select * from multiple_sources_joined



    

    
    

    

    


  );
  
[0m09:38:05.929006 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m09:38:05.930448 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"} */
alter table "nerd_facts"."public"."fct_marts_or_intermediate_dependent_on_source__dbt_tmp" rename to "fct_marts_or_intermediate_dependent_on_source"
[0m09:38:05.929874 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_fanout: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_fanout"} */
alter table "nerd_facts"."public"."fct_model_fanout__dbt_tmp" rename to "fct_model_fanout"
[0m09:38:05.931340 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:38:05.933996 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: COMMIT
[0m09:38:05.935151 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m09:38:05.934659 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:38:05.929417 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:38:05.939981 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_model_directories: COMMIT
[0m09:38:05.938258 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_fanout: COMMIT
[0m09:38:05.940453 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m09:38:05.935709 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: COMMIT
[0m09:38:05.940889 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m09:38:05.941275 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_model_directories: COMMIT
[0m09:38:05.941828 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_fanout: COMMIT
[0m09:38:05.944022 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:38:05.948322 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."fct_marts_or_intermediate_dependent_on_source__dbt_backup"
[0m09:38:05.948739 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.018 seconds
[0m09:38:05.949629 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m09:38:05.950228 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m09:38:05.955536 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m09:38:05.955975 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m09:38:05.956442 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"} */
drop table if exists "nerd_facts"."public"."fct_marts_or_intermediate_dependent_on_source__dbt_backup" cascade
[0m09:38:05.959324 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."fct_model_fanout__dbt_backup"
[0m09:38:05.959797 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_multiple_sources_joined: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_multiple_sources_joined"} */
alter table "nerd_facts"."public"."fct_multiple_sources_joined" rename to "fct_multiple_sources_joined__dbt_backup"
[0m09:38:05.962469 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."fct_model_directories__dbt_backup"
[0m09:38:05.965389 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m09:38:05.964624 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:38:05.963678 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m09:38:05.965815 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_model_directories: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_directories"} */
drop view if exists "nerd_facts"."public"."fct_model_directories__dbt_backup" cascade
[0m09:38:05.969459 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m09:38:05.969855 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m09:38:05.972743 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: Close
[0m09:38:05.970286 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_fanout: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_fanout"} */
drop table if exists "nerd_facts"."public"."fct_model_fanout__dbt_backup" cascade
[0m09:38:05.971428 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:38:05.971007 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_multiple_sources_joined: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_multiple_sources_joined"} */
alter table "nerd_facts"."public"."fct_multiple_sources_joined__dbt_tmp" rename to "fct_multiple_sources_joined"
[0m09:38:05.977064 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_model_directories: Close
[0m09:38:05.977957 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:38:05.984044 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_multiple_sources_joined: COMMIT
[0m09:38:05.981683 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b84aa200>]}
[0m09:38:05.985418 [info ] [Thread-2 (]: 92 of 103 OK created sql view model public.fct_model_directories ............... [[32mCREATE VIEW[0m in 0.25s]
[0m09:38:05.986206 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.fct_model_directories
[0m09:38:05.986755 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts
[0m09:38:05.982121 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m09:38:05.989260 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_fanout: Close
[0m09:38:05.979966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b8237490>]}
[0m09:38:05.987477 [info ] [Thread-2 (]: 95 of 103 START sql table model public.fct_rejoining_of_upstream_concepts ...... [RUN]
[0m09:38:05.984494 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m09:38:05.994639 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_multiple_sources_joined: COMMIT
[0m09:38:05.993846 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_model_directories, now model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts)
[0m09:38:05.995292 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts
[0m09:38:05.993043 [info ] [Thread-1 (]: 91 of 103 OK created sql table model public.fct_marts_or_intermediate_dependent_on_source  [[32mSELECT 0[0m in 0.26s]
[0m09:38:05.990196 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b9a6f940>]}
[0m09:38:06.002278 [info ] [Thread-3 (]: 93 of 103 OK created sql table model public.fct_model_fanout ................... [[32mSELECT 11[0m in 0.24s]
[0m09:38:06.000922 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m09:38:06.005508 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."fct_multiple_sources_joined__dbt_backup"
[0m09:38:06.002915 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.fct_model_fanout
[0m09:38:06.000451 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m09:38:06.001574 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source
[0m09:38:06.006272 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m09:38:06.006756 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.fct_root_models
[0m09:38:06.007562 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts
[0m09:38:06.008050 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.fct_source_fanout
[0m09:38:06.008681 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_multiple_sources_joined: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_multiple_sources_joined"} */
drop table if exists "nerd_facts"."public"."fct_multiple_sources_joined__dbt_backup" cascade
[0m09:38:06.017831 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m09:38:06.009242 [info ] [Thread-3 (]: 96 of 103 START sql table model public.fct_root_models ......................... [RUN]
[0m09:38:06.018545 [info ] [Thread-1 (]: 97 of 103 START sql table model public.fct_source_fanout ....................... [RUN]
[0m09:38:06.020896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source, now model.dbt_project_evaluator.fct_source_fanout)
[0m09:38:06.020408 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_model_fanout, now model.dbt_project_evaluator.fct_root_models)
[0m09:38:06.021296 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.fct_source_fanout
[0m09:38:06.019754 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m09:38:06.021686 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.fct_root_models
[0m09:38:06.028388 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_source_fanout"
[0m09:38:06.028881 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m09:38:06.029409 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: BEGIN
[0m09:38:06.036050 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:38:06.035412 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_multiple_sources_joined: Close
[0m09:38:06.033818 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_root_models"
[0m09:38:06.037120 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.fct_root_models
[0m09:38:06.045355 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ba554c40>]}
[0m09:38:06.046181 [info ] [Thread-4 (]: 94 of 103 OK created sql table model public.fct_multiple_sources_joined ........ [[32mSELECT 0[0m in 0.25s]
[0m09:38:06.047107 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.fct_multiple_sources_joined
[0m09:38:06.047534 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate
[0m09:38:06.055836 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_root_models"
[0m09:38:06.051217 [info ] [Thread-4 (]: 98 of 103 START sql table model public.fct_staging_dependent_on_marts_or_intermediate  [RUN]
[0m09:38:06.056611 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.fct_source_fanout
[0m09:38:06.057634 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_multiple_sources_joined, now model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate)
[0m09:38:06.064882 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate
[0m09:38:06.064358 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_source_fanout"
[0m09:38:06.070287 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m09:38:06.070945 [debug] [Thread-2 (]: SQL status: BEGIN in 0.035 seconds
[0m09:38:06.072954 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m09:38:06.072311 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m09:38:06.073895 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_source_fanout: BEGIN
[0m09:38:06.071640 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m09:38:06.074270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:38:06.073408 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"} */

  
    

  create  table "nerd_facts"."public"."fct_rejoining_of_upstream_concepts__dbt_tmp"
  
  
    as
  
  (
    with all_relationships as (
    select  
        *
    from "nerd_facts"."public"."int_all_dag_relationships"
    where parent_resource_type not in ('exposure', 'metric')
    and child_resource_type not in ('exposure', 'metric')
    and not parent_is_excluded
    and not child_is_excluded
),

-- all parent/child relationships where the parent is BOTH the direct parent of the child and the second level parent of the child 
rejoined as (
    select
        parent,
        child
    from all_relationships
    group by 1, 2
    having (sum(case when distance = 1 then 1 else 0 end) >= 1 
        and sum(case when distance = 2 then 1 else 0 end) >= 1)
),

-- resources with only one direct child
single_use_resources as (
    select
        parent
    from all_relationships
    where distance = 1
    group by 1
    having count(*) = 1
),

-- all cases where one of the parent's direct children (child) is ALSO the direct child of ANOTHER one of the parent's direct childen (parent_and_child)
triad_relationships as (
    select 
        rejoined.parent,
        rejoined.child,
        direct_child.parent as parent_and_child
    from rejoined
    left join all_relationships as direct_child
        on rejoined.child = direct_child.child
        and direct_child.distance = 1
    left join all_relationships as direct_parent
        on rejoined.parent = direct_parent.parent
        and direct_parent.distance = 1
    where direct_child.parent = direct_parent.child
),

-- additionally, only includes cases where the model "in between" the parent and parent_and_child has NO other downstream dependencies
-- Note: when the "in between" model DOES have downstream dependencies, it's possible this DAG choice has been made to avoid duplicated code and as such is OKAY
final as (
    select
        triad_relationships.*,
        case 
            when single_use_resources.parent is not null then true 
            else false
        end as is_loop_independent
    from triad_relationships
    left join single_use_resources 
        on triad_relationships.parent_and_child = single_use_resources.parent
),

final_filtered as (
    select * from final
    where is_loop_independent
)

select * from final_filtered



    

    
    

    

    


  );
  
[0m09:38:06.074642 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate
[0m09:38:06.075036 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_root_models: BEGIN
[0m09:38:06.087050 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m09:38:06.089411 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m09:38:06.088061 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:38:06.096457 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.020 seconds
[0m09:38:06.102974 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m09:38:06.103684 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"} */
alter table "nerd_facts"."public"."fct_rejoining_of_upstream_concepts" rename to "fct_rejoining_of_upstream_concepts__dbt_backup"
[0m09:38:06.104157 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: BEGIN
[0m09:38:06.104652 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:38:06.105756 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:38:06.111519 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m09:38:06.112454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m09:38:06.113432 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m09:38:06.113894 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_source_fanout: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_fanout"} */

  
    

  create  table "nerd_facts"."public"."fct_source_fanout__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a source is used in multiple direct downstream models
with direct_source_relationships as (
    select  
        *
    from "nerd_facts"."public"."int_all_dag_relationships"
    where distance = 1
    and parent_resource_type = 'source'
    and child_resource_type = 'model'
    and not parent_is_excluded
    and not child_is_excluded
    -- we order the CTE so that listagg returns values correctly sorted for some warehouses
    order by child
),

source_fanout as (
    select
        parent,
        
    string_agg(
        child,
        ', '
        
        ) as model_children
    from direct_source_relationships
    group by 1
    having count(*) > 1
)

select * from source_fanout



    

    
    

    

    


  );
  
[0m09:38:06.112964 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"} */
alter table "nerd_facts"."public"."fct_rejoining_of_upstream_concepts__dbt_tmp" rename to "fct_rejoining_of_upstream_concepts"
[0m09:38:06.123196 [debug] [Thread-3 (]: SQL status: BEGIN in 0.035 seconds
[0m09:38:06.123979 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m09:38:06.124596 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_root_models: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_root_models"} */

  
    

  create  table "nerd_facts"."public"."fct_root_models__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a model has 0 direct parents, likely due to a lack of source or ref function

with model_relationships as (
    select  
        *
    from "nerd_facts"."public"."int_all_dag_relationships"
    where child_resource_type = 'model'
    -- only filter out excluded children nodes
        -- filtering parents could result in incorrectly flagging nodes that depend on excluded nodes
    and not child_is_excluded
    -- exclude required time spine
    and child != 'metricflow_time_spine'
),

final as (
    select
        child
    from model_relationships
    group by 1
    having max(distance) = 0
)

select * from final



    

    
    

    

    


  );
  
[0m09:38:06.125464 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m09:38:06.129032 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: COMMIT
[0m09:38:06.129802 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m09:38:06.130531 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: COMMIT
[0m09:38:06.131570 [debug] [Thread-4 (]: SQL status: BEGIN in 0.027 seconds
[0m09:38:06.132112 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m09:38:06.132989 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"} */

  
    

  create  table "nerd_facts"."public"."fct_staging_dependent_on_marts_or_intermediate__dbt_tmp"
  
  
    as
  
  (
    -- cases where a staging model depends on a marts/intermediate model
-- data should flow from raw -> staging -> intermediate -> marts
with direct_model_relationships as (
    select  
        *
    from "nerd_facts"."public"."int_all_dag_relationships"
    where distance = 1
    and parent_resource_type = 'model'
    and child_resource_type = 'model'
    and not parent_is_excluded
    and not child_is_excluded
),
final as (
    select
        parent,
        parent_model_type,
        child,
        child_model_type
    from direct_model_relationships
    where child_model_type = 'staging'
    and parent_model_type in ('marts', 'intermediate')
)
select * from final



    

    
    

    

    


  );
  
[0m09:38:06.137078 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.023 seconds
[0m09:38:06.143381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m09:38:06.143922 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m09:38:06.144360 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_source_fanout: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_fanout"} */
alter table "nerd_facts"."public"."fct_source_fanout" rename to "fct_source_fanout__dbt_backup"
[0m09:38:06.148486 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."fct_rejoining_of_upstream_concepts__dbt_backup"
[0m09:38:06.153954 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m09:38:06.154514 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.021 seconds
[0m09:38:06.155723 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"} */
drop table if exists "nerd_facts"."public"."fct_rejoining_of_upstream_concepts__dbt_backup" cascade
[0m09:38:06.155230 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.030 seconds
[0m09:38:06.160354 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m09:38:06.165914 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"} */
alter table "nerd_facts"."public"."fct_staging_dependent_on_marts_or_intermediate" rename to "fct_staging_dependent_on_marts_or_intermediate__dbt_backup"
[0m09:38:06.154860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:38:06.165390 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m09:38:06.170341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m09:38:06.170888 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.010 seconds
[0m09:38:06.173501 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: Close
[0m09:38:06.171270 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_root_models: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_root_models"} */
alter table "nerd_facts"."public"."fct_root_models" rename to "fct_root_models__dbt_backup"
[0m09:38:06.171654 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:38:06.172065 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_source_fanout: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_fanout"} */
alter table "nerd_facts"."public"."fct_source_fanout__dbt_tmp" rename to "fct_source_fanout"
[0m09:38:06.178583 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m09:38:06.179525 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ba9d6470>]}
[0m09:38:06.179938 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:38:06.180625 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"} */
alter table "nerd_facts"."public"."fct_staging_dependent_on_marts_or_intermediate__dbt_tmp" rename to "fct_staging_dependent_on_marts_or_intermediate"
[0m09:38:06.180953 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:38:06.181967 [info ] [Thread-2 (]: 95 of 103 OK created sql table model public.fct_rejoining_of_upstream_concepts . [[32mSELECT 0[0m in 0.19s]
[0m09:38:06.189707 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts
[0m09:38:06.190122 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.fct_staging_dependent_on_staging
[0m09:38:06.188935 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_source_fanout: COMMIT
[0m09:38:06.186149 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m09:38:06.187163 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:38:06.190631 [info ] [Thread-2 (]: 99 of 103 START sql table model public.fct_staging_dependent_on_staging ........ [RUN]
[0m09:38:06.193832 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts, now model.dbt_project_evaluator.fct_staging_dependent_on_staging)
[0m09:38:06.194158 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.fct_staging_dependent_on_staging
[0m09:38:06.193314 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: COMMIT
[0m09:38:06.191181 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m09:38:06.191555 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_root_models: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_root_models"} */
alter table "nerd_facts"."public"."fct_root_models__dbt_tmp" rename to "fct_root_models"
[0m09:38:06.198639 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m09:38:06.199992 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_source_fanout: COMMIT
[0m09:38:06.199531 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m09:38:06.200918 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:38:06.201638 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.fct_staging_dependent_on_staging
[0m09:38:06.202103 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: COMMIT
[0m09:38:06.203742 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_root_models: COMMIT
[0m09:38:06.204149 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:38:06.211416 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m09:38:06.212137 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m09:38:06.216234 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_root_models: COMMIT
[0m09:38:06.215699 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m09:38:06.215149 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."fct_source_fanout__dbt_backup"
[0m09:38:06.219226 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."fct_staging_dependent_on_marts_or_intermediate__dbt_backup"
[0m09:38:06.219681 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m09:38:06.224726 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."fct_root_models__dbt_backup"
[0m09:38:06.220638 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m09:38:06.221468 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m09:38:06.225443 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m09:38:06.225838 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m09:38:06.226280 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_source_fanout: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_fanout"} */
drop table if exists "nerd_facts"."public"."fct_source_fanout__dbt_backup" cascade
[0m09:38:06.226660 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"} */
drop table if exists "nerd_facts"."public"."fct_staging_dependent_on_marts_or_intermediate__dbt_backup" cascade
[0m09:38:06.227016 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_root_models: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_root_models"} */
drop table if exists "nerd_facts"."public"."fct_root_models__dbt_backup" cascade
[0m09:38:06.227357 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: BEGIN
[0m09:38:06.229532 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:38:06.231517 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m09:38:06.235532 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_source_fanout: Close
[0m09:38:06.235928 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m09:38:06.237434 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_root_models: Close
[0m09:38:06.238371 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b8f82b00>]}
[0m09:38:06.236253 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m09:38:06.240486 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: Close
[0m09:38:06.241245 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ba554c40>]}
[0m09:38:06.238989 [info ] [Thread-3 (]: 96 of 103 OK created sql table model public.fct_root_models .................... [[32mSELECT 4[0m in 0.22s]
[0m09:38:06.242573 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.fct_root_models
[0m09:38:06.244037 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.fct_too_many_joins
[0m09:38:06.245599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b865cca0>]}
[0m09:38:06.241899 [info ] [Thread-4 (]: 98 of 103 OK created sql table model public.fct_staging_dependent_on_marts_or_intermediate  [[32mSELECT 0[0m in 0.18s]
[0m09:38:06.247138 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate
[0m09:38:06.247474 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.fct_unused_sources
[0m09:38:06.248727 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m09:38:06.249251 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m09:38:06.244953 [info ] [Thread-3 (]: 100 of 103 START sql table model public.fct_too_many_joins ..................... [RUN]
[0m09:38:06.250322 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_root_models, now model.dbt_project_evaluator.fct_too_many_joins)
[0m09:38:06.250722 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.fct_too_many_joins
[0m09:38:06.249823 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_staging"} */

  
    

  create  table "nerd_facts"."public"."fct_staging_dependent_on_staging__dbt_tmp"
  
  
    as
  
  (
    -- check for cases where models in the staging layer are dependent on each other
with direct_model_relationships as (
    select  
        *
    from "nerd_facts"."public"."int_all_dag_relationships"
    where parent_resource_type in ('model', 'snapshot')
    and child_resource_type in ('model', 'snapshot')
    and not parent_is_excluded
    and not child_is_excluded
    and distance = 1
),

bending_connections as (
    select
        parent,
        parent_model_type,
        child,
        child_model_type
    from direct_model_relationships
    where parent_model_type = 'staging'
    and child_model_type = 'staging'
)

select * from bending_connections



    

    
    

    

    


  );
  
[0m09:38:06.246477 [info ] [Thread-1 (]: 97 of 103 OK created sql table model public.fct_source_fanout .................. [[32mSELECT 0[0m in 0.22s]
[0m09:38:06.260072 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.fct_source_fanout
[0m09:38:06.260609 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.fct_missing_primary_key_tests
[0m09:38:06.261253 [info ] [Thread-1 (]: 102 of 103 START sql view model public.fct_missing_primary_key_tests ........... [RUN]
[0m09:38:06.261788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_source_fanout, now model.dbt_project_evaluator.fct_missing_primary_key_tests)
[0m09:38:06.262144 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.fct_missing_primary_key_tests
[0m09:38:06.248098 [info ] [Thread-4 (]: 101 of 103 START sql table model public.fct_unused_sources ..................... [RUN]
[0m09:38:06.256723 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_too_many_joins"
[0m09:38:06.270742 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate, now model.dbt_project_evaluator.fct_unused_sources)
[0m09:38:06.266793 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m09:38:06.271693 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.fct_too_many_joins
[0m09:38:06.272138 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.015 seconds
[0m09:38:06.272592 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.fct_unused_sources
[0m09:38:06.282573 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m09:38:06.289035 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_staging"} */
alter table "nerd_facts"."public"."fct_staging_dependent_on_staging" rename to "fct_staging_dependent_on_staging__dbt_backup"
[0m09:38:06.283260 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.fct_missing_primary_key_tests
[0m09:38:06.288513 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_unused_sources"
[0m09:38:06.284010 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_too_many_joins"
[0m09:38:06.296639 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m09:38:06.297538 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_too_many_joins: BEGIN
[0m09:38:06.297926 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:38:06.297135 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.fct_unused_sources
[0m09:38:06.295254 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:38:06.295790 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m09:38:06.307045 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m09:38:06.309202 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_staging"} */
alter table "nerd_facts"."public"."fct_staging_dependent_on_staging__dbt_tmp" rename to "fct_staging_dependent_on_staging"
[0m09:38:06.308641 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_unused_sources"
[0m09:38:06.310010 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m09:38:06.311839 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: BEGIN
[0m09:38:06.312201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:38:06.310386 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:06.314631 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: COMMIT
[0m09:38:06.315081 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m09:38:06.315405 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: COMMIT
[0m09:38:06.311480 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m09:38:06.315960 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_unused_sources: BEGIN
[0m09:38:06.316294 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:38:06.310723 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m09:38:06.318649 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m09:38:06.319108 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_too_many_joins: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_too_many_joins"} */

  
    

  create  table "nerd_facts"."public"."fct_too_many_joins__dbt_tmp"
  
  
    as
  
  (
    with all_dag_relationships as (
    select
        *
    from "nerd_facts"."public"."int_all_dag_relationships"
    where not child_is_excluded
    and child_resource_type = 'model'
),

final as (
    select
        child as resource_name,
        child_file_path as file_path,
        cast(count(distinct parent) as integer) as join_count
    from all_dag_relationships
    where distance = 1
    group by 1, 2
    having count(distinct parent) >= 7
)

select * from final



    

    
    

    

    


  );
  
[0m09:38:06.321898 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m09:38:06.325102 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."fct_staging_dependent_on_staging__dbt_backup"
[0m09:38:06.326464 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m09:38:06.326853 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_staging"} */
drop table if exists "nerd_facts"."public"."fct_staging_dependent_on_staging__dbt_backup" cascade
[0m09:38:06.331896 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m09:38:06.333770 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: Close
[0m09:38:06.334608 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b8482020>]}
[0m09:38:06.339392 [info ] [Thread-2 (]: 99 of 103 OK created sql table model public.fct_staging_dependent_on_staging ... [[32mSELECT 0[0m in 0.14s]
[0m09:38:06.340678 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.fct_staging_dependent_on_staging
[0m09:38:06.340063 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.021 seconds
[0m09:38:06.341100 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.fct_test_coverage
[0m09:38:06.347685 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m09:38:06.348556 [debug] [Thread-4 (]: SQL status: BEGIN in 0.032 seconds
[0m09:38:06.348957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m09:38:06.350789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m09:38:06.351096 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_missing_primary_key_tests"} */

  create view "nerd_facts"."public"."fct_missing_primary_key_tests__dbt_tmp"
    
    
  as (
    with

tests as (
    select * from "nerd_facts"."public"."int_model_test_summary"
    where resource_type in
    (
        'model'
        
    )
),

final as (

    select
        resource_name,
        resource_type,
        model_type,
        is_primary_key_tested,
        number_of_tests_on_model,
        number_of_constraints_on_model
    from tests
    where not(is_primary_key_tested)

)

select * from final



    

    
    

    

    


  );
[0m09:38:06.349600 [info ] [Thread-2 (]: 103 of 103 START sql view model public.fct_test_coverage ....................... [RUN]
[0m09:38:06.350086 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_too_many_joins: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_too_many_joins"} */
alter table "nerd_facts"."public"."fct_too_many_joins" rename to "fct_too_many_joins__dbt_backup"
[0m09:38:06.350450 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m09:38:06.352335 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_unused_sources: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_unused_sources"} */

  
    

  create  table "nerd_facts"."public"."fct_unused_sources__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a source has no children

with source_relationships as (
    select  
        *
    from "nerd_facts"."public"."int_all_dag_relationships"
    where parent_resource_type = 'source'
    and not parent_is_excluded
    and not child_is_excluded
),

final as (
    select
        parent
    from source_relationships
    group by 1
    having max(distance) = 0
)

select * from final



    

    
    

    

    


  );
  
[0m09:38:06.351659 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_staging_dependent_on_staging, now model.dbt_project_evaluator.fct_test_coverage)
[0m09:38:06.352863 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.fct_test_coverage
[0m09:38:06.360828 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m09:38:06.364398 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m09:38:06.364845 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m09:38:06.365255 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_too_many_joins: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_too_many_joins"} */
alter table "nerd_facts"."public"."fct_too_many_joins__dbt_tmp" rename to "fct_too_many_joins"
[0m09:38:06.370723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m09:38:06.367794 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_test_coverage"
[0m09:38:06.371123 [debug] [Thread-4 (]: SQL status: SELECT 20 in 0.018 seconds
[0m09:38:06.371717 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_missing_primary_key_tests"} */
alter table "nerd_facts"."public"."fct_missing_primary_key_tests__dbt_tmp" rename to "fct_missing_primary_key_tests"
[0m09:38:06.372065 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:38:06.375723 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m09:38:06.376347 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.fct_test_coverage
[0m09:38:06.378593 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_too_many_joins: COMMIT
[0m09:38:06.379013 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:38:06.379538 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_unused_sources: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_unused_sources"} */
alter table "nerd_facts"."public"."fct_unused_sources" rename to "fct_unused_sources__dbt_backup"
[0m09:38:06.386794 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_test_coverage"
[0m09:38:06.387230 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m09:38:06.388521 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: COMMIT
[0m09:38:06.389224 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_too_many_joins: COMMIT
[0m09:38:06.389603 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:06.389951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m09:38:06.390469 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m09:38:06.394218 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m09:38:06.394722 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m09:38:06.398248 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."fct_too_many_joins__dbt_backup"
[0m09:38:06.395035 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: COMMIT
[0m09:38:06.395827 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_unused_sources: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_unused_sources"} */
alter table "nerd_facts"."public"."fct_unused_sources__dbt_tmp" rename to "fct_unused_sources"
[0m09:38:06.395432 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_test_coverage: BEGIN
[0m09:38:06.399598 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:38:06.398979 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m09:38:06.400183 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_too_many_joins: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_too_many_joins"} */
drop table if exists "nerd_facts"."public"."fct_too_many_joins__dbt_backup" cascade
[0m09:38:06.401211 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:38:06.403364 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_unused_sources: COMMIT
[0m09:38:06.404158 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m09:38:06.407513 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."fct_missing_primary_key_tests__dbt_backup"
[0m09:38:06.408277 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m09:38:06.408683 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_missing_primary_key_tests"} */
drop view if exists "nerd_facts"."public"."fct_missing_primary_key_tests__dbt_backup" cascade
[0m09:38:06.404517 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:38:06.405121 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m09:38:06.411336 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_unused_sources: COMMIT
[0m09:38:06.410654 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_too_many_joins: Close
[0m09:38:06.410992 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:38:06.409366 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m09:38:06.417007 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m09:38:06.416251 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: Close
[0m09:38:06.416630 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m09:38:06.417394 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_test_coverage: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_coverage"} */

  create view "nerd_facts"."public"."fct_test_coverage__dbt_tmp"
    
    
  as (
    with

test_counts as (
    select * from "nerd_facts"."public"."int_model_test_summary"
    where resource_type = 'model'
),

conversion as (
    select
        resource_name,
        cast(case when number_of_tests_on_model > 0 then 1 else 0 end as boolean) as is_tested_model,
        
            case when model_type = 'base' then 1.0 else NULL end as is_base_model,
            case when number_of_tests_on_model > 0 and model_type = 'base' then 1.0 else 0 end as is_tested_base_model,
        
            case when model_type = 'staging' then 1.0 else NULL end as is_staging_model,
            case when number_of_tests_on_model > 0 and model_type = 'staging' then 1.0 else 0 end as is_tested_staging_model,
        
            case when model_type = 'intermediate' then 1.0 else NULL end as is_intermediate_model,
            case when number_of_tests_on_model > 0 and model_type = 'intermediate' then 1.0 else 0 end as is_tested_intermediate_model,
        
            case when model_type = 'marts' then 1.0 else NULL end as is_marts_model,
            case when number_of_tests_on_model > 0 and model_type = 'marts' then 1.0 else 0 end as is_tested_marts_model,
        
            case when model_type = 'other' then 1.0 else NULL end as is_other_model,
            case when number_of_tests_on_model > 0 and model_type = 'other' then 1.0 else 0 end as is_tested_other_model
        

    from test_counts
),

final as (
    select
        now() as measured_at,
        cast(count(*) as integer) as total_models,
        cast(sum(number_of_tests_on_model) as integer) as total_tests,
        sum(cast(is_tested_model as integer)) as tested_models,
        round(sum(cast(is_tested_model as integer)) * 100.0 / count(*), 2) as test_coverage_pct,
        
            round(
                
    ( sum(is_tested_base_model) * 100.0 ) / nullif( ( count(is_base_model) ), 0)

            , 2) as base_test_coverage_pct,
        
            round(
                
    ( sum(is_tested_staging_model) * 100.0 ) / nullif( ( count(is_staging_model) ), 0)

            , 2) as staging_test_coverage_pct,
        
            round(
                
    ( sum(is_tested_intermediate_model) * 100.0 ) / nullif( ( count(is_intermediate_model) ), 0)

            , 2) as intermediate_test_coverage_pct,
        
            round(
                
    ( sum(is_tested_marts_model) * 100.0 ) / nullif( ( count(is_marts_model) ), 0)

            , 2) as marts_test_coverage_pct,
        
            round(
                
    ( sum(is_tested_other_model) * 100.0 ) / nullif( ( count(is_other_model) ), 0)

            , 2) as other_test_coverage_pct,
        
        round(sum(number_of_tests_on_model) * 1.0000 / count(*), 4) as test_to_model_ratio

    from test_counts
    left join conversion
    on test_counts.resource_name = conversion.resource_name
)

select * from final
  );
[0m09:38:06.414696 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b8f82b00>]}
[0m09:38:06.424264 [info ] [Thread-3 (]: 100 of 103 OK created sql table model public.fct_too_many_joins ................ [[32mSELECT 1[0m in 0.16s]
[0m09:38:06.424950 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.fct_too_many_joins
[0m09:38:06.420549 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."fct_unused_sources__dbt_backup"
[0m09:38:06.425399 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:38:06.429908 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m09:38:06.430375 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_test_coverage: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_coverage"} */
alter table "nerd_facts"."public"."fct_test_coverage__dbt_tmp" rename to "fct_test_coverage"
[0m09:38:06.426341 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m09:38:06.431303 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_unused_sources: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_unused_sources"} */
drop table if exists "nerd_facts"."public"."fct_unused_sources__dbt_backup" cascade
[0m09:38:06.421333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82bb957f40>]}
[0m09:38:06.431662 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:06.433972 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_test_coverage: COMMIT
[0m09:38:06.434361 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m09:38:06.434660 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_test_coverage: COMMIT
[0m09:38:06.432495 [info ] [Thread-1 (]: 102 of 103 OK created sql view model public.fct_missing_primary_key_tests ...... [[32mCREATE VIEW[0m in 0.16s]
[0m09:38:06.435328 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.fct_missing_primary_key_tests
[0m09:38:06.435844 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:38:06.437363 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_unused_sources: Close
[0m09:38:06.437744 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m09:38:06.442254 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."fct_test_coverage__dbt_backup"
[0m09:38:06.443039 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b8fb1450>]}
[0m09:38:06.443993 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m09:38:06.445090 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_test_coverage: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_coverage"} */
drop view if exists "nerd_facts"."public"."fct_test_coverage__dbt_backup" cascade
[0m09:38:06.444689 [info ] [Thread-4 (]: 101 of 103 OK created sql table model public.fct_unused_sources ................ [[32mSELECT 20[0m in 0.18s]
[0m09:38:06.446184 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.fct_unused_sources
[0m09:38:06.446521 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:38:06.448345 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_test_coverage: Close
[0m09:38:06.451541 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16d65d5-2c5d-4fe8-b97f-dee20f3e33e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b84aa200>]}
[0m09:38:06.452299 [info ] [Thread-2 (]: 103 of 103 OK created sql view model public.fct_test_coverage .................. [[32mCREATE VIEW[0m in 0.10s]
[0m09:38:06.452898 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.fct_test_coverage
[0m09:38:06.454751 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:06.455121 [debug] [MainThread]: On master: BEGIN
[0m09:38:06.455392 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:38:06.464727 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:38:06.465211 [debug] [MainThread]: On master: COMMIT
[0m09:38:06.465532 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:06.465792 [debug] [MainThread]: On master: COMMIT
[0m09:38:06.466147 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:38:06.466427 [debug] [MainThread]: On master: Close
[0m09:38:06.466928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:38:06.467168 [debug] [MainThread]: Connection 'model.dbt_project_evaluator.fct_missing_primary_key_tests' was properly closed.
[0m09:38:06.467380 [debug] [MainThread]: Connection 'model.dbt_project_evaluator.fct_test_coverage' was properly closed.
[0m09:38:06.467608 [debug] [MainThread]: Connection 'model.dbt_project_evaluator.fct_unused_sources' was properly closed.
[0m09:38:06.467822 [debug] [MainThread]: Connection 'model.dbt_project_evaluator.fct_too_many_joins' was properly closed.
[0m09:38:06.468530 [info ] [MainThread]: 
[0m09:38:06.468836 [info ] [MainThread]: Finished running 57 table models, 46 view models in 0 hours 0 minutes and 16.18 seconds (16.18s).
[0m09:38:06.480395 [debug] [MainThread]: Command end result
[0m09:38:06.641079 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m09:38:06.643720 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m09:38:06.656401 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m09:38:06.657050 [info ] [MainThread]: 
[0m09:38:06.657552 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:38:06.658057 [info ] [MainThread]: 
[0m09:38:06.658444 [info ] [MainThread]: Done. PASS=103 WARN=0 ERROR=0 SKIP=0 TOTAL=103
[0m09:38:06.659512 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.250233, "process_in_blocks": "0", "process_kernel_time": 0.461622, "process_mem_max_rss": "127328", "process_out_blocks": "13520", "process_user_time": 9.921961}
[0m09:38:06.660112 [debug] [MainThread]: Command `dbt run` succeeded at 09:38:06.660015 after 17.25 seconds
[0m09:38:06.660502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82bd068be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82bcf2d510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b84bcdc0>]}
[0m09:38:06.660910 [debug] [MainThread]: Flushing usage events
[0m09:38:07.163555 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:52:17.056363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d53cd2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d52e87700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d52e850f0>]}


============================== 12:52:17.058696 | ee18c81f-236f-4219-b314-05c1c746d941 ==============================
[0m12:52:17.058696 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:52:17.059157 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select marts.obt.*', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:52:17.200033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee18c81f-236f-4219-b314-05c1c746d941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d52e868c0>]}
[0m12:52:17.253299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee18c81f-236f-4219-b314-05c1c746d941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d523ac700>]}
[0m12:52:17.254116 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:52:17.362805 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:52:17.505111 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:52:17.505714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ee18c81f-236f-4219-b314-05c1c746d941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d5352dd80>]}
[0m12:52:19.856828 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_netrunner_types' in the 'models' section of file 'models/staging/netrunner/stg_netrunner.yml'
[0m12:52:19.862011 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_netrunner_cycles' in the 'models' section of file 'models/staging/netrunner/stg_netrunner.yml'
[0m12:52:19.864588 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_netrunner_subtypes' in the 'models' section of file 'models/staging/netrunner/stg_netrunner.yml'
[0m12:52:20.111315 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_films' in the 'models' section of file 'models/marts/star_wars/schema.yml'
[0m12:52:20.135437 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'operational_batch_sw' in the 'models' section of file 'tests/operational_batch.yml'
[0m12:52:20.422724 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nerd_facts_dbt.nerd_universe_obt' (models/marts/obt/nerd_universe_obt.sql) depends on a node named 'dim_planets' which was not found
[0m12:52:20.423783 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.414656, "process_in_blocks": "0", "process_kernel_time": 0.111993, "process_mem_max_rss": "115012", "process_out_blocks": "8", "process_user_time": 4.319791}
[0m12:52:20.424217 [debug] [MainThread]: Command `dbt run` failed at 12:52:20.424120 after 3.42 seconds
[0m12:52:20.424560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d53cd2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d51b1ad40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d51b1b7c0>]}
[0m12:52:20.424893 [debug] [MainThread]: Flushing usage events
[0m12:52:20.868796 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:55:38.526470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83fe6b8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ff77ea70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ff77cfa0>]}


============================== 12:55:38.529556 | c105eef4-55c1-4225-8005-1f6373e25e95 ==============================
[0m12:55:38.529556 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:55:38.530331 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/janne/.dbt', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select marts.obt.*', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:55:38.687404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c105eef4-55c1-4225-8005-1f6373e25e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83fd87c220>]}
[0m12:55:38.744071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c105eef4-55c1-4225-8005-1f6373e25e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83fdc07340>]}
[0m12:55:38.744970 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:55:38.854421 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:55:39.042154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 10 files added, 0 files changed.
[0m12:55:39.043379 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://tests/operational/test_sw_character_quality.sql
[0m12:55:39.043912 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/star_wars/schema.yml
[0m12:55:39.044339 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://tests/operational_batch.yml
[0m12:55:39.044697 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://tests/generic/test_not_null_values.sql
[0m12:55:39.045037 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://tests/generic/test_unique_values.sql
[0m12:55:39.045382 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/obt/star_wars_obt.sql
[0m12:55:39.045710 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/obt/pokemon_obt.sql
[0m12:55:39.046034 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://tests/operational/test_data_freshness.sql
[0m12:55:39.046367 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/obt/nerd_universe_obt.sql
[0m12:55:39.046797 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/obt/schema.yml
[0m12:55:39.418575 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_films' in the 'models' section of file 'models/marts/star_wars/schema.yml'
[0m12:55:39.510626 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'operational_batch_sw' in the 'models' section of file 'tests/operational_batch.yml'
[0m12:55:39.547191 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nerd_facts_dbt.star_wars_obt' (models/marts/obt/star_wars_obt.sql) depends on a node named 'dim_planets' which was not found
[0m12:55:39.548318 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.068598, "process_in_blocks": "0", "process_kernel_time": 0.115677, "process_mem_max_rss": "109068", "process_out_blocks": "16", "process_user_time": 1.902913}
[0m12:55:39.548946 [debug] [MainThread]: Command `dbt run` failed at 12:55:39.548835 after 1.07 seconds
[0m12:55:39.549372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83fb2a2c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83fb72df30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83fb72e050>]}
[0m12:55:39.549802 [debug] [MainThread]: Flushing usage events
[0m12:55:39.993058 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:57:54.123557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2af2e9cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2af203ed40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2af203eda0>]}


============================== 12:57:54.126137 | 5f9fccd9-9a19-4f66-95ef-0fcd17a59a69 ==============================
[0m12:57:54.126137 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:57:54.126802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt ls', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:57:54.273924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f9fccd9-9a19-4f66-95ef-0fcd17a59a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2af3e973d0>]}
[0m12:57:54.325519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f9fccd9-9a19-4f66-95ef-0fcd17a59a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2af203ecb0>]}
[0m12:57:54.326430 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:57:54.434358 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:57:54.620627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 10 files added, 0 files changed.
[0m12:57:54.621983 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/star_wars/schema.yml
[0m12:57:54.622535 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://tests/operational_batch.yml
[0m12:57:54.622927 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://tests/operational/test_data_freshness.sql
[0m12:57:54.623283 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://tests/generic/test_unique_values.sql
[0m12:57:54.623687 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://tests/operational/test_sw_character_quality.sql
[0m12:57:54.624037 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/obt/schema.yml
[0m12:57:54.624312 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/obt/star_wars_obt.sql
[0m12:57:54.624572 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://tests/generic/test_not_null_values.sql
[0m12:57:54.624824 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/obt/nerd_universe_obt.sql
[0m12:57:54.625073 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/obt/pokemon_obt.sql
[0m12:57:55.018984 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_films' in the 'models' section of file 'models/marts/star_wars/schema.yml'
[0m12:57:55.135983 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'operational_batch_sw' in the 'models' section of file 'tests/operational_batch.yml'
[0m12:57:55.169874 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nerd_facts_dbt.star_wars_obt' (models/marts/obt/star_wars_obt.sql) depends on a node named 'dim_planets' which was not found
[0m12:57:55.170883 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": false, "command_wall_clock_time": 1.1071362, "process_in_blocks": "0", "process_kernel_time": 0.080267, "process_mem_max_rss": "108892", "process_out_blocks": "16", "process_user_time": 2.002574}
[0m12:57:55.171410 [debug] [MainThread]: Command `dbt ls` failed at 12:57:55.171320 after 1.11 seconds
[0m12:57:55.171776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2af2e9cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2af0f6a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aeff4a0e0>]}
[0m12:57:55.172128 [debug] [MainThread]: Flushing usage events
[0m12:57:55.594622 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:01:01.355569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd534fe8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5350afcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd535fdc100>]}


============================== 13:01:01.358270 | b7ebd4cb-31eb-420f-8eb4-4441d433793a ==============================
[0m13:01:01.358270 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:01:01.358942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select marts.obt.*', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:01.505595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7ebd4cb-31eb-420f-8eb4-4441d433793a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd535fdc550>]}
[0m13:01:01.554968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7ebd4cb-31eb-420f-8eb4-4441d433793a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5341de8c0>]}
[0m13:01:01.555766 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:01:01.648130 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:01:01.825074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 10 files added, 0 files changed.
[0m13:01:01.826132 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/obt/nerd_universe_obt.sql
[0m13:01:01.826506 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/obt/pokemon_obt.sql
[0m13:01:01.826793 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://tests/generic/test_not_null_values.sql
[0m13:01:01.827065 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://tests/generic/test_unique_values.sql
[0m13:01:01.827338 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/obt/star_wars_obt.sql
[0m13:01:01.827675 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/star_wars/schema.yml
[0m13:01:01.828007 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/obt/schema.yml
[0m13:01:01.828262 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://tests/operational/test_sw_character_quality.sql
[0m13:01:01.828548 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://tests/operational_batch.yml
[0m13:01:01.828796 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://tests/operational/test_data_freshness.sql
[0m13:01:02.199984 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_films' in the 'models' section of file 'models/marts/star_wars/schema.yml'
[0m13:01:02.310449 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'operational_batch_sw' in the 'models' section of file 'tests/operational_batch.yml'
[0m13:01:02.329149 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.test_data_freshness' (tests/operational/test_data_freshness.sql) depends on a node named 'dim_films' in package '' which was not found
[0m13:01:02.329828 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.unique_column_dim_films_film_id.d927909715' (models/marts/star_wars/schema.yml) depends on a node named 'dim_films' in package '' which was not found
[0m13:01:02.330289 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.not_null_column_dim_films_film_id.4e6599f0f8' (models/marts/star_wars/schema.yml) depends on a node named 'dim_films' in package '' which was not found
[0m13:01:02.330762 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.not_null_column_dim_films_title.db94e0209e' (models/marts/star_wars/schema.yml) depends on a node named 'dim_films' in package '' which was not found
[0m13:01:02.331251 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.not_null_column_dim_films_release_date.05bcd8d750' (models/marts/star_wars/schema.yml) depends on a node named 'dim_films' in package '' which was not found
[0m13:01:02.331785 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.test_sw_character_data_quality.9079a0b52c' (tests/operational_batch.yml) depends on a node named 'operational_batch_sw' in package '' which was not found
[0m13:01:02.332170 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.test_sw_films_freshness.37a43a604d' (tests/operational_batch.yml) depends on a node named 'operational_batch_sw' in package '' which was not found
[0m13:01:02.446307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7ebd4cb-31eb-420f-8eb4-4441d433793a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5313c8130>]}
[0m13:01:02.684236 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m13:01:02.687233 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m13:01:02.720388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7ebd4cb-31eb-420f-8eb4-4441d433793a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5314d0130>]}
[0m13:01:02.721013 [info ] [MainThread]: Found 106 models, 1 seed, 155 data tests, 30 sources, 633 macros
[0m13:01:02.721446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7ebd4cb-31eb-420f-8eb4-4441d433793a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5354825c0>]}
[0m13:01:02.725196 [info ] [MainThread]: 
[0m13:01:02.725595 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:02.725871 [info ] [MainThread]: 
[0m13:01:02.726329 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:01:02.730159 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m13:01:02.749680 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m13:01:02.750232 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m13:01:02.750584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:02.762434 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m13:01:02.763661 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m13:01:02.771277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_public)
[0m13:01:02.776964 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m13:01:02.777370 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m13:01:02.777694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:02.786833 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:01:02.787278 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m13:01:02.787572 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:01:02.790696 [debug] [ThreadPool]: SQL status: SELECT 110 in 0.003 seconds
[0m13:01:02.793211 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m13:01:02.793707 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m13:01:02.816595 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.817004 [debug] [MainThread]: On master: BEGIN
[0m13:01:02.817280 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:02.826564 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:01:02.827006 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.827360 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:01:02.834683 [debug] [MainThread]: SQL status: SELECT 55 in 0.007 seconds
[0m13:01:02.842263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7ebd4cb-31eb-420f-8eb4-4441d433793a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5314d02b0>]}
[0m13:01:02.842816 [debug] [MainThread]: On master: ROLLBACK
[0m13:01:02.843317 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.843624 [debug] [MainThread]: On master: BEGIN
[0m13:01:02.844258 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:01:02.844557 [debug] [MainThread]: On master: COMMIT
[0m13:01:02.844857 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.845117 [debug] [MainThread]: On master: COMMIT
[0m13:01:02.845472 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:02.845750 [debug] [MainThread]: On master: Close
[0m13:01:02.847621 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.nerd_universe_obt
[0m13:01:02.848201 [info ] [Thread-1 (]: 1 of 3 START sql table model public.nerd_universe_obt .......................... [RUN]
[0m13:01:02.848693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.nerd_universe_obt)
[0m13:01:02.849097 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.nerd_universe_obt
[0m13:01:02.857040 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.pokemon_obt
[0m13:01:02.857714 [info ] [Thread-2 (]: 2 of 3 START sql table model public.pokemon_obt ................................ [RUN]
[0m13:01:02.858301 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.star_wars_obt
[0m13:01:02.858854 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.pokemon_obt'
[0m13:01:02.859829 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:01:02.860761 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.pokemon_obt
[0m13:01:02.860377 [info ] [Thread-3 (]: 3 of 3 START sql table model public.star_wars_obt .............................. [RUN]
[0m13:01:02.866632 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.pokemon_obt"
[0m13:01:02.867386 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.star_wars_obt'
[0m13:01:02.868786 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.star_wars_obt
[0m13:01:02.868269 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.nerd_universe_obt
[0m13:01:02.873231 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.star_wars_obt"
[0m13:01:02.879312 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.pokemon_obt
[0m13:01:02.879885 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.star_wars_obt
[0m13:01:02.954585 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.pokemon_obt"
[0m13:01:02.958442 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:01:02.961056 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.star_wars_obt"
[0m13:01:02.961976 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.star_wars_obt"
[0m13:01:02.962558 [debug] [Thread-3 (]: On model.nerd_facts_dbt.star_wars_obt: BEGIN
[0m13:01:02.963000 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:01:02.963859 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:01:02.964857 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: BEGIN
[0m13:01:02.965377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:02.964441 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.pokemon_obt"
[0m13:01:02.966980 [debug] [Thread-2 (]: On model.nerd_facts_dbt.pokemon_obt: BEGIN
[0m13:01:02.967480 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:01:02.982678 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m13:01:02.983485 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.pokemon_obt"
[0m13:01:02.984158 [debug] [Thread-2 (]: On model.nerd_facts_dbt.pokemon_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon_obt"} */

  
    

  create  table "nerd_facts"."public"."pokemon_obt__dbt_tmp"
  
  
    as
  
  (
    /* 
   One Big Table (OBT) for Pok√©mon Data
   This model combines pokemon, types, abilities, and stats into a single denormalized table
   optimized for analytics and reporting.
*/

with pokemon as (
    select 
        p.pokemon_id,
        p.name as pokemon_name,
        p.height,
        p.weight,
        p.base_experience,
        p.is_default,
        p.type_id,
        p.ability_id
    from "nerd_facts"."public"."fact_pokemon" p
),

types as (
    select
        t.type_id,
        t.type_name,
        t.generation_id
    from "nerd_facts"."public"."dim_pokemon_types" t
),

abilities as (
    select
        a.ability_id,
        a.ability_name,
        a.is_main_series
    from "nerd_facts"."public"."dim_pokemon_abilities" a
),

pokemon_stats as (
    select
        ps.pokemon_id,
        ps.stat_name,
        ps.base_stat,
        ps.effort
    from "nerd_facts"."public"."fact_pokemon_stats" ps
)

-- Final OBT assembly
select
    -- Pokemon information (core entity)
    p.pokemon_id,
    p.pokemon_name,
    p.height,
    p.weight,
    p.base_experience,
    
    -- Type information (denormalized)
    t.type_id,
    t.type_name,
    
    -- Ability information (denormalized)
    a.ability_id,
    a.ability_name,
    
    -- Stat information (denormalized with values)
    ps.stat_name,
    ps.base_stat,
    ps.effort
from pokemon p
left join types t on p.type_id = t.type_id
left join abilities a on p.ability_id = a.ability_id
left join pokemon_stats ps on p.pokemon_id = ps.pokemon_id
  );
  
[0m13:01:02.985526 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column p.name does not exist
LINE 21:         p.name as pokemon_name,
                 ^

[0m13:01:02.986080 [debug] [Thread-2 (]: On model.nerd_facts_dbt.pokemon_obt: ROLLBACK
[0m13:01:02.986803 [debug] [Thread-2 (]: On model.nerd_facts_dbt.pokemon_obt: Close
[0m13:01:02.990579 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m13:01:02.991339 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.star_wars_obt"
[0m13:01:02.991747 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m13:01:02.992283 [debug] [Thread-3 (]: On model.nerd_facts_dbt.star_wars_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.star_wars_obt"} */

  
    

  create  table "nerd_facts"."public"."star_wars_obt__dbt_tmp"
  
  
    as
  
  (
    /* 
   One Big Table (OBT) for Star Wars Data
   This model combines character, film, planet, and species data into a single denormalized table
   optimized for analytics and reporting.
*/

with characters as (
    select 
        c.character_id,
        c.name as character_name,
        c.height,
        c.mass,
        c.hair_color,
        c.skin_color,
        c.eye_color,
        c.birth_year,
        c.gender,
        c.homeworld_id
    from "nerd_facts"."public"."dim_sw_characters" c
),

planets as (
    select
        p.planet_id,
        p.name as planet_name,
        p.rotation_period,
        p.orbital_period,
        p.diameter,
        p.climate,
        p.gravity,
        p.terrain,
        p.surface_water,
        p.population
    from "nerd_facts"."public"."dim_sw_planets" p
),

species as (
    select
        s.species_id,
        s.name as species_name,
        s.classification,
        s.designation,
        s.average_height,
        s.skin_colors,
        s.hair_colors,
        s.eye_colors,
        s.average_lifespan,
        s.language,
        s.homeworld_id
    from "nerd_facts"."public"."dim_sw_species" s
),

films as (
    select
        f.film_id,
        f.title as film_title,
        f.episode_id,
        f.opening_crawl,
        f.director,
        f.producer,
        f.release_date
    from "nerd_facts"."public"."dim_sw_films" f
),

character_films as (
    select
        cf.character_id,
        cf.film_id
    from "nerd_facts"."public"."bridge_sw_characters_films" cf
),

character_planets as (
    -- Using homeworld relationship from characters
    select
        c.character_id,
        c.homeworld_id as planet_id
    from characters c
    where c.homeworld_id is not null
)

-- Final OBT assembly
select
    -- Character information (core entity)
    c.character_id,
    c.character_name,
    c.height,
    c.mass,
    c.hair_color,
    c.skin_color,
    c.eye_color,
    c.birth_year,
    c.gender,
    
    -- Planet information (denormalized)
    p.planet_id,
    p.planet_name,
    p.climate,
    p.terrain,
    p.population,
    
    -- Species information (denormalized)
    s.species_id,
    s.species_name,
    s.classification,
    s.designation,
    s.language,
    
    -- Film information (denormalized)
    f.film_id,
    f.film_title,
    f.episode_id,
    f.director,
    f.release_date
from characters c
left join character_planets cp on c.character_id = cp.character_id
left join planets p on cp.planet_id = p.planet_id
-- Removed character_species join since we don't have that bridge table
left join species s on s.homeworld_id = p.planet_id -- Simplified species join using homeworld
left join character_films cf on c.character_id = cf.character_id
left join films f on cf.film_id = f.film_id
  );
  
[0m13:01:02.993717 [debug] [Thread-2 (]: Database Error in model pokemon_obt (models/marts/obt/pokemon_obt.sql)
  column p.name does not exist
  LINE 21:         p.name as pokemon_name,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/pokemon_obt.sql
[0m13:01:02.994127 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:01:02.996512 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.nerd_universe_obt"} */

  
    

  create  table "nerd_facts"."public"."nerd_universe_obt__dbt_tmp"
  
  
    as
  
  (
    /* 
   Master One Big Table (OBT) for Nerd Universes Data
   This model combines multiple fictional universes into a single unified table
   with a common structure for cross-universe analysis.
*/

with star_wars_characters as (
    select 
        'Star Wars' as universe,
        c.character_id as entity_id,
        c.name as entity_name,
        'character' as entity_type,
        c.gender,
        cast(c.height as numeric) as height_cm,
        cast(c.mass as numeric) as weight_kg,
        p.name as origin_location,
        s.name as species,
        null as abilities,
        f.title as appears_in,
        f.release_date as first_appearance_date,
        'human' as creator_type
    from "nerd_facts"."public"."dim_sw_characters" c
    left join "nerd_facts"."public"."dim_sw_planets" p on c.homeworld_id = p.planet_id
    left join "nerd_facts"."public"."dim_sw_species" s on s.homeworld_id = p.planet_id -- Simplified species join
    left join "nerd_facts"."public"."bridge_sw_characters_films" cf on c.character_id = cf.character_id
    left join "nerd_facts"."public"."dim_sw_films" f on cf.film_id = f.film_id
),

pokemon_entities as (
    select
        'Pokemon' as universe,
        p.pokemon_id as entity_id,
        p.name as entity_name,
        'pokemon' as entity_type,
        null as gender,
        cast(p.height * 10 as numeric) as height_cm,  -- convert to cm
        cast(p.weight / 10 as numeric) as weight_kg,  -- convert to kg
        null as origin_location,
        t.type_name as species,
        a.ability_name as abilities,
        null as appears_in,
        null as first_appearance_date,
        'digital' as creator_type
    from "nerd_facts"."public"."fact_pokemon" p
    left join "nerd_facts"."public"."dim_pokemon_types" t on p.type_id = t.type_id
    left join "nerd_facts"."public"."dim_pokemon_abilities" a on p.ability_id = a.ability_id
),

/* You can add more universes here as needed, following the same pattern */

-- Final Master OBT
unified_entities as (
    select * from star_wars_characters
    union all
    select * from pokemon_entities
    -- Add more universes here with UNION ALL
)

select
    universe,
    entity_id,
    entity_name,
    entity_type,
    gender,
    height_cm,
    weight_kg,
    origin_location,
    species,
    abilities,
    appears_in,
    first_appearance_date,
    creator_type,
    -- Add computed/derived columns
    case
        when height_cm > 200 then 'Tall'
        when height_cm between 100 and 200 then 'Medium'
        when height_cm < 100 then 'Short'
        else 'Unknown'
    end as height_category,
    case
        when weight_kg > 100 then 'Heavy'
        when weight_kg between 50 and 100 then 'Medium'
        when weight_kg < 50 then 'Light'
        else 'Unknown'
    end as weight_category,
    current_timestamp as obt_created_at
from unified_entities
  );
  
[0m13:01:02.997080 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7ebd4cb-31eb-420f-8eb4-4441d433793a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5378bc820>]}
[0m13:01:02.995908 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column c.character_id does not exist
LINE 20:         c.character_id,
                 ^
HINT:  Perhaps you meant to reference the column "c.character_key".

[0m13:01:02.998202 [debug] [Thread-3 (]: On model.nerd_facts_dbt.star_wars_obt: ROLLBACK
[0m13:01:02.997821 [error] [Thread-2 (]: 2 of 3 ERROR creating sql table model public.pokemon_obt ....................... [[31mERROR[0m in 0.14s]
[0m13:01:02.999244 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.pokemon_obt
[0m13:01:02.998782 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column c.homeworld_id does not exist
LINE 34: ... join "nerd_facts"."public"."dim_sw_planets" p on c.homeworl...
                                                              ^

[0m13:01:03.000549 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: ROLLBACK
[0m13:01:03.000176 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.pokemon_obt' to be skipped because of status 'error'.  Reason: Database Error in model pokemon_obt (models/marts/obt/pokemon_obt.sql)
  column p.name does not exist
  LINE 21:         p.name as pokemon_name,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/pokemon_obt.sql.
[0m13:01:03.001679 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: Close
[0m13:01:02.999691 [debug] [Thread-3 (]: On model.nerd_facts_dbt.star_wars_obt: Close
[0m13:01:03.004511 [debug] [Thread-3 (]: Database Error in model star_wars_obt (models/marts/obt/star_wars_obt.sql)
  column c.character_id does not exist
  LINE 20:         c.character_id,
                   ^
  HINT:  Perhaps you meant to reference the column "c.character_key".
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/star_wars_obt.sql
[0m13:01:03.005351 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7ebd4cb-31eb-420f-8eb4-4441d433793a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd532d66cb0>]}
[0m13:01:03.006172 [error] [Thread-3 (]: 3 of 3 ERROR creating sql table model public.star_wars_obt ..................... [[31mERROR[0m in 0.14s]
[0m13:01:03.007434 [debug] [Thread-1 (]: Database Error in model nerd_universe_obt (models/marts/obt/nerd_universe_obt.sql)
  column c.homeworld_id does not exist
  LINE 34: ... join "nerd_facts"."public"."dim_sw_planets" p on c.homeworl...
                                                                ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/nerd_universe_obt.sql
[0m13:01:03.008032 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.star_wars_obt
[0m13:01:03.008635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7ebd4cb-31eb-420f-8eb4-4441d433793a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd531cdfeb0>]}
[0m13:01:03.009194 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.star_wars_obt' to be skipped because of status 'error'.  Reason: Database Error in model star_wars_obt (models/marts/obt/star_wars_obt.sql)
  column c.character_id does not exist
  LINE 20:         c.character_id,
                   ^
  HINT:  Perhaps you meant to reference the column "c.character_key".
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/star_wars_obt.sql.
[0m13:01:03.009939 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.nerd_universe_obt ................. [[31mERROR[0m in 0.16s]
[0m13:01:03.010422 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.nerd_universe_obt
[0m13:01:03.010904 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.nerd_universe_obt' to be skipped because of status 'error'.  Reason: Database Error in model nerd_universe_obt (models/marts/obt/nerd_universe_obt.sql)
  column c.homeworld_id does not exist
  LINE 34: ... join "nerd_facts"."public"."dim_sw_planets" p on c.homeworl...
                                                                ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/nerd_universe_obt.sql.
[0m13:01:03.012360 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:03.012720 [debug] [MainThread]: On master: BEGIN
[0m13:01:03.012997 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:03.022342 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:01:03.022838 [debug] [MainThread]: On master: COMMIT
[0m13:01:03.023155 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:03.023423 [debug] [MainThread]: On master: COMMIT
[0m13:01:03.023817 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:03.024093 [debug] [MainThread]: On master: Close
[0m13:01:03.024617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:03.024865 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.nerd_universe_obt' was properly closed.
[0m13:01:03.025082 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.pokemon_obt' was properly closed.
[0m13:01:03.025293 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.star_wars_obt' was properly closed.
[0m13:01:03.025700 [info ] [MainThread]: 
[0m13:01:03.026217 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m13:01:03.027094 [debug] [MainThread]: Command end result
[0m13:01:03.136653 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m13:01:03.139158 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m13:01:03.144625 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m13:01:03.145075 [info ] [MainThread]: 
[0m13:01:03.145464 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m13:01:03.145801 [info ] [MainThread]: 
[0m13:01:03.146118 [error] [MainThread]:   Database Error in model pokemon_obt (models/marts/obt/pokemon_obt.sql)
  column p.name does not exist
  LINE 21:         p.name as pokemon_name,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/pokemon_obt.sql
[0m13:01:03.146381 [info ] [MainThread]: 
[0m13:01:03.146671 [error] [MainThread]:   Database Error in model star_wars_obt (models/marts/obt/star_wars_obt.sql)
  column c.character_id does not exist
  LINE 20:         c.character_id,
                   ^
  HINT:  Perhaps you meant to reference the column "c.character_key".
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/star_wars_obt.sql
[0m13:01:03.146927 [info ] [MainThread]: 
[0m13:01:03.147214 [error] [MainThread]:   Database Error in model nerd_universe_obt (models/marts/obt/nerd_universe_obt.sql)
  column c.homeworld_id does not exist
  LINE 34: ... join "nerd_facts"."public"."dim_sw_planets" p on c.homeworl...
                                                                ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/nerd_universe_obt.sql
[0m13:01:03.147472 [info ] [MainThread]: 
[0m13:01:03.147762 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m13:01:03.148513 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8548938, "process_in_blocks": "0", "process_kernel_time": 0.123678, "process_mem_max_rss": "126008", "process_out_blocks": "11504", "process_user_time": 2.680731}
[0m13:01:03.148997 [debug] [MainThread]: Command `dbt run` failed at 13:01:03.148912 after 1.86 seconds
[0m13:01:03.149340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd534fe8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd535085b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5312748e0>]}
[0m13:01:03.149716 [debug] [MainThread]: Flushing usage events
[0m13:01:03.592535 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:04:06.587015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e97bc0c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e96d2ea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e96d2dff0>]}


============================== 13:04:06.589266 | 31c70024-a4f6-4f38-a06a-0485cef4bc79 ==============================
[0m13:04:06.589266 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:04:06.589809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select marts.obt.*', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:04:06.730296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31c70024-a4f6-4f38-a06a-0485cef4bc79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e98cef670>]}
[0m13:04:06.780024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31c70024-a4f6-4f38-a06a-0485cef4bc79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e97b3b6a0>]}
[0m13:04:06.780932 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:04:06.880448 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:04:07.070797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:04:07.072379 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/obt/star_wars_obt.sql
[0m13:04:07.072829 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/obt/pokemon_obt.sql
[0m13:04:07.073200 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/obt/nerd_universe_obt.sql
[0m13:04:07.538282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31c70024-a4f6-4f38-a06a-0485cef4bc79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e8feb0bb0>]}
[0m13:04:07.702930 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m13:04:07.705646 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m13:04:07.787216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31c70024-a4f6-4f38-a06a-0485cef4bc79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e98f5e4a0>]}
[0m13:04:07.787863 [info ] [MainThread]: Found 106 models, 1 seed, 155 data tests, 30 sources, 633 macros
[0m13:04:07.788263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31c70024-a4f6-4f38-a06a-0485cef4bc79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9a5a85b0>]}
[0m13:04:07.792407 [info ] [MainThread]: 
[0m13:04:07.792790 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:04:07.793070 [info ] [MainThread]: 
[0m13:04:07.793556 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:04:07.797294 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m13:04:07.817017 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m13:04:07.817526 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m13:04:07.817911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:07.829103 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m13:04:07.830504 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m13:04:07.840019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_public)
[0m13:04:07.846594 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m13:04:07.847063 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m13:04:07.847419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:04:07.856915 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:04:07.857429 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m13:04:07.857845 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:04:07.860923 [debug] [ThreadPool]: SQL status: SELECT 110 in 0.003 seconds
[0m13:04:07.864668 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m13:04:07.865247 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m13:04:07.891305 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:07.891834 [debug] [MainThread]: On master: BEGIN
[0m13:04:07.892179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:04:07.901743 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:04:07.902231 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:07.902679 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:04:07.910729 [debug] [MainThread]: SQL status: SELECT 55 in 0.008 seconds
[0m13:04:07.918837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31c70024-a4f6-4f38-a06a-0485cef4bc79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e945e1480>]}
[0m13:04:07.919556 [debug] [MainThread]: On master: ROLLBACK
[0m13:04:07.920141 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:07.920487 [debug] [MainThread]: On master: BEGIN
[0m13:04:07.921030 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:04:07.921358 [debug] [MainThread]: On master: COMMIT
[0m13:04:07.921704 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:07.922022 [debug] [MainThread]: On master: COMMIT
[0m13:04:07.922447 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:04:07.922776 [debug] [MainThread]: On master: Close
[0m13:04:07.926367 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.nerd_universe_obt
[0m13:04:07.926894 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.pokemon_obt
[0m13:04:07.927274 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.star_wars_obt
[0m13:04:07.927817 [info ] [Thread-1 (]: 1 of 3 START sql table model public.nerd_universe_obt .......................... [RUN]
[0m13:04:07.929618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.nerd_universe_obt)
[0m13:04:07.928892 [info ] [Thread-3 (]: 3 of 3 START sql table model public.star_wars_obt .............................. [RUN]
[0m13:04:07.929988 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.nerd_universe_obt
[0m13:04:07.928439 [info ] [Thread-2 (]: 2 of 3 START sql table model public.pokemon_obt ................................ [RUN]
[0m13:04:07.930489 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.star_wars_obt'
[0m13:04:07.936224 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.pokemon_obt'
[0m13:04:07.939530 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:04:07.940062 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.star_wars_obt
[0m13:04:07.940492 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.pokemon_obt
[0m13:04:07.944376 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.star_wars_obt"
[0m13:04:07.949848 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.pokemon_obt"
[0m13:04:07.951311 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.pokemon_obt
[0m13:04:07.950588 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.nerd_universe_obt
[0m13:04:07.997454 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.pokemon_obt"
[0m13:04:08.001412 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:04:08.001983 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.star_wars_obt
[0m13:04:08.002703 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.pokemon_obt"
[0m13:04:08.008472 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.star_wars_obt"
[0m13:04:08.009236 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:04:08.010950 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: BEGIN
[0m13:04:08.010586 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.star_wars_obt"
[0m13:04:08.009594 [debug] [Thread-2 (]: On model.nerd_facts_dbt.pokemon_obt: BEGIN
[0m13:04:08.012005 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:04:08.011668 [debug] [Thread-3 (]: On model.nerd_facts_dbt.star_wars_obt: BEGIN
[0m13:04:08.011337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:08.012503 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:04:08.021676 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m13:04:08.022286 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.pokemon_obt"
[0m13:04:08.022774 [debug] [Thread-2 (]: On model.nerd_facts_dbt.pokemon_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon_obt"} */

  
    

  create  table "nerd_facts"."public"."pokemon_obt__dbt_tmp"
  
  
    as
  
  (
    /* 
   One Big Table (OBT) for Pok√©mon Data
   This model combines pokemon, types, abilities, and stats into a single denormalized table
   optimized for analytics and reporting.
*/

with pokemon as (
    select 
        p.pokemon_key,
        p.pokemon_id,
        p.pokemon_name,
        p.height_m,
        p.weight_kg,
        p.base_xp as base_experience,
        p.primary_type,
        p.secondary_type,
        p.primary_type_key,
        p.secondary_type_key,
        p.base_stat_hp,
        p.total_base_stats
    from "nerd_facts"."public"."fact_pokemon" p
),

types as (
    select
        t.type_key,
        t.type_id,
        t.type_name,
        t.generation_id
    from "nerd_facts"."public"."dim_pokemon_types" t
),

abilities as (
    select
        a.ability_key,
        a.ability_id,
        a.ability_name,
        a.is_main_series
    from "nerd_facts"."public"."dim_pokemon_abilities" a
),

pokemon_abilities as (
    select
        pa.pokemon_key,
        pa.ability_key,
        pa.is_hidden
    from "nerd_facts"."public"."bridge_pokemon_abilities" pa
),

pokemon_stats as (
    select
        ps.pokemon_id,
        ps.stat_name,
        ps.base_stat,
        ps.effort
    from "nerd_facts"."public"."fact_pokemon_stats" ps
)

-- Final OBT assembly
select
    -- Pokemon information (core entity)
    p.pokemon_key,
    p.pokemon_id,
    p.pokemon_name,
    p.height_m,
    p.weight_kg,
    p.base_experience,
    p.base_stat_hp,
    p.total_base_stats,
    
    -- Type information (denormalized)
    t1.type_key as primary_type_key,
    t1.type_name as primary_type_name,
    t2.type_key as secondary_type_key,
    t2.type_name as secondary_type_name,
    
    -- Ability information (denormalized)
    a.ability_key,
    a.ability_name,
    pa.is_hidden,
    
    -- Stat information (denormalized with values)
    ps.stat_name,
    ps.base_stat,
    ps.effort,
    
    -- Metadata
    current_timestamp as obt_created_at
from pokemon p
left join types t1 on p.primary_type_key = t1.type_key
left join types t2 on p.secondary_type_key = t2.type_key
left join pokemon_abilities pa on p.pokemon_key = pa.pokemon_key
left join abilities a on pa.ability_key = a.ability_key
left join pokemon_stats ps on p.pokemon_id = ps.pokemon_id
  );
  
[0m13:04:08.023846 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column t.generation_id does not exist
LINE 40:         t.generation_id
                 ^

[0m13:04:08.024226 [debug] [Thread-2 (]: On model.nerd_facts_dbt.pokemon_obt: ROLLBACK
[0m13:04:08.024736 [debug] [Thread-2 (]: On model.nerd_facts_dbt.pokemon_obt: Close
[0m13:04:08.029502 [debug] [Thread-2 (]: Database Error in model pokemon_obt (models/marts/obt/pokemon_obt.sql)
  column t.generation_id does not exist
  LINE 40:         t.generation_id
                   ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/pokemon_obt.sql
[0m13:04:08.031526 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31c70024-a4f6-4f38-a06a-0485cef4bc79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e97ee6650>]}
[0m13:04:08.031996 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m13:04:08.033278 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:04:08.032899 [error] [Thread-2 (]: 2 of 3 ERROR creating sql table model public.pokemon_obt ....................... [[31mERROR[0m in 0.09s]
[0m13:04:08.034867 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.pokemon_obt
[0m13:04:08.034177 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.nerd_universe_obt"} */

  
    

  create  table "nerd_facts"."public"."nerd_universe_obt__dbt_tmp"
  
  
    as
  
  (
    /* 
   Master One Big Table (OBT) for Nerd Universes Data
   This model combines multiple fictional universes into a single unified table
   with a common structure for cross-universe analysis.
*/

with star_wars_characters as (
    select 
        'Star Wars' as universe,
        c.character_key as entity_key,
        c.people_id as entity_id,
        c.character_name as entity_name,
        'character' as entity_type,
        c.gender,
        c.height_cm,
        c.mass_kg as weight_kg,
        c.homeworld_name as origin_location,
        NULL as species,
        NULL as abilities,
        c.film_appearances as appears_in,
        NULL as first_appearance_date,
        'human' as creator_type
    from "nerd_facts"."public"."dim_sw_characters" c
),

pokemon_entities as (
    select
        'Pokemon' as universe,
        p.pokemon_key as entity_key,
        p.pokemon_id as entity_id,
        p.pokemon_name as entity_name,
        'pokemon' as entity_type,
        null as gender,
        p.height_m * 100 as height_cm,  -- convert to cm
        p.weight_kg,
        null as origin_location,
        p.primary_type as species,
        a.ability_name as abilities,
        null as appears_in,
        null as first_appearance_date,
        'digital' as creator_type
    from "nerd_facts"."public"."fact_pokemon" p
    left join "nerd_facts"."public"."bridge_pokemon_abilities" ba on p.pokemon_key = ba.pokemon_key
    left join "nerd_facts"."public"."dim_pokemon_abilities" a on ba.ability_key = a.ability_key
),

/* You can add more universes here as needed, following the same pattern */

-- Final Master OBT
unified_entities as (
    select * from star_wars_characters
    union all
    select * from pokemon_entities
    -- Add more universes here with UNION ALL
)

select
    universe,
    entity_key,
    entity_id,
    entity_name,
    entity_type,
    gender,
    height_cm,
    weight_kg,
    origin_location,
    species,
    abilities,
    appears_in,
    first_appearance_date,
    creator_type,
    -- Add computed/derived columns
    case
        when height_cm > 200 then 'Tall'
        when height_cm between 100 and 200 then 'Medium'
        when height_cm < 100 then 'Short'
        else 'Unknown'
    end as height_category,
    case
        when weight_kg > 100 then 'Heavy'
        when weight_kg between 50 and 100 then 'Medium'
        when weight_kg < 50 then 'Light'
        else 'Unknown'
    end as weight_category,
    current_timestamp as obt_created_at
from unified_entities
  );
  
[0m13:04:08.033793 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m13:04:08.035410 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.pokemon_obt' to be skipped because of status 'error'.  Reason: Database Error in model pokemon_obt (models/marts/obt/pokemon_obt.sql)
  column t.generation_id does not exist
  LINE 40:         t.generation_id
                   ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/pokemon_obt.sql.
[0m13:04:08.035867 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.star_wars_obt"
[0m13:04:08.036779 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column ba.pokemon_key does not exist
LINE 54: ...."bridge_pokemon_abilities" ba on p.pokemon_key = ba.pokemon...
                                                              ^
HINT:  Perhaps you meant to reference the column "p.pokemon_key".

[0m13:04:08.037739 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: ROLLBACK
[0m13:04:08.037279 [debug] [Thread-3 (]: On model.nerd_facts_dbt.star_wars_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.star_wars_obt"} */

  
    

  create  table "nerd_facts"."public"."star_wars_obt__dbt_tmp"
  
  
    as
  
  (
    /* 
   One Big Table (OBT) for Star Wars Data
   This model combines character, film, planet, and species data into a single denormalized table
   optimized for analytics and reporting.
*/

with characters as (
    select 
        c.character_key,
        c.people_id,
        c.character_name,
        c.height_cm,
        c.mass_kg,
        c.hair_color,
        c.skin_color,
        c.eye_color,
        c.birth_year,
        c.gender,
        c.homeworld_name
    from "nerd_facts"."public"."dim_sw_characters" c
),

planets as (
    select
        p.planet_key,
        p.planet_id,
        p.planet_name,
        p.rotation_period,
        p.orbital_period,
        p.diameter,
        p.climate,
        p.gravity,
        p.terrain,
        p.surface_water,
        p.population
    from "nerd_facts"."public"."dim_sw_planets" p
),

species as (
    select
        s.species_key,
        s.species_id,
        s.name as species_name,
        s.classification,
        s.designation,
        s.average_height,
        s.skin_colors,
        s.hair_colors,
        s.eye_colors,
        s.average_lifespan,
        s.language,
        s.homeworld_id
    from "nerd_facts"."public"."dim_sw_species" s
),

films as (
    select
        f.film_key,
        f.film_id,
        f.title as film_title,
        f.episode_id,
        f.opening_crawl,
        f.director,
        f.producer,
        f.release_date
    from "nerd_facts"."public"."dim_sw_films" f
),

character_films as (
    select
        cf.character_key,
        cf.film_key
    from "nerd_facts"."public"."bridge_sw_characters_films" cf
)

-- Final OBT assembly
select
    -- Character information (core entity)
    c.character_key,
    c.people_id,
    c.character_name,
    c.height_cm,
    c.mass_kg,
    c.hair_color,
    c.skin_color,
    c.eye_color,
    c.birth_year,
    c.gender,
    
    -- Planet information (denormalized)
    p.planet_key,
    p.planet_id,
    p.planet_name,
    p.climate,
    p.terrain,
    p.population,
    
    -- Species information (denormalized)
    s.species_key,
    s.species_id,
    s.species_name,
    s.classification,
    s.designation,
    s.language,
    
    -- Film information (denormalized)
    f.film_key,
    f.film_id,
    f.film_title,
    f.episode_id,
    f.director,
    f.release_date,
    
    -- Metadata
    current_timestamp as obt_created_at
from characters c
left join planets p on c.homeworld_name = p.planet_name
left join species s on s.homeworld_id::integer = p.planet_id
left join character_films cf on c.character_key = cf.character_key
left join films f on cf.film_key = f.film_key
  );
  
[0m13:04:08.038940 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: Close
[0m13:04:08.039528 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column s.name does not exist
LINE 54:         s.name as species_name,
                 ^

[0m13:04:08.039957 [debug] [Thread-3 (]: On model.nerd_facts_dbt.star_wars_obt: ROLLBACK
[0m13:04:08.041555 [debug] [Thread-3 (]: On model.nerd_facts_dbt.star_wars_obt: Close
[0m13:04:08.042822 [debug] [Thread-3 (]: Database Error in model star_wars_obt (models/marts/obt/star_wars_obt.sql)
  column s.name does not exist
  LINE 54:         s.name as species_name,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/star_wars_obt.sql
[0m13:04:08.043440 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31c70024-a4f6-4f38-a06a-0485cef4bc79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e95122440>]}
[0m13:04:08.044539 [debug] [Thread-1 (]: Database Error in model nerd_universe_obt (models/marts/obt/nerd_universe_obt.sql)
  column ba.pokemon_key does not exist
  LINE 54: ...."bridge_pokemon_abilities" ba on p.pokemon_key = ba.pokemon...
                                                                ^
  HINT:  Perhaps you meant to reference the column "p.pokemon_key".
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/nerd_universe_obt.sql
[0m13:04:08.045805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31c70024-a4f6-4f38-a06a-0485cef4bc79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e8fe72980>]}
[0m13:04:08.045267 [error] [Thread-3 (]: 3 of 3 ERROR creating sql table model public.star_wars_obt ..................... [[31mERROR[0m in 0.11s]
[0m13:04:08.046522 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.nerd_universe_obt ................. [[31mERROR[0m in 0.12s]
[0m13:04:08.047102 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.star_wars_obt
[0m13:04:08.047632 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.nerd_universe_obt
[0m13:04:08.048162 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.star_wars_obt' to be skipped because of status 'error'.  Reason: Database Error in model star_wars_obt (models/marts/obt/star_wars_obt.sql)
  column s.name does not exist
  LINE 54:         s.name as species_name,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/star_wars_obt.sql.
[0m13:04:08.048779 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.nerd_universe_obt' to be skipped because of status 'error'.  Reason: Database Error in model nerd_universe_obt (models/marts/obt/nerd_universe_obt.sql)
  column ba.pokemon_key does not exist
  LINE 54: ...."bridge_pokemon_abilities" ba on p.pokemon_key = ba.pokemon...
                                                                ^
  HINT:  Perhaps you meant to reference the column "p.pokemon_key".
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/nerd_universe_obt.sql.
[0m13:04:08.050023 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:08.050355 [debug] [MainThread]: On master: BEGIN
[0m13:04:08.050614 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:04:08.060072 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:04:08.060538 [debug] [MainThread]: On master: COMMIT
[0m13:04:08.060852 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:08.061111 [debug] [MainThread]: On master: COMMIT
[0m13:04:08.061462 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:04:08.061738 [debug] [MainThread]: On master: Close
[0m13:04:08.062236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:08.062478 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.nerd_universe_obt' was properly closed.
[0m13:04:08.062692 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.star_wars_obt' was properly closed.
[0m13:04:08.062903 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.pokemon_obt' was properly closed.
[0m13:04:08.063218 [info ] [MainThread]: 
[0m13:04:08.063770 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m13:04:08.064564 [debug] [MainThread]: Command end result
[0m13:04:08.144938 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m13:04:08.147345 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m13:04:08.153218 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m13:04:08.153708 [info ] [MainThread]: 
[0m13:04:08.154086 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m13:04:08.154382 [info ] [MainThread]: 
[0m13:04:08.154713 [error] [MainThread]:   Database Error in model pokemon_obt (models/marts/obt/pokemon_obt.sql)
  column t.generation_id does not exist
  LINE 40:         t.generation_id
                   ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/pokemon_obt.sql
[0m13:04:08.155017 [info ] [MainThread]: 
[0m13:04:08.155313 [error] [MainThread]:   Database Error in model star_wars_obt (models/marts/obt/star_wars_obt.sql)
  column s.name does not exist
  LINE 54:         s.name as species_name,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/star_wars_obt.sql
[0m13:04:08.155566 [info ] [MainThread]: 
[0m13:04:08.155881 [error] [MainThread]:   Database Error in model nerd_universe_obt (models/marts/obt/nerd_universe_obt.sql)
  column ba.pokemon_key does not exist
  LINE 54: ...."bridge_pokemon_abilities" ba on p.pokemon_key = ba.pokemon...
                                                                ^
  HINT:  Perhaps you meant to reference the column "p.pokemon_key".
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/nerd_universe_obt.sql
[0m13:04:08.156146 [info ] [MainThread]: 
[0m13:04:08.156427 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m13:04:08.157201 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.620075, "process_in_blocks": "0", "process_kernel_time": 0.135966, "process_mem_max_rss": "124504", "process_out_blocks": "11488", "process_user_time": 2.440415}
[0m13:04:08.157692 [debug] [MainThread]: Command `dbt run` failed at 13:04:08.157607 after 1.62 seconds
[0m13:04:08.158026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e97bc0c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e98cef670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e97c5ff40>]}
[0m13:04:08.158527 [debug] [MainThread]: Flushing usage events
[0m13:04:08.648895 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:05:42.299739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049e564c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049d6ede70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049d6eded0>]}


============================== 13:05:42.302512 | a230e27c-3963-4207-8624-37242e5fc883 ==============================
[0m13:05:42.302512 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:05:42.303118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select marts.obt.*', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:05:42.443750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a230e27c-3963-4207-8624-37242e5fc883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049f513af0>]}
[0m13:05:42.494030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a230e27c-3963-4207-8624-37242e5fc883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049f4dbc70>]}
[0m13:05:42.494823 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:05:42.588431 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:05:42.777245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:05:42.778785 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/obt/star_wars_obt.sql
[0m13:05:42.779253 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/obt/pokemon_obt.sql
[0m13:05:42.779722 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/obt/nerd_universe_obt.sql
[0m13:05:43.239025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a230e27c-3963-4207-8624-37242e5fc883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049aa0be50>]}
[0m13:05:43.412208 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m13:05:43.415153 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m13:05:43.500698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a230e27c-3963-4207-8624-37242e5fc883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049bf1d0f0>]}
[0m13:05:43.501447 [info ] [MainThread]: Found 106 models, 1 seed, 155 data tests, 30 sources, 633 macros
[0m13:05:43.502004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a230e27c-3963-4207-8624-37242e5fc883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049bf1c5b0>]}
[0m13:05:43.506626 [info ] [MainThread]: 
[0m13:05:43.507141 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:05:43.507624 [info ] [MainThread]: 
[0m13:05:43.508242 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:05:43.512806 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m13:05:43.530780 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m13:05:43.531246 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m13:05:43.531647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:43.543505 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m13:05:43.544959 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m13:05:43.554695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_public)
[0m13:05:43.560685 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m13:05:43.561144 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m13:05:43.561504 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:43.570909 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:05:43.571418 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m13:05:43.571850 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:05:43.574896 [debug] [ThreadPool]: SQL status: SELECT 110 in 0.003 seconds
[0m13:05:43.579236 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m13:05:43.579926 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m13:05:43.603950 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:43.604363 [debug] [MainThread]: On master: BEGIN
[0m13:05:43.604630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:05:43.614088 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:05:43.614560 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:43.614917 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:05:43.621815 [debug] [MainThread]: SQL status: SELECT 55 in 0.007 seconds
[0m13:05:43.628935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a230e27c-3963-4207-8624-37242e5fc883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049bf60700>]}
[0m13:05:43.629462 [debug] [MainThread]: On master: ROLLBACK
[0m13:05:43.630080 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:43.630404 [debug] [MainThread]: On master: BEGIN
[0m13:05:43.631038 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:05:43.631373 [debug] [MainThread]: On master: COMMIT
[0m13:05:43.631688 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:43.631937 [debug] [MainThread]: On master: COMMIT
[0m13:05:43.632357 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:05:43.632633 [debug] [MainThread]: On master: Close
[0m13:05:43.634605 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.nerd_universe_obt
[0m13:05:43.635228 [info ] [Thread-1 (]: 1 of 3 START sql table model public.nerd_universe_obt .......................... [RUN]
[0m13:05:43.635741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.nerd_universe_obt)
[0m13:05:43.636113 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.nerd_universe_obt
[0m13:05:43.644898 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.pokemon_obt
[0m13:05:43.646002 [info ] [Thread-2 (]: 2 of 3 START sql table model public.pokemon_obt ................................ [RUN]
[0m13:05:43.645381 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.star_wars_obt
[0m13:05:43.646557 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.pokemon_obt'
[0m13:05:43.647827 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.pokemon_obt
[0m13:05:43.647020 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:05:43.647470 [info ] [Thread-3 (]: 3 of 3 START sql table model public.star_wars_obt .............................. [RUN]
[0m13:05:43.651985 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.pokemon_obt"
[0m13:05:43.652803 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.star_wars_obt'
[0m13:05:43.653444 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.star_wars_obt
[0m13:05:43.658056 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.star_wars_obt"
[0m13:05:43.658671 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.pokemon_obt
[0m13:05:43.659239 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.nerd_universe_obt
[0m13:05:43.695720 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.pokemon_obt"
[0m13:05:43.696220 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.star_wars_obt
[0m13:05:43.701623 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:05:43.708835 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:05:43.707988 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.star_wars_obt"
[0m13:05:43.709355 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.pokemon_obt"
[0m13:05:43.709864 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: BEGIN
[0m13:05:43.710515 [debug] [Thread-2 (]: On model.nerd_facts_dbt.pokemon_obt: BEGIN
[0m13:05:43.710954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:43.711410 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.star_wars_obt"
[0m13:05:43.712763 [debug] [Thread-3 (]: On model.nerd_facts_dbt.star_wars_obt: BEGIN
[0m13:05:43.713216 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:05:43.711830 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:05:43.728888 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:05:43.729694 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:05:43.730346 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.nerd_universe_obt"} */

  
    

  create  table "nerd_facts"."public"."nerd_universe_obt__dbt_tmp"
  
  
    as
  
  (
    /* 
   Master One Big Table (OBT) for Nerd Universes Data
   This model combines multiple fictional universes into a single unified table
   with a common structure for cross-universe analysis.
*/

with star_wars_characters as (
    select 
        'Star Wars' as universe,
        c.character_key as entity_key,
        c.people_id as entity_id,
        c.character_name as entity_name,
        'character' as entity_type,
        c.gender,
        c.height_cm,
        c.mass_kg as weight_kg,
        c.homeworld_name as origin_location,
        NULL as species,
        NULL as abilities,
        c.film_appearances as appears_in,
        NULL as first_appearance_date,
        'human' as creator_type
    from "nerd_facts"."public"."dim_sw_characters" c
),

pokemon_entities as (
    select
        'Pokemon' as universe,
        p.pokemon_key as entity_key,
        p.pokemon_id as entity_id,
        p.pokemon_name as entity_name,
        'pokemon' as entity_type,
        null as gender,
        p.height_m * 100 as height_cm,  -- convert to cm
        p.weight_kg,
        null as origin_location,
        p.primary_type as species,
        null as abilities,
        null as appears_in,
        null as first_appearance_date,
        'digital' as creator_type
    from "nerd_facts"."public"."fact_pokemon" p
),

-- Add ability information
pokemon_with_abilities as (
    select
        pe.*,
        pa.ability_name as abilities
    from pokemon_entities pe
    left join "nerd_facts"."public"."bridge_pokemon_abilities" pa on pe.entity_id = pa.pokemon_id
)

-- Final Master OBT
select
    universe,
    entity_key,
    entity_id,
    entity_name,
    entity_type,
    gender,
    height_cm,
    weight_kg,
    origin_location,
    species,
    abilities,
    appears_in,
    first_appearance_date,
    creator_type,
    -- Add computed/derived columns
    case
        when height_cm > 200 then 'Tall'
        when height_cm between 100 and 200 then 'Medium'
        when height_cm < 100 then 'Short'
        else 'Unknown'
    end as height_category,
    case
        when weight_kg > 100 then 'Heavy'
        when weight_kg between 50 and 100 then 'Medium'
        when weight_kg < 50 then 'Light'
        else 'Unknown'
    end as weight_category,
    current_timestamp as obt_created_at
from (
    select * from star_wars_characters
    union all
    select * from pokemon_with_abilities
) as unified_entities
  );
  
[0m13:05:43.732111 [debug] [Thread-1 (]: Postgres adapter: Postgres error: each UNION query must have the same number of columns
LINE 98:     select * from pokemon_with_abilities
                    ^

[0m13:05:43.734844 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: ROLLBACK
[0m13:05:43.737120 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: Close
[0m13:05:43.735511 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m13:05:43.737842 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.star_wars_obt"
[0m13:05:43.738453 [debug] [Thread-3 (]: On model.nerd_facts_dbt.star_wars_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.star_wars_obt"} */

  
    

  create  table "nerd_facts"."public"."star_wars_obt__dbt_tmp"
  
  
    as
  
  (
    /* 
   One Big Table (OBT) for Star Wars Data
   This model combines character, film, planet, and species data into a single denormalized table
   optimized for analytics and reporting.
*/

with characters as (
    select 
        c.character_key,
        c.people_id,
        c.character_name,
        c.height_cm,
        c.mass_kg,
        c.hair_color,
        c.skin_color,
        c.eye_color,
        c.birth_year,
        c.gender,
        c.homeworld_name
    from "nerd_facts"."public"."dim_sw_characters" c
),

planets as (
    select
        p.planet_key,
        p.planet_id,
        p.planet_name,
        p.rotation_period,
        p.orbital_period,
        p.diameter,
        p.climate,
        p.gravity,
        p.terrain,
        p.surface_water,
        p.population
    from "nerd_facts"."public"."dim_sw_planets" p
),

species as (
    select
        s.species_key,
        s.species_id,
        s.name as species_name,
        s.classification,
        s.designation,
        s.average_height,
        s.skin_colors,
        s.hair_colors,
        s.eye_colors,
        s.average_lifespan,
        s.language,
        s.homeworld_id
    from "nerd_facts"."public"."dim_sw_species" s
),

films as (
    select
        f.film_key,
        f.film_id,
        f.title as film_title,
        f.episode_id,
        f.opening_crawl,
        f.director,
        f.producer,
        f.release_date
    from "nerd_facts"."public"."dim_sw_films" f
),

character_films as (
    select
        cf.character_key,
        cf.film_key
    from "nerd_facts"."public"."bridge_sw_characters_films" cf
)

-- Final OBT assembly
select
    -- Character information (core entity)
    c.character_key,
    c.people_id,
    c.character_name,
    c.height_cm,
    c.mass_kg,
    c.hair_color,
    c.skin_color,
    c.eye_color,
    c.birth_year,
    c.gender,
    
    -- Planet information (denormalized)
    p.planet_key,
    p.planet_id,
    p.planet_name,
    p.climate,
    p.terrain,
    p.population,
    
    -- Film information (denormalized)
    f.film_key,
    f.film_id,
    f.film_title,
    f.episode_id,
    f.director,
    f.release_date,
    
    -- Metadata
    current_timestamp as obt_created_at
from characters c
left join planets p on c.homeworld_name = p.planet_name
left join character_films cf on c.character_key = cf.character_key
left join films f on cf.film_key = f.film_key
  );
  
[0m13:05:43.739928 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column s.name does not exist
LINE 54:         s.name as species_name,
                 ^

[0m13:05:43.740481 [debug] [Thread-3 (]: On model.nerd_facts_dbt.star_wars_obt: ROLLBACK
[0m13:05:43.741591 [debug] [Thread-3 (]: On model.nerd_facts_dbt.star_wars_obt: Close
[0m13:05:43.743719 [debug] [Thread-1 (]: Database Error in model nerd_universe_obt (models/marts/obt/nerd_universe_obt.sql)
  each UNION query must have the same number of columns
  LINE 98:     select * from pokemon_with_abilities
                      ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/nerd_universe_obt.sql
[0m13:05:43.744365 [debug] [Thread-2 (]: SQL status: BEGIN in 0.032 seconds
[0m13:05:43.747004 [debug] [Thread-3 (]: Database Error in model star_wars_obt (models/marts/obt/star_wars_obt.sql)
  column s.name does not exist
  LINE 54:         s.name as species_name,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/star_wars_obt.sql
[0m13:05:43.747412 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.pokemon_obt"
[0m13:05:43.748913 [debug] [Thread-2 (]: On model.nerd_facts_dbt.pokemon_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon_obt"} */

  
    

  create  table "nerd_facts"."public"."pokemon_obt__dbt_tmp"
  
  
    as
  
  (
    /* 
   One Big Table (OBT) for Pok√©mon Data
   This model combines pokemon, types, abilities, and stats into a single denormalized table
   optimized for analytics and reporting.
*/

with pokemon as (
    select 
        p.pokemon_key,
        p.pokemon_id,
        p.pokemon_name,
        p.height_m,
        p.weight_kg,
        p.base_xp as base_experience,
        p.primary_type,
        p.secondary_type,
        p.primary_type_key,
        p.secondary_type_key,
        p.base_stat_hp,
        p.total_base_stats
    from "nerd_facts"."public"."fact_pokemon" p
),

types as (
    select
        t.type_key,
        t.type_id,
        t.type_name
    from "nerd_facts"."public"."dim_pokemon_types" t
),

pokemon_abilities as (
    select
        pa.pokemon_ability_id,
        pa.pokemon_id,
        pa.ability_name,
        pa.is_hidden,
        pa.slot_number
    from "nerd_facts"."public"."bridge_pokemon_abilities" pa
),

pokemon_stats as (
    select
        ps.pokemon_id,
        ps.stat_name,
        ps.base_stat,
        ps.effort
    from "nerd_facts"."public"."fact_pokemon_stats" ps
)

-- Final OBT assembly
select
    -- Pokemon information (core entity)
    p.pokemon_key,
    p.pokemon_id,
    p.pokemon_name,
    p.height_m,
    p.weight_kg,
    p.base_experience,
    p.base_stat_hp,
    p.total_base_stats,
    
    -- Type information (denormalized)
    p.primary_type as primary_type_name,
    p.secondary_type as secondary_type_name,
    
    -- Ability information (denormalized)
    pa.ability_name,
    pa.is_hidden,
    pa.slot_number,
    
    -- Stat information (denormalized with values)
    ps.stat_name,
    ps.base_stat,
    ps.effort,
    
    -- Metadata
    current_timestamp as obt_created_at
from pokemon p
left join pokemon_abilities pa on p.pokemon_id = pa.pokemon_id
left join pokemon_stats ps on p.pokemon_id = ps.pokemon_id
  );
  
[0m13:05:43.748429 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a230e27c-3963-4207-8624-37242e5fc883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049aa4e230>]}
[0m13:05:43.747934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a230e27c-3963-4207-8624-37242e5fc883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049e886ce0>]}
[0m13:05:43.750762 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column ps.stat_name does not exist
LINE 56:         ps.stat_name,
                 ^

[0m13:05:43.752019 [debug] [Thread-2 (]: On model.nerd_facts_dbt.pokemon_obt: ROLLBACK
[0m13:05:43.752709 [debug] [Thread-2 (]: On model.nerd_facts_dbt.pokemon_obt: Close
[0m13:05:43.751613 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.nerd_universe_obt ................. [[31mERROR[0m in 0.11s]
[0m13:05:43.753515 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.nerd_universe_obt
[0m13:05:43.755447 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.nerd_universe_obt' to be skipped because of status 'error'.  Reason: Database Error in model nerd_universe_obt (models/marts/obt/nerd_universe_obt.sql)
  each UNION query must have the same number of columns
  LINE 98:     select * from pokemon_with_abilities
                      ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/nerd_universe_obt.sql.
[0m13:05:43.750373 [error] [Thread-3 (]: 3 of 3 ERROR creating sql table model public.star_wars_obt ..................... [[31mERROR[0m in 0.10s]
[0m13:05:43.756799 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.star_wars_obt
[0m13:05:43.757498 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.star_wars_obt' to be skipped because of status 'error'.  Reason: Database Error in model star_wars_obt (models/marts/obt/star_wars_obt.sql)
  column s.name does not exist
  LINE 54:         s.name as species_name,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/star_wars_obt.sql.
[0m13:05:43.758550 [debug] [Thread-2 (]: Database Error in model pokemon_obt (models/marts/obt/pokemon_obt.sql)
  column ps.stat_name does not exist
  LINE 56:         ps.stat_name,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/pokemon_obt.sql
[0m13:05:43.759075 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a230e27c-3963-4207-8624-37242e5fc883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049af59f00>]}
[0m13:05:43.759792 [error] [Thread-2 (]: 2 of 3 ERROR creating sql table model public.pokemon_obt ....................... [[31mERROR[0m in 0.11s]
[0m13:05:43.760408 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.pokemon_obt
[0m13:05:43.760912 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.pokemon_obt' to be skipped because of status 'error'.  Reason: Database Error in model pokemon_obt (models/marts/obt/pokemon_obt.sql)
  column ps.stat_name does not exist
  LINE 56:         ps.stat_name,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/pokemon_obt.sql.
[0m13:05:43.762236 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:43.762618 [debug] [MainThread]: On master: BEGIN
[0m13:05:43.762941 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:05:43.773502 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:05:43.774112 [debug] [MainThread]: On master: COMMIT
[0m13:05:43.774604 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:43.774941 [debug] [MainThread]: On master: COMMIT
[0m13:05:43.775409 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:05:43.775891 [debug] [MainThread]: On master: Close
[0m13:05:43.776596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:43.776983 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.nerd_universe_obt' was properly closed.
[0m13:05:43.777352 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.pokemon_obt' was properly closed.
[0m13:05:43.777719 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.star_wars_obt' was properly closed.
[0m13:05:43.778213 [info ] [MainThread]: 
[0m13:05:43.778929 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m13:05:43.779986 [debug] [MainThread]: Command end result
[0m13:05:43.891719 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m13:05:43.894177 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m13:05:43.900376 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m13:05:43.900763 [info ] [MainThread]: 
[0m13:05:43.901120 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m13:05:43.901431 [info ] [MainThread]: 
[0m13:05:43.901787 [error] [MainThread]:   Database Error in model nerd_universe_obt (models/marts/obt/nerd_universe_obt.sql)
  each UNION query must have the same number of columns
  LINE 98:     select * from pokemon_with_abilities
                      ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/nerd_universe_obt.sql
[0m13:05:43.902068 [info ] [MainThread]: 
[0m13:05:43.902375 [error] [MainThread]:   Database Error in model star_wars_obt (models/marts/obt/star_wars_obt.sql)
  column s.name does not exist
  LINE 54:         s.name as species_name,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/star_wars_obt.sql
[0m13:05:43.902636 [info ] [MainThread]: 
[0m13:05:43.902944 [error] [MainThread]:   Database Error in model pokemon_obt (models/marts/obt/pokemon_obt.sql)
  column ps.stat_name does not exist
  LINE 56:         ps.stat_name,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/pokemon_obt.sql
[0m13:05:43.903248 [info ] [MainThread]: 
[0m13:05:43.903561 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m13:05:43.904458 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6500694, "process_in_blocks": "0", "process_kernel_time": 0.10749, "process_mem_max_rss": "124052", "process_out_blocks": "11472", "process_user_time": 2.463245}
[0m13:05:43.905052 [debug] [MainThread]: Command `dbt run` failed at 13:05:43.904950 after 1.65 seconds
[0m13:05:43.905474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049e564c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049a8905b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049bfc8580>]}
[0m13:05:43.905857 [debug] [MainThread]: Flushing usage events
[0m13:05:44.349372 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:07:30.600452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba0944be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9facde70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9facded0>]}


============================== 13:07:30.603055 | 7871c229-a66d-4963-8a69-fcdfc6d7fd2a ==============================
[0m13:07:30.603055 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:07:30.603574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select marts.obt.*', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:07:30.742457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7871c229-a66d-4963-8a69-fcdfc6d7fd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba18f7a90>]}
[0m13:07:30.792561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7871c229-a66d-4963-8a69-fcdfc6d7fd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba18bfc70>]}
[0m13:07:30.793351 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:07:30.886343 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:07:31.087501 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:07:31.089263 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/obt/star_wars_obt.sql
[0m13:07:31.089821 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/obt/nerd_universe_obt.sql
[0m13:07:31.090270 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/obt/pokemon_obt.sql
[0m13:07:31.561019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7871c229-a66d-4963-8a69-fcdfc6d7fd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9ce47ee0>]}
[0m13:07:31.748628 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m13:07:31.751542 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m13:07:31.835104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7871c229-a66d-4963-8a69-fcdfc6d7fd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba0945510>]}
[0m13:07:31.835824 [info ] [MainThread]: Found 106 models, 1 seed, 155 data tests, 30 sources, 633 macros
[0m13:07:31.836354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7871c229-a66d-4963-8a69-fcdfc6d7fd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba0947580>]}
[0m13:07:31.840988 [info ] [MainThread]: 
[0m13:07:31.841482 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:07:31.841949 [info ] [MainThread]: 
[0m13:07:31.842579 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:07:31.847085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m13:07:31.866322 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m13:07:31.866868 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m13:07:31.867256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:31.878445 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m13:07:31.880068 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m13:07:31.890343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_public)
[0m13:07:31.896354 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m13:07:31.896808 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m13:07:31.897168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:07:31.906596 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:07:31.907105 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m13:07:31.907494 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:07:31.910617 [debug] [ThreadPool]: SQL status: SELECT 110 in 0.003 seconds
[0m13:07:31.913952 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m13:07:31.914547 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m13:07:31.940452 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:31.940917 [debug] [MainThread]: On master: BEGIN
[0m13:07:31.941266 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:07:31.950825 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:07:31.951313 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:31.951758 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:07:31.959413 [debug] [MainThread]: SQL status: SELECT 55 in 0.007 seconds
[0m13:07:31.967806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7871c229-a66d-4963-8a69-fcdfc6d7fd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9e3a96f0>]}
[0m13:07:31.968379 [debug] [MainThread]: On master: ROLLBACK
[0m13:07:31.968928 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:31.969270 [debug] [MainThread]: On master: BEGIN
[0m13:07:31.969893 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:07:31.970251 [debug] [MainThread]: On master: COMMIT
[0m13:07:31.970574 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:31.970876 [debug] [MainThread]: On master: COMMIT
[0m13:07:31.971317 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:07:31.971681 [debug] [MainThread]: On master: Close
[0m13:07:31.975825 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.nerd_universe_obt
[0m13:07:31.976298 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.pokemon_obt
[0m13:07:31.977131 [info ] [Thread-1 (]: 1 of 3 START sql table model public.nerd_universe_obt .......................... [RUN]
[0m13:07:31.977709 [info ] [Thread-3 (]: 2 of 3 START sql table model public.pokemon_obt ................................ [RUN]
[0m13:07:31.979377 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.pokemon_obt'
[0m13:07:31.978846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.nerd_universe_obt)
[0m13:07:31.979769 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.pokemon_obt
[0m13:07:31.978296 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.star_wars_obt
[0m13:07:31.980172 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.nerd_universe_obt
[0m13:07:31.988514 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.pokemon_obt"
[0m13:07:31.993155 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:07:31.993926 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.pokemon_obt
[0m13:07:31.989260 [info ] [Thread-2 (]: 3 of 3 START sql table model public.star_wars_obt .............................. [RUN]
[0m13:07:32.017654 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.star_wars_obt'
[0m13:07:32.034153 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.star_wars_obt
[0m13:07:32.043245 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.star_wars_obt"
[0m13:07:32.038452 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.pokemon_obt"
[0m13:07:32.023821 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.nerd_universe_obt
[0m13:07:32.044274 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.pokemon_obt"
[0m13:07:32.051177 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:07:32.051708 [debug] [Thread-3 (]: On model.nerd_facts_dbt.pokemon_obt: BEGIN
[0m13:07:32.052234 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.star_wars_obt
[0m13:07:32.052867 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:07:32.057564 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.star_wars_obt"
[0m13:07:32.058662 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:07:32.059878 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: BEGIN
[0m13:07:32.060304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:32.059359 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.star_wars_obt"
[0m13:07:32.062194 [debug] [Thread-2 (]: On model.nerd_facts_dbt.star_wars_obt: BEGIN
[0m13:07:32.062661 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:07:32.069736 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m13:07:32.070260 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.pokemon_obt"
[0m13:07:32.071260 [debug] [Thread-3 (]: On model.nerd_facts_dbt.pokemon_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon_obt"} */

  
    

  create  table "nerd_facts"."public"."pokemon_obt__dbt_tmp"
  
  
    as
  
  (
    /* 
   One Big Table (OBT) for Pok√©mon Data
   This model combines pokemon, types, abilities, and stats into a single denormalized table
   optimized for analytics and reporting.
*/

with pokemon as (
    select 
        p.pokemon_key,
        p.pokemon_id,
        p.pokemon_name,
        p.height_m,
        p.weight_kg,
        p.base_xp as base_experience,
        p.primary_type,
        p.secondary_type,
        p.primary_type_key,
        p.secondary_type_key,
        p.base_stat_hp,
        p.total_base_stats
    from "nerd_facts"."public"."fact_pokemon" p
),

types as (
    select
        t.type_key,
        t.type_id,
        t.type_name
    from "nerd_facts"."public"."dim_pokemon_types" t
),

pokemon_abilities as (
    select
        pa.pokemon_ability_id,
        pa.pokemon_id,
        pa.ability_name,
        pa.is_hidden,
        pa.slot_number
    from "nerd_facts"."public"."bridge_pokemon_abilities" pa
)

-- Final OBT assembly
select
    -- Pokemon information (core entity)
    p.pokemon_key,
    p.pokemon_id,
    p.pokemon_name,
    p.height_m,
    p.weight_kg,
    p.base_experience,
    p.base_stat_hp,
    p.total_base_stats,
    
    -- Type information (denormalized)
    p.primary_type as primary_type_name,
    p.secondary_type as secondary_type_name,
    
    -- Ability information (denormalized)
    pa.ability_name,
    pa.is_hidden,
    pa.slot_number,
    
    -- Metadata
    current_timestamp as obt_created_at
from pokemon p
left join pokemon_abilities pa on p.pokemon_id = pa.pokemon_id
  );
  
[0m13:07:32.077005 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:07:32.077583 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:07:32.078041 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.nerd_universe_obt"} */

  
    

  create  table "nerd_facts"."public"."nerd_universe_obt__dbt_tmp"
  
  
    as
  
  (
    /* 
   Master One Big Table (OBT) for Nerd Universes Data
   This model combines multiple fictional universes into a single unified table
   with a common structure for cross-universe analysis.
*/

with star_wars_characters as (
    select 
        'Star Wars' as universe,
        c.character_key as entity_key,
        c.people_id as entity_id,
        c.character_name as entity_name,
        'character' as entity_type,
        c.gender,
        c.height_cm,
        c.mass_kg as weight_kg,
        c.homeworld_name as origin_location,
        NULL as species,
        NULL as abilities,
        c.film_appearances as appears_in,
        NULL as first_appearance_date,
        'human' as creator_type
    from "nerd_facts"."public"."dim_sw_characters" c
),

pokemon_entities as (
    select
        'Pokemon' as universe,
        p.pokemon_key as entity_key,
        p.pokemon_id as entity_id,
        p.pokemon_name as entity_name,
        'pokemon' as entity_type,
        null as gender,
        p.height_m * 100 as height_cm,  -- convert to cm
        p.weight_kg,
        null as origin_location,
        p.primary_type as species,
        null as abilities,
        null as appears_in,
        null as first_appearance_date,
        'digital' as creator_type
    from "nerd_facts"."public"."fact_pokemon" p
)

-- Final Master OBT
select
    universe,
    entity_key,
    entity_id,
    entity_name,
    entity_type,
    gender,
    height_cm,
    weight_kg,
    origin_location,
    species,
    abilities,
    appears_in,
    first_appearance_date,
    creator_type,
    -- Add computed/derived columns
    case
        when height_cm > 200 then 'Tall'
        when height_cm between 100 and 200 then 'Medium'
        when height_cm < 100 then 'Short'
        else 'Unknown'
    end as height_category,
    case
        when weight_kg > 100 then 'Heavy'
        when weight_kg between 50 and 100 then 'Medium'
        when weight_kg < 50 then 'Light'
        else 'Unknown'
    end as weight_category,
    current_timestamp as obt_created_at
from (
    select * from star_wars_characters
    union all
    select * from pokemon_entities
) as unified_entities
  );
  
[0m13:07:32.078548 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m13:07:32.078855 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.star_wars_obt"
[0m13:07:32.079193 [debug] [Thread-2 (]: On model.nerd_facts_dbt.star_wars_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.star_wars_obt"} */

  
    

  create  table "nerd_facts"."public"."star_wars_obt__dbt_tmp"
  
  
    as
  
  (
    /* 
   One Big Table (OBT) for Star Wars Data
   This model combines character, film, planet, and species data into a single denormalized table
   optimized for analytics and reporting.
*/

with characters as (
    select 
        c.character_key,
        c.people_id,
        c.character_name,
        c.height_cm,
        c.mass_kg,
        c.hair_color,
        c.skin_color,
        c.eye_color,
        c.birth_year,
        c.gender,
        c.homeworld_name
    from "nerd_facts"."public"."dim_sw_characters" c
),

planets as (
    select
        p.planet_key,
        p.planet_id,
        p.planet_name,
        p.rotation_period,
        p.orbital_period,
        p.diameter,
        p.climate,
        p.gravity,
        p.terrain,
        p.surface_water,
        p.population
    from "nerd_facts"."public"."dim_sw_planets" p
),

species as (
    select
        s.species_key,
        s.species_id,
        s.species_name,
        s.classification,
        s.designation,
        s.average_height,
        s.skin_colors,
        s.hair_colors,
        s.eye_colors,
        s.average_lifespan,
        s.language,
        s.homeworld_id
    from "nerd_facts"."public"."dim_sw_species" s
),

films as (
    select
        f.film_key,
        f.film_id,
        f.title as film_title,
        f.episode_id,
        f.opening_crawl,
        f.director,
        f.producer,
        f.release_date
    from "nerd_facts"."public"."dim_sw_films" f
),

character_films as (
    select
        cf.character_key,
        cf.film_key
    from "nerd_facts"."public"."bridge_sw_characters_films" cf
)

-- Final OBT assembly
select
    -- Character information (core entity)
    c.character_key,
    c.people_id,
    c.character_name,
    c.height_cm,
    c.mass_kg,
    c.hair_color,
    c.skin_color,
    c.eye_color,
    c.birth_year,
    c.gender,
    
    -- Planet information (denormalized)
    p.planet_key,
    p.planet_id,
    p.planet_name,
    p.climate,
    p.terrain,
    p.population,
    
    -- Film information (denormalized)
    f.film_key,
    f.film_id,
    f.film_title,
    f.episode_id,
    f.director,
    f.release_date,
    
    -- Metadata
    current_timestamp as obt_created_at
from characters c
left join planets p on c.homeworld_name = p.planet_name
left join character_films cf on c.character_key = cf.character_key
left join films f on cf.film_key = f.film_key
  );
  
[0m13:07:32.080328 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column f.title does not exist
LINE 71:         f.title as film_title,
                 ^

[0m13:07:32.080720 [debug] [Thread-2 (]: On model.nerd_facts_dbt.star_wars_obt: ROLLBACK
[0m13:07:32.081226 [debug] [Thread-2 (]: On model.nerd_facts_dbt.star_wars_obt: Close
[0m13:07:32.085103 [debug] [Thread-2 (]: Database Error in model star_wars_obt (models/marts/obt/star_wars_obt.sql)
  column f.title does not exist
  LINE 71:         f.title as film_title,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/star_wars_obt.sql
[0m13:07:32.086876 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7871c229-a66d-4963-8a69-fcdfc6d7fd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9ce43580>]}
[0m13:07:32.087982 [debug] [Thread-3 (]: SQL status: SELECT 1302 in 0.016 seconds
[0m13:07:32.087613 [error] [Thread-2 (]: 3 of 3 ERROR creating sql table model public.star_wars_obt ..................... [[31mERROR[0m in 0.07s]
[0m13:07:32.095203 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.star_wars_obt
[0m13:07:32.097663 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.pokemon_obt"
[0m13:07:32.098274 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.star_wars_obt' to be skipped because of status 'error'.  Reason: Database Error in model star_wars_obt (models/marts/obt/star_wars_obt.sql)
  column f.title does not exist
  LINE 71:         f.title as film_title,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/star_wars_obt.sql.
[0m13:07:32.098684 [debug] [Thread-1 (]: SQL status: SELECT 1384 in 0.020 seconds
[0m13:07:32.099084 [debug] [Thread-3 (]: On model.nerd_facts_dbt.pokemon_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon_obt"} */
alter table "nerd_facts"."public"."pokemon_obt__dbt_tmp" rename to "pokemon_obt"
[0m13:07:32.102722 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:07:32.103546 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:07:32.103966 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.nerd_universe_obt"} */
alter table "nerd_facts"."public"."nerd_universe_obt__dbt_tmp" rename to "nerd_universe_obt"
[0m13:07:32.119376 [debug] [Thread-3 (]: On model.nerd_facts_dbt.pokemon_obt: COMMIT
[0m13:07:32.120423 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:07:32.120823 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.pokemon_obt"
[0m13:07:32.122168 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: COMMIT
[0m13:07:32.122576 [debug] [Thread-3 (]: On model.nerd_facts_dbt.pokemon_obt: COMMIT
[0m13:07:32.122960 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:07:32.124172 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: COMMIT
[0m13:07:32.130230 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m13:07:32.137134 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m13:07:32.136934 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."pokemon_obt__dbt_backup"
[0m13:07:32.140199 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."nerd_universe_obt__dbt_backup"
[0m13:07:32.144355 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.pokemon_obt"
[0m13:07:32.145135 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:07:32.145584 [debug] [Thread-3 (]: On model.nerd_facts_dbt.pokemon_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon_obt"} */
drop table if exists "nerd_facts"."public"."pokemon_obt__dbt_backup" cascade
[0m13:07:32.146111 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.nerd_universe_obt"} */
drop table if exists "nerd_facts"."public"."nerd_universe_obt__dbt_backup" cascade
[0m13:07:32.146806 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:07:32.147361 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:07:32.149657 [debug] [Thread-3 (]: On model.nerd_facts_dbt.pokemon_obt: Close
[0m13:07:32.151017 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: Close
[0m13:07:32.151815 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7871c229-a66d-4963-8a69-fcdfc6d7fd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba1d12e60>]}
[0m13:07:32.154231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7871c229-a66d-4963-8a69-fcdfc6d7fd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9cdc9180>]}
[0m13:07:32.154983 [info ] [Thread-3 (]: 2 of 3 OK created sql table model public.pokemon_obt ........................... [[32mSELECT 1302[0m in 0.17s]
[0m13:07:32.155809 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.nerd_universe_obt ..................... [[32mSELECT 1384[0m in 0.18s]
[0m13:07:32.156667 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.pokemon_obt
[0m13:07:32.157176 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.nerd_universe_obt
[0m13:07:32.159388 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:32.159827 [debug] [MainThread]: On master: BEGIN
[0m13:07:32.160106 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:07:32.169407 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:07:32.169965 [debug] [MainThread]: On master: COMMIT
[0m13:07:32.170298 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:32.170558 [debug] [MainThread]: On master: COMMIT
[0m13:07:32.170926 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:07:32.171202 [debug] [MainThread]: On master: Close
[0m13:07:32.171764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:32.172034 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.nerd_universe_obt' was properly closed.
[0m13:07:32.172262 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.pokemon_obt' was properly closed.
[0m13:07:32.172479 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.star_wars_obt' was properly closed.
[0m13:07:32.172809 [info ] [MainThread]: 
[0m13:07:32.173113 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m13:07:32.174093 [debug] [MainThread]: Command end result
[0m13:07:32.274921 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m13:07:32.277353 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m13:07:32.283356 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m13:07:32.283817 [info ] [MainThread]: 
[0m13:07:32.284287 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:07:32.284682 [info ] [MainThread]: 
[0m13:07:32.285111 [error] [MainThread]:   Database Error in model star_wars_obt (models/marts/obt/star_wars_obt.sql)
  column f.title does not exist
  LINE 71:         f.title as film_title,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/marts/obt/star_wars_obt.sql
[0m13:07:32.285484 [info ] [MainThread]: 
[0m13:07:32.285873 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:07:32.286767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7321621, "process_in_blocks": "0", "process_kernel_time": 0.140824, "process_mem_max_rss": "124512", "process_out_blocks": "11480", "process_user_time": 2.530887}
[0m13:07:32.287404 [debug] [MainThread]: Command `dbt run` failed at 13:07:32.287275 after 1.73 seconds
[0m13:07:32.287938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba18f7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba09feec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9cd538e0>]}
[0m13:07:32.288467 [debug] [MainThread]: Flushing usage events
[0m13:07:32.723941 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:08:13.006492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2022e60bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2021fcd300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2023ddbe20>]}


============================== 13:08:13.009074 | b91e870b-4e07-4027-9f7c-f7b290e749f9 ==============================
[0m13:08:13.009074 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:08:13.009729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select marts.obt.*', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:08:13.161433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b91e870b-4e07-4027-9f7c-f7b290e749f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2023f8e8f0>]}
[0m13:08:13.215786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b91e870b-4e07-4027-9f7c-f7b290e749f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2021fce500>]}
[0m13:08:13.216645 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:08:13.330760 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:08:13.527892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:08:13.529645 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/obt/star_wars_obt.sql
[0m13:08:14.000222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b91e870b-4e07-4027-9f7c-f7b290e749f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201f297e50>]}
[0m13:08:14.159072 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m13:08:14.161846 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m13:08:14.240983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b91e870b-4e07-4027-9f7c-f7b290e749f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2020bc0940>]}
[0m13:08:14.241676 [info ] [MainThread]: Found 106 models, 1 seed, 155 data tests, 30 sources, 633 macros
[0m13:08:14.242094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b91e870b-4e07-4027-9f7c-f7b290e749f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2023468ac0>]}
[0m13:08:14.245709 [info ] [MainThread]: 
[0m13:08:14.246083 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:08:14.246352 [info ] [MainThread]: 
[0m13:08:14.246811 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:08:14.250735 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m13:08:14.269028 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m13:08:14.269688 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m13:08:14.270030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:14.281173 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m13:08:14.282511 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m13:08:14.289337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_public)
[0m13:08:14.295284 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m13:08:14.295942 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m13:08:14.296482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:08:14.309228 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m13:08:14.309741 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m13:08:14.310045 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:08:14.313340 [debug] [ThreadPool]: SQL status: SELECT 112 in 0.003 seconds
[0m13:08:14.317700 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m13:08:14.318612 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m13:08:14.346325 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:14.346875 [debug] [MainThread]: On master: BEGIN
[0m13:08:14.347260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:08:14.357363 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:08:14.357975 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:14.358433 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:08:14.366281 [debug] [MainThread]: SQL status: SELECT 55 in 0.007 seconds
[0m13:08:14.375381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b91e870b-4e07-4027-9f7c-f7b290e749f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20226cfeb0>]}
[0m13:08:14.376127 [debug] [MainThread]: On master: ROLLBACK
[0m13:08:14.376798 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:14.377209 [debug] [MainThread]: On master: BEGIN
[0m13:08:14.377875 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:08:14.378248 [debug] [MainThread]: On master: COMMIT
[0m13:08:14.378605 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:14.378931 [debug] [MainThread]: On master: COMMIT
[0m13:08:14.379443 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:08:14.379813 [debug] [MainThread]: On master: Close
[0m13:08:14.383314 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.nerd_universe_obt
[0m13:08:14.383904 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.pokemon_obt
[0m13:08:14.384354 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.star_wars_obt
[0m13:08:14.385019 [info ] [Thread-1 (]: 1 of 3 START sql table model public.nerd_universe_obt .......................... [RUN]
[0m13:08:14.385642 [info ] [Thread-2 (]: 2 of 3 START sql table model public.pokemon_obt ................................ [RUN]
[0m13:08:14.387534 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.pokemon_obt'
[0m13:08:14.386986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.nerd_universe_obt)
[0m13:08:14.388351 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.nerd_universe_obt
[0m13:08:14.386376 [info ] [Thread-3 (]: 3 of 3 START sql table model public.star_wars_obt .............................. [RUN]
[0m13:08:14.387980 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.pokemon_obt
[0m13:08:14.398365 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:08:14.399260 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.star_wars_obt'
[0m13:08:14.403229 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.pokemon_obt"
[0m13:08:14.404002 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.star_wars_obt
[0m13:08:14.409232 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.star_wars_obt"
[0m13:08:14.404662 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.nerd_universe_obt
[0m13:08:14.410255 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.star_wars_obt
[0m13:08:14.410674 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.pokemon_obt
[0m13:08:14.472651 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.star_wars_obt"
[0m13:08:14.474224 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.pokemon_obt"
[0m13:08:14.477828 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:08:14.478894 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.pokemon_obt"
[0m13:08:14.479607 [debug] [Thread-2 (]: On model.nerd_facts_dbt.pokemon_obt: BEGIN
[0m13:08:14.480231 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:08:14.480643 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:08:14.481222 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.star_wars_obt"
[0m13:08:14.482615 [debug] [Thread-3 (]: On model.nerd_facts_dbt.star_wars_obt: BEGIN
[0m13:08:14.482997 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:08:14.481576 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: BEGIN
[0m13:08:14.484369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:08:14.494571 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m13:08:14.495118 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:08:14.495501 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.nerd_universe_obt"} */

  
    

  create  table "nerd_facts"."public"."nerd_universe_obt__dbt_tmp"
  
  
    as
  
  (
    /* 
   Master One Big Table (OBT) for Nerd Universes Data
   This model combines multiple fictional universes into a single unified table
   with a common structure for cross-universe analysis.
*/

with star_wars_characters as (
    select 
        'Star Wars' as universe,
        c.character_key as entity_key,
        c.people_id as entity_id,
        c.character_name as entity_name,
        'character' as entity_type,
        c.gender,
        c.height_cm,
        c.mass_kg as weight_kg,
        c.homeworld_name as origin_location,
        NULL as species,
        NULL as abilities,
        c.film_appearances as appears_in,
        NULL as first_appearance_date,
        'human' as creator_type
    from "nerd_facts"."public"."dim_sw_characters" c
),

pokemon_entities as (
    select
        'Pokemon' as universe,
        p.pokemon_key as entity_key,
        p.pokemon_id as entity_id,
        p.pokemon_name as entity_name,
        'pokemon' as entity_type,
        null as gender,
        p.height_m * 100 as height_cm,  -- convert to cm
        p.weight_kg,
        null as origin_location,
        p.primary_type as species,
        null as abilities,
        null as appears_in,
        null as first_appearance_date,
        'digital' as creator_type
    from "nerd_facts"."public"."fact_pokemon" p
)

-- Final Master OBT
select
    universe,
    entity_key,
    entity_id,
    entity_name,
    entity_type,
    gender,
    height_cm,
    weight_kg,
    origin_location,
    species,
    abilities,
    appears_in,
    first_appearance_date,
    creator_type,
    -- Add computed/derived columns
    case
        when height_cm > 200 then 'Tall'
        when height_cm between 100 and 200 then 'Medium'
        when height_cm < 100 then 'Short'
        else 'Unknown'
    end as height_category,
    case
        when weight_kg > 100 then 'Heavy'
        when weight_kg between 50 and 100 then 'Medium'
        when weight_kg < 50 then 'Light'
        else 'Unknown'
    end as weight_category,
    current_timestamp as obt_created_at
from (
    select * from star_wars_characters
    union all
    select * from pokemon_entities
) as unified_entities
  );
  
[0m13:08:14.501703 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m13:08:14.502374 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.pokemon_obt"
[0m13:08:14.502770 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m13:08:14.503232 [debug] [Thread-2 (]: On model.nerd_facts_dbt.pokemon_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon_obt"} */

  
    

  create  table "nerd_facts"."public"."pokemon_obt__dbt_tmp"
  
  
    as
  
  (
    /* 
   One Big Table (OBT) for Pok√©mon Data
   This model combines pokemon, types, abilities, and stats into a single denormalized table
   optimized for analytics and reporting.
*/

with pokemon as (
    select 
        p.pokemon_key,
        p.pokemon_id,
        p.pokemon_name,
        p.height_m,
        p.weight_kg,
        p.base_xp as base_experience,
        p.primary_type,
        p.secondary_type,
        p.primary_type_key,
        p.secondary_type_key,
        p.base_stat_hp,
        p.total_base_stats
    from "nerd_facts"."public"."fact_pokemon" p
),

types as (
    select
        t.type_key,
        t.type_id,
        t.type_name
    from "nerd_facts"."public"."dim_pokemon_types" t
),

pokemon_abilities as (
    select
        pa.pokemon_ability_id,
        pa.pokemon_id,
        pa.ability_name,
        pa.is_hidden,
        pa.slot_number
    from "nerd_facts"."public"."bridge_pokemon_abilities" pa
)

-- Final OBT assembly
select
    -- Pokemon information (core entity)
    p.pokemon_key,
    p.pokemon_id,
    p.pokemon_name,
    p.height_m,
    p.weight_kg,
    p.base_experience,
    p.base_stat_hp,
    p.total_base_stats,
    
    -- Type information (denormalized)
    p.primary_type as primary_type_name,
    p.secondary_type as secondary_type_name,
    
    -- Ability information (denormalized)
    pa.ability_name,
    pa.is_hidden,
    pa.slot_number,
    
    -- Metadata
    current_timestamp as obt_created_at
from pokemon p
left join pokemon_abilities pa on p.pokemon_id = pa.pokemon_id
  );
  
[0m13:08:14.503693 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.star_wars_obt"
[0m13:08:14.507211 [debug] [Thread-3 (]: On model.nerd_facts_dbt.star_wars_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.star_wars_obt"} */

  
    

  create  table "nerd_facts"."public"."star_wars_obt__dbt_tmp"
  
  
    as
  
  (
    /* 
   One Big Table (OBT) for Star Wars Data
   This model combines character, film, planet, and species data into a single denormalized table
   optimized for analytics and reporting.
*/

with characters as (
    select 
        c.character_key,
        c.people_id,
        c.character_name,
        c.height_cm,
        c.mass_kg,
        c.hair_color,
        c.skin_color,
        c.eye_color,
        c.birth_year,
        c.gender,
        c.homeworld_name
    from "nerd_facts"."public"."dim_sw_characters" c
),

planets as (
    select
        p.planet_key,
        p.planet_id,
        p.planet_name,
        p.rotation_period,
        p.orbital_period,
        p.diameter,
        p.climate,
        p.gravity,
        p.terrain,
        p.surface_water,
        p.population
    from "nerd_facts"."public"."dim_sw_planets" p
),

species as (
    select
        s.species_key,
        s.species_id,
        s.species_name,
        s.classification,
        s.designation,
        s.average_height,
        s.skin_colors,
        s.hair_colors,
        s.eye_colors,
        s.average_lifespan,
        s.language,
        s.homeworld_id
    from "nerd_facts"."public"."dim_sw_species" s
),

films as (
    select
        f.film_key,
        f.film_id,
        f.film_title,
        f.episode_id,
        f.opening_crawl,
        f.director,
        f.producer,
        f.release_date
    from "nerd_facts"."public"."dim_sw_films" f
),

character_films as (
    select
        cf.character_key,
        cf.film_key
    from "nerd_facts"."public"."bridge_sw_characters_films" cf
)

-- Final OBT assembly
select
    -- Character information (core entity)
    c.character_key,
    c.people_id,
    c.character_name,
    c.height_cm,
    c.mass_kg,
    c.hair_color,
    c.skin_color,
    c.eye_color,
    c.birth_year,
    c.gender,
    
    -- Planet information (denormalized)
    p.planet_key,
    p.planet_id,
    p.planet_name,
    p.climate,
    p.terrain,
    p.population,
    
    -- Film information (denormalized)
    f.film_key,
    f.film_id,
    f.film_title,
    f.episode_id,
    f.director,
    f.release_date,
    
    -- Metadata
    current_timestamp as obt_created_at
from characters c
left join planets p on c.homeworld_name = p.planet_name
left join character_films cf on c.character_key = cf.character_key
left join films f on cf.film_key = f.film_key
  );
  
[0m13:08:14.509218 [debug] [Thread-1 (]: SQL status: SELECT 1384 in 0.013 seconds
[0m13:08:14.516077 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:08:14.516537 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.nerd_universe_obt"} */
alter table "nerd_facts"."public"."nerd_universe_obt" rename to "nerd_universe_obt__dbt_backup"
[0m13:08:14.517240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:08:14.521609 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:08:14.522131 [debug] [Thread-2 (]: SQL status: SELECT 1302 in 0.018 seconds
[0m13:08:14.522528 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.nerd_universe_obt"} */
alter table "nerd_facts"."public"."nerd_universe_obt__dbt_tmp" rename to "nerd_universe_obt"
[0m13:08:14.526334 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.pokemon_obt"
[0m13:08:14.526860 [debug] [Thread-3 (]: SQL status: SELECT 162 in 0.019 seconds
[0m13:08:14.527499 [debug] [Thread-2 (]: On model.nerd_facts_dbt.pokemon_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon_obt"} */
alter table "nerd_facts"."public"."pokemon_obt" rename to "pokemon_obt__dbt_backup"
[0m13:08:14.531123 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.star_wars_obt"
[0m13:08:14.532034 [debug] [Thread-3 (]: On model.nerd_facts_dbt.star_wars_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.star_wars_obt"} */
alter table "nerd_facts"."public"."star_wars_obt__dbt_tmp" rename to "star_wars_obt"
[0m13:08:14.532617 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m13:08:14.533113 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:08:14.539291 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m13:08:14.562528 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: COMMIT
[0m13:08:14.548354 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.pokemon_obt"
[0m13:08:14.565491 [debug] [Thread-3 (]: On model.nerd_facts_dbt.star_wars_obt: COMMIT
[0m13:08:14.566393 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:08:14.567003 [debug] [Thread-2 (]: On model.nerd_facts_dbt.pokemon_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon_obt"} */
alter table "nerd_facts"."public"."pokemon_obt__dbt_tmp" rename to "pokemon_obt"
[0m13:08:14.567514 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.star_wars_obt"
[0m13:08:14.568010 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: COMMIT
[0m13:08:14.568983 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:08:14.569393 [debug] [Thread-3 (]: On model.nerd_facts_dbt.star_wars_obt: COMMIT
[0m13:08:14.572096 [debug] [Thread-2 (]: On model.nerd_facts_dbt.pokemon_obt: COMMIT
[0m13:08:14.573196 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.pokemon_obt"
[0m13:08:14.573716 [debug] [Thread-2 (]: On model.nerd_facts_dbt.pokemon_obt: COMMIT
[0m13:08:14.574529 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:08:14.581742 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m13:08:14.582386 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m13:08:14.589221 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."nerd_universe_obt__dbt_backup"
[0m13:08:14.592475 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."star_wars_obt__dbt_backup"
[0m13:08:14.592926 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."pokemon_obt__dbt_backup"
[0m13:08:14.597549 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:08:14.598478 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.star_wars_obt"
[0m13:08:14.599254 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.pokemon_obt"
[0m13:08:14.600217 [debug] [Thread-3 (]: On model.nerd_facts_dbt.star_wars_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.star_wars_obt"} */
drop table if exists "nerd_facts"."public"."star_wars_obt__dbt_backup" cascade
[0m13:08:14.599775 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.nerd_universe_obt"} */
drop table if exists "nerd_facts"."public"."nerd_universe_obt__dbt_backup" cascade
[0m13:08:14.601513 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:08:14.600650 [debug] [Thread-2 (]: On model.nerd_facts_dbt.pokemon_obt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon_obt"} */
drop table if exists "nerd_facts"."public"."pokemon_obt__dbt_backup" cascade
[0m13:08:14.604762 [debug] [Thread-3 (]: On model.nerd_facts_dbt.star_wars_obt: Close
[0m13:08:14.608704 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b91e870b-4e07-4027-9f7c-f7b290e749f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20241fee30>]}
[0m13:08:14.605430 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m13:08:14.611476 [debug] [Thread-1 (]: On model.nerd_facts_dbt.nerd_universe_obt: Close
[0m13:08:14.612056 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m13:08:14.614606 [debug] [Thread-2 (]: On model.nerd_facts_dbt.pokemon_obt: Close
[0m13:08:14.616546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b91e870b-4e07-4027-9f7c-f7b290e749f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2020be5090>]}
[0m13:08:14.619109 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b91e870b-4e07-4027-9f7c-f7b290e749f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201f11e410>]}
[0m13:08:14.612812 [info ] [Thread-3 (]: 3 of 3 OK created sql table model public.star_wars_obt ......................... [[32mSELECT 162[0m in 0.21s]
[0m13:08:14.618075 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.nerd_universe_obt ..................... [[32mSELECT 1384[0m in 0.23s]
[0m13:08:14.620236 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.star_wars_obt
[0m13:08:14.620750 [info ] [Thread-2 (]: 2 of 3 OK created sql table model public.pokemon_obt ........................... [[32mSELECT 1302[0m in 0.23s]
[0m13:08:14.621582 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.nerd_universe_obt
[0m13:08:14.622421 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.pokemon_obt
[0m13:08:14.624249 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:14.624741 [debug] [MainThread]: On master: BEGIN
[0m13:08:14.625159 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:08:14.635048 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:08:14.635669 [debug] [MainThread]: On master: COMMIT
[0m13:08:14.636027 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:14.636306 [debug] [MainThread]: On master: COMMIT
[0m13:08:14.636681 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:08:14.636973 [debug] [MainThread]: On master: Close
[0m13:08:14.637509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:08:14.637813 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.nerd_universe_obt' was properly closed.
[0m13:08:14.638079 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.pokemon_obt' was properly closed.
[0m13:08:14.638332 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.star_wars_obt' was properly closed.
[0m13:08:14.638701 [info ] [MainThread]: 
[0m13:08:14.639022 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m13:08:14.639880 [debug] [MainThread]: Command end result
[0m13:08:14.725982 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m13:08:14.728230 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m13:08:14.733960 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m13:08:14.734424 [info ] [MainThread]: 
[0m13:08:14.734780 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:08:14.735093 [info ] [MainThread]: 
[0m13:08:14.735382 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:08:14.736178 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7904906, "process_in_blocks": "0", "process_kernel_time": 0.095687, "process_mem_max_rss": "124356", "process_out_blocks": "11472", "process_user_time": 2.650141}
[0m13:08:14.736660 [debug] [MainThread]: Command `dbt run` succeeded at 13:08:14.736574 after 1.79 seconds
[0m13:08:14.736991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2022e60bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2023f8e8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2022d245b0>]}
[0m13:08:14.737324 [debug] [MainThread]: Flushing usage events
[0m13:08:15.157045 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:08:44.666027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74c246cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74c352d4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74c352e8c0>]}


============================== 13:08:44.668322 | 5d059495-15de-41e0-9bd5-c358a5526259 ==============================
[0m13:08:44.668322 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:08:44.668785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run-operation generate_model_schema --args {model: nerd_universe_obt}', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:08:44.809670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d059495-15de-41e0-9bd5-c358a5526259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74c0d9b7c0>]}
[0m13:08:44.858989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d059495-15de-41e0-9bd5-c358a5526259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74c1e48820>]}
[0m13:08:44.859807 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:08:44.952114 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:08:45.135291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:08:45.135795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:08:45.246657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d059495-15de-41e0-9bd5-c358a5526259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74c34ec520>]}
[0m13:08:45.407413 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m13:08:45.410218 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m13:08:45.441465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d059495-15de-41e0-9bd5-c358a5526259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74c01f1d80>]}
[0m13:08:45.442177 [info ] [MainThread]: Found 106 models, 1 seed, 155 data tests, 30 sources, 633 macros
[0m13:08:45.442702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d059495-15de-41e0-9bd5-c358a5526259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74c01f1d20>]}
[0m13:08:45.443327 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_model_schema'
[0m13:08:45.443720 [debug] [MainThread]: Using postgres connection "macro_generate_model_schema"
[0m13:08:45.444039 [debug] [MainThread]: On macro_generate_model_schema: BEGIN
[0m13:08:45.444348 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:08:45.454872 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:08:45.455414 [debug] [MainThread]: On macro_generate_model_schema: COMMIT
[0m13:08:45.455800 [debug] [MainThread]: Using postgres connection "macro_generate_model_schema"
[0m13:08:45.456091 [debug] [MainThread]: On macro_generate_model_schema: COMMIT
[0m13:08:45.456574 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:08:45.456930 [debug] [MainThread]: On macro_generate_model_schema: Close
[0m13:08:45.457434 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "generate_model_schema" in any package
[0m13:08:45.458602 [debug] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
  File "/usr/local/lib/python3.10/dist-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
  File "/usr/local/lib/python3.10/dist-packages/dbt/adapters/base/impl.py", line 1182, in execute_macro
    raise DbtRuntimeError(
dbt_common.exceptions.base.DbtRuntimeError: Runtime Error
  dbt could not find a macro with the name "generate_model_schema" in any package

[0m13:08:45.459069 [error] [MainThread]: Encountered an error:
Internal Error
  dbt could not find a macro with the name 'generate_model_schema' in any package
[0m13:08:45.460138 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.85642403, "process_in_blocks": "32", "process_kernel_time": 0.112208, "process_mem_max_rss": "110420", "process_out_blocks": "4704", "process_user_time": 1.747812}
[0m13:08:45.460622 [debug] [MainThread]: Command `dbt run-operation` failed at 13:08:45.460534 after 0.86 seconds
[0m13:08:45.460913 [debug] [MainThread]: Connection 'macro_generate_model_schema' was properly closed.
[0m13:08:45.461200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74c246cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74c01f25c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74c01f25f0>]}
[0m13:08:45.461544 [debug] [MainThread]: Flushing usage events
[0m13:08:45.887218 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:07.911381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f552597e920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55268d0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55268d2bc0>]}


============================== 13:39:07.913784 | b52cc44b-06a6-44f5-b561-a8269870be1c ==============================
[0m13:39:07.913784 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:39:07.914248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:39:08.052618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b52cc44b-06a6-44f5-b561-a8269870be1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5526ad6710>]}
[0m13:39:08.105244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b52cc44b-06a6-44f5-b561-a8269870be1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5525013f10>]}
[0m13:39:08.106112 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:39:08.224103 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:39:08.366232 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m13:39:08.366712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b52cc44b-06a6-44f5-b561-a8269870be1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55251b9db0>]}
[0m13:39:10.799828 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_netrunner_types' in the 'models' section of file 'models/staging/netrunner/stg_netrunner.yml'
[0m13:39:10.805306 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_netrunner_cycles' in the 'models' section of file 'models/staging/netrunner/stg_netrunner.yml'
[0m13:39:10.807898 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_netrunner_subtypes' in the 'models' section of file 'models/staging/netrunner/stg_netrunner.yml'
[0m13:39:11.021472 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_films' in the 'models' section of file 'models/marts/star_wars/schema.yml'
[0m13:39:11.045844 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'operational_batch_sw' in the 'models' section of file 'tests/operational_batch.yml'
[0m13:39:11.335446 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.test_data_freshness' (tests/operational/test_data_freshness.sql) depends on a node named 'dim_films' in package '' which was not found
[0m13:39:11.336902 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.unique_stg_netrunner_types_type_id.6c0873a4b5' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_types' in package '' which was not found
[0m13:39:11.337420 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.not_null_stg_netrunner_types_type_id.d7e0c6692f' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_types' in package '' which was not found
[0m13:39:11.337862 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.unique_stg_netrunner_types_type_code.f043eaac08' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_types' in package '' which was not found
[0m13:39:11.338189 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.not_null_stg_netrunner_types_type_code.dd9e128956' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_types' in package '' which was not found
[0m13:39:11.338481 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.not_null_stg_netrunner_types_type_name.3d8e59b009' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_types' in package '' which was not found
[0m13:39:11.338789 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.accepted_values_stg_netrunner_types_side_code__corp__runner__None.ea3a9022cf' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_types' in package '' which was not found
[0m13:39:11.339081 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_types_card_count___0.fabff6255a' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_types' in package '' which was not found
[0m13:39:11.339443 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.unique_stg_netrunner_cycles_cycle_id.eadb505df5' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_cycles' in package '' which was not found
[0m13:39:11.339766 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.not_null_stg_netrunner_cycles_cycle_id.62ac352d3f' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_cycles' in package '' which was not found
[0m13:39:11.340057 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.unique_stg_netrunner_cycles_cycle_code.4f84a84350' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_cycles' in package '' which was not found
[0m13:39:11.340339 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.not_null_stg_netrunner_cycles_cycle_code.4c9240e6c1' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_cycles' in package '' which was not found
[0m13:39:11.340632 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.not_null_stg_netrunner_cycles_cycle_name.865301e9dd' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_cycles' in package '' which was not found
[0m13:39:11.340916 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.unique_stg_netrunner_cycles_position.b1a7d27022' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_cycles' in package '' which was not found
[0m13:39:11.341212 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.not_null_stg_netrunner_cycles_position.4a0a7c8342' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_cycles' in package '' which was not found
[0m13:39:11.341569 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cycles_pack_count___0.50541a18a6' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_cycles' in package '' which was not found
[0m13:39:11.341887 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cycles_card_count___0.e1ddce52f3' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_cycles' in package '' which was not found
[0m13:39:11.342206 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cycles_first_release_date___current_date_OR_IS_NULL.8b14b6468a' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_cycles' in package '' which was not found
[0m13:39:11.342515 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.unique_stg_netrunner_subtypes_subtype_id.3449a40165' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_subtypes' in package '' which was not found
[0m13:39:11.342800 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.not_null_stg_netrunner_subtypes_subtype_id.fca108b90f' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_subtypes' in package '' which was not found
[0m13:39:11.343082 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.unique_stg_netrunner_subtypes_subtype_code.bed6436dd0' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_subtypes' in package '' which was not found
[0m13:39:11.343362 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.not_null_stg_netrunner_subtypes_subtype_code.7e85af9991' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_subtypes' in package '' which was not found
[0m13:39:11.343690 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.not_null_stg_netrunner_subtypes_subtype_name.2c8839b12c' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_subtypes' in package '' which was not found
[0m13:39:11.343991 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_subtypes_card_count___0.d00a712176' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_subtypes' in package '' which was not found
[0m13:39:11.344321 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_subtypes_corp_count___0.6f39ee868e' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_subtypes' in package '' which was not found
[0m13:39:11.344640 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_subtypes_runner_count___0.0ea2524870' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_subtypes' in package '' which was not found
[0m13:39:11.344924 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_subtypes_card_count_corp_count_runner_count.5edd92ae57' (models/staging/netrunner/stg_netrunner.yml) depends on a node named 'stg_netrunner_subtypes' in package '' which was not found
[0m13:39:11.345411 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.unique_column_dim_films_film_id.d927909715' (models/marts/star_wars/schema.yml) depends on a node named 'dim_films' in package '' which was not found
[0m13:39:11.345724 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.not_null_column_dim_films_film_id.4e6599f0f8' (models/marts/star_wars/schema.yml) depends on a node named 'dim_films' in package '' which was not found
[0m13:39:11.346017 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.not_null_column_dim_films_title.db94e0209e' (models/marts/star_wars/schema.yml) depends on a node named 'dim_films' in package '' which was not found
[0m13:39:11.346302 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.not_null_column_dim_films_release_date.05bcd8d750' (models/marts/star_wars/schema.yml) depends on a node named 'dim_films' in package '' which was not found
[0m13:39:11.346582 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.test_sw_character_data_quality.9079a0b52c' (tests/operational_batch.yml) depends on a node named 'operational_batch_sw' in package '' which was not found
[0m13:39:11.346855 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.test_sw_films_freshness.37a43a604d' (tests/operational_batch.yml) depends on a node named 'operational_batch_sw' in package '' which was not found
[0m13:39:11.480253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b52cc44b-06a6-44f5-b561-a8269870be1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55236216f0>]}
[0m13:39:11.519255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b52cc44b-06a6-44f5-b561-a8269870be1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5523c375b0>]}
[0m13:39:11.519874 [info ] [MainThread]: Found 106 models, 155 data tests, 1 seed, 30 sources, 633 macros
[0m13:39:11.520262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b52cc44b-06a6-44f5-b561-a8269870be1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5523c35c60>]}
[0m13:39:11.530679 [info ] [MainThread]: 
[0m13:39:11.531351 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:39:11.531794 [info ] [MainThread]: 
[0m13:39:11.532394 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:39:11.544359 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public'
[0m13:39:11.637489 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m13:39:11.637950 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m13:39:11.638230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:11.651603 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m13:39:11.652119 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m13:39:11.652466 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:39:11.655677 [debug] [ThreadPool]: SQL status: SELECT 113 in 0.003 seconds
[0m13:39:11.658607 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m13:39:11.659210 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m13:39:11.680878 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:11.681273 [debug] [MainThread]: On master: BEGIN
[0m13:39:11.681545 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:39:11.694359 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m13:39:11.694795 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:11.695147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:39:11.702238 [debug] [MainThread]: SQL status: SELECT 55 in 0.007 seconds
[0m13:39:11.709771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b52cc44b-06a6-44f5-b561-a8269870be1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5523afada0>]}
[0m13:39:11.710255 [debug] [MainThread]: On master: ROLLBACK
[0m13:39:11.710685 [debug] [MainThread]: On master: Close
[0m13:39:11.714121 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.base_exposure_relationships
[0m13:39:11.714616 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.base_metric_relationships
[0m13:39:11.715121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.dbt_project_evaluator.base_exposure_relationships)
[0m13:39:11.715531 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.base_node_columns
[0m13:39:11.715873 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.base_node_relationships
[0m13:39:11.716389 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project_evaluator.base_metric_relationships'
[0m13:39:11.718078 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.base_metric_relationships
[0m13:39:11.716756 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.base_exposure_relationships
[0m13:39:11.717702 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project_evaluator.base_node_relationships'
[0m13:39:11.717225 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project_evaluator.base_node_columns'
[0m13:39:11.728015 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.base_metric_relationships"
[0m13:39:11.733103 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.base_exposure_relationships"
[0m13:39:11.733646 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.base_node_relationships
[0m13:39:11.734018 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.base_node_columns
[0m13:39:11.734634 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.base_metric_relationships
[0m13:39:11.739283 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.base_node_relationships"
[0m13:39:11.748294 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.base_node_relationships
[0m13:39:11.746838 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.base_exposure_relationships
[0m13:39:11.749713 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.base_exposure_relationships
[0m13:39:11.750091 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.base_source_columns
[0m13:39:11.749040 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.base_node_relationships
[0m13:39:11.747524 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.base_metric_relationships
[0m13:39:11.746302 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.base_node_columns"
[0m13:39:11.752130 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.base_node_columns
[0m13:39:11.751027 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.stg_exposures
[0m13:39:11.751516 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.stg_metrics
[0m13:39:11.753512 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.base_metric_relationships, now model.dbt_project_evaluator.stg_metrics)
[0m13:39:11.753846 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.stg_metrics
[0m13:39:11.753134 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.base_node_relationships, now model.dbt_project_evaluator.stg_exposures)
[0m13:39:11.752712 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.base_node_columns
[0m13:39:11.750620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.base_exposure_relationships, now model.dbt_project_evaluator.base_source_columns)
[0m13:39:11.761980 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.stg_metrics"
[0m13:39:11.762554 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.stg_exposures
[0m13:39:11.763005 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.stg_naming_convention_folders
[0m13:39:11.763463 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.base_source_columns
[0m13:39:11.763994 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.stg_metrics
[0m13:39:11.771023 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.stg_exposures"
[0m13:39:11.771545 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.base_node_columns, now model.dbt_project_evaluator.stg_naming_convention_folders)
[0m13:39:11.776509 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.base_source_columns"
[0m13:39:11.777360 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.stg_metrics
[0m13:39:11.778157 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.stg_exposures
[0m13:39:11.780566 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.stg_exposures
[0m13:39:11.780979 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.stg_nodes
[0m13:39:11.779745 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.base_source_columns
[0m13:39:11.778537 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.stg_naming_convention_folders
[0m13:39:11.779241 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.stg_naming_convention_prefixes
[0m13:39:11.781432 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_exposures, now model.dbt_project_evaluator.stg_nodes)
[0m13:39:11.782037 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.base_source_columns
[0m13:39:11.786960 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.stg_naming_convention_folders"
[0m13:39:11.787568 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_metrics, now model.dbt_project_evaluator.stg_naming_convention_prefixes)
[0m13:39:11.788057 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.stg_nodes
[0m13:39:11.788556 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.stg_sources
[0m13:39:11.789225 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.stg_naming_convention_prefixes
[0m13:39:11.800423 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.stg_nodes"
[0m13:39:11.801198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.base_source_columns, now model.dbt_project_evaluator.stg_sources)
[0m13:39:11.801585 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.stg_naming_convention_folders
[0m13:39:11.807857 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.stg_naming_convention_prefixes"
[0m13:39:11.808613 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.stg_sources
[0m13:39:11.809348 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.stg_naming_convention_folders
[0m13:39:11.809778 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.stg_nodes
[0m13:39:11.818175 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.stg_sources"
[0m13:39:11.818809 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.stg_naming_convention_prefixes
[0m13:39:11.819215 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_netrunner_cards
[0m13:39:11.820003 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.stg_nodes
[0m13:39:11.821790 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_netrunner_factions
[0m13:39:11.821284 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_naming_convention_folders, now model.nerd_facts_dbt.stg_netrunner_cards)
[0m13:39:11.822907 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner_cards
[0m13:39:11.822122 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.stg_sources
[0m13:39:11.822559 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_nodes, now model.nerd_facts_dbt.stg_netrunner_factions)
[0m13:39:11.820799 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.stg_naming_convention_prefixes
[0m13:39:11.826147 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner_cards"
[0m13:39:11.828359 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_netrunner_cards
[0m13:39:11.827289 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner_factions
[0m13:39:11.827687 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_netrunner_packs
[0m13:39:11.832679 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_naming_convention_prefixes, now model.nerd_facts_dbt.stg_netrunner_packs)
[0m13:39:11.833067 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner_packs
[0m13:39:11.832024 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner_factions"
[0m13:39:11.837560 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_netrunner_factions
[0m13:39:11.836854 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner_packs"
[0m13:39:11.826907 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.stg_sources
[0m13:39:11.838782 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_pokeapi_abilities
[0m13:39:11.828970 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_netrunner_cards
[0m13:39:11.838265 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_netrunner_factions
[0m13:39:11.839359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_sources, now model.nerd_facts_dbt.stg_pokeapi_abilities)
[0m13:39:11.841687 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_pokeapi_abilities
[0m13:39:11.840217 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_pokeapi_items
[0m13:39:11.840963 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_pokeapi_moves
[0m13:39:11.844718 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner_factions, now model.nerd_facts_dbt.stg_pokeapi_moves)
[0m13:39:11.845038 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_pokeapi_moves
[0m13:39:11.844266 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner_cards, now model.nerd_facts_dbt.stg_pokeapi_items)
[0m13:39:11.843778 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_pokeapi_abilities"
[0m13:39:11.839889 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_netrunner_packs
[0m13:39:11.848282 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_pokeapi_moves"
[0m13:39:11.848775 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_pokeapi_items
[0m13:39:11.849497 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_pokeapi_abilities
[0m13:39:11.850253 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_netrunner_packs
[0m13:39:11.855114 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_pokeapi_pokemon
[0m13:39:11.855923 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner_packs, now model.nerd_facts_dbt.stg_pokeapi_pokemon)
[0m13:39:11.854675 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_pokeapi_abilities
[0m13:39:11.853235 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_pokeapi_items"
[0m13:39:11.853937 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_pokeapi_moves
[0m13:39:11.856334 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_pokeapi_pokemon
[0m13:39:11.856744 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_pokeapi_types
[0m13:39:11.857967 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_pokeapi_moves
[0m13:39:11.858467 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_pokeapi_items
[0m13:39:11.863100 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_pokeapi_items
[0m13:39:11.861630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_pokeapi_abilities, now model.nerd_facts_dbt.stg_pokeapi_types)
[0m13:39:11.864099 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_pokeapi_types
[0m13:39:11.867349 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_pokeapi_types"
[0m13:39:11.868077 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_pokeapi_types
[0m13:39:11.862096 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi_films
[0m13:39:11.869345 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_pokeapi_moves, now model.nerd_facts_dbt.stg_swapi_films)
[0m13:39:11.861095 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_pokeapi_pokemon"
[0m13:39:11.870303 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_pokeapi_pokemon
[0m13:39:11.869711 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_films
[0m13:39:11.868867 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_pokeapi_types
[0m13:39:11.875042 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_swapi_planets
[0m13:39:11.875769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_pokeapi_types, now model.nerd_facts_dbt.stg_swapi_planets)
[0m13:39:11.874536 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_films"
[0m13:39:11.876786 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi_films
[0m13:39:11.863502 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_people
[0m13:39:11.877849 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_pokeapi_items, now model.nerd_facts_dbt.stg_swapi_people)
[0m13:39:11.878199 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_people
[0m13:39:11.870976 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_pokeapi_pokemon
[0m13:39:11.882606 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_swapi_species
[0m13:39:11.882074 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_people"
[0m13:39:11.877448 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi_films
[0m13:39:11.876184 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_planets
[0m13:39:11.883443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_pokeapi_pokemon, now model.nerd_facts_dbt.stg_swapi_species)
[0m13:39:11.884127 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_people
[0m13:39:11.884545 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi_starships
[0m13:39:11.888687 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m13:39:11.889183 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_species
[0m13:39:11.889945 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_people
[0m13:39:11.890403 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_films, now model.nerd_facts_dbt.stg_swapi_starships)
[0m13:39:11.896277 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_starships
[0m13:39:11.895008 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_species"
[0m13:39:11.895552 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_vehicles
[0m13:39:11.891042 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_swapi_planets
[0m13:39:11.902256 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_swapi_species
[0m13:39:11.901476 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m13:39:11.902820 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_people, now model.nerd_facts_dbt.stg_swapi_vehicles)
[0m13:39:11.903661 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_swapi_planets
[0m13:39:11.904326 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_swapi_species
[0m13:39:11.906425 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.source_not_null_netrunner_cards_code.b018ea8b82
[0m13:39:11.905273 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_vehicles
[0m13:39:11.905688 [debug] [Thread-1 (]: Began running node seed.dbt_project_evaluator.dbt_project_evaluator_exceptions
[0m13:39:11.904919 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi_starships
[0m13:39:11.907083 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_species, now test.nerd_facts_dbt.source_not_null_netrunner_cards_code.b018ea8b82)
[0m13:39:11.911124 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m13:39:11.911792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_planets, now seed.dbt_project_evaluator.dbt_project_evaluator_exceptions)
[0m13:39:11.912545 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi_starships
[0m13:39:11.912949 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.source_not_null_netrunner_cards_code.b018ea8b82
[0m13:39:11.913613 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_vehicles
[0m13:39:11.913962 [debug] [Thread-1 (]: Began compiling node seed.dbt_project_evaluator.dbt_project_evaluator_exceptions
[0m13:39:11.914373 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.source_not_null_netrunner_cards_title.9384019c8c
[0m13:39:11.921900 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_netrunner_cards_code.b018ea8b82"
[0m13:39:11.922796 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_vehicles
[0m13:39:11.925491 [debug] [Thread-1 (]: Began executing node seed.dbt_project_evaluator.dbt_project_evaluator_exceptions
[0m13:39:11.926034 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_starships, now test.nerd_facts_dbt.source_not_null_netrunner_cards_title.9384019c8c)
[0m13:39:11.928538 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.source_not_null_netrunner_cards_title.9384019c8c
[0m13:39:11.927173 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.source_not_null_netrunner_cycles_code.1e343fc387
[0m13:39:11.928146 [debug] [Thread-1 (]: Finished running node seed.dbt_project_evaluator.dbt_project_evaluator_exceptions
[0m13:39:11.926774 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.source_not_null_netrunner_cards_code.b018ea8b82
[0m13:39:11.935215 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.source_not_null_netrunner_cards_code.b018ea8b82
[0m13:39:11.933866 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_vehicles, now test.nerd_facts_dbt.source_not_null_netrunner_cycles_code.1e343fc387)
[0m13:39:11.934397 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.source_not_null_netrunner_factions_code.a535114c79
[0m13:39:11.935650 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.source_not_null_netrunner_factions_name.4321a60eb8
[0m13:39:11.936955 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_netrunner_cards_code.b018ea8b82, now test.nerd_facts_dbt.source_not_null_netrunner_factions_name.4321a60eb8)
[0m13:39:11.937321 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.source_not_null_netrunner_factions_name.4321a60eb8
[0m13:39:11.936545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_project_evaluator.dbt_project_evaluator_exceptions, now test.nerd_facts_dbt.source_not_null_netrunner_factions_code.a535114c79)
[0m13:39:11.933231 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_netrunner_cards_title.9384019c8c"
[0m13:39:11.936105 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.source_not_null_netrunner_cycles_code.1e343fc387
[0m13:39:11.943267 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_netrunner_factions_name.4321a60eb8"
[0m13:39:11.949709 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.source_not_null_netrunner_factions_name.4321a60eb8
[0m13:39:11.948877 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_netrunner_cycles_code.1e343fc387"
[0m13:39:11.943914 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.source_not_null_netrunner_factions_code.a535114c79
[0m13:39:11.950229 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.source_not_null_netrunner_cards_title.9384019c8c
[0m13:39:11.950911 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.source_not_null_netrunner_factions_name.4321a60eb8
[0m13:39:11.951486 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.source_not_null_netrunner_cycles_code.1e343fc387
[0m13:39:11.958563 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.source_not_null_netrunner_cycles_code.1e343fc387
[0m13:39:11.957313 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.source_not_null_netrunner_cards_title.9384019c8c
[0m13:39:11.957818 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.source_not_null_netrunner_packs_code.a5aa8c198b
[0m13:39:11.959723 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_netrunner_factions_name.4321a60eb8, now test.nerd_facts_dbt.source_not_null_netrunner_packs_code.a5aa8c198b)
[0m13:39:11.956138 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_netrunner_factions_code.a535114c79"
[0m13:39:11.960579 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.source_not_null_netrunner_factions_code.a535114c79
[0m13:39:11.960041 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.source_not_null_netrunner_packs_code.a5aa8c198b
[0m13:39:11.958902 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.source_not_null_netrunner_types_code.cd58935bd5
[0m13:39:11.965957 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_netrunner_cycles_code.1e343fc387, now test.nerd_facts_dbt.source_not_null_netrunner_types_code.cd58935bd5)
[0m13:39:11.966341 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.source_not_null_netrunner_types_code.cd58935bd5
[0m13:39:11.965290 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_netrunner_packs_code.a5aa8c198b"
[0m13:39:11.961221 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.source_not_null_netrunner_factions_code.a535114c79
[0m13:39:11.970955 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9
[0m13:39:11.959268 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.source_not_null_netrunner_types_name.311e01ac8a
[0m13:39:11.971561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_netrunner_factions_code.a535114c79, now test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9)
[0m13:39:11.970185 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_netrunner_types_code.cd58935bd5"
[0m13:39:11.971984 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.source_not_null_netrunner_packs_code.a5aa8c198b
[0m13:39:11.972423 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_netrunner_cards_title.9384019c8c, now test.nerd_facts_dbt.source_not_null_netrunner_types_name.311e01ac8a)
[0m13:39:11.972809 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9
[0m13:39:11.973395 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.source_not_null_netrunner_types_code.cd58935bd5
[0m13:39:11.974012 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.source_not_null_netrunner_packs_code.a5aa8c198b
[0m13:39:11.974378 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.source_not_null_netrunner_types_name.311e01ac8a
[0m13:39:11.978455 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9"
[0m13:39:11.979244 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.source_not_null_netrunner_types_code.cd58935bd5
[0m13:39:11.979722 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3
[0m13:39:11.985398 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_netrunner_types_name.311e01ac8a"
[0m13:39:11.986293 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9
[0m13:39:11.986694 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.source_not_null_swapi_films_episode_id.878f8e1d7f
[0m13:39:11.987246 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_netrunner_packs_code.a5aa8c198b, now test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3)
[0m13:39:11.987813 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.source_not_null_netrunner_types_name.311e01ac8a
[0m13:39:11.988508 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9
[0m13:39:11.988939 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_netrunner_types_code.cd58935bd5, now test.nerd_facts_dbt.source_not_null_swapi_films_episode_id.878f8e1d7f)
[0m13:39:11.990670 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.source_not_null_swapi_films_episode_id.878f8e1d7f
[0m13:39:11.989892 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.source_not_null_netrunner_types_name.311e01ac8a
[0m13:39:11.990284 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.source_not_null_swapi_films_id.a8d97fb7bd
[0m13:39:11.995896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9, now test.nerd_facts_dbt.source_not_null_swapi_films_id.a8d97fb7bd)
[0m13:39:11.994738 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_swapi_films_episode_id.878f8e1d7f"
[0m13:39:11.995340 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.source_not_null_swapi_films_release_date.cff58563b1
[0m13:39:11.996247 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.source_not_null_swapi_films_id.a8d97fb7bd
[0m13:39:11.989328 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3
[0m13:39:11.996846 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.source_not_null_swapi_films_episode_id.878f8e1d7f
[0m13:39:11.997248 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_netrunner_types_name.311e01ac8a, now test.nerd_facts_dbt.source_not_null_swapi_films_release_date.cff58563b1)
[0m13:39:12.001130 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_swapi_films_id.a8d97fb7bd"
[0m13:39:12.004897 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3"
[0m13:39:12.005728 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.source_not_null_swapi_films_episode_id.878f8e1d7f
[0m13:39:12.006126 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.source_not_null_swapi_films_release_date.cff58563b1
[0m13:39:12.006754 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.source_not_null_swapi_films_id.a8d97fb7bd
[0m13:39:12.007215 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.source_not_null_swapi_films_title.212e764912
[0m13:39:12.011513 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_swapi_films_release_date.cff58563b1"
[0m13:39:12.012124 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3
[0m13:39:12.012828 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.source_not_null_swapi_films_id.a8d97fb7bd
[0m13:39:12.013292 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_swapi_films_episode_id.878f8e1d7f, now test.nerd_facts_dbt.source_not_null_swapi_films_title.212e764912)
[0m13:39:12.015291 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.source_not_null_swapi_films_title.212e764912
[0m13:39:12.014482 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3
[0m13:39:12.014894 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.source_not_null_swapi_people_id.f2f7ed0536
[0m13:39:12.013886 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.source_not_null_swapi_films_release_date.cff58563b1
[0m13:39:12.020720 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_swapi_films_title.212e764912"
[0m13:39:12.023055 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.source_not_null_swapi_films_title.212e764912
[0m13:39:12.021821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_swapi_films_id.a8d97fb7bd, now test.nerd_facts_dbt.source_not_null_swapi_people_id.f2f7ed0536)
[0m13:39:12.024024 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.source_not_null_swapi_people_id.f2f7ed0536
[0m13:39:12.021270 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.source_not_null_swapi_people_name.f00750019f
[0m13:39:12.028804 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3, now test.nerd_facts_dbt.source_not_null_swapi_people_name.f00750019f)
[0m13:39:12.022492 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.source_not_null_swapi_films_release_date.cff58563b1
[0m13:39:12.028266 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_swapi_people_id.f2f7ed0536"
[0m13:39:12.029179 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.source_not_null_swapi_people_name.f00750019f
[0m13:39:12.023683 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.source_not_null_swapi_films_title.212e764912
[0m13:39:12.034815 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.source_not_null_swapi_planets_name.319b74f0ef
[0m13:39:12.035305 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_swapi_films_title.212e764912, now test.nerd_facts_dbt.source_not_null_swapi_planets_name.319b74f0ef)
[0m13:39:12.034248 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_swapi_people_name.f00750019f"
[0m13:39:12.029554 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.source_not_null_swapi_planets_id.4186af8d70
[0m13:39:12.030195 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.source_not_null_swapi_people_id.f2f7ed0536
[0m13:39:12.035640 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.source_not_null_swapi_planets_name.319b74f0ef
[0m13:39:12.036367 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_swapi_films_release_date.cff58563b1, now test.nerd_facts_dbt.source_not_null_swapi_planets_id.4186af8d70)
[0m13:39:12.036783 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.source_not_null_swapi_people_name.f00750019f
[0m13:39:12.037442 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.source_not_null_swapi_people_id.f2f7ed0536
[0m13:39:12.041390 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_swapi_planets_name.319b74f0ef"
[0m13:39:12.041877 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.source_not_null_swapi_planets_id.4186af8d70
[0m13:39:12.042513 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.source_not_null_swapi_people_name.f00750019f
[0m13:39:12.048121 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.source_not_null_swapi_species_name.6420b153a1
[0m13:39:12.048658 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_swapi_people_name.f00750019f, now test.nerd_facts_dbt.source_not_null_swapi_species_name.6420b153a1)
[0m13:39:12.047533 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_swapi_planets_id.4186af8d70"
[0m13:39:12.042934 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.source_not_null_swapi_species_id.fe660e97e9
[0m13:39:12.049003 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.source_not_null_swapi_species_name.6420b153a1
[0m13:39:12.043629 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.source_not_null_swapi_planets_name.319b74f0ef
[0m13:39:12.049569 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.source_not_null_swapi_planets_id.4186af8d70
[0m13:39:12.049962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_swapi_people_id.f2f7ed0536, now test.nerd_facts_dbt.source_not_null_swapi_species_id.fe660e97e9)
[0m13:39:12.055157 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_swapi_species_name.6420b153a1"
[0m13:39:12.056003 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.source_not_null_swapi_planets_name.319b74f0ef
[0m13:39:12.056799 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.source_not_null_swapi_planets_id.4186af8d70
[0m13:39:12.057295 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.source_not_null_swapi_species_id.fe660e97e9
[0m13:39:12.062566 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_swapi_species_id.fe660e97e9"
[0m13:39:12.058256 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.source_not_null_swapi_starships_id.20f60e38ef
[0m13:39:12.058740 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.source_not_null_swapi_starships_name.14334d5803
[0m13:39:12.057884 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.source_not_null_swapi_species_name.6420b153a1
[0m13:39:12.063395 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_swapi_planets_name.319b74f0ef, now test.nerd_facts_dbt.source_not_null_swapi_starships_id.20f60e38ef)
[0m13:39:12.063853 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.source_not_null_swapi_species_id.fe660e97e9
[0m13:39:12.064289 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_swapi_planets_id.4186af8d70, now test.nerd_facts_dbt.source_not_null_swapi_starships_name.14334d5803)
[0m13:39:12.064973 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.source_not_null_swapi_species_name.6420b153a1
[0m13:39:12.065358 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.source_not_null_swapi_starships_id.20f60e38ef
[0m13:39:12.065935 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.source_not_null_swapi_species_id.fe660e97e9
[0m13:39:12.066289 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.source_not_null_swapi_starships_name.14334d5803
[0m13:39:12.066644 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.source_not_null_swapi_vehicles_id.50e734d039
[0m13:39:12.070549 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_swapi_starships_id.20f60e38ef"
[0m13:39:12.071191 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.source_not_null_swapi_vehicles_name.20c147bb0c
[0m13:39:12.074927 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_swapi_starships_name.14334d5803"
[0m13:39:12.075558 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_swapi_species_name.6420b153a1, now test.nerd_facts_dbt.source_not_null_swapi_vehicles_id.50e734d039)
[0m13:39:12.076310 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.source_not_null_swapi_starships_id.20f60e38ef
[0m13:39:12.076698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_swapi_species_id.fe660e97e9, now test.nerd_facts_dbt.source_not_null_swapi_vehicles_name.20c147bb0c)
[0m13:39:12.077242 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.source_not_null_swapi_vehicles_id.50e734d039
[0m13:39:12.083009 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_swapi_vehicles_id.50e734d039"
[0m13:39:12.077684 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.source_not_null_swapi_starships_name.14334d5803
[0m13:39:12.084115 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.source_not_null_swapi_starships_name.14334d5803
[0m13:39:12.078462 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.source_not_null_swapi_starships_id.20f60e38ef
[0m13:39:12.084578 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.source_unique_netrunner_cards_code.7f8cacd76a
[0m13:39:12.085863 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_swapi_starships_name.14334d5803, now test.nerd_facts_dbt.source_unique_netrunner_cards_code.7f8cacd76a)
[0m13:39:12.084907 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.source_not_null_swapi_vehicles_id.50e734d039
[0m13:39:12.086724 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.source_not_null_swapi_vehicles_id.50e734d039
[0m13:39:12.086165 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.source_unique_netrunner_cards_code.7f8cacd76a
[0m13:39:12.078835 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.source_not_null_swapi_vehicles_name.20c147bb0c
[0m13:39:12.087070 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.source_unique_netrunner_factions_code.818d947833
[0m13:39:12.098882 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_swapi_vehicles_id.50e734d039, now test.nerd_facts_dbt.source_unique_netrunner_factions_code.818d947833)
[0m13:39:12.085430 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.source_unique_netrunner_cycles_code.5bfadefe6f
[0m13:39:12.099739 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_swapi_starships_id.20f60e38ef, now test.nerd_facts_dbt.source_unique_netrunner_cycles_code.5bfadefe6f)
[0m13:39:12.100092 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.source_unique_netrunner_cycles_code.5bfadefe6f
[0m13:39:12.099299 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.source_unique_netrunner_factions_code.818d947833
[0m13:39:12.098199 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_swapi_vehicles_name.20c147bb0c"
[0m13:39:12.094019 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_unique_netrunner_cards_code.7f8cacd76a"
[0m13:39:12.104471 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_unique_netrunner_cycles_code.5bfadefe6f"
[0m13:39:12.108687 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_unique_netrunner_factions_code.818d947833"
[0m13:39:12.109488 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.source_not_null_swapi_vehicles_name.20c147bb0c
[0m13:39:12.111382 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.source_not_null_swapi_vehicles_name.20c147bb0c
[0m13:39:12.111826 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.source_unique_netrunner_packs_code.4fd37b2799
[0m13:39:12.110138 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.source_unique_netrunner_cycles_code.5bfadefe6f
[0m13:39:12.110699 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.source_unique_netrunner_cards_code.7f8cacd76a
[0m13:39:12.112243 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.source_unique_netrunner_factions_code.818d947833
[0m13:39:12.112717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_swapi_vehicles_name.20c147bb0c, now test.nerd_facts_dbt.source_unique_netrunner_packs_code.4fd37b2799)
[0m13:39:12.113423 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.source_unique_netrunner_cycles_code.5bfadefe6f
[0m13:39:12.114061 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.source_unique_netrunner_cards_code.7f8cacd76a
[0m13:39:12.114685 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.source_unique_netrunner_factions_code.818d947833
[0m13:39:12.115061 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.source_unique_netrunner_packs_code.4fd37b2799
[0m13:39:12.115467 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.source_unique_netrunner_subtypes_code.82e267410f
[0m13:39:12.115965 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.source_unique_netrunner_types_code.63fb152384
[0m13:39:12.116417 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11
[0m13:39:12.120828 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_unique_netrunner_packs_code.4fd37b2799"
[0m13:39:12.121444 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_unique_netrunner_cycles_code.5bfadefe6f, now test.nerd_facts_dbt.source_unique_netrunner_subtypes_code.82e267410f)
[0m13:39:12.121938 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_unique_netrunner_cards_code.7f8cacd76a, now test.nerd_facts_dbt.source_unique_netrunner_types_code.63fb152384)
[0m13:39:12.123652 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.source_unique_netrunner_types_code.63fb152384
[0m13:39:12.123064 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.source_unique_netrunner_subtypes_code.82e267410f
[0m13:39:12.122402 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_unique_netrunner_factions_code.818d947833, now test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11)
[0m13:39:12.128404 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_unique_netrunner_types_code.63fb152384"
[0m13:39:12.128877 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.source_unique_netrunner_packs_code.4fd37b2799
[0m13:39:12.134066 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_unique_netrunner_subtypes_code.82e267410f"
[0m13:39:12.134675 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11
[0m13:39:12.135295 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.source_unique_netrunner_types_code.63fb152384
[0m13:39:12.135985 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.source_unique_netrunner_packs_code.4fd37b2799
[0m13:39:12.136535 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.source_unique_netrunner_subtypes_code.82e267410f
[0m13:39:12.142806 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.source_unique_netrunner_subtypes_code.82e267410f
[0m13:39:12.141667 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.source_unique_netrunner_types_code.63fb152384
[0m13:39:12.143506 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.source_unique_swapi_planets_id.d844490a10
[0m13:39:12.143877 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_unique_netrunner_types_code.63fb152384, now test.nerd_facts_dbt.source_unique_swapi_planets_id.d844490a10)
[0m13:39:12.144181 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.source_unique_swapi_planets_id.d844490a10
[0m13:39:12.140858 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11"
[0m13:39:12.149499 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11
[0m13:39:12.143133 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.source_unique_swapi_people_id.a65a848ed3
[0m13:39:12.148678 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_unique_swapi_planets_id.d844490a10"
[0m13:39:12.151133 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.source_unique_swapi_planets_id.d844490a10
[0m13:39:12.142117 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.source_unique_swapi_films_id.2e4ee95c0f
[0m13:39:12.150595 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_unique_netrunner_subtypes_code.82e267410f, now test.nerd_facts_dbt.source_unique_swapi_people_id.a65a848ed3)
[0m13:39:12.150171 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11
[0m13:39:12.151750 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.source_unique_swapi_planets_id.d844490a10
[0m13:39:12.152253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_unique_netrunner_packs_code.4fd37b2799, now test.nerd_facts_dbt.source_unique_swapi_films_id.2e4ee95c0f)
[0m13:39:12.152696 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.source_unique_swapi_people_id.a65a848ed3
[0m13:39:12.153084 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.source_unique_swapi_species_id.1559b8a172
[0m13:39:12.153541 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.source_unique_swapi_starships_id.4a35a82bda
[0m13:39:12.153907 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.source_unique_swapi_films_id.2e4ee95c0f
[0m13:39:12.158171 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_unique_swapi_people_id.a65a848ed3"
[0m13:39:12.158788 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11, now test.nerd_facts_dbt.source_unique_swapi_species_id.1559b8a172)
[0m13:39:12.159259 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_unique_swapi_planets_id.d844490a10, now test.nerd_facts_dbt.source_unique_swapi_starships_id.4a35a82bda)
[0m13:39:12.162958 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_unique_swapi_films_id.2e4ee95c0f"
[0m13:39:12.163608 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.source_unique_swapi_species_id.1559b8a172
[0m13:39:12.164017 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.source_unique_swapi_starships_id.4a35a82bda
[0m13:39:12.173210 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_unique_swapi_starships_id.4a35a82bda"
[0m13:39:12.173884 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.source_unique_swapi_people_id.a65a848ed3
[0m13:39:12.174176 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_unique_swapi_species_id.1559b8a172"
[0m13:39:12.174662 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.source_unique_swapi_starships_id.4a35a82bda
[0m13:39:12.175351 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.source_unique_swapi_films_id.2e4ee95c0f
[0m13:39:12.176438 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.source_unique_swapi_people_id.a65a848ed3
[0m13:39:12.177744 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.source_unique_swapi_starships_id.4a35a82bda
[0m13:39:12.179711 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.stg_exposure_relationships
[0m13:39:12.178812 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.source_unique_swapi_films_id.2e4ee95c0f
[0m13:39:12.179250 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.source_unique_swapi_vehicles_id.27e66a26c3
[0m13:39:12.180900 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_unique_swapi_people_id.a65a848ed3, now test.nerd_facts_dbt.source_unique_swapi_vehicles_id.27e66a26c3)
[0m13:39:12.181216 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.source_unique_swapi_vehicles_id.27e66a26c3
[0m13:39:12.185330 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_unique_swapi_vehicles_id.27e66a26c3"
[0m13:39:12.178231 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.source_unique_swapi_species_id.1559b8a172
[0m13:39:12.186695 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.source_unique_swapi_species_id.1559b8a172
[0m13:39:12.180515 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.stg_node_relationships
[0m13:39:12.185966 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.source_unique_swapi_vehicles_id.27e66a26c3
[0m13:39:12.180076 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_unique_swapi_starships_id.4a35a82bda, now model.dbt_project_evaluator.stg_exposure_relationships)
[0m13:39:12.188539 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.stg_exposure_relationships
[0m13:39:12.187100 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.stg_metric_relationships
[0m13:39:12.193386 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_unique_swapi_species_id.1559b8a172, now model.dbt_project_evaluator.stg_metric_relationships)
[0m13:39:12.193766 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.stg_metric_relationships
[0m13:39:12.192780 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.stg_exposure_relationships"
[0m13:39:12.188177 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.source_unique_swapi_vehicles_id.27e66a26c3
[0m13:39:12.197313 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.stg_metric_relationships"
[0m13:39:12.187569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_unique_swapi_films_id.2e4ee95c0f, now model.dbt_project_evaluator.stg_node_relationships)
[0m13:39:12.198078 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.stg_exposure_relationships
[0m13:39:12.198475 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.stg_columns
[0m13:39:12.199206 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.stg_metric_relationships
[0m13:39:12.199551 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.stg_node_relationships
[0m13:39:12.200285 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.stg_exposure_relationships
[0m13:39:12.200733 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_unique_swapi_vehicles_id.27e66a26c3, now model.dbt_project_evaluator.stg_columns)
[0m13:39:12.201384 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.stg_metric_relationships
[0m13:39:12.206179 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.stg_node_relationships"
[0m13:39:12.206773 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.int_all_graph_resources
[0m13:39:12.207254 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.stg_columns
[0m13:39:12.207654 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.dim_netrunner_cards
[0m13:39:12.208263 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.stg_node_relationships
[0m13:39:12.230728 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.stg_node_relationships
[0m13:39:12.229257 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m13:39:12.229989 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_metric_relationships, now model.nerd_facts_dbt.dim_netrunner_cards)
[0m13:39:12.231937 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.dim_netrunner_cards
[0m13:39:12.235180 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_netrunner_cards"
[0m13:39:12.231513 [debug] [Thread-3 (]: On model.dbt_project_evaluator.stg_columns: BEGIN
[0m13:39:12.231092 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.fact_netrunner_card_power
[0m13:39:12.208737 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_exposure_relationships, now model.dbt_project_evaluator.int_all_graph_resources)
[0m13:39:12.235851 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.dim_netrunner_cards
[0m13:39:12.236259 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:39:12.236783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_node_relationships, now model.nerd_facts_dbt.fact_netrunner_card_power)
[0m13:39:12.237144 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.int_all_graph_resources
[0m13:39:12.237778 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.dim_netrunner_cards
[0m13:39:12.249001 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.accepted_values_stg_netrunner_cards_side_code__corp__runner.e1912189e7
[0m13:39:12.249682 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_netrunner_cards, now test.nerd_facts_dbt.accepted_values_stg_netrunner_cards_side_code__corp__runner.e1912189e7)
[0m13:39:12.250061 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.accepted_values_stg_netrunner_cards_side_code__corp__runner.e1912189e7
[0m13:39:12.255096 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.accepted_values_stg_netrunner_cards_side_code__corp__runner.e1912189e7"
[0m13:39:12.238296 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.fact_netrunner_card_power
[0m13:39:12.259560 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_netrunner_card_power"
[0m13:39:12.263600 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m13:39:12.264111 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m13:39:12.264954 [debug] [Thread-4 (]: On model.dbt_project_evaluator.int_all_graph_resources: BEGIN
[0m13:39:12.265437 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.fact_netrunner_card_power
[0m13:39:12.267178 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.fact_netrunner_card_power
[0m13:39:12.265782 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m13:39:12.266503 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:39:12.267561 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_netrunner_cards_agenda_points__3__0.d200763bad
[0m13:39:12.268702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_netrunner_card_power, now test.nerd_facts_dbt.dbt_utils_accepted_range_stg_netrunner_cards_agenda_points__3__0.d200763bad)
[0m13:39:12.269116 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_netrunner_cards_agenda_points__3__0.d200763bad
[0m13:39:12.274102 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_netrunner_cards_agenda_points__3__0.d200763bad"
[0m13:39:12.274839 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_netrunner_cards_agenda_points__3__0.d200763bad
[0m13:39:12.268046 [debug] [Thread-3 (]: On model.dbt_project_evaluator.stg_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_columns"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "nerd_facts".INFORMATION_SCHEMA.columns
      where table_name = 'base_node_columns'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:39:12.266168 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.accepted_values_stg_netrunner_cards_side_code__corp__runner.e1912189e7
[0m13:39:12.276249 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.accepted_values_stg_netrunner_cards_side_code__corp__runner.e1912189e7
[0m13:39:12.276584 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_NOT_is_agenda_true_AND_side_code_runner_.d2a158c7e8
[0m13:39:12.276930 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.accepted_values_stg_netrunner_cards_side_code__corp__runner.e1912189e7, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_NOT_is_agenda_true_AND_side_code_runner_.d2a158c7e8)
[0m13:39:12.277257 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_NOT_is_agenda_true_AND_side_code_runner_.d2a158c7e8
[0m13:39:12.282174 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_NOT_is_agenda_true_AND_side_code_runner_.d2a158c7e8"
[0m13:39:12.283361 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_NOT_is_agenda_true_AND_side_code_runner_.d2a158c7e8
[0m13:39:12.282638 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.007 seconds
[0m13:39:12.290191 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m13:39:12.284064 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_NOT_is_agenda_true_AND_side_code_runner_.d2a158c7e8
[0m13:39:12.275511 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_netrunner_cards_agenda_points__3__0.d200763bad
[0m13:39:12.292128 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_advancement_cost___0_OR_IS_NULL.1abd5a5017
[0m13:39:12.291169 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m13:39:12.293005 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m13:39:12.290795 [debug] [Thread-3 (]: On model.dbt_project_evaluator.stg_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_columns"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "nerd_facts".INFORMATION_SCHEMA.columns
      where table_name = 'base_source_columns'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:39:12.292616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_accepted_range_stg_netrunner_cards_agenda_points__3__0.d200763bad, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_advancement_cost___0_OR_IS_NULL.1abd5a5017)
[0m13:39:12.293868 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_advancement_cost___0_OR_IS_NULL.1abd5a5017
[0m13:39:12.297997 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_advancement_cost___0_OR_IS_NULL.1abd5a5017"
[0m13:39:12.298736 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_advancement_cost___0_OR_IS_NULL.1abd5a5017
[0m13:39:12.299387 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_advancement_cost___0_OR_IS_NULL.1abd5a5017
[0m13:39:12.291727 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards__advancement_cost_IS_NULL_AND_agenda_points_IS_NULL_OR_advancement_cost_IS_NOT_NULL_AND_agenda_points_IS_NOT_NULL_.e96d9d2051
[0m13:39:12.293407 [debug] [Thread-4 (]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "nerd_facts".INFORMATION_SCHEMA.columns
      where table_name = 'stg_nodes'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:39:12.299781 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_cost___0_OR_IS_NULL.1a1c1a1d38
[0m13:39:12.301586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_advancement_cost___0_OR_IS_NULL.1abd5a5017, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_cost___0_OR_IS_NULL.1a1c1a1d38)
[0m13:39:12.300849 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_NOT_is_agenda_true_AND_side_code_runner_.d2a158c7e8, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards__advancement_cost_IS_NULL_AND_agenda_points_IS_NULL_OR_advancement_cost_IS_NOT_NULL_AND_agenda_points_IS_NOT_NULL_.e96d9d2051)
[0m13:39:12.302371 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards__advancement_cost_IS_NULL_AND_agenda_points_IS_NULL_OR_advancement_cost_IS_NOT_NULL_AND_agenda_points_IS_NOT_NULL_.e96d9d2051
[0m13:39:12.306901 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards__advancement_cost_IS_NULL_AND_agenda_points_IS_NULL_OR_advancement_cost_IS_NOT_NULL_AND_agenda_points_IS_NOT_NULL_.e96d9d2051"
[0m13:39:12.300273 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.006 seconds
[0m13:39:12.310223 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.stg_columns"
[0m13:39:12.311311 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.stg_columns
[0m13:39:12.302021 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_cost___0_OR_IS_NULL.1a1c1a1d38
[0m13:39:12.311735 [debug] [Thread-3 (]: On model.dbt_project_evaluator.stg_columns: ROLLBACK
[0m13:39:12.307688 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards__advancement_cost_IS_NULL_AND_agenda_points_IS_NULL_OR_advancement_cost_IS_NOT_NULL_AND_agenda_points_IS_NOT_NULL_.e96d9d2051
[0m13:39:12.310704 [debug] [Thread-4 (]: SQL status: SELECT 28 in 0.009 seconds
[0m13:39:12.315943 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_cost___0_OR_IS_NULL.1a1c1a1d38"
[0m13:39:12.316746 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards__advancement_cost_IS_NULL_AND_agenda_points_IS_NULL_OR_advancement_cost_IS_NOT_NULL_AND_agenda_points_IS_NOT_NULL_.e96d9d2051
[0m13:39:12.317281 [debug] [Thread-3 (]: On model.dbt_project_evaluator.stg_columns: Close
[0m13:39:12.321588 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m13:39:12.322235 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_is_agenda__is_agenda_false_OR_agenda_points_IS_NOT_NULL.a8fb404302
[0m13:39:12.323838 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards__advancement_cost_IS_NULL_AND_agenda_points_IS_NULL_OR_advancement_cost_IS_NOT_NULL_AND_agenda_points_IS_NOT_NULL_.e96d9d2051, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_is_agenda__is_agenda_false_OR_agenda_points_IS_NOT_NULL.a8fb404302)
[0m13:39:12.324156 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_is_agenda__is_agenda_false_OR_agenda_points_IS_NOT_NULL.a8fb404302
[0m13:39:12.323387 [debug] [Thread-4 (]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "nerd_facts".INFORMATION_SCHEMA.columns
      where table_name = 'stg_exposures'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:39:12.322917 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_cost___0_OR_IS_NULL.1a1c1a1d38
[0m13:39:12.391510 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.stg_columns
[0m13:39:12.396799 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_is_ice__is_ice_false_OR_strength_IS_NOT_NULL.7555949034
[0m13:39:12.395681 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_cost___0_OR_IS_NULL.1a1c1a1d38
[0m13:39:12.393095 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_is_agenda__is_agenda_false_OR_agenda_points_IS_NOT_NULL.a8fb404302"
[0m13:39:12.397502 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_columns, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_is_ice__is_ice_false_OR_strength_IS_NOT_NULL.7555949034)
[0m13:39:12.397904 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.004 seconds
[0m13:39:12.398346 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_strength___0_OR_IS_NULL.0994cac55d
[0m13:39:12.398981 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_is_ice__is_ice_false_OR_strength_IS_NOT_NULL.7555949034
[0m13:39:12.399560 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_is_agenda__is_agenda_false_OR_agenda_points_IS_NOT_NULL.a8fb404302
[0m13:39:12.403810 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m13:39:12.404422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_cost___0_OR_IS_NULL.1a1c1a1d38, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_strength___0_OR_IS_NULL.0994cac55d)
[0m13:39:12.409060 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_is_ice__is_ice_false_OR_strength_IS_NOT_NULL.7555949034"
[0m13:39:12.409928 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_is_agenda__is_agenda_false_OR_agenda_points_IS_NOT_NULL.a8fb404302
[0m13:39:12.410348 [debug] [Thread-4 (]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "nerd_facts".INFORMATION_SCHEMA.columns
      where table_name = 'stg_metrics'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:39:12.410749 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_strength___0_OR_IS_NULL.0994cac55d
[0m13:39:12.411353 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_is_ice__is_ice_false_OR_strength_IS_NOT_NULL.7555949034
[0m13:39:12.411754 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.not_null_stg_netrunner_cards_card_id.3b4f6a03b2
[0m13:39:12.414511 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.002 seconds
[0m13:39:12.419019 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_strength___0_OR_IS_NULL.0994cac55d"
[0m13:39:12.419913 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_is_ice__is_ice_false_OR_strength_IS_NOT_NULL.7555949034
[0m13:39:12.420437 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_is_agenda__is_agenda_false_OR_agenda_points_IS_NOT_NULL.a8fb404302, now test.nerd_facts_dbt.not_null_stg_netrunner_cards_card_id.3b4f6a03b2)
[0m13:39:12.424861 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m13:39:12.426860 [debug] [Thread-4 (]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "nerd_facts".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sources'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:39:12.426059 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.not_null_stg_netrunner_cards_faction_code.0f8dc0958f
[0m13:39:12.426519 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_netrunner_cards_card_id.3b4f6a03b2
[0m13:39:12.425681 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_strength___0_OR_IS_NULL.0994cac55d
[0m13:39:12.427322 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_is_ice__is_ice_false_OR_strength_IS_NOT_NULL.7555949034, now test.nerd_facts_dbt.not_null_stg_netrunner_cards_faction_code.0f8dc0958f)
[0m13:39:12.432928 [debug] [Thread-4 (]: SQL status: SELECT 18 in 0.006 seconds
[0m13:39:12.435087 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_netrunner_cards_card_id.3b4f6a03b2"
[0m13:39:12.436003 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_strength___0_OR_IS_NULL.0994cac55d
[0m13:39:12.436485 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_netrunner_cards_faction_code.0f8dc0958f
[0m13:39:12.443554 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.int_all_graph_resources"
[0m13:39:12.444302 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.not_null_stg_netrunner_cards_title.166cc8902c
[0m13:39:12.450195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_cards_strength___0_OR_IS_NULL.0994cac55d, now test.nerd_facts_dbt.not_null_stg_netrunner_cards_title.166cc8902c)
[0m13:39:12.450539 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_netrunner_cards_title.166cc8902c
[0m13:39:12.448812 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_netrunner_cards_faction_code.0f8dc0958f"
[0m13:39:12.455790 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.not_null_stg_netrunner_cards_faction_code.0f8dc0958f
[0m13:39:12.454635 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_netrunner_cards_title.166cc8902c"
[0m13:39:12.449539 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.not_null_stg_netrunner_cards_card_id.3b4f6a03b2
[0m13:39:12.456350 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.int_all_graph_resources
[0m13:39:12.457135 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.not_null_stg_netrunner_cards_faction_code.0f8dc0958f
[0m13:39:12.457827 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.not_null_stg_netrunner_cards_title.166cc8902c
[0m13:39:12.460130 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.not_null_stg_netrunner_cards_title.166cc8902c
[0m13:39:12.458960 [debug] [Thread-4 (]: On model.dbt_project_evaluator.int_all_graph_resources: ROLLBACK
[0m13:39:12.459358 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.not_null_stg_netrunner_cards_type_code.6a190ba3f1
[0m13:39:12.460975 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_netrunner_cards_faction_code.0f8dc0958f, now test.nerd_facts_dbt.not_null_stg_netrunner_cards_type_code.6a190ba3f1)
[0m13:39:12.461305 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_netrunner_cards_type_code.6a190ba3f1
[0m13:39:12.458531 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.not_null_stg_netrunner_cards_card_id.3b4f6a03b2
[0m13:39:12.460469 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.unique_stg_netrunner_cards_card_id.8a41c61802
[0m13:39:12.465149 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_netrunner_cards_type_code.6a190ba3f1"
[0m13:39:12.465613 [debug] [Thread-4 (]: On model.dbt_project_evaluator.int_all_graph_resources: Close
[0m13:39:12.465995 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.accepted_values_stg_netrunner_factions_side_code__corp__runner.c8f8bcad6d
[0m13:39:12.466520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_netrunner_cards_title.166cc8902c, now test.nerd_facts_dbt.unique_stg_netrunner_cards_card_id.8a41c61802)
[0m13:39:12.469376 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_netrunner_cards_card_id.3b4f6a03b2, now test.nerd_facts_dbt.accepted_values_stg_netrunner_factions_side_code__corp__runner.c8f8bcad6d)
[0m13:39:12.469962 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.not_null_stg_netrunner_cards_type_code.6a190ba3f1
[0m13:39:12.470618 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.int_all_graph_resources
[0m13:39:12.471058 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.unique_stg_netrunner_cards_card_id.8a41c61802
[0m13:39:12.471417 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.accepted_values_stg_netrunner_factions_side_code__corp__runner.c8f8bcad6d
[0m13:39:12.482516 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.accepted_values_stg_netrunner_factions_side_code__corp__runner.c8f8bcad6d"
[0m13:39:12.472510 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_factions_card_count___0.18ec718d8b
[0m13:39:12.483813 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.int_all_graph_resources, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_factions_card_count___0.18ec718d8b)
[0m13:39:12.472100 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.not_null_stg_netrunner_cards_type_code.6a190ba3f1
[0m13:39:12.483288 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.accepted_values_stg_netrunner_factions_side_code__corp__runner.c8f8bcad6d
[0m13:39:12.484152 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_factions_card_count___0.18ec718d8b
[0m13:39:12.477260 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_netrunner_cards_card_id.8a41c61802"
[0m13:39:12.484551 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_code.f336d64d9e
[0m13:39:12.485290 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.accepted_values_stg_netrunner_factions_side_code__corp__runner.c8f8bcad6d
[0m13:39:12.489501 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_factions_card_count___0.18ec718d8b"
[0m13:39:12.490272 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.unique_stg_netrunner_cards_card_id.8a41c61802
[0m13:39:12.490679 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_netrunner_cards_type_code.6a190ba3f1, now test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_code.f336d64d9e)
[0m13:39:12.491141 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_id.6f93485553
[0m13:39:12.491786 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_factions_card_count___0.18ec718d8b
[0m13:39:12.492375 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.unique_stg_netrunner_cards_card_id.8a41c61802
[0m13:39:12.492804 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_code.f336d64d9e
[0m13:39:12.493245 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.accepted_values_stg_netrunner_factions_side_code__corp__runner.c8f8bcad6d, now test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_id.6f93485553)
[0m13:39:12.498638 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_id.6f93485553
[0m13:39:12.494265 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_name.d6bf7db21e
[0m13:39:12.498162 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_code.f336d64d9e"
[0m13:39:12.493868 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_factions_card_count___0.18ec718d8b
[0m13:39:12.502249 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_id.6f93485553"
[0m13:39:12.502778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.unique_stg_netrunner_cards_card_id.8a41c61802, now test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_name.d6bf7db21e)
[0m13:39:12.503414 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_code.f336d64d9e
[0m13:39:12.503824 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.not_null_stg_netrunner_factions_side_code.6676ebadef
[0m13:39:12.504388 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_name.d6bf7db21e
[0m13:39:12.509874 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_name.d6bf7db21e"
[0m13:39:12.504810 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_id.6f93485553
[0m13:39:12.510965 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_id.6f93485553
[0m13:39:12.505471 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_code.f336d64d9e
[0m13:39:12.506063 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_factions_card_count___0.18ec718d8b, now test.nerd_facts_dbt.not_null_stg_netrunner_factions_side_code.6676ebadef)
[0m13:39:12.512716 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_netrunner_factions_side_code.6676ebadef
[0m13:39:12.511852 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.unique_stg_netrunner_factions_faction_code.3416ae5674
[0m13:39:12.512338 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.unique_stg_netrunner_factions_faction_id.5a10d31533
[0m13:39:12.511373 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_name.d6bf7db21e
[0m13:39:12.516547 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_netrunner_factions_side_code.6676ebadef"
[0m13:39:12.517088 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_id.6f93485553, now test.nerd_facts_dbt.unique_stg_netrunner_factions_faction_code.3416ae5674)
[0m13:39:12.517533 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_code.f336d64d9e, now test.nerd_facts_dbt.unique_stg_netrunner_factions_faction_id.5a10d31533)
[0m13:39:12.519400 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.unique_stg_netrunner_factions_faction_id.5a10d31533
[0m13:39:12.518726 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.not_null_stg_netrunner_factions_side_code.6676ebadef
[0m13:39:12.525581 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.not_null_stg_netrunner_factions_side_code.6676ebadef
[0m13:39:12.518170 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_name.d6bf7db21e
[0m13:39:12.524606 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_netrunner_factions_faction_id.5a10d31533"
[0m13:39:12.519057 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.unique_stg_netrunner_factions_faction_code.3416ae5674
[0m13:39:12.526031 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.dim_netrunner_factions
[0m13:39:12.526482 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.fact_netrunner_cards
[0m13:39:12.527072 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.unique_stg_netrunner_factions_faction_id.5a10d31533
[0m13:39:12.531208 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_netrunner_factions_faction_code.3416ae5674"
[0m13:39:12.531831 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_netrunner_factions_side_code.6676ebadef, now model.nerd_facts_dbt.dim_netrunner_factions)
[0m13:39:12.532274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_netrunner_factions_faction_name.d6bf7db21e, now model.nerd_facts_dbt.fact_netrunner_cards)
[0m13:39:12.534409 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.fact_netrunner_cards
[0m13:39:12.534023 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.dim_netrunner_factions
[0m13:39:12.532922 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.unique_stg_netrunner_factions_faction_id.5a10d31533
[0m13:39:12.534754 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.unique_stg_netrunner_factions_faction_code.3416ae5674
[0m13:39:12.541350 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m13:39:12.545859 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m13:39:12.546428 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_packs_card_count___0.c1a902beb2
[0m13:39:12.547282 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.unique_stg_netrunner_factions_faction_code.3416ae5674
[0m13:39:12.549423 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_packs_release_date___current_date_OR_IS_NULL.b45470f922
[0m13:39:12.549802 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.unique_stg_netrunner_factions_faction_code.3416ae5674, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_packs_release_date___current_date_OR_IS_NULL.b45470f922)
[0m13:39:12.548919 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.unique_stg_netrunner_factions_faction_id.5a10d31533, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_packs_card_count___0.c1a902beb2)
[0m13:39:12.550527 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_packs_card_count___0.c1a902beb2
[0m13:39:12.548513 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.fact_netrunner_cards
[0m13:39:12.550190 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_packs_release_date___current_date_OR_IS_NULL.b45470f922
[0m13:39:12.547998 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.dim_netrunner_factions
[0m13:39:12.556031 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_packs_card_count___0.c1a902beb2"
[0m13:39:12.556978 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.fact_netrunner_cards
[0m13:39:12.561138 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_packs_release_date___current_date_OR_IS_NULL.b45470f922"
[0m13:39:12.562002 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.dim_netrunner_factions
[0m13:39:12.562666 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_packs_card_count___0.c1a902beb2
[0m13:39:12.563033 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.not_null_stg_netrunner_packs_cycle_code.840c080532
[0m13:39:12.563707 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_packs_release_date___current_date_OR_IS_NULL.b45470f922
[0m13:39:12.564075 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_code.d697381895
[0m13:39:12.564766 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_packs_card_count___0.c1a902beb2
[0m13:39:12.565211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_netrunner_cards, now test.nerd_facts_dbt.not_null_stg_netrunner_packs_cycle_code.840c080532)
[0m13:39:12.566943 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_netrunner_packs_cycle_code.840c080532
[0m13:39:12.566208 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_netrunner_factions, now test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_code.d697381895)
[0m13:39:12.566588 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_id.2eb527422b
[0m13:39:12.565813 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_packs_release_date___current_date_OR_IS_NULL.b45470f922
[0m13:39:12.570943 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_netrunner_packs_cycle_code.840c080532"
[0m13:39:12.571464 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_code.d697381895
[0m13:39:12.571998 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_packs_card_count___0.c1a902beb2, now test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_id.2eb527422b)
[0m13:39:12.572490 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_name.2ffea00bd3
[0m13:39:12.577469 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_netrunner_packs_release_date___current_date_OR_IS_NULL.b45470f922, now test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_name.2ffea00bd3)
[0m13:39:12.576999 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_id.2eb527422b
[0m13:39:12.577814 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_name.2ffea00bd3
[0m13:39:12.585260 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_name.2ffea00bd3"
[0m13:39:12.581576 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_id.2eb527422b"
[0m13:39:12.576498 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_code.d697381895"
[0m13:39:12.585917 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_name.2ffea00bd3
[0m13:39:12.586345 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.not_null_stg_netrunner_packs_cycle_code.840c080532
[0m13:39:12.587393 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_name.2ffea00bd3
[0m13:39:12.587831 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_id.2eb527422b
[0m13:39:12.588251 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_code.d697381895
[0m13:39:12.590607 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_code.d697381895
[0m13:39:12.588843 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.not_null_stg_netrunner_packs_cycle_code.840c080532
[0m13:39:12.590015 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_id.2eb527422b
[0m13:39:12.589304 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.unique_stg_netrunner_packs_pack_code.fcdac2a8e4
[0m13:39:12.590968 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.unique_stg_netrunner_packs_pack_id.17a6fecf9e
[0m13:39:12.592587 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_code.d697381895, now test.nerd_facts_dbt.unique_stg_netrunner_packs_pack_id.17a6fecf9e)
[0m13:39:12.591780 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_ability_id.454a997776
[0m13:39:12.593280 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_id.2eb527422b, now test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_ability_id.454a997776)
[0m13:39:12.592908 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.unique_stg_netrunner_packs_pack_id.17a6fecf9e
[0m13:39:12.591357 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_abilities_pokemon_count___0.b568ce117d
[0m13:39:12.599276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_netrunner_packs_cycle_code.840c080532, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_abilities_pokemon_count___0.b568ce117d)
[0m13:39:12.599676 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_abilities_pokemon_count___0.b568ce117d
[0m13:39:12.598677 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_netrunner_packs_pack_id.17a6fecf9e"
[0m13:39:12.593622 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_ability_id.454a997776
[0m13:39:12.592195 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_netrunner_packs_pack_name.2ffea00bd3, now test.nerd_facts_dbt.unique_stg_netrunner_packs_pack_code.fcdac2a8e4)
[0m13:39:12.603564 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_abilities_pokemon_count___0.b568ce117d"
[0m13:39:12.607372 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_ability_id.454a997776"
[0m13:39:12.608164 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.unique_stg_netrunner_packs_pack_code.fcdac2a8e4
[0m13:39:12.608717 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.unique_stg_netrunner_packs_pack_id.17a6fecf9e
[0m13:39:12.612901 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_netrunner_packs_pack_code.fcdac2a8e4"
[0m13:39:12.615364 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.unique_stg_netrunner_packs_pack_code.fcdac2a8e4
[0m13:39:12.614092 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_ability_id.454a997776
[0m13:39:12.616593 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_ability_id.454a997776
[0m13:39:12.616947 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_ability_name.6b290c6d3e
[0m13:39:12.616006 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.unique_stg_netrunner_packs_pack_code.fcdac2a8e4
[0m13:39:12.613632 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_abilities_pokemon_count___0.b568ce117d
[0m13:39:12.614777 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.unique_stg_netrunner_packs_pack_id.17a6fecf9e
[0m13:39:12.618789 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.unique_stg_pokeapi_abilities_ability_id.73002b7b78
[0m13:39:12.617771 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_effect_description.03e18e135a
[0m13:39:12.618411 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_abilities_pokemon_count___0.b568ce117d
[0m13:39:12.619969 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.dim_pokemon_moves
[0m13:39:12.620354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_abilities_pokemon_count___0.b568ce117d, now model.nerd_facts_dbt.dim_pokemon_moves)
[0m13:39:12.619606 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.unique_stg_netrunner_packs_pack_code.fcdac2a8e4, now test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_effect_description.03e18e135a)
[0m13:39:12.617387 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_ability_id.454a997776, now test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_ability_name.6b290c6d3e)
[0m13:39:12.621302 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_ability_name.6b290c6d3e
[0m13:39:12.620665 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.dim_pokemon_moves
[0m13:39:12.620978 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_effect_description.03e18e135a
[0m13:39:12.635378 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_effect_description.03e18e135a"
[0m13:39:12.625174 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_ability_name.6b290c6d3e"
[0m13:39:12.631444 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_pokemon_moves"
[0m13:39:12.619190 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.unique_stg_netrunner_packs_pack_id.17a6fecf9e, now test.nerd_facts_dbt.unique_stg_pokeapi_abilities_ability_id.73002b7b78)
[0m13:39:12.636040 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_effect_description.03e18e135a
[0m13:39:12.636790 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.dim_pokemon_moves
[0m13:39:12.637321 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_ability_name.6b290c6d3e
[0m13:39:12.637677 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.unique_stg_pokeapi_abilities_ability_id.73002b7b78
[0m13:39:12.638407 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_effect_description.03e18e135a
[0m13:39:12.639063 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.dim_pokemon_moves
[0m13:39:12.639648 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_ability_name.6b290c6d3e
[0m13:39:12.643424 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_pokeapi_abilities_ability_id.73002b7b78"
[0m13:39:12.643979 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_accuracy__100__0.bf1d97b6f1
[0m13:39:12.644406 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_effect_chance__100__0.c16002ba56
[0m13:39:12.644944 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_power__250__0.ae824db77d
[0m13:39:12.647070 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_ability_name.6b290c6d3e, now test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_power__250__0.ae824db77d)
[0m13:39:12.646230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_pokemon_moves, now test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_effect_chance__100__0.c16002ba56)
[0m13:39:12.647725 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_effect_chance__100__0.c16002ba56
[0m13:39:12.647399 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_power__250__0.ae824db77d
[0m13:39:12.645726 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_pokeapi_abilities_effect_description.03e18e135a, now test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_accuracy__100__0.bf1d97b6f1)
[0m13:39:12.646697 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.unique_stg_pokeapi_abilities_ability_id.73002b7b78
[0m13:39:12.652298 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_effect_chance__100__0.c16002ba56"
[0m13:39:12.656653 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_power__250__0.ae824db77d"
[0m13:39:12.657273 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_accuracy__100__0.bf1d97b6f1
[0m13:39:12.658115 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.unique_stg_pokeapi_abilities_ability_id.73002b7b78
[0m13:39:12.658759 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_effect_chance__100__0.c16002ba56
[0m13:39:12.666309 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_effect_chance__100__0.c16002ba56
[0m13:39:12.666660 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_priority__5___7.aa330941c4
[0m13:39:12.665543 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_accuracy__100__0.bf1d97b6f1"
[0m13:39:12.665153 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_pp__40__1.89fb9bec20
[0m13:39:12.664674 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_power__250__0.ae824db77d
[0m13:39:12.667064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_effect_chance__100__0.c16002ba56, now test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_priority__5___7.aa330941c4)
[0m13:39:12.667653 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_accuracy__100__0.bf1d97b6f1
[0m13:39:12.668030 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.unique_stg_pokeapi_abilities_ability_id.73002b7b78, now test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_pp__40__1.89fb9bec20)
[0m13:39:12.668662 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_power__250__0.ae824db77d
[0m13:39:12.669023 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_priority__5___7.aa330941c4
[0m13:39:12.669588 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_accuracy__100__0.bf1d97b6f1
[0m13:39:12.669945 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_pp__40__1.89fb9bec20
[0m13:39:12.670336 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.not_null_stg_pokeapi_moves_move_id.ed207f55ba
[0m13:39:12.674696 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_priority__5___7.aa330941c4"
[0m13:39:12.675283 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.not_null_stg_pokeapi_moves_move_name.e3d107b599
[0m13:39:12.679251 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_pp__40__1.89fb9bec20"
[0m13:39:12.679910 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_power__250__0.ae824db77d, now test.nerd_facts_dbt.not_null_stg_pokeapi_moves_move_id.ed207f55ba)
[0m13:39:12.680737 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_accuracy__100__0.bf1d97b6f1, now test.nerd_facts_dbt.not_null_stg_pokeapi_moves_move_name.e3d107b599)
[0m13:39:12.681200 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_priority__5___7.aa330941c4
[0m13:39:12.683141 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_priority__5___7.aa330941c4
[0m13:39:12.683486 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.unique_stg_pokeapi_moves_move_id.627c191b0b
[0m13:39:12.682481 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_pokeapi_moves_move_name.e3d107b599
[0m13:39:12.683863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_priority__5___7.aa330941c4, now test.nerd_facts_dbt.unique_stg_pokeapi_moves_move_id.627c191b0b)
[0m13:39:12.681720 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_pokeapi_moves_move_id.ed207f55ba
[0m13:39:12.682179 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_pp__40__1.89fb9bec20
[0m13:39:12.687966 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_pokeapi_moves_move_name.e3d107b599"
[0m13:39:12.688555 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.unique_stg_pokeapi_moves_move_id.627c191b0b
[0m13:39:12.692298 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_pokeapi_moves_move_id.ed207f55ba"
[0m13:39:12.693090 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_pp__40__1.89fb9bec20
[0m13:39:12.693687 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.not_null_stg_pokeapi_moves_move_name.e3d107b599
[0m13:39:12.697549 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_pokeapi_moves_move_id.627c191b0b"
[0m13:39:12.698163 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_items_cost___0_OR_IS_NULL.c332b5938b
[0m13:39:12.698651 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.not_null_stg_pokeapi_moves_move_id.ed207f55ba
[0m13:39:12.699298 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.not_null_stg_pokeapi_moves_move_name.e3d107b599
[0m13:39:12.699871 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_accepted_range_stg_pokeapi_moves_pp__40__1.89fb9bec20, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_items_cost___0_OR_IS_NULL.c332b5938b)
[0m13:39:12.701762 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_items_cost___0_OR_IS_NULL.c332b5938b
[0m13:39:12.700897 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.not_null_stg_pokeapi_moves_move_id.ed207f55ba
[0m13:39:12.707975 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.not_null_stg_pokeapi_items_item_name.835b172802
[0m13:39:12.701303 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.not_null_stg_pokeapi_items_item_id.e1f99416f9
[0m13:39:12.707404 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_items_cost___0_OR_IS_NULL.c332b5938b"
[0m13:39:12.709507 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_items_cost___0_OR_IS_NULL.c332b5938b
[0m13:39:12.708374 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_pokeapi_moves_move_id.ed207f55ba, now test.nerd_facts_dbt.not_null_stg_pokeapi_items_item_name.835b172802)
[0m13:39:12.708931 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_pokeapi_moves_move_name.e3d107b599, now test.nerd_facts_dbt.not_null_stg_pokeapi_items_item_id.e1f99416f9)
[0m13:39:12.710805 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_pokeapi_items_item_id.e1f99416f9
[0m13:39:12.714600 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_pokeapi_items_item_id.e1f99416f9"
[0m13:39:12.710480 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_pokeapi_items_item_name.835b172802
[0m13:39:12.700305 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.unique_stg_pokeapi_moves_move_id.627c191b0b
[0m13:39:12.710124 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_items_cost___0_OR_IS_NULL.c332b5938b
[0m13:39:12.719080 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_pokeapi_items_item_name.835b172802"
[0m13:39:12.721785 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.not_null_stg_pokeapi_items_item_name.835b172802
[0m13:39:12.720650 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.unique_stg_pokeapi_moves_move_id.627c191b0b
[0m13:39:12.723432 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.accepted_values_stg_pokeapi_types_type_name__normal__fire__water__electric__grass__ice__fighting__poison__ground__flying__psychic__bug__rock__ghost__dragon__dark__steel__fairy.a64f89e9e1
[0m13:39:12.722723 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.not_null_stg_pokeapi_items_item_name.835b172802
[0m13:39:12.724741 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.not_null_stg_pokeapi_types_type_id.7eab806dd3
[0m13:39:12.724172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.unique_stg_pokeapi_moves_move_id.627c191b0b, now test.nerd_facts_dbt.accepted_values_stg_pokeapi_types_type_name__normal__fire__water__electric__grass__ice__fighting__poison__ground__flying__psychic__bug__rock__ghost__dragon__dark__steel__fairy.a64f89e9e1)
[0m13:39:12.725866 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.accepted_values_stg_pokeapi_types_type_name__normal__fire__water__electric__grass__ice__fighting__poison__ground__flying__psychic__bug__rock__ghost__dragon__dark__steel__fairy.a64f89e9e1
[0m13:39:12.719895 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.not_null_stg_pokeapi_items_item_id.e1f99416f9
[0m13:39:12.725404 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_pokeapi_items_item_name.835b172802, now test.nerd_facts_dbt.not_null_stg_pokeapi_types_type_id.7eab806dd3)
[0m13:39:12.732271 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_pokeapi_types_type_id.7eab806dd3
[0m13:39:12.721073 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.unique_stg_pokeapi_items_item_id.9edce17dc9
[0m13:39:12.737376 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_items_cost___0_OR_IS_NULL.c332b5938b, now test.nerd_facts_dbt.unique_stg_pokeapi_items_item_id.9edce17dc9)
[0m13:39:12.737795 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.unique_stg_pokeapi_items_item_id.9edce17dc9
[0m13:39:12.736791 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_pokeapi_types_type_id.7eab806dd3"
[0m13:39:12.731827 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.not_null_stg_pokeapi_items_item_id.e1f99416f9
[0m13:39:12.743055 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_pokeapi_items_item_id.9edce17dc9"
[0m13:39:12.730887 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.accepted_values_stg_pokeapi_types_type_name__normal__fire__water__electric__grass__ice__fighting__poison__ground__flying__psychic__bug__rock__ghost__dragon__dark__steel__fairy.a64f89e9e1"
[0m13:39:12.744106 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.not_null_stg_pokeapi_types_type_name.34ca71a5c0
[0m13:39:12.744890 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.unique_stg_pokeapi_items_item_id.9edce17dc9
[0m13:39:12.745955 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.not_null_stg_pokeapi_types_type_id.7eab806dd3
[0m13:39:12.746434 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_pokeapi_items_item_id.e1f99416f9, now test.nerd_facts_dbt.not_null_stg_pokeapi_types_type_name.34ca71a5c0)
[0m13:39:12.747001 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.accepted_values_stg_pokeapi_types_type_name__normal__fire__water__electric__grass__ice__fighting__poison__ground__flying__psychic__bug__rock__ghost__dragon__dark__steel__fairy.a64f89e9e1
[0m13:39:12.747724 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.unique_stg_pokeapi_items_item_id.9edce17dc9
[0m13:39:12.748369 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.not_null_stg_pokeapi_types_type_id.7eab806dd3
[0m13:39:12.748735 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_pokeapi_types_type_name.34ca71a5c0
[0m13:39:12.749374 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.accepted_values_stg_pokeapi_types_type_name__normal__fire__water__electric__grass__ice__fighting__poison__ground__flying__psychic__bug__rock__ghost__dragon__dark__steel__fairy.a64f89e9e1
[0m13:39:12.749790 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.unique_stg_pokeapi_types_type_id.5c90e57894
[0m13:39:12.750277 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.bridge_pokemon_abilities
[0m13:39:12.754902 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_pokeapi_types_type_name.34ca71a5c0"
[0m13:39:12.755472 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.bridge_pokemon_moves
[0m13:39:12.756058 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.unique_stg_pokeapi_items_item_id.9edce17dc9, now test.nerd_facts_dbt.unique_stg_pokeapi_types_type_id.5c90e57894)
[0m13:39:12.756520 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_pokeapi_types_type_id.7eab806dd3, now model.nerd_facts_dbt.bridge_pokemon_abilities)
[0m13:39:12.757200 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.not_null_stg_pokeapi_types_type_name.34ca71a5c0
[0m13:39:12.757669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.accepted_values_stg_pokeapi_types_type_name__normal__fire__water__electric__grass__ice__fighting__poison__ground__flying__psychic__bug__rock__ghost__dragon__dark__steel__fairy.a64f89e9e1, now model.nerd_facts_dbt.bridge_pokemon_moves)
[0m13:39:12.758073 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.unique_stg_pokeapi_types_type_id.5c90e57894
[0m13:39:12.758475 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.bridge_pokemon_abilities
[0m13:39:12.759134 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.not_null_stg_pokeapi_types_type_name.34ca71a5c0
[0m13:39:12.759518 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.bridge_pokemon_moves
[0m13:39:12.764177 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_pokeapi_types_type_id.5c90e57894"
[0m13:39:12.771274 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.bridge_pokemon_abilities"
[0m13:39:12.771851 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.dim_pokemon_abilities
[0m13:39:12.778543 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.bridge_pokemon_moves"
[0m13:39:12.779321 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.unique_stg_pokeapi_types_type_id.5c90e57894
[0m13:39:12.780017 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_pokeapi_types_type_name.34ca71a5c0, now model.nerd_facts_dbt.dim_pokemon_abilities)
[0m13:39:12.780493 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.bridge_pokemon_abilities
[0m13:39:12.781479 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.unique_stg_pokeapi_types_type_id.5c90e57894
[0m13:39:12.781876 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.bridge_pokemon_moves
[0m13:39:12.782229 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.dim_pokemon_abilities
[0m13:39:12.782893 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.bridge_pokemon_abilities
[0m13:39:12.793010 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.fact_pokemon
[0m13:39:12.784042 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.bridge_pokemon_moves
[0m13:39:12.792417 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_pokemon_abilities"
[0m13:39:12.783318 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.dim_pokemon_types
[0m13:39:12.795379 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.unique_stg_pokeapi_types_type_id.5c90e57894, now model.nerd_facts_dbt.dim_pokemon_types)
[0m13:39:12.794084 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.fact_pokemon_matchups
[0m13:39:12.796350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.bridge_pokemon_moves, now model.nerd_facts_dbt.fact_pokemon_matchups)
[0m13:39:12.795814 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.dim_pokemon_types
[0m13:39:12.793625 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.bridge_pokemon_abilities, now model.nerd_facts_dbt.fact_pokemon)
[0m13:39:12.804591 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.fact_pokemon
[0m13:39:12.796688 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.fact_pokemon_matchups
[0m13:39:12.804085 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_pokemon_types"
[0m13:39:12.794867 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.dim_pokemon_abilities
[0m13:39:12.811534 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_pokemon"
[0m13:39:12.816675 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_pokemon_matchups"
[0m13:39:12.817697 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.dim_pokemon_abilities
[0m13:39:12.818942 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.fact_pokemon_stats
[0m13:39:12.819511 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_pokemon_abilities, now model.nerd_facts_dbt.fact_pokemon_stats)
[0m13:39:12.820127 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.fact_pokemon_stats
[0m13:39:12.818254 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.dim_pokemon_types
[0m13:39:12.825719 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.fact_pokemon
[0m13:39:12.826357 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.fact_pokemon_matchups
[0m13:39:12.826914 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_pokemon_stats"
[0m13:39:12.827573 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.dim_pokemon_types
[0m13:39:12.828276 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.fact_pokemon
[0m13:39:12.828900 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.fact_pokemon_matchups
[0m13:39:12.831020 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.not_null_stg_pokeapi_pokemon_pokemon_id.54d6f632e9
[0m13:39:12.829925 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_pokemon_height___0_OR_IS_NULL.05fe91c18a
[0m13:39:12.830429 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_pokemon_weight___0_OR_IS_NULL.e7f07e55cb
[0m13:39:12.832377 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_pokemon, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_pokemon_weight___0_OR_IS_NULL.e7f07e55cb)
[0m13:39:12.832730 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_pokemon_weight___0_OR_IS_NULL.e7f07e55cb
[0m13:39:12.831964 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_pokemon_types, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_pokemon_height___0_OR_IS_NULL.05fe91c18a)
[0m13:39:12.839355 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_pokemon_height___0_OR_IS_NULL.05fe91c18a
[0m13:39:12.831501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_pokemon_matchups, now test.nerd_facts_dbt.not_null_stg_pokeapi_pokemon_pokemon_id.54d6f632e9)
[0m13:39:12.838837 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_pokemon_weight___0_OR_IS_NULL.e7f07e55cb"
[0m13:39:12.829546 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.fact_pokemon_stats
[0m13:39:12.843535 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_pokemon_height___0_OR_IS_NULL.05fe91c18a"
[0m13:39:12.844132 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_pokeapi_pokemon_pokemon_id.54d6f632e9
[0m13:39:12.845038 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.fact_pokemon_stats
[0m13:39:12.845563 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_pokemon_weight___0_OR_IS_NULL.e7f07e55cb
[0m13:39:12.850456 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_pokeapi_pokemon_pokemon_id.54d6f632e9"
[0m13:39:12.851159 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.not_null_stg_pokeapi_pokemon_pokemon_name.4c7ee26e1b
[0m13:39:12.851825 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_pokemon_height___0_OR_IS_NULL.05fe91c18a
[0m13:39:12.852608 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_pokemon_weight___0_OR_IS_NULL.e7f07e55cb
[0m13:39:12.853267 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.not_null_stg_pokeapi_pokemon_pokemon_id.54d6f632e9
[0m13:39:12.855407 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.not_null_stg_pokeapi_pokemon_pokemon_id.54d6f632e9
[0m13:39:12.854367 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_pokemon_height___0_OR_IS_NULL.05fe91c18a
[0m13:39:12.856120 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05
[0m13:39:12.856495 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_pokemon_height___0_OR_IS_NULL.05fe91c18a, now test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05)
[0m13:39:12.856806 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05
[0m13:39:12.854773 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.unique_stg_pokeapi_pokemon_pokemon_id.0aae465ab6
[0m13:39:12.853693 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_pokemon_stats, now test.nerd_facts_dbt.not_null_stg_pokeapi_pokemon_pokemon_name.4c7ee26e1b)
[0m13:39:12.855759 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.int_swapi_films
[0m13:39:12.861411 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05"
[0m13:39:12.862040 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_pokeapi_pokemon_weight___0_OR_IS_NULL.e7f07e55cb, now test.nerd_facts_dbt.unique_stg_pokeapi_pokemon_pokemon_id.0aae465ab6)
[0m13:39:12.862470 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_pokeapi_pokemon_pokemon_name.4c7ee26e1b
[0m13:39:12.862873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_pokeapi_pokemon_pokemon_id.54d6f632e9, now model.nerd_facts_dbt.int_swapi_films)
[0m13:39:12.867906 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.int_swapi_films
[0m13:39:12.867382 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_pokeapi_pokemon_pokemon_name.4c7ee26e1b"
[0m13:39:12.873132 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.not_null_stg_pokeapi_pokemon_pokemon_name.4c7ee26e1b
[0m13:39:12.874014 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.not_null_stg_pokeapi_pokemon_pokemon_name.4c7ee26e1b
[0m13:39:12.863355 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.unique_stg_pokeapi_pokemon_pokemon_id.0aae465ab6
[0m13:39:12.872057 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.int_swapi_films"
[0m13:39:12.872495 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05
[0m13:39:12.874410 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696
[0m13:39:12.878429 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_pokeapi_pokemon_pokemon_id.0aae465ab6"
[0m13:39:12.881188 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.unique_stg_pokeapi_pokemon_pokemon_id.0aae465ab6
[0m13:39:12.881801 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.unique_stg_pokeapi_pokemon_pokemon_id.0aae465ab6
[0m13:39:12.879311 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.int_swapi_films
[0m13:39:12.882753 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.int_swapi_films
[0m13:39:12.880578 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_pokeapi_pokemon_pokemon_name.4c7ee26e1b, now test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696)
[0m13:39:12.883412 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696
[0m13:39:12.883068 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_films_film_title.7e4077bef4
[0m13:39:12.880065 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05
[0m13:39:12.882145 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_films_film_id.a339ca4379
[0m13:39:12.889308 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.unique_stg_pokeapi_pokemon_pokemon_id.0aae465ab6, now test.nerd_facts_dbt.not_null_stg_swapi_films_film_id.a339ca4379)
[0m13:39:12.888349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.int_swapi_films, now test.nerd_facts_dbt.not_null_stg_swapi_films_film_title.7e4077bef4)
[0m13:39:12.888806 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74
[0m13:39:12.889656 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_films_film_id.a339ca4379
[0m13:39:12.887694 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696"
[0m13:39:12.889977 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_films_film_title.7e4077bef4
[0m13:39:12.890358 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05, now test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74)
[0m13:39:12.894207 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_films_film_id.a339ca4379"
[0m13:39:12.898186 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_films_film_title.7e4077bef4"
[0m13:39:12.898762 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74
[0m13:39:12.899235 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696
[0m13:39:12.899834 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_films_film_id.a339ca4379
[0m13:39:12.906020 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696
[0m13:39:12.907893 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.unique_stg_swapi_films_film_id.ea5ba181e6
[0m13:39:12.906865 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_films_film_title.7e4077bef4
[0m13:39:12.907485 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_films_film_id.a339ca4379
[0m13:39:12.906483 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74"
[0m13:39:12.909898 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74
[0m13:39:12.908898 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_films_film_title.7e4077bef4
[0m13:39:12.909329 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.dim_characters
[0m13:39:12.911300 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_films_film_id.a339ca4379, now model.nerd_facts_dbt.dim_characters)
[0m13:39:12.908317 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696, now test.nerd_facts_dbt.unique_stg_swapi_films_film_id.ea5ba181e6)
[0m13:39:12.910865 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.fact_power_ratings
[0m13:39:12.910478 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74
[0m13:39:12.911616 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.dim_characters
[0m13:39:12.918326 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_characters"
[0m13:39:12.912273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_films_film_title.7e4077bef4, now model.nerd_facts_dbt.fact_power_ratings)
[0m13:39:12.912641 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.fact_sw_characters
[0m13:39:12.911928 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.unique_stg_swapi_films_film_id.ea5ba181e6
[0m13:39:12.918954 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.dim_characters
[0m13:39:12.919376 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.fact_power_ratings
[0m13:39:12.919847 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74, now model.nerd_facts_dbt.fact_sw_characters)
[0m13:39:12.924043 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_swapi_films_film_id.ea5ba181e6"
[0m13:39:12.924819 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.dim_characters
[0m13:39:12.931250 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_power_ratings"
[0m13:39:12.931760 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.fact_sw_characters
[0m13:39:12.932503 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.int_swapi_films_characters
[0m13:39:12.933251 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.unique_stg_swapi_films_film_id.ea5ba181e6
[0m13:39:12.938888 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.unique_stg_swapi_films_film_id.ea5ba181e6
[0m13:39:12.938149 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_characters, now model.nerd_facts_dbt.int_swapi_films_characters)
[0m13:39:12.937534 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_sw_characters"
[0m13:39:12.939245 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.fact_power_ratings
[0m13:39:12.939657 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.int_swapi_people
[0m13:39:12.940070 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.int_swapi_films_characters
[0m13:39:12.940625 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.fact_sw_characters
[0m13:39:12.941261 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.fact_power_ratings
[0m13:39:12.941717 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.unique_stg_swapi_films_film_id.ea5ba181e6, now model.nerd_facts_dbt.int_swapi_people)
[0m13:39:12.947624 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.int_swapi_films_characters"
[0m13:39:12.948370 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.fact_sw_characters
[0m13:39:12.948937 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_people_height___0_OR_IS_NULL.fa60c94a6e
[0m13:39:12.949411 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.int_swapi_people
[0m13:39:12.949940 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.int_swapi_films_characters
[0m13:39:12.950313 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f
[0m13:39:12.955244 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_sw_characters, now test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f)
[0m13:39:12.955591 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f
[0m13:39:12.950821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_power_ratings, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_people_height___0_OR_IS_NULL.fa60c94a6e)
[0m13:39:12.960192 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_people_height___0_OR_IS_NULL.fa60c94a6e
[0m13:39:12.954692 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.int_swapi_films_characters
[0m13:39:12.959509 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f"
[0m13:39:12.964258 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_people_height___0_OR_IS_NULL.fa60c94a6e"
[0m13:39:12.953966 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.int_swapi_people"
[0m13:39:12.964833 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_people_people_id.9097a6c93c
[0m13:39:12.966643 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.int_swapi_films_characters, now test.nerd_facts_dbt.not_null_stg_swapi_people_people_id.9097a6c93c)
[0m13:39:12.966965 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_people_people_id.9097a6c93c
[0m13:39:12.965665 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_people_height___0_OR_IS_NULL.fa60c94a6e
[0m13:39:12.966124 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f
[0m13:39:12.967351 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.int_swapi_people
[0m13:39:12.971136 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_people_people_id.9097a6c93c"
[0m13:39:12.971954 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_people_height___0_OR_IS_NULL.fa60c94a6e
[0m13:39:12.972632 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f
[0m13:39:12.973256 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.int_swapi_people
[0m13:39:12.975088 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.int_swapi_films_planets
[0m13:39:12.974221 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.unique_stg_swapi_people_people_id.49907a6ad0
[0m13:39:12.975980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_people_height___0_OR_IS_NULL.fa60c94a6e, now test.nerd_facts_dbt.unique_stg_swapi_people_people_id.49907a6ad0)
[0m13:39:12.976271 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.unique_stg_swapi_people_people_id.49907a6ad0
[0m13:39:12.975606 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.int_swapi_people, now model.nerd_facts_dbt.int_swapi_films_planets)
[0m13:39:12.973873 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_people_people_id.9097a6c93c
[0m13:39:12.974686 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.dim_locations
[0m13:39:12.981245 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_swapi_people_people_id.49907a6ad0"
[0m13:39:12.981877 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.int_swapi_films_planets
[0m13:39:12.982562 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_people_people_id.9097a6c93c
[0m13:39:12.983056 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f, now model.nerd_facts_dbt.dim_locations)
[0m13:39:12.983671 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.unique_stg_swapi_people_people_id.49907a6ad0
[0m13:39:12.988271 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.int_swapi_films_planets"
[0m13:39:12.988809 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.int_swapi_planets
[0m13:39:12.989273 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.dim_locations
[0m13:39:12.989900 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.unique_stg_swapi_people_people_id.49907a6ad0
[0m13:39:12.990473 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_people_people_id.9097a6c93c, now model.nerd_facts_dbt.int_swapi_planets)
[0m13:39:12.995294 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.int_swapi_planets
[0m13:39:12.994822 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.int_swapi_planets_characters
[0m13:39:12.994224 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_locations"
[0m13:39:12.995733 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.int_swapi_films_planets
[0m13:39:12.999230 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.int_swapi_planets"
[0m13:39:12.999858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.unique_stg_swapi_people_people_id.49907a6ad0, now model.nerd_facts_dbt.int_swapi_planets_characters)
[0m13:39:13.000522 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.dim_locations
[0m13:39:13.001141 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.int_swapi_films_planets
[0m13:39:13.001713 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.int_swapi_planets
[0m13:39:13.003892 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.int_swapi_planets
[0m13:39:13.002665 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.dim_locations
[0m13:39:13.004658 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_planets_planet_id.0392ef05b9
[0m13:39:13.005041 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_locations, now test.nerd_facts_dbt.not_null_stg_swapi_planets_planet_id.0392ef05b9)
[0m13:39:13.005363 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_planets_planet_id.0392ef05b9
[0m13:39:13.004219 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78
[0m13:39:13.009709 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.int_swapi_planets, now test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78)
[0m13:39:13.002050 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.int_swapi_planets_characters
[0m13:39:13.003092 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03
[0m13:39:13.009130 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_planets_planet_id.0392ef05b9"
[0m13:39:13.010331 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78
[0m13:39:13.016543 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.int_swapi_planets_characters"
[0m13:39:13.017109 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.int_swapi_films_planets, now test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03)
[0m13:39:13.017788 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_planets_planet_id.0392ef05b9
[0m13:39:13.021662 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78"
[0m13:39:13.022396 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03
[0m13:39:13.023078 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_planets_planet_id.0392ef05b9
[0m13:39:13.028615 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.unique_stg_swapi_planets_planet_id.615d4daee0
[0m13:39:13.028034 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03"
[0m13:39:13.029139 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_planets_planet_id.0392ef05b9, now test.nerd_facts_dbt.unique_stg_swapi_planets_planet_id.615d4daee0)
[0m13:39:13.023483 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.int_swapi_planets_characters
[0m13:39:13.029658 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78
[0m13:39:13.030204 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03
[0m13:39:13.030506 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.unique_stg_swapi_planets_planet_id.615d4daee0
[0m13:39:13.031160 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.int_swapi_planets_characters
[0m13:39:13.031787 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78
[0m13:39:13.037962 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.int_swapi_films_species
[0m13:39:13.036764 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_swapi_planets_planet_id.615d4daee0"
[0m13:39:13.037335 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.int_swapi_characters_species
[0m13:39:13.032457 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03
[0m13:39:13.038390 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78, now model.nerd_facts_dbt.int_swapi_films_species)
[0m13:39:13.040209 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.int_swapi_films_species
[0m13:39:13.039393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.int_swapi_planets_characters, now model.nerd_facts_dbt.int_swapi_characters_species)
[0m13:39:13.039818 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.int_swapi_species
[0m13:39:13.039025 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.unique_stg_swapi_planets_planet_id.615d4daee0
[0m13:39:13.044598 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.int_swapi_films_species"
[0m13:39:13.045117 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.int_swapi_characters_species
[0m13:39:13.045611 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03, now model.nerd_facts_dbt.int_swapi_species)
[0m13:39:13.046269 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.unique_stg_swapi_planets_planet_id.615d4daee0
[0m13:39:13.046885 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.int_swapi_films_species
[0m13:39:13.051299 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.int_swapi_characters_species"
[0m13:39:13.051814 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.int_swapi_species
[0m13:39:13.052272 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221
[0m13:39:13.053002 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.int_swapi_films_species
[0m13:39:13.057292 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.int_swapi_species"
[0m13:39:13.057875 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.unique_stg_swapi_planets_planet_id.615d4daee0, now test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221)
[0m13:39:13.058452 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_species_species_id.037c430261
[0m13:39:13.059991 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.int_swapi_films_species, now test.nerd_facts_dbt.not_null_stg_swapi_species_species_id.037c430261)
[0m13:39:13.059449 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221
[0m13:39:13.059002 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.int_swapi_characters_species
[0m13:39:13.065424 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.int_swapi_characters_species
[0m13:39:13.065841 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.unique_stg_swapi_species_species_id.eef5924130
[0m13:39:13.064584 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221"
[0m13:39:13.060637 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.int_swapi_species
[0m13:39:13.060331 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_species_species_id.037c430261
[0m13:39:13.066271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.int_swapi_characters_species, now test.nerd_facts_dbt.unique_stg_swapi_species_species_id.eef5924130)
[0m13:39:13.066906 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221
[0m13:39:13.067485 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.int_swapi_species
[0m13:39:13.071246 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_species_species_id.037c430261"
[0m13:39:13.071761 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.unique_stg_swapi_species_species_id.eef5924130
[0m13:39:13.072446 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221
[0m13:39:13.072922 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.int_swapi_films_starships
[0m13:39:13.078432 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.int_swapi_species, now model.nerd_facts_dbt.int_swapi_films_starships)
[0m13:39:13.078747 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.int_swapi_films_starships
[0m13:39:13.077903 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.int_swapi_starships
[0m13:39:13.076898 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_swapi_species_species_id.eef5924130"
[0m13:39:13.077505 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_species_species_id.037c430261
[0m13:39:13.083415 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.int_swapi_films_starships"
[0m13:39:13.083983 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221, now model.nerd_facts_dbt.int_swapi_starships)
[0m13:39:13.085000 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_species_species_id.037c430261
[0m13:39:13.085392 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.unique_stg_swapi_species_species_id.eef5924130
[0m13:39:13.085830 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.int_swapi_starships
[0m13:39:13.086294 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.int_swapi_starships_people
[0m13:39:13.086747 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.int_swapi_films_starships
[0m13:39:13.087323 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.unique_stg_swapi_species_species_id.eef5924130
[0m13:39:13.092242 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.int_swapi_starships"
[0m13:39:13.094648 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.int_swapi_starships
[0m13:39:13.093571 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.int_swapi_films_starships
[0m13:39:13.095663 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_starships_starship_id.33d24c92bc
[0m13:39:13.095244 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.int_swapi_starships
[0m13:39:13.092869 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_species_species_id.037c430261, now model.nerd_facts_dbt.int_swapi_starships_people)
[0m13:39:13.096903 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.int_swapi_starships_people
[0m13:39:13.096024 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.int_swapi_films_starships, now test.nerd_facts_dbt.not_null_stg_swapi_starships_starship_id.33d24c92bc)
[0m13:39:13.101267 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_starships_starship_id.33d24c92bc
[0m13:39:13.100713 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.int_swapi_starships_people"
[0m13:39:13.093989 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5
[0m13:39:13.105062 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_starships_starship_id.33d24c92bc"
[0m13:39:13.096455 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.unique_stg_swapi_starships_starship_id.8d2f1e1387
[0m13:39:13.105766 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.int_swapi_starships_people
[0m13:39:13.106214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.unique_stg_swapi_species_species_id.eef5924130, now test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5)
[0m13:39:13.106881 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_starships_starship_id.33d24c92bc
[0m13:39:13.107248 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.int_swapi_starships, now test.nerd_facts_dbt.unique_stg_swapi_starships_starship_id.8d2f1e1387)
[0m13:39:13.107912 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.int_swapi_starships_people
[0m13:39:13.108651 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5
[0m13:39:13.109260 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_starships_starship_id.33d24c92bc
[0m13:39:13.109637 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.unique_stg_swapi_starships_starship_id.8d2f1e1387
[0m13:39:13.109990 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.int_swapi_films_vehicles
[0m13:39:13.119344 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.int_swapi_starships_people, now model.nerd_facts_dbt.int_swapi_films_vehicles)
[0m13:39:13.114668 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.int_swapi_vehicles
[0m13:39:13.118780 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_swapi_starships_starship_id.8d2f1e1387"
[0m13:39:13.119719 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.int_swapi_films_vehicles
[0m13:39:13.114002 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5"
[0m13:39:13.120100 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_starships_starship_id.33d24c92bc, now model.nerd_facts_dbt.int_swapi_vehicles)
[0m13:39:13.120715 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.unique_stg_swapi_starships_starship_id.8d2f1e1387
[0m13:39:13.126790 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.int_swapi_films_vehicles"
[0m13:39:13.127453 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5
[0m13:39:13.127801 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.int_swapi_vehicles
[0m13:39:13.128589 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.unique_stg_swapi_starships_starship_id.8d2f1e1387
[0m13:39:13.129189 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.int_swapi_films_vehicles
[0m13:39:13.134370 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.int_swapi_films_vehicles
[0m13:39:13.133096 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.int_swapi_vehicles"
[0m13:39:13.135349 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.int_swapi_vehicles
[0m13:39:13.135947 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.int_swapi_vehicles
[0m13:39:13.136260 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_vehicles_vehicle_id.44275887db
[0m13:39:13.136719 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.int_swapi_vehicles, now test.nerd_facts_dbt.not_null_stg_swapi_vehicles_vehicle_id.44275887db)
[0m13:39:13.137008 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_vehicles_vehicle_id.44275887db
[0m13:39:13.129815 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5
[0m13:39:13.133629 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.int_swapi_vehicles_people
[0m13:39:13.134701 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7
[0m13:39:13.142431 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.int_swapi_films_vehicles, now test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7)
[0m13:39:13.141436 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.unique_stg_swapi_vehicles_vehicle_id.f42372d3a8
[0m13:39:13.142003 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.unique_stg_swapi_starships_starship_id.8d2f1e1387, now model.nerd_facts_dbt.int_swapi_vehicles_people)
[0m13:39:13.144025 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.int_swapi_vehicles_people
[0m13:39:13.142762 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7
[0m13:39:13.143526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5, now test.nerd_facts_dbt.unique_stg_swapi_vehicles_vehicle_id.f42372d3a8)
[0m13:39:13.140829 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_vehicles_vehicle_id.44275887db"
[0m13:39:13.147742 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.int_swapi_vehicles_people"
[0m13:39:13.152408 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7"
[0m13:39:13.152947 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.unique_stg_swapi_vehicles_vehicle_id.f42372d3a8
[0m13:39:13.153877 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_vehicles_vehicle_id.44275887db
[0m13:39:13.154552 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7
[0m13:39:13.158864 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_swapi_vehicles_vehicle_id.f42372d3a8"
[0m13:39:13.159431 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.int_swapi_vehicles_people
[0m13:39:13.160166 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_vehicles_vehicle_id.44275887db
[0m13:39:13.160832 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7
[0m13:39:13.161411 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.unique_stg_swapi_vehicles_vehicle_id.f42372d3a8
[0m13:39:13.163490 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.unique_stg_swapi_vehicles_vehicle_id.f42372d3a8
[0m13:39:13.162464 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.fct_documentation_coverage
[0m13:39:13.164226 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_vehicles_vehicle_id.44275887db, now model.dbt_project_evaluator.fct_documentation_coverage)
[0m13:39:13.164535 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.fct_documentation_coverage
[0m13:39:13.162895 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.fct_duplicate_sources
[0m13:39:13.172889 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7, now model.dbt_project_evaluator.fct_duplicate_sources)
[0m13:39:13.173312 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.fct_duplicate_sources
[0m13:39:13.172257 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_documentation_coverage"
[0m13:39:13.163843 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.fct_hard_coded_references
[0m13:39:13.162034 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.int_swapi_vehicles_people
[0m13:39:13.178634 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_duplicate_sources"
[0m13:39:13.179375 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.fct_documentation_coverage
[0m13:39:13.179824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.unique_stg_swapi_vehicles_vehicle_id.f42372d3a8, now model.dbt_project_evaluator.fct_hard_coded_references)
[0m13:39:13.180330 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.fct_model_naming_conventions
[0m13:39:13.181328 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.fct_documentation_coverage
[0m13:39:13.181862 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.fct_duplicate_sources
[0m13:39:13.182195 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.fct_hard_coded_references
[0m13:39:13.182613 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.int_swapi_vehicles_people, now model.dbt_project_evaluator.fct_model_naming_conventions)
[0m13:39:13.188635 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.fct_model_naming_conventions
[0m13:39:13.183003 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.fct_public_models_without_contract
[0m13:39:13.188100 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_hard_coded_references"
[0m13:39:13.183756 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.fct_duplicate_sources
[0m13:39:13.194882 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m13:39:13.195500 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_documentation_coverage, now model.dbt_project_evaluator.fct_public_models_without_contract)
[0m13:39:13.196251 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.fct_hard_coded_references
[0m13:39:13.196714 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.fct_source_directories
[0m13:39:13.197564 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.fct_model_naming_conventions
[0m13:39:13.197914 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.fct_public_models_without_contract
[0m13:39:13.198607 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.fct_hard_coded_references
[0m13:39:13.199039 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_duplicate_sources, now model.dbt_project_evaluator.fct_source_directories)
[0m13:39:13.205519 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.fct_source_directories
[0m13:39:13.204316 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m13:39:13.204886 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.fct_sources_without_freshness
[0m13:39:13.199724 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.fct_model_naming_conventions
[0m13:39:13.212066 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_source_directories"
[0m13:39:13.214740 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.fct_source_directories
[0m13:39:13.213462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_hard_coded_references, now model.dbt_project_evaluator.fct_sources_without_freshness)
[0m13:39:13.213956 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.fct_undocumented_models
[0m13:39:13.212923 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.fct_public_models_without_contract
[0m13:39:13.215438 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.fct_source_directories
[0m13:39:13.215857 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.fct_sources_without_freshness
[0m13:39:13.216277 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_model_naming_conventions, now model.dbt_project_evaluator.fct_undocumented_models)
[0m13:39:13.222532 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.fct_undocumented_models
[0m13:39:13.217337 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.fct_undocumented_public_models
[0m13:39:13.222034 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m13:39:13.228393 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.fct_sources_without_freshness
[0m13:39:13.227701 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_source_directories, now model.dbt_project_evaluator.fct_undocumented_public_models)
[0m13:39:13.229510 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.fct_undocumented_public_models
[0m13:39:13.229114 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.fct_sources_without_freshness
[0m13:39:13.234815 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.fct_undocumented_source_tables
[0m13:39:13.226922 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_undocumented_models"
[0m13:39:13.236185 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.fct_undocumented_models
[0m13:39:13.216929 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.fct_public_models_without_contract
[0m13:39:13.237325 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.fct_undocumented_sources
[0m13:39:13.236903 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.fct_undocumented_models
[0m13:39:13.234187 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m13:39:13.239084 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.fct_undocumented_public_models
[0m13:39:13.235528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_sources_without_freshness, now model.dbt_project_evaluator.fct_undocumented_source_tables)
[0m13:39:13.238349 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.int_direct_relationships
[0m13:39:13.239776 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.fct_undocumented_public_models
[0m13:39:13.237922 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_public_models_without_contract, now model.dbt_project_evaluator.fct_undocumented_sources)
[0m13:39:13.241513 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.fct_undocumented_sources
[0m13:39:13.240578 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_undocumented_models, now model.dbt_project_evaluator.int_direct_relationships)
[0m13:39:13.240993 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.pokemon_obt
[0m13:39:13.246160 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_undocumented_sources"
[0m13:39:13.240154 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.fct_undocumented_source_tables
[0m13:39:13.246690 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.int_direct_relationships
[0m13:39:13.247230 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_undocumented_public_models, now model.nerd_facts_dbt.pokemon_obt)
[0m13:39:13.247907 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.fct_undocumented_sources
[0m13:39:13.253627 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m13:39:13.259017 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.int_direct_relationships"
[0m13:39:13.259655 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.pokemon_obt
[0m13:39:13.260448 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.fct_undocumented_sources
[0m13:39:13.264532 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.pokemon_obt"
[0m13:39:13.265385 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.fct_undocumented_source_tables
[0m13:39:13.265872 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.not_null_column_dim_characters_character_id.c97cad84e1
[0m13:39:13.268329 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_undocumented_sources, now test.nerd_facts_dbt.not_null_column_dim_characters_character_id.c97cad84e1)
[0m13:39:13.268685 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.not_null_column_dim_characters_character_id.c97cad84e1
[0m13:39:13.267868 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.fct_undocumented_source_tables
[0m13:39:13.266660 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.int_direct_relationships
[0m13:39:13.273278 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_column_dim_characters_character_id.c97cad84e1"
[0m13:39:13.267164 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.pokemon_obt
[0m13:39:13.273845 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.not_null_column_dim_characters_name.9bb85b23a6
[0m13:39:13.274793 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.int_direct_relationships
[0m13:39:13.275624 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.pokemon_obt
[0m13:39:13.277504 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.unique_column_dim_characters_character_id.84b36a6ff7
[0m13:39:13.276460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_undocumented_source_tables, now test.nerd_facts_dbt.not_null_column_dim_characters_name.9bb85b23a6)
[0m13:39:13.276898 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.test_sw_character_quality
[0m13:39:13.276044 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.not_null_column_dim_characters_character_id.c97cad84e1
[0m13:39:13.278049 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.pokemon_obt, now test.nerd_facts_dbt.unique_column_dim_characters_character_id.84b36a6ff7)
[0m13:39:13.278422 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.not_null_column_dim_characters_name.9bb85b23a6
[0m13:39:13.278834 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.int_direct_relationships, now test.nerd_facts_dbt.test_sw_character_quality)
[0m13:39:13.279471 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.not_null_column_dim_characters_character_id.c97cad84e1
[0m13:39:13.279864 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.unique_column_dim_characters_character_id.84b36a6ff7
[0m13:39:13.284637 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_column_dim_characters_name.9bb85b23a6"
[0m13:39:13.285214 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.test_sw_character_quality
[0m13:39:13.285694 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.bridge_sw_characters_films
[0m13:39:13.290197 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_column_dim_characters_character_id.84b36a6ff7"
[0m13:39:13.290930 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.not_null_column_dim_characters_name.9bb85b23a6
[0m13:39:13.295625 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.test_sw_character_quality"
[0m13:39:13.296285 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_column_dim_characters_character_id.c97cad84e1, now model.nerd_facts_dbt.bridge_sw_characters_films)
[0m13:39:13.297552 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.not_null_column_dim_characters_name.9bb85b23a6
[0m13:39:13.297999 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.unique_column_dim_characters_character_id.84b36a6ff7
[0m13:39:13.298574 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.bridge_sw_characters_films
[0m13:39:13.299138 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.test_sw_character_quality
[0m13:39:13.299653 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.bridge_sw_films_planets
[0m13:39:13.308405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_column_dim_characters_name.9bb85b23a6, now model.nerd_facts_dbt.bridge_sw_films_planets)
[0m13:39:13.307210 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.bridge_sw_characters_films"
[0m13:39:13.308011 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.test_sw_character_quality
[0m13:39:13.308713 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.bridge_sw_films_planets
[0m13:39:13.300490 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.unique_column_dim_characters_character_id.84b36a6ff7
[0m13:39:13.309276 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.bridge_sw_characters_films
[0m13:39:13.309721 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.dim_sw_characters
[0m13:39:13.316212 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.bridge_sw_films_planets"
[0m13:39:13.316751 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.dim_sw_planets
[0m13:39:13.317590 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.bridge_sw_characters_films
[0m13:39:13.318059 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.test_sw_character_quality, now model.nerd_facts_dbt.dim_sw_characters)
[0m13:39:13.318573 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.unique_column_dim_characters_character_id.84b36a6ff7, now model.nerd_facts_dbt.dim_sw_planets)
[0m13:39:13.319716 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.dim_sw_planets
[0m13:39:13.319362 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.dim_sw_characters
[0m13:39:13.318959 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.dim_sw_species
[0m13:39:13.324752 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_sw_planets"
[0m13:39:13.325232 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.bridge_sw_films_planets
[0m13:39:13.331689 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_sw_characters"
[0m13:39:13.332329 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.bridge_sw_characters_films, now model.nerd_facts_dbt.dim_sw_species)
[0m13:39:13.332976 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.dim_sw_planets
[0m13:39:13.333646 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.bridge_sw_films_planets
[0m13:39:13.334130 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.dim_sw_species
[0m13:39:13.334738 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.dim_sw_planets
[0m13:39:13.335124 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.dim_sw_characters
[0m13:39:13.335514 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.bridge_sw_starships_pilots
[0m13:39:13.341618 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_sw_species"
[0m13:39:13.342207 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m13:39:13.343065 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.dim_sw_characters
[0m13:39:13.343572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.bridge_sw_films_planets, now model.nerd_facts_dbt.bridge_sw_starships_pilots)
[0m13:39:13.344580 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_sw_planets, now model.nerd_facts_dbt.fact_starships)
[0m13:39:13.345086 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.dim_sw_films
[0m13:39:13.345920 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.bridge_sw_starships_pilots
[0m13:39:13.346331 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m13:39:13.346705 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.dim_sw_species
[0m13:39:13.347134 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_sw_characters, now model.nerd_facts_dbt.dim_sw_films)
[0m13:39:13.355961 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.bridge_sw_starships_pilots"
[0m13:39:13.361327 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m13:39:13.362227 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.dim_sw_species
[0m13:39:13.362668 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.dim_sw_films
[0m13:39:13.363363 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.bridge_sw_starships_pilots
[0m13:39:13.363911 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.fact_sw_films
[0m13:39:13.370731 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_sw_films"
[0m13:39:13.371222 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m13:39:13.372054 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.bridge_sw_starships_pilots
[0m13:39:13.372532 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_sw_species, now model.nerd_facts_dbt.fact_sw_films)
[0m13:39:13.373179 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.dim_sw_films
[0m13:39:13.373835 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m13:39:13.374259 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.dim_sw_vehicles
[0m13:39:13.374706 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.fact_sw_films
[0m13:39:13.375337 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.dim_sw_films
[0m13:39:13.375760 [debug] [Thread-3 (]: Began running node test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7
[0m13:39:13.385676 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_starships, now test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7)
[0m13:39:13.384317 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_sw_films"
[0m13:39:13.384938 [debug] [Thread-4 (]: Began running node test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31
[0m13:39:13.386073 [debug] [Thread-3 (]: Began compiling node test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7
[0m13:39:13.376225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.bridge_sw_starships_pilots, now model.nerd_facts_dbt.dim_sw_vehicles)
[0m13:39:13.386741 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.fact_sw_films
[0m13:39:13.387175 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_sw_films, now test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31)
[0m13:39:13.392816 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7"
[0m13:39:13.393327 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.dim_sw_vehicles
[0m13:39:13.394184 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.fact_sw_films
[0m13:39:13.394598 [debug] [Thread-4 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31
[0m13:39:13.400914 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_sw_vehicles"
[0m13:39:13.401412 [debug] [Thread-2 (]: Began running node test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113
[0m13:39:13.407179 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_sw_films, now test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113)
[0m13:39:13.405949 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31"
[0m13:39:13.406480 [debug] [Thread-3 (]: Began executing node test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7
[0m13:39:13.407657 [debug] [Thread-2 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113
[0m13:39:13.408342 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.dim_sw_vehicles
[0m13:39:13.414824 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.dim_sw_vehicles
[0m13:39:13.415401 [debug] [Thread-1 (]: Began running node test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2
[0m13:39:13.413997 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113"
[0m13:39:13.409085 [debug] [Thread-3 (]: Finished running node test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7
[0m13:39:13.409507 [debug] [Thread-4 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31
[0m13:39:13.415938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_sw_vehicles, now test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2)
[0m13:39:13.416596 [debug] [Thread-2 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113
[0m13:39:13.416994 [debug] [Thread-3 (]: Began running node test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c
[0m13:39:13.417766 [debug] [Thread-4 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31
[0m13:39:13.418133 [debug] [Thread-1 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2
[0m13:39:13.418739 [debug] [Thread-2 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113
[0m13:39:13.419146 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7, now test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c)
[0m13:39:13.419551 [debug] [Thread-4 (]: Began running node test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283
[0m13:39:13.426342 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31, now test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283)
[0m13:39:13.425522 [debug] [Thread-2 (]: Began running node test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0
[0m13:39:13.425936 [debug] [Thread-3 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c
[0m13:39:13.426691 [debug] [Thread-4 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283
[0m13:39:13.500483 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283"
[0m13:39:13.424950 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2"
[0m13:39:13.496634 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c"
[0m13:39:13.427064 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113, now test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0)
[0m13:39:13.501191 [debug] [Thread-4 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283
[0m13:39:13.501796 [debug] [Thread-1 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2
[0m13:39:13.502392 [debug] [Thread-3 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c
[0m13:39:13.502786 [debug] [Thread-2 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0
[0m13:39:13.503453 [debug] [Thread-4 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283
[0m13:39:13.504093 [debug] [Thread-1 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2
[0m13:39:13.504766 [debug] [Thread-3 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c
[0m13:39:13.510579 [debug] [Thread-3 (]: Began running node test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235
[0m13:39:13.509675 [debug] [Thread-4 (]: Began running node test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c
[0m13:39:13.510175 [debug] [Thread-1 (]: Began running node test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938
[0m13:39:13.511816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2, now test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938)
[0m13:39:13.512142 [debug] [Thread-1 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938
[0m13:39:13.511421 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283, now test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c)
[0m13:39:13.509111 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0"
[0m13:39:13.517358 [debug] [Thread-2 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0
[0m13:39:13.518011 [debug] [Thread-2 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0
[0m13:39:13.516776 [debug] [Thread-4 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c
[0m13:39:13.518345 [debug] [Thread-2 (]: Began running node test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166
[0m13:39:13.516283 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938"
[0m13:39:13.510997 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c, now test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235)
[0m13:39:13.522285 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c"
[0m13:39:13.522872 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0, now test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166)
[0m13:39:13.523394 [debug] [Thread-3 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235
[0m13:39:13.523828 [debug] [Thread-1 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938
[0m13:39:13.530812 [debug] [Thread-1 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938
[0m13:39:13.531218 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.fct_test_directories
[0m13:39:13.529881 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235"
[0m13:39:13.524357 [debug] [Thread-4 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c
[0m13:39:13.524704 [debug] [Thread-2 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166
[0m13:39:13.531728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938, now model.dbt_project_evaluator.fct_test_directories)
[0m13:39:13.537693 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.fct_test_directories
[0m13:39:13.532899 [debug] [Thread-3 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235
[0m13:39:13.537137 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166"
[0m13:39:13.541447 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_test_directories"
[0m13:39:13.532509 [debug] [Thread-4 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c
[0m13:39:13.542217 [debug] [Thread-3 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235
[0m13:39:13.542836 [debug] [Thread-2 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166
[0m13:39:13.543790 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.int_all_dag_relationships
[0m13:39:13.544229 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.fct_test_directories
[0m13:39:13.544565 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.int_model_test_summary
[0m13:39:13.545379 [debug] [Thread-2 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166
[0m13:39:13.545826 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c, now model.dbt_project_evaluator.int_all_dag_relationships)
[0m13:39:13.548043 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.int_all_dag_relationships
[0m13:39:13.547152 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235, now model.dbt_project_evaluator.int_model_test_summary)
[0m13:39:13.547605 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.not_null_pokemon_obt_pokemon_id.17bc952d9e
[0m13:39:13.546737 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.fct_test_directories
[0m13:39:13.552569 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.int_all_dag_relationships"
[0m13:39:13.553070 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.int_model_test_summary
[0m13:39:13.554086 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166, now test.nerd_facts_dbt.not_null_pokemon_obt_pokemon_id.17bc952d9e)
[0m13:39:13.562828 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.not_null_pokemon_obt_pokemon_id.17bc952d9e
[0m13:39:13.562203 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.int_model_test_summary"
[0m13:39:13.554798 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.nerd_universe_obt
[0m13:39:13.569119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_test_directories, now model.nerd_facts_dbt.nerd_universe_obt)
[0m13:39:13.569492 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.nerd_universe_obt
[0m13:39:13.572708 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.nerd_universe_obt"
[0m13:39:13.568491 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.int_all_dag_relationships
[0m13:39:13.567941 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_pokemon_obt_pokemon_id.17bc952d9e"
[0m13:39:13.573678 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.int_all_dag_relationships
[0m13:39:13.574226 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.int_model_test_summary
[0m13:39:13.576637 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.int_model_test_summary
[0m13:39:13.575209 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.star_wars_obt
[0m13:39:13.576060 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.not_null_pokemon_obt_pokemon_id.17bc952d9e
[0m13:39:13.574839 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.nerd_universe_obt
[0m13:39:13.578715 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.nerd_universe_obt
[0m13:39:13.577428 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.int_all_dag_relationships, now model.nerd_facts_dbt.star_wars_obt)
[0m13:39:13.578147 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.not_null_pokemon_obt_pokemon_id.17bc952d9e
[0m13:39:13.579068 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.fct_chained_views_dependencies
[0m13:39:13.576966 [debug] [Thread-3 (]: Began running node test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433
[0m13:39:13.580704 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.int_model_test_summary, now test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433)
[0m13:39:13.579903 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.fct_direct_join_to_source
[0m13:39:13.581327 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_pokemon_obt_pokemon_id.17bc952d9e, now model.dbt_project_evaluator.fct_direct_join_to_source)
[0m13:39:13.580993 [debug] [Thread-3 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433
[0m13:39:13.579531 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.star_wars_obt
[0m13:39:13.581623 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.fct_direct_join_to_source
[0m13:39:13.580335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.nerd_universe_obt, now model.dbt_project_evaluator.fct_chained_views_dependencies)
[0m13:39:13.585337 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433"
[0m13:39:13.589026 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.star_wars_obt"
[0m13:39:13.592709 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m13:39:13.593347 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.fct_chained_views_dependencies
[0m13:39:13.593988 [debug] [Thread-3 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433
[0m13:39:13.594654 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.star_wars_obt
[0m13:39:13.595327 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.fct_direct_join_to_source
[0m13:39:13.601364 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m13:39:13.602156 [debug] [Thread-3 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433
[0m13:39:13.602814 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.star_wars_obt
[0m13:39:13.604731 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.fct_exposures_dependent_on_private_models
[0m13:39:13.604181 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.fct_exposure_parents_materializations
[0m13:39:13.606118 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433, now model.dbt_project_evaluator.fct_exposure_parents_materializations)
[0m13:39:13.605067 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.fct_chained_views_dependencies
[0m13:39:13.605615 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.star_wars_obt, now model.dbt_project_evaluator.fct_exposures_dependent_on_private_models)
[0m13:39:13.607334 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.fct_exposures_dependent_on_private_models
[0m13:39:13.606425 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.fct_exposure_parents_materializations
[0m13:39:13.606990 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.fct_chained_views_dependencies
[0m13:39:13.610913 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m13:39:13.615777 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.fct_exposures_dependent_on_private_models
[0m13:39:13.614464 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m13:39:13.614995 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source
[0m13:39:13.617189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_chained_views_dependencies, now model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source)
[0m13:39:13.603424 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.fct_direct_join_to_source
[0m13:39:13.618300 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.fct_model_directories
[0m13:39:13.618753 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_direct_join_to_source, now model.dbt_project_evaluator.fct_model_directories)
[0m13:39:13.617935 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source
[0m13:39:13.616456 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.fct_exposures_dependent_on_private_models
[0m13:39:13.617590 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.fct_exposure_parents_materializations
[0m13:39:13.619122 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.fct_model_directories
[0m13:39:13.623134 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m13:39:13.630886 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source
[0m13:39:13.624371 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.fct_exposure_parents_materializations
[0m13:39:13.630154 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_model_directories"
[0m13:39:13.631553 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source
[0m13:39:13.623703 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.fct_model_fanout
[0m13:39:13.631955 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.fct_multiple_sources_joined
[0m13:39:13.634239 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_exposure_parents_materializations, now model.dbt_project_evaluator.fct_multiple_sources_joined)
[0m13:39:13.633310 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.fct_model_directories
[0m13:39:13.635125 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.fct_model_directories
[0m13:39:13.634565 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.fct_multiple_sources_joined
[0m13:39:13.632765 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts
[0m13:39:13.633811 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_exposures_dependent_on_private_models, now model.dbt_project_evaluator.fct_model_fanout)
[0m13:39:13.641458 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.fct_model_fanout
[0m13:39:13.640490 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m13:39:13.647877 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.fct_multiple_sources_joined
[0m13:39:13.648525 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.fct_multiple_sources_joined
[0m13:39:13.647121 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_model_fanout"
[0m13:39:13.649592 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.fct_model_fanout
[0m13:39:13.650198 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.fct_model_fanout
[0m13:39:13.650523 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate
[0m13:39:13.650933 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_model_fanout, now model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate)
[0m13:39:13.651281 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate
[0m13:39:13.648885 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.fct_source_fanout
[0m13:39:13.641053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source, now model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts)
[0m13:39:13.635457 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.fct_root_models
[0m13:39:13.654914 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m13:39:13.655568 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_multiple_sources_joined, now model.dbt_project_evaluator.fct_source_fanout)
[0m13:39:13.655959 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts
[0m13:39:13.656394 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_model_directories, now model.dbt_project_evaluator.fct_root_models)
[0m13:39:13.656988 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate
[0m13:39:13.657335 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.fct_source_fanout
[0m13:39:13.661204 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m13:39:13.661655 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.fct_root_models
[0m13:39:13.662305 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate
[0m13:39:13.667030 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_source_fanout"
[0m13:39:13.670795 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_root_models"
[0m13:39:13.671380 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts
[0m13:39:13.673109 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts
[0m13:39:13.674340 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.fct_too_many_joins
[0m13:39:13.674804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts, now model.dbt_project_evaluator.fct_too_many_joins)
[0m13:39:13.673947 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.fct_root_models
[0m13:39:13.671910 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.fct_staging_dependent_on_staging
[0m13:39:13.673566 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.fct_source_fanout
[0m13:39:13.676756 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.fct_source_fanout
[0m13:39:13.675765 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.fct_root_models
[0m13:39:13.676163 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate, now model.dbt_project_evaluator.fct_staging_dependent_on_staging)
[0m13:39:13.675177 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.fct_too_many_joins
[0m13:39:13.683109 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_too_many_joins"
[0m13:39:13.677583 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.fct_missing_primary_key_tests
[0m13:39:13.678011 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.fct_staging_dependent_on_staging
[0m13:39:13.677110 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.fct_unused_sources
[0m13:39:13.683846 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.fct_too_many_joins
[0m13:39:13.684343 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_root_models, now model.dbt_project_evaluator.fct_missing_primary_key_tests)
[0m13:39:13.688604 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m13:39:13.689180 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_source_fanout, now model.dbt_project_evaluator.fct_unused_sources)
[0m13:39:13.689852 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.fct_too_many_joins
[0m13:39:13.690229 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.fct_missing_primary_key_tests
[0m13:39:13.690764 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.fct_staging_dependent_on_staging
[0m13:39:13.691084 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.fct_unused_sources
[0m13:39:13.691463 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.fct_test_coverage
[0m13:39:13.700928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_too_many_joins, now model.dbt_project_evaluator.fct_test_coverage)
[0m13:39:13.701292 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.fct_test_coverage
[0m13:39:13.700394 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_unused_sources"
[0m13:39:13.696009 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m13:39:13.709877 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.fct_missing_primary_key_tests
[0m13:39:13.708416 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_test_coverage"
[0m13:39:13.709189 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.fct_unused_sources
[0m13:39:13.696810 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.fct_staging_dependent_on_staging
[0m13:39:13.710742 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.fct_missing_primary_key_tests
[0m13:39:13.712140 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.fct_unused_sources
[0m13:39:13.714176 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.not_null_nerd_universe_obt_obt_created_at.46390d7480
[0m13:39:13.713085 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.not_null_nerd_universe_obt_entity_id.f6a71ebb11
[0m13:39:13.713684 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.not_null_nerd_universe_obt_entity_name.3b5e13295e
[0m13:39:13.712671 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.fct_test_coverage
[0m13:39:13.714678 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_unused_sources, now test.nerd_facts_dbt.not_null_nerd_universe_obt_obt_created_at.46390d7480)
[0m13:39:13.715103 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_staging_dependent_on_staging, now test.nerd_facts_dbt.not_null_nerd_universe_obt_entity_id.f6a71ebb11)
[0m13:39:13.715508 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_missing_primary_key_tests, now test.nerd_facts_dbt.not_null_nerd_universe_obt_entity_name.3b5e13295e)
[0m13:39:13.716136 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.fct_test_coverage
[0m13:39:13.716506 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.not_null_nerd_universe_obt_obt_created_at.46390d7480
[0m13:39:13.716822 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.not_null_nerd_universe_obt_entity_id.f6a71ebb11
[0m13:39:13.717141 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.not_null_nerd_universe_obt_entity_name.3b5e13295e
[0m13:39:13.717530 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.not_null_nerd_universe_obt_universe.51c9e975b4
[0m13:39:13.723013 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_nerd_universe_obt_obt_created_at.46390d7480"
[0m13:39:13.727603 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_nerd_universe_obt_entity_id.f6a71ebb11"
[0m13:39:13.731339 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_nerd_universe_obt_entity_name.3b5e13295e"
[0m13:39:13.731929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_test_coverage, now test.nerd_facts_dbt.not_null_nerd_universe_obt_universe.51c9e975b4)
[0m13:39:13.732513 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.not_null_nerd_universe_obt_obt_created_at.46390d7480
[0m13:39:13.733000 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.not_null_nerd_universe_obt_entity_id.f6a71ebb11
[0m13:39:13.733429 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.not_null_nerd_universe_obt_universe.51c9e975b4
[0m13:39:13.734040 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.not_null_nerd_universe_obt_obt_created_at.46390d7480
[0m13:39:13.734488 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.not_null_nerd_universe_obt_entity_name.3b5e13295e
[0m13:39:13.740741 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.not_null_nerd_universe_obt_entity_name.3b5e13295e
[0m13:39:13.739289 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_nerd_universe_obt_universe.51c9e975b4"
[0m13:39:13.741589 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.not_null_nerd_universe_obt_universe.51c9e975b4
[0m13:39:13.742135 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.not_null_nerd_universe_obt_universe.51c9e975b4
[0m13:39:13.742445 [debug] [Thread-1 (]: Began running node test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028
[0m13:39:13.739915 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.not_null_star_wars_obt_character_id.aa2d5ca904
[0m13:39:13.735030 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.not_null_nerd_universe_obt_entity_id.f6a71ebb11
[0m13:39:13.743612 [debug] [Thread-4 (]: Began running node test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e
[0m13:39:13.742825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_nerd_universe_obt_universe.51c9e975b4, now test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028)
[0m13:39:13.743219 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_nerd_universe_obt_obt_created_at.46390d7480, now test.nerd_facts_dbt.not_null_star_wars_obt_character_id.aa2d5ca904)
[0m13:39:13.741078 [debug] [Thread-2 (]: Began running node test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33
[0m13:39:13.744041 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_nerd_universe_obt_entity_id.f6a71ebb11, now test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e)
[0m13:39:13.744412 [debug] [Thread-1 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028
[0m13:39:13.744750 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.not_null_star_wars_obt_character_id.aa2d5ca904
[0m13:39:13.745212 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_nerd_universe_obt_entity_name.3b5e13295e, now test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33)
[0m13:39:13.745628 [debug] [Thread-4 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e
[0m13:39:13.749467 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028"
[0m13:39:13.753176 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_star_wars_obt_character_id.aa2d5ca904"
[0m13:39:13.753671 [debug] [Thread-2 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33
[0m13:39:13.758402 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e"
[0m13:39:13.763050 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33"
[0m13:39:13.763725 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.not_null_star_wars_obt_character_id.aa2d5ca904
[0m13:39:13.764558 [debug] [Thread-2 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33
[0m13:39:13.766731 [debug] [Thread-2 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33
[0m13:39:13.765643 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.not_null_star_wars_obt_character_id.aa2d5ca904
[0m13:39:13.766113 [debug] [Thread-4 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e
[0m13:39:13.768053 [debug] [Thread-4 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e
[0m13:39:13.768362 [debug] [Thread-4 (]: Began running node test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db
[0m13:39:13.767462 [debug] [Thread-3 (]: Began running node test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f
[0m13:39:13.769140 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_star_wars_obt_character_id.aa2d5ca904, now test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f)
[0m13:39:13.767061 [debug] [Thread-2 (]: Began running node test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422
[0m13:39:13.769831 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33, now test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422)
[0m13:39:13.769484 [debug] [Thread-3 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f
[0m13:39:13.774076 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f"
[0m13:39:13.770128 [debug] [Thread-2 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422
[0m13:39:13.778496 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422"
[0m13:39:13.764890 [debug] [Thread-1 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028
[0m13:39:13.774753 [debug] [Thread-3 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f
[0m13:39:13.768731 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e, now test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db)
[0m13:39:13.780853 [debug] [Thread-4 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db
[0m13:39:13.779331 [debug] [Thread-1 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028
[0m13:39:13.785792 [debug] [Thread-1 (]: Began running node test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817
[0m13:39:13.786220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028, now test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817)
[0m13:39:13.785233 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db"
[0m13:39:13.786531 [debug] [Thread-1 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817
[0m13:39:13.780462 [debug] [Thread-3 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f
[0m13:39:13.779823 [debug] [Thread-2 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422
[0m13:39:13.792982 [debug] [Thread-2 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422
[0m13:39:13.791998 [debug] [Thread-3 (]: Began running node test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95
[0m13:39:13.791375 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817"
[0m13:39:13.793438 [debug] [Thread-4 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db
[0m13:39:13.793824 [debug] [Thread-2 (]: Began running node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f
[0m13:39:13.794394 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f, now test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95)
[0m13:39:13.795129 [debug] [Thread-1 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817
[0m13:39:13.795951 [debug] [Thread-4 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db
[0m13:39:13.796445 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422, now test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f)
[0m13:39:13.796853 [debug] [Thread-3 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95
[0m13:39:13.797504 [debug] [Thread-1 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817
[0m13:39:13.797916 [debug] [Thread-4 (]: Began running node test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d
[0m13:39:13.804001 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db, now test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d)
[0m13:39:13.802864 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95"
[0m13:39:13.803418 [debug] [Thread-1 (]: Began running node test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722
[0m13:39:13.804378 [debug] [Thread-4 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d
[0m13:39:13.798342 [debug] [Thread-2 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f
[0m13:39:13.805028 [debug] [Thread-3 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95
[0m13:39:13.805471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817, now test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722)
[0m13:39:13.809903 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d"
[0m13:39:13.814136 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f"
[0m13:39:13.814966 [debug] [Thread-3 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95
[0m13:39:13.815404 [debug] [Thread-1 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722
[0m13:39:13.821442 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722"
[0m13:39:13.816665 [debug] [Thread-3 (]: Began running node test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1
[0m13:39:13.816074 [debug] [Thread-4 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d
[0m13:39:13.822207 [debug] [Thread-2 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f
[0m13:39:13.822853 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95, now test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1)
[0m13:39:13.823639 [debug] [Thread-4 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d
[0m13:39:13.824364 [debug] [Thread-2 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f
[0m13:39:13.825915 [debug] [Thread-2 (]: Began running node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca
[0m13:39:13.825072 [debug] [Thread-3 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1
[0m13:39:13.825483 [debug] [Thread-4 (]: Began running node test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535
[0m13:39:13.832054 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d, now test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535)
[0m13:39:13.832413 [debug] [Thread-4 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535
[0m13:39:13.831466 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1"
[0m13:39:13.824775 [debug] [Thread-1 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722
[0m13:39:13.826310 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f, now test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca)
[0m13:39:13.836481 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535"
[0m13:39:13.837223 [debug] [Thread-3 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1
[0m13:39:13.837995 [debug] [Thread-1 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722
[0m13:39:13.838479 [debug] [Thread-2 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca
[0m13:39:13.838983 [debug] [Thread-4 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535
[0m13:39:13.839722 [debug] [Thread-3 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1
[0m13:39:13.840164 [debug] [Thread-1 (]: Began running node test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0
[0m13:39:13.844206 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca"
[0m13:39:13.845028 [debug] [Thread-4 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535
[0m13:39:13.845463 [debug] [Thread-3 (]: Began running node test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8
[0m13:39:13.845957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722, now test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0)
[0m13:39:13.846518 [debug] [Thread-2 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca
[0m13:39:13.846872 [debug] [Thread-4 (]: Began running node test.dbt_project_evaluator.valid_test_coverage.df03f31e09
[0m13:39:13.847354 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1, now test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8)
[0m13:39:13.847729 [debug] [Thread-1 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0
[0m13:39:13.848294 [debug] [Thread-2 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca
[0m13:39:13.848656 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535, now test.dbt_project_evaluator.valid_test_coverage.df03f31e09)
[0m13:39:13.853499 [debug] [Thread-4 (]: Began compiling node test.dbt_project_evaluator.valid_test_coverage.df03f31e09
[0m13:39:13.852840 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0"
[0m13:39:13.858991 [debug] [Thread-1 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0
[0m13:39:13.849007 [debug] [Thread-3 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8
[0m13:39:13.859739 [debug] [Thread-1 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0
[0m13:39:13.858193 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project_evaluator.valid_test_coverage.df03f31e09"
[0m13:39:13.864237 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8"
[0m13:39:13.865147 [debug] [Thread-4 (]: Began executing node test.dbt_project_evaluator.valid_test_coverage.df03f31e09
[0m13:39:13.865986 [debug] [Thread-4 (]: Finished running node test.dbt_project_evaluator.valid_test_coverage.df03f31e09
[0m13:39:13.866524 [debug] [Thread-3 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8
[0m13:39:13.867112 [debug] [Thread-3 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8
[0m13:39:13.868359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:13.868675 [debug] [MainThread]: Connection 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' was properly closed.
[0m13:39:13.868911 [debug] [MainThread]: Connection 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' was properly closed.
[0m13:39:13.869125 [debug] [MainThread]: Connection 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' was properly closed.
[0m13:39:13.869388 [debug] [MainThread]: Connection 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' was properly closed.
[0m13:39:13.898019 [debug] [MainThread]: Command end result
[0m13:39:14.071885 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m13:39:14.075339 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m13:39:14.090795 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m13:39:14.094301 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m13:39:14.094700 [info ] [MainThread]: Building catalog
[0m13:39:14.124583 [debug] [ThreadPool]: Acquiring new postgres connection 'nerd_facts.information_schema'
[0m13:39:14.132808 [debug] [ThreadPool]: Using postgres connection "nerd_facts.information_schema"
[0m13:39:14.133228 [debug] [ThreadPool]: On nerd_facts.information_schema: BEGIN
[0m13:39:14.133604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:14.146753 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m13:39:14.147247 [debug] [ThreadPool]: Using postgres connection "nerd_facts.information_schema"
[0m13:39:14.147676 [debug] [ThreadPool]: On nerd_facts.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "nerd_facts.information_schema"} */

    
    

    select
        'nerd_facts' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where (upper(sch.nspname) = upper('raw') or upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m13:39:14.159154 [debug] [ThreadPool]: SQL status: SELECT 1672 in 0.011 seconds
[0m13:39:14.277463 [debug] [ThreadPool]: On nerd_facts.information_schema: ROLLBACK
[0m13:39:14.278140 [debug] [ThreadPool]: On nerd_facts.information_schema: Close
[0m13:39:14.375063 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/janne/nerd-facts-dbt/dbt_project/target/catalog.json
[0m13:39:14.481415 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m13:39:14.484993 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m13:39:14.485628 [info ] [MainThread]: Catalog written to /home/janne/nerd-facts-dbt/dbt_project/target/catalog.json
[0m13:39:14.487572 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.6206903, "process_in_blocks": "3376", "process_kernel_time": 0.240536, "process_mem_max_rss": "131820", "process_out_blocks": "20136", "process_user_time": 7.323401}
[0m13:39:14.488156 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:39:14.488019 after 6.62 seconds
[0m13:39:14.488586 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:39:14.488953 [debug] [MainThread]: Connection 'nerd_facts.information_schema' was properly closed.
[0m13:39:14.489391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f552597e920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5523bf55d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5523d62c80>]}
[0m13:39:14.489884 [debug] [MainThread]: Flushing usage events
[0m13:39:14.873267 [debug] [MainThread]: An error was encountered while trying to flush usage events

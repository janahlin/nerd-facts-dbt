[0m09:24:30.192729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe31be7c970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe31cc7acb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe31cc7ac20>]}


============================== 09:24:30.195763 | 4fa17a17-1716-422e-a50f-f4f59a1287af ==============================
[0m09:24:30.195763 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:24:30.196171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'log_path': 'logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:24:30.205833 [info ] [MainThread]: dbt version: 1.9.3
[0m09:24:30.206201 [info ] [MainThread]: python version: 3.10.12
[0m09:24:30.206450 [info ] [MainThread]: python path: /home/janne/nerd-facts-dbt/venv/bin/python3
[0m09:24:30.206691 [info ] [MainThread]: os info: Linux-5.15.0-134-generic-x86_64-with-glibc2.35
[0m09:24:30.207136 [error] [MainThread]: Encountered an error:
local variable 'summary_message' referenced before assignment
[0m09:24:30.208393 [error] [MainThread]: Traceback (most recent call last):
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/main.py", line 414, in debug
    results = task.run()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 114, in run
    load_profile_status: SubtaskStatus = self._load_profile()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 201, in _load_profile
    profile_names, summary_message = self._choose_profile_names()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 276, in _choose_profile_names
    return profiles, summary_message
UnboundLocalError: local variable 'summary_message' referenced before assignment

[0m09:24:30.209450 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.01886777, "process_in_blocks": "32064", "process_kernel_time": 0.063574, "process_mem_max_rss": "85644", "process_out_blocks": "16", "process_user_time": 0.970532}
[0m09:24:30.209813 [debug] [MainThread]: Command `dbt debug` failed at 09:24:30.209723 after 0.02 seconds
[0m09:24:30.210115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe31be7c970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe31cc7b9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe31ae3f5e0>]}
[0m09:24:30.210404 [debug] [MainThread]: Flushing usage events
[0m09:24:30.599013 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:25:00.934211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00f08a4820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00f1817b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00f1817ac0>]}


============================== 09:25:00.937212 | eff28e44-ace8-40e6-be51-ab5030d1e08c ==============================
[0m09:25:00.937212 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:25:00.937670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:25:00.950777 [info ] [MainThread]: dbt version: 1.9.2
[0m09:25:00.951159 [info ] [MainThread]: python version: 3.10.12
[0m09:25:00.951424 [info ] [MainThread]: python path: /usr/bin/python3
[0m09:25:00.951666 [info ] [MainThread]: os info: Linux-5.15.0-134-generic-x86_64-with-glibc2.35
[0m09:25:00.952120 [error] [MainThread]: Encountered an error:
local variable 'summary_message' referenced before assignment
[0m09:25:00.953487 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/dbt/cli/main.py", line 414, in debug
    results = task.run()
  File "/usr/local/lib/python3.10/dist-packages/dbt/task/debug.py", line 114, in run
    load_profile_status: SubtaskStatus = self._load_profile()
  File "/usr/local/lib/python3.10/dist-packages/dbt/task/debug.py", line 201, in _load_profile
    profile_names, summary_message = self._choose_profile_names()
  File "/usr/local/lib/python3.10/dist-packages/dbt/task/debug.py", line 276, in _choose_profile_names
    return profiles, summary_message
UnboundLocalError: local variable 'summary_message' referenced before assignment

[0m09:25:00.954202 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.022016058, "process_in_blocks": "29432", "process_kernel_time": 0.061838, "process_mem_max_rss": "84820", "process_out_blocks": "16", "process_user_time": 0.960141}
[0m09:25:00.954623 [debug] [MainThread]: Command `dbt debug` failed at 09:25:00.954545 after 0.02 seconds
[0m09:25:00.954891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00f08a4820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00f1817a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00efa680a0>]}
[0m09:25:00.955181 [debug] [MainThread]: Flushing usage events
[0m09:25:01.387100 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:25:50.858270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdec1b8880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdecf8abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdecf8ab60>]}


============================== 09:25:50.860484 | c5e11c67-e008-4f34-bde7-6c38fa570137 ==============================
[0m09:25:50.860484 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:25:50.860907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'version_check': 'True', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug --config-dir', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:25:50.866255 [info ] [MainThread]: To view your profiles.yml file, run:

xdg-open /home/janne/nerd-facts-dbt/dbt_project
[0m09:25:50.867032 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.010643467, "process_in_blocks": "0", "process_kernel_time": 0.032158, "process_mem_max_rss": "85412", "process_out_blocks": "16", "process_user_time": 0.904295}
[0m09:25:50.867375 [debug] [MainThread]: Command `dbt debug` succeeded at 09:25:50.867298 after 0.01 seconds
[0m09:25:50.867656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdec1b8880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdecf8ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdecf8abc0>]}
[0m09:25:50.867940 [debug] [MainThread]: Flushing usage events
[0m09:25:51.256496 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:27:03.526809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c20764850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c21566b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c21566b30>]}


============================== 09:27:03.529409 | f6b013c3-8f75-4d2f-8fe8-58ed5fd93b3e ==============================
[0m09:27:03.529409 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:27:03.529973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --config-dir', 'send_anonymous_usage_stats': 'True'}
[0m09:27:03.535937 [info ] [MainThread]: To view your profiles.yml file, run:

xdg-open /home/janne/nerd-facts-dbt/dbt_project
[0m09:27:03.536768 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.011985836, "process_in_blocks": "0", "process_kernel_time": 0.036019, "process_mem_max_rss": "85456", "process_out_blocks": "8", "process_user_time": 0.887775}
[0m09:27:03.537198 [debug] [MainThread]: Command `dbt debug` succeeded at 09:27:03.537106 after 0.01 seconds
[0m09:27:03.537556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c20764850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c21566ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c21566b90>]}
[0m09:27:03.537937 [debug] [MainThread]: Flushing usage events
[0m09:27:03.941871 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:27:08.811573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6761b8970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff676f8acb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff676f8ac50>]}


============================== 09:27:08.813901 | e6f9c77f-9a83-43f4-9e6c-0e1d619f77e7 ==============================
[0m09:27:08.813901 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:27:08.814309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'debug': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m09:27:08.819564 [info ] [MainThread]: dbt version: 1.9.3
[0m09:27:08.819878 [info ] [MainThread]: python version: 3.10.12
[0m09:27:08.820117 [info ] [MainThread]: python path: /home/janne/nerd-facts-dbt/venv/bin/python3
[0m09:27:08.820352 [info ] [MainThread]: os info: Linux-5.15.0-134-generic-x86_64-with-glibc2.35
[0m09:27:08.820797 [error] [MainThread]: Encountered an error:
local variable 'summary_message' referenced before assignment
[0m09:27:08.821493 [error] [MainThread]: Traceback (most recent call last):
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/main.py", line 414, in debug
    results = task.run()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 114, in run
    load_profile_status: SubtaskStatus = self._load_profile()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 201, in _load_profile
    profile_names, summary_message = self._choose_profile_names()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 276, in _choose_profile_names
    return profiles, summary_message
UnboundLocalError: local variable 'summary_message' referenced before assignment

[0m09:27:08.822166 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.012489452, "process_in_blocks": "0", "process_kernel_time": 0.031999, "process_mem_max_rss": "85596", "process_out_blocks": "8", "process_user_time": 0.931124}
[0m09:27:08.822499 [debug] [MainThread]: Command `dbt debug` failed at 09:27:08.822410 after 0.01 seconds
[0m09:27:08.822764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6761b8970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff676f8b9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6770335e0>]}
[0m09:27:08.823053 [debug] [MainThread]: Flushing usage events
[0m09:27:09.212482 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:28:08.104523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fda2288e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdb02ec20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdb02ebc0>]}


============================== 09:28:08.106793 | fe349e36-04b7-4c81-889d-c69b87b72496 ==============================
[0m09:28:08.106793 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:28:08.107223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:28:08.112478 [info ] [MainThread]: dbt version: 1.9.3
[0m09:28:08.112812 [info ] [MainThread]: python version: 3.10.12
[0m09:28:08.113080 [info ] [MainThread]: python path: /home/janne/nerd-facts-dbt/venv/bin/python3
[0m09:28:08.113317 [info ] [MainThread]: os info: Linux-5.15.0-134-generic-x86_64-with-glibc2.35
[0m09:28:08.114001 [error] [MainThread]: Encountered an error:
local variable 'summary_message' referenced before assignment
[0m09:28:08.114671 [error] [MainThread]: Traceback (most recent call last):
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/main.py", line 414, in debug
    results = task.run()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 114, in run
    load_profile_status: SubtaskStatus = self._load_profile()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 201, in _load_profile
    profile_names, summary_message = self._choose_profile_names()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 276, in _choose_profile_names
    return profiles, summary_message
UnboundLocalError: local variable 'summary_message' referenced before assignment

[0m09:28:08.115380 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.012873661, "process_in_blocks": "0", "process_kernel_time": 0.048112, "process_mem_max_rss": "85756", "process_out_blocks": "16", "process_user_time": 0.876172}
[0m09:28:08.115742 [debug] [MainThread]: Command `dbt debug` failed at 09:28:08.115634 after 0.01 seconds
[0m09:28:08.116046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fda2288e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdb0d7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdb0d73d0>]}
[0m09:28:08.116331 [debug] [MainThread]: Flushing usage events
[0m09:28:08.521045 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:28:23.625544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44ffa8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb450d7acb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb450d7ac50>]}


============================== 09:28:23.628055 | 7df280e9-92f8-47fc-9f75-fcdf40fe0a80 ==============================
[0m09:28:23.628055 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:28:23.628711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:28:23.636910 [info ] [MainThread]: dbt version: 1.9.3
[0m09:28:23.637394 [info ] [MainThread]: python version: 3.10.12
[0m09:28:23.637844 [info ] [MainThread]: python path: /home/janne/nerd-facts-dbt/venv/bin/python3
[0m09:28:23.638193 [info ] [MainThread]: os info: Linux-5.15.0-134-generic-x86_64-with-glibc2.35
[0m09:28:23.639280 [error] [MainThread]: Encountered an error:
local variable 'summary_message' referenced before assignment
[0m09:28:23.640386 [error] [MainThread]: Traceback (most recent call last):
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/cli/main.py", line 414, in debug
    results = task.run()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 114, in run
    load_profile_status: SubtaskStatus = self._load_profile()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 201, in _load_profile
    profile_names, summary_message = self._choose_profile_names()
  File "/home/janne/nerd-facts-dbt/venv/lib/python3.10/site-packages/dbt/task/debug.py", line 276, in _choose_profile_names
    return profiles, summary_message
UnboundLocalError: local variable 'summary_message' referenced before assignment

[0m09:28:23.641547 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.018077997, "process_in_blocks": "0", "process_kernel_time": 0.063977, "process_mem_max_rss": "85612", "process_out_blocks": "16", "process_user_time": 0.859905}
[0m09:28:23.642172 [debug] [MainThread]: Command `dbt debug` failed at 09:28:23.642033 after 0.02 seconds
[0m09:28:23.642632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44ffa8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb450e274c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb450e27460>]}
[0m09:28:23.643139 [debug] [MainThread]: Flushing usage events
[0m09:28:24.027068 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:29:28.521066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee27974880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee287e5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee287e56f0>]}


============================== 09:29:28.523147 | 2479a3f7-036e-4cd2-9922-4cb189e05f48 ==============================
[0m09:29:28.523147 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:29:28.523589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'log_path': 'logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:29:28.528935 [info ] [MainThread]: dbt version: 1.9.3
[0m09:29:28.529267 [info ] [MainThread]: python version: 3.10.12
[0m09:29:28.529561 [info ] [MainThread]: python path: /home/janne/nerd-facts-dbt/venv/bin/python3
[0m09:29:28.529803 [info ] [MainThread]: os info: Linux-5.15.0-134-generic-x86_64-with-glibc2.35
[0m09:29:28.592653 [info ] [MainThread]: Using profiles dir at /home/janne/nerd-facts-dbt/dbt_project
[0m09:29:28.593068 [info ] [MainThread]: Using profiles.yml file at /home/janne/nerd-facts-dbt/dbt_project/profiles.yml
[0m09:29:28.593465 [info ] [MainThread]: Using dbt_project.yml file at /home/janne/nerd-facts-dbt/dbt_project/dbt_project.yml
[0m09:29:28.594147 [info ] [MainThread]: adapter type: postgres
[0m09:29:28.594417 [info ] [MainThread]: adapter version: 1.9.0
[0m09:29:28.594888 [info ] [MainThread]: Configuration:
[0m09:29:28.595130 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:29:28.595354 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m09:29:28.595571 [info ] [MainThread]: Required dependencies:
[0m09:29:28.595807 [debug] [MainThread]: Executing "git --help"
[0m09:29:28.597077 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:29:28.597438 [debug] [MainThread]: STDERR: "b''"
[0m09:29:28.597694 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:29:28.597954 [info ] [MainThread]: Connection:
[0m09:29:28.598199 [info ] [MainThread]:   host: localhost
[0m09:29:28.598412 [info ] [MainThread]:   port: 5432
[0m09:29:28.598622 [info ] [MainThread]:   user: dbt_user
[0m09:29:28.598839 [info ] [MainThread]:   database: nerd_facts
[0m09:29:28.599050 [info ] [MainThread]:   schema: public
[0m09:29:28.599270 [info ] [MainThread]:   connect_timeout: 10
[0m09:29:28.599482 [info ] [MainThread]:   role: None
[0m09:29:28.599699 [info ] [MainThread]:   search_path: None
[0m09:29:28.599914 [info ] [MainThread]:   keepalives_idle: 0
[0m09:29:28.600140 [info ] [MainThread]:   sslmode: None
[0m09:29:28.600351 [info ] [MainThread]:   sslcert: None
[0m09:29:28.600565 [info ] [MainThread]:   sslkey: None
[0m09:29:28.600775 [info ] [MainThread]:   sslrootcert: None
[0m09:29:28.600986 [info ] [MainThread]:   application_name: dbt
[0m09:29:28.601213 [info ] [MainThread]:   retries: 1
[0m09:29:28.601554 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:29:28.669510 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:29:28.691643 [debug] [MainThread]: Using postgres connection "debug"
[0m09:29:28.692020 [debug] [MainThread]: On debug: select 1 as id
[0m09:29:28.692327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:29:28.705123 [debug] [MainThread]: SQL status: SELECT 1 in 0.013 seconds
[0m09:29:28.706105 [debug] [MainThread]: On debug: Close
[0m09:29:28.706569 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:29:28.707194 [info ] [MainThread]: [31m1 check failed:[0m
[0m09:29:28.707705 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  dbt_project.yml does not parse to a dictionary


[0m09:29:28.708885 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.23143281, "process_in_blocks": "16160", "process_kernel_time": 0.091378, "process_mem_max_rss": "100440", "process_out_blocks": "24", "process_user_time": 1.069261}
[0m09:29:28.709324 [debug] [MainThread]: Command `dbt debug` failed at 09:29:28.709228 after 0.23 seconds
[0m09:29:28.709678 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:29:28.709985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee27974880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee287e5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee26145ab0>]}
[0m09:29:28.710338 [debug] [MainThread]: Flushing usage events
[0m09:29:29.100913 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:30:24.068104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2eff0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2fe6bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2fe6bd90>]}


============================== 09:30:24.070508 | b80b5078-dd5f-4fc6-b48b-18fd3336fdd4 ==============================
[0m09:30:24.070508 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:30:24.071036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:30:24.076922 [info ] [MainThread]: dbt version: 1.9.3
[0m09:30:24.077311 [info ] [MainThread]: python version: 3.10.12
[0m09:30:24.077669 [info ] [MainThread]: python path: /home/janne/nerd-facts-dbt/venv/bin/python3
[0m09:30:24.077988 [info ] [MainThread]: os info: Linux-5.15.0-134-generic-x86_64-with-glibc2.35
[0m09:30:24.124238 [info ] [MainThread]: Using profiles dir at /home/janne/nerd-facts-dbt/dbt_project
[0m09:30:24.124723 [info ] [MainThread]: Using profiles.yml file at /home/janne/nerd-facts-dbt/dbt_project/profiles.yml
[0m09:30:24.125078 [info ] [MainThread]: Using dbt_project.yml file at /home/janne/nerd-facts-dbt/dbt_project/dbt_project.yml
[0m09:30:24.125563 [info ] [MainThread]: adapter type: postgres
[0m09:30:24.125874 [info ] [MainThread]: adapter version: 1.9.0
[0m09:30:24.213143 [info ] [MainThread]: Configuration:
[0m09:30:24.213654 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:30:24.214004 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:30:24.214310 [info ] [MainThread]: Required dependencies:
[0m09:30:24.214628 [debug] [MainThread]: Executing "git --help"
[0m09:30:24.216058 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:30:24.216400 [debug] [MainThread]: STDERR: "b''"
[0m09:30:24.216681 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:30:24.216988 [info ] [MainThread]: Connection:
[0m09:30:24.217310 [info ] [MainThread]:   host: localhost
[0m09:30:24.217634 [info ] [MainThread]:   port: 5432
[0m09:30:24.217920 [info ] [MainThread]:   user: dbt_user
[0m09:30:24.218201 [info ] [MainThread]:   database: nerd_facts
[0m09:30:24.218491 [info ] [MainThread]:   schema: public
[0m09:30:24.218777 [info ] [MainThread]:   connect_timeout: 10
[0m09:30:24.219057 [info ] [MainThread]:   role: None
[0m09:30:24.219333 [info ] [MainThread]:   search_path: None
[0m09:30:24.219615 [info ] [MainThread]:   keepalives_idle: 0
[0m09:30:24.219895 [info ] [MainThread]:   sslmode: None
[0m09:30:24.220176 [info ] [MainThread]:   sslcert: None
[0m09:30:24.220454 [info ] [MainThread]:   sslkey: None
[0m09:30:24.220730 [info ] [MainThread]:   sslrootcert: None
[0m09:30:24.221015 [info ] [MainThread]:   application_name: dbt
[0m09:30:24.221293 [info ] [MainThread]:   retries: 1
[0m09:30:24.221730 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:30:24.302145 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:30:24.323516 [debug] [MainThread]: Using postgres connection "debug"
[0m09:30:24.323899 [debug] [MainThread]: On debug: select 1 as id
[0m09:30:24.324198 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:30:24.334255 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m09:30:24.335202 [debug] [MainThread]: On debug: Close
[0m09:30:24.335658 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:30:24.336271 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:30:24.337375 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.3124077, "process_in_blocks": "0", "process_kernel_time": 0.068366, "process_mem_max_rss": "102600", "process_out_blocks": "24", "process_user_time": 1.214409}
[0m09:30:24.337984 [debug] [MainThread]: Command `dbt debug` succeeded at 09:30:24.337887 after 0.31 seconds
[0m09:30:24.338313 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:30:24.338644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2eff0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2fe0f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2eebd270>]}
[0m09:30:24.339012 [debug] [MainThread]: Flushing usage events
[0m09:30:24.722972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:16:46.368836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdae4cd07c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdae5c826e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdae5c82680>]}


============================== 10:16:46.371167 | 5c816e66-1b75-48a4-b9a8-3f297bce627d ==============================
[0m10:16:46.371167 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:16:46.371690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:16:46.376082 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m10:16:46.376589 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "nerd_facts_dbt", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!
[0m10:16:46.377324 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.053926922, "process_in_blocks": "0", "process_kernel_time": 0.031927, "process_mem_max_rss": "85140", "process_out_blocks": "8", "process_user_time": 1.003708}
[0m10:16:46.377828 [debug] [MainThread]: Command `dbt run` failed at 10:16:46.377741 after 0.05 seconds
[0m10:16:46.378146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdae4cd07c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdae5c17a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdae5c17910>]}
[0m10:16:46.378514 [debug] [MainThread]: Flushing usage events
[0m10:16:46.812409 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:17:04.519505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bf30087c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bf2172350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bf21723b0>]}


============================== 10:17:04.521872 | a049bf12-938c-4b2d-8df1-ca202db10477 ==============================
[0m10:17:04.521872 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:17:04.522428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:17:04.526769 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m10:17:04.527249 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "nerd_facts_dbt", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!
[0m10:17:04.527950 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05624714, "process_in_blocks": "0", "process_kernel_time": 0.028019, "process_mem_max_rss": "85048", "process_out_blocks": "8", "process_user_time": 0.931854}
[0m10:17:04.528405 [debug] [MainThread]: Command `dbt run` failed at 10:17:04.528319 after 0.06 seconds
[0m10:17:04.528732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bf30087c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bf3f4fa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bf3f4f8e0>]}
[0m10:17:04.529076 [debug] [MainThread]: Flushing usage events
[0m10:17:04.949489 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:18:33.449734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651f7f08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6520667b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6520667be0>]}


============================== 10:18:33.452013 | 9735f254-4160-4bde-adbc-d36f91b09d31 ==============================
[0m10:18:33.452013 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:18:33.452440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:18:33.579375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9735f254-4160-4bde-adbc-d36f91b09d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65207ca710>]}
[0m10:18:33.628021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9735f254-4160-4bde-adbc-d36f91b09d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6520667b50>]}
[0m10:18:33.628743 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:18:33.715798 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:18:33.716452 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:18:33.716840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9735f254-4160-4bde-adbc-d36f91b09d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651de4b310>]}
[0m10:18:34.533416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9735f254-4160-4bde-adbc-d36f91b09d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651dd184c0>]}
[0m10:18:34.585864 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m10:18:34.587988 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m10:18:34.607091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9735f254-4160-4bde-adbc-d36f91b09d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651d550700>]}
[0m10:18:34.607601 [info ] [MainThread]: Found 1 model, 433 macros
[0m10:18:34.607977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9735f254-4160-4bde-adbc-d36f91b09d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651d550790>]}
[0m10:18:34.609285 [info ] [MainThread]: 
[0m10:18:34.609669 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:18:34.609984 [info ] [MainThread]: 
[0m10:18:34.610488 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:18:34.611916 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m10:18:34.643209 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m10:18:34.643606 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m10:18:34.643916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:34.657094 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m10:18:34.658348 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m10:18:34.661219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_raw)
[0m10:18:34.667166 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_raw"
[0m10:18:34.667555 [debug] [ThreadPool]: On list_nerd_facts_raw: BEGIN
[0m10:18:34.667855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:34.680103 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:18:34.680516 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_raw"
[0m10:18:34.680846 [debug] [ThreadPool]: On list_nerd_facts_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_raw"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m10:18:34.683232 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:18:34.684449 [debug] [ThreadPool]: On list_nerd_facts_raw: ROLLBACK
[0m10:18:34.684877 [debug] [ThreadPool]: On list_nerd_facts_raw: Close
[0m10:18:34.690398 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:34.690772 [debug] [MainThread]: On master: BEGIN
[0m10:18:34.691066 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:18:34.703394 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:18:34.703820 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:34.704197 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:18:34.711990 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m10:18:34.713180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9735f254-4160-4bde-adbc-d36f91b09d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651df3cdc0>]}
[0m10:18:34.713694 [debug] [MainThread]: On master: ROLLBACK
[0m10:18:34.714163 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:34.714460 [debug] [MainThread]: On master: BEGIN
[0m10:18:34.714929 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:18:34.715225 [debug] [MainThread]: On master: COMMIT
[0m10:18:34.715517 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:34.715792 [debug] [MainThread]: On master: COMMIT
[0m10:18:34.716150 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:18:34.716433 [debug] [MainThread]: On master: Close
[0m10:18:34.720435 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.pokemon
[0m10:18:34.721015 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.pokemon ........................................ [RUN]
[0m10:18:34.721547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_raw, now model.nerd_facts_dbt.pokemon)
[0m10:18:34.721900 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.pokemon
[0m10:18:34.729469 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.pokemon"
[0m10:18:34.730284 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.pokemon
[0m10:18:34.763752 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.pokemon"
[0m10:18:34.764506 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m10:18:34.764894 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: BEGIN
[0m10:18:34.765227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:34.777443 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m10:18:34.777901 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m10:18:34.778276 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */

  create view "nerd_facts"."raw"."pokemon__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM raw.pokeapi_pokemon
)

SELECT 
    id,
    name,
    height,
    weight,
    ROUND(weight / (height * height), 2) AS bmi
FROM source
  );
[0m10:18:34.779148 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: text * text
LINE 16:     ROUND(weight / (height * height), 2) AS bmi
                                    ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m10:18:34.779515 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: ROLLBACK
[0m10:18:34.780013 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: Close
[0m10:18:34.783418 [debug] [Thread-1 (]: Database Error in model pokemon (models/pokemon.sql)
  operator does not exist: text * text
  LINE 16:     ROUND(weight / (height * height), 2) AS bmi
                                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/pokemon.sql
[0m10:18:34.785235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9735f254-4160-4bde-adbc-d36f91b09d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6520a84a60>]}
[0m10:18:34.785930 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.pokemon ............................... [[31mERROR[0m in 0.06s]
[0m10:18:34.786555 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.pokemon
[0m10:18:34.787093 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.pokemon' to be skipped because of status 'error'.  Reason: Database Error in model pokemon (models/pokemon.sql)
  operator does not exist: text * text
  LINE 16:     ROUND(weight / (height * height), 2) AS bmi
                                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/pokemon.sql.
[0m10:18:34.788652 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:34.788975 [debug] [MainThread]: On master: BEGIN
[0m10:18:34.789255 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:18:34.801373 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:18:34.801830 [debug] [MainThread]: On master: COMMIT
[0m10:18:34.802172 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:34.802459 [debug] [MainThread]: On master: COMMIT
[0m10:18:34.802844 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:18:34.803128 [debug] [MainThread]: On master: Close
[0m10:18:34.803613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:18:34.803837 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.pokemon' was properly closed.
[0m10:18:34.804074 [info ] [MainThread]: 
[0m10:18:34.804329 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m10:18:34.804817 [debug] [MainThread]: Command end result
[0m10:18:34.820759 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m10:18:34.822086 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m10:18:34.827835 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m10:18:34.828154 [info ] [MainThread]: 
[0m10:18:34.828483 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:18:34.828756 [info ] [MainThread]: 
[0m10:18:34.829054 [error] [MainThread]:   Database Error in model pokemon (models/pokemon.sql)
  operator does not exist: text * text
  LINE 16:     ROUND(weight / (height * height), 2) AS bmi
                                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/pokemon.sql
[0m10:18:34.829301 [info ] [MainThread]: 
[0m10:18:34.829576 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:18:34.830272 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4229543, "process_in_blocks": "2272", "process_kernel_time": 0.06774, "process_mem_max_rss": "110600", "process_out_blocks": "2536", "process_user_time": 2.209926}
[0m10:18:34.830648 [debug] [MainThread]: Command `dbt run` failed at 10:18:34.830571 after 1.42 seconds
[0m10:18:34.830947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651f7f08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65207ca710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651dceffa0>]}
[0m10:18:34.831277 [debug] [MainThread]: Flushing usage events
[0m10:18:35.228893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:19:26.272202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf25e0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf34537c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf3453820>]}


============================== 10:19:26.274327 | e6b5d28a-e2d9-438b-8ff2-0707ffc56bef ==============================
[0m10:19:26.274327 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:19:26.274753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:19:26.400214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6b5d28a-e2d9-438b-8ff2-0707ffc56bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf33f0b80>]}
[0m10:19:26.448951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6b5d28a-e2d9-438b-8ff2-0707ffc56bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf33afd30>]}
[0m10:19:26.449623 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:19:26.521704 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:19:26.591518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:19:26.591866 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:19:26.613605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6b5d28a-e2d9-438b-8ff2-0707ffc56bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf0854130>]}
[0m10:19:26.661993 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m10:19:26.663893 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m10:19:26.672093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6b5d28a-e2d9-438b-8ff2-0707ffc56bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf08551e0>]}
[0m10:19:26.672554 [info ] [MainThread]: Found 1 model, 433 macros
[0m10:19:26.672844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6b5d28a-e2d9-438b-8ff2-0707ffc56bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf0855900>]}
[0m10:19:26.674216 [info ] [MainThread]: 
[0m10:19:26.674548 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:19:26.674775 [info ] [MainThread]: 
[0m10:19:26.675140 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:19:26.675940 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m10:19:26.706260 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m10:19:26.706630 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m10:19:26.706876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:26.719813 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m10:19:26.720845 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m10:19:26.722041 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_raw'
[0m10:19:26.727777 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_raw"
[0m10:19:26.728195 [debug] [ThreadPool]: On list_nerd_facts_raw: BEGIN
[0m10:19:26.728501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:26.740716 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:19:26.741098 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_raw"
[0m10:19:26.741355 [debug] [ThreadPool]: On list_nerd_facts_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_raw"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m10:19:26.743683 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:19:26.744688 [debug] [ThreadPool]: On list_nerd_facts_raw: ROLLBACK
[0m10:19:26.745080 [debug] [ThreadPool]: On list_nerd_facts_raw: Close
[0m10:19:26.749930 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.750300 [debug] [MainThread]: On master: BEGIN
[0m10:19:26.750532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:26.762693 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:19:26.763069 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.763353 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:19:26.770742 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m10:19:26.771656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6b5d28a-e2d9-438b-8ff2-0707ffc56bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf0872110>]}
[0m10:19:26.772063 [debug] [MainThread]: On master: ROLLBACK
[0m10:19:26.772476 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.772799 [debug] [MainThread]: On master: BEGIN
[0m10:19:26.773187 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:19:26.773438 [debug] [MainThread]: On master: COMMIT
[0m10:19:26.773671 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.773908 [debug] [MainThread]: On master: COMMIT
[0m10:19:26.774279 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:19:26.774512 [debug] [MainThread]: On master: Close
[0m10:19:26.776948 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.pokemon
[0m10:19:26.777457 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.pokemon ........................................ [RUN]
[0m10:19:26.778039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_raw, now model.nerd_facts_dbt.pokemon)
[0m10:19:26.778357 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.pokemon
[0m10:19:26.784297 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.pokemon"
[0m10:19:26.784812 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.pokemon
[0m10:19:26.813936 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.pokemon"
[0m10:19:26.814587 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m10:19:26.814947 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: BEGIN
[0m10:19:26.815208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:26.827470 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m10:19:26.827893 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m10:19:26.828180 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */

  create view "nerd_facts"."raw"."pokemon__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM raw.pokeapi_pokemon
)

SELECT 
    id,
    name,
    height,
    weight,
    ROUND(weight / (height * height), 2) AS bmi
FROM source
  );
[0m10:19:26.828986 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: text * text
LINE 16:     ROUND(weight / (height * height), 2) AS bmi
                                    ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m10:19:26.829284 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: ROLLBACK
[0m10:19:26.829838 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: Close
[0m10:19:26.831531 [debug] [Thread-1 (]: Database Error in model pokemon (models/pokemon.sql)
  operator does not exist: text * text
  LINE 16:     ROUND(weight / (height * height), 2) AS bmi
                                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/pokemon.sql
[0m10:19:26.833038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6b5d28a-e2d9-438b-8ff2-0707ffc56bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf27023e0>]}
[0m10:19:26.833890 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.pokemon ............................... [[31mERROR[0m in 0.05s]
[0m10:19:26.834547 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.pokemon
[0m10:19:26.835115 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.pokemon' to be skipped because of status 'error'.  Reason: Database Error in model pokemon (models/pokemon.sql)
  operator does not exist: text * text
  LINE 16:     ROUND(weight / (height * height), 2) AS bmi
                                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/pokemon.sql.
[0m10:19:26.836534 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.836814 [debug] [MainThread]: On master: BEGIN
[0m10:19:26.837031 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:19:26.849044 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:19:26.849515 [debug] [MainThread]: On master: COMMIT
[0m10:19:26.849867 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.850136 [debug] [MainThread]: On master: COMMIT
[0m10:19:26.850515 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:19:26.850810 [debug] [MainThread]: On master: Close
[0m10:19:26.851396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:26.851748 [debug] [MainThread]: Connection 'list_nerd_facts' was properly closed.
[0m10:19:26.852062 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.pokemon' was properly closed.
[0m10:19:26.852413 [info ] [MainThread]: 
[0m10:19:26.852779 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m10:19:26.853565 [debug] [MainThread]: Command end result
[0m10:19:26.872684 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m10:19:26.874153 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m10:19:26.879473 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m10:19:26.879848 [info ] [MainThread]: 
[0m10:19:26.880249 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:19:26.880578 [info ] [MainThread]: 
[0m10:19:26.880947 [error] [MainThread]:   Database Error in model pokemon (models/pokemon.sql)
  operator does not exist: text * text
  LINE 16:     ROUND(weight / (height * height), 2) AS bmi
                                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/pokemon.sql
[0m10:19:26.881248 [info ] [MainThread]: 
[0m10:19:26.881592 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:19:26.882382 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6551281, "process_in_blocks": "0", "process_kernel_time": 0.091696, "process_mem_max_rss": "108044", "process_out_blocks": "1712", "process_user_time": 1.530676}
[0m10:19:26.882757 [debug] [MainThread]: Command `dbt run` failed at 10:19:26.882673 after 0.66 seconds
[0m10:19:26.883111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf25e0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf33f0b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf249e410>]}
[0m10:19:26.883468 [debug] [MainThread]: Flushing usage events
[0m10:19:27.265711 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:20:52.502193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8409bf08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840aa637c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840aa63820>]}


============================== 10:20:52.504542 | 89dbec8a-d7e6-4284-b60e-fa8003117cde ==============================
[0m10:20:52.504542 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:20:52.505074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:20:52.638514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89dbec8a-d7e6-4284-b60e-fa8003117cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840abca710>]}
[0m10:20:52.690532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89dbec8a-d7e6-4284-b60e-fa8003117cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840aa63790>]}
[0m10:20:52.691237 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:20:52.771304 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:20:52.845997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:20:52.846617 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/pokemon.sql
[0m10:20:53.046831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89dbec8a-d7e6-4284-b60e-fa8003117cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8407de27d0>]}
[0m10:20:53.102171 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m10:20:53.104392 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m10:20:53.112896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89dbec8a-d7e6-4284-b60e-fa8003117cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8407dbd510>]}
[0m10:20:53.113394 [info ] [MainThread]: Found 1 model, 433 macros
[0m10:20:53.113792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89dbec8a-d7e6-4284-b60e-fa8003117cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8407dbcaf0>]}
[0m10:20:53.115208 [info ] [MainThread]: 
[0m10:20:53.115575 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:20:53.115877 [info ] [MainThread]: 
[0m10:20:53.116355 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:20:53.117157 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m10:20:53.148073 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m10:20:53.148537 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m10:20:53.148860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:53.162035 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m10:20:53.163229 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m10:20:53.165836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_raw)
[0m10:20:53.171270 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_raw"
[0m10:20:53.171688 [debug] [ThreadPool]: On list_nerd_facts_raw: BEGIN
[0m10:20:53.171998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:20:53.184348 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:20:53.184723 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_raw"
[0m10:20:53.184985 [debug] [ThreadPool]: On list_nerd_facts_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_raw"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m10:20:53.187305 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:20:53.188307 [debug] [ThreadPool]: On list_nerd_facts_raw: ROLLBACK
[0m10:20:53.188670 [debug] [ThreadPool]: On list_nerd_facts_raw: Close
[0m10:20:53.192525 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:53.192857 [debug] [MainThread]: On master: BEGIN
[0m10:20:53.193100 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:20:53.205186 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:20:53.205564 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:53.205865 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:20:53.213122 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m10:20:53.214060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89dbec8a-d7e6-4284-b60e-fa8003117cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8407de2fe0>]}
[0m10:20:53.214459 [debug] [MainThread]: On master: ROLLBACK
[0m10:20:53.214886 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:53.215148 [debug] [MainThread]: On master: BEGIN
[0m10:20:53.215530 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:20:53.215766 [debug] [MainThread]: On master: COMMIT
[0m10:20:53.215989 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:53.216197 [debug] [MainThread]: On master: COMMIT
[0m10:20:53.216474 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:20:53.216701 [debug] [MainThread]: On master: Close
[0m10:20:53.218640 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.pokemon
[0m10:20:53.219141 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.pokemon ........................................ [RUN]
[0m10:20:53.219569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_raw, now model.nerd_facts_dbt.pokemon)
[0m10:20:53.219860 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.pokemon
[0m10:20:53.225228 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.pokemon"
[0m10:20:53.225753 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.pokemon
[0m10:20:53.255249 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.pokemon"
[0m10:20:53.255956 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m10:20:53.256298 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: BEGIN
[0m10:20:53.256585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:53.268776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m10:20:53.269196 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m10:20:53.269521 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */

  create view "nerd_facts"."raw"."pokemon__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM raw.pokeapi_pokemon
)

SELECT 
    id,
    name,
    CAST(height AS NUMERIC) AS height,  -- ✅ Convert to numeric
    CAST(weight AS NUMERIC) AS weight,  -- ✅ Convert to numeric
    ROUND(CAST(weight AS NUMERIC) / (CAST(height AS NUMERIC) * CAST(height AS NUMERIC)), 2) AS bmi  -- ✅ Calculate BMI
FROM source
  );
[0m10:20:53.271476 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:20:53.312281 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m10:20:53.312690 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */
alter table "nerd_facts"."raw"."pokemon__dbt_tmp" rename to "pokemon"
[0m10:20:53.313408 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:20:53.324302 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: COMMIT
[0m10:20:53.324682 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m10:20:53.324965 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: COMMIT
[0m10:20:53.331372 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m10:20:53.336701 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."raw"."pokemon__dbt_backup"
[0m10:20:53.340361 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m10:20:53.340726 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */
drop view if exists "nerd_facts"."raw"."pokemon__dbt_backup" cascade
[0m10:20:53.341240 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:20:53.343217 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: Close
[0m10:20:53.344754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89dbec8a-d7e6-4284-b60e-fa8003117cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8406c7f010>]}
[0m10:20:53.345351 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw.pokemon ................................... [[32mCREATE VIEW[0m in 0.12s]
[0m10:20:53.345875 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.pokemon
[0m10:20:53.346942 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:53.347227 [debug] [MainThread]: On master: BEGIN
[0m10:20:53.347455 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:20:53.359402 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:20:53.359813 [debug] [MainThread]: On master: COMMIT
[0m10:20:53.360094 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:53.360333 [debug] [MainThread]: On master: COMMIT
[0m10:20:53.360655 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:20:53.360906 [debug] [MainThread]: On master: Close
[0m10:20:53.361370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:20:53.361671 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.pokemon' was properly closed.
[0m10:20:53.361946 [info ] [MainThread]: 
[0m10:20:53.362341 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m10:20:53.363036 [debug] [MainThread]: Command end result
[0m10:20:53.379265 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m10:20:53.380581 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m10:20:53.386065 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m10:20:53.386379 [info ] [MainThread]: 
[0m10:20:53.386732 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:20:53.387000 [info ] [MainThread]: 
[0m10:20:53.387268 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:20:53.387935 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9309484, "process_in_blocks": "0", "process_kernel_time": 0.095683, "process_mem_max_rss": "111104", "process_out_blocks": "2536", "process_user_time": 1.733626}
[0m10:20:53.388284 [debug] [MainThread]: Command `dbt run` succeeded at 10:20:53.388191 after 0.93 seconds
[0m10:20:53.388599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8409bf08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8409a89f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8407dbc280>]}
[0m10:20:53.388890 [debug] [MainThread]: Flushing usage events
[0m10:20:53.787307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:48:33.661100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8369b988b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8368b4d870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8368b4d810>]}


============================== 12:48:33.663967 | f944e282-6c0b-4ade-9af5-bad02966a972 ==============================
[0m12:48:33.663967 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:48:33.664405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:48:33.669866 [info ] [MainThread]: dbt version: 1.9.3
[0m12:48:33.670196 [info ] [MainThread]: python version: 3.10.12
[0m12:48:33.670454 [info ] [MainThread]: python path: /home/janne/nerd-facts-dbt/venv/bin/python3
[0m12:48:33.670684 [info ] [MainThread]: os info: Linux-5.15.0-134-generic-x86_64-with-glibc2.35
[0m12:48:33.712654 [info ] [MainThread]: Using profiles dir at /home/janne/nerd-facts-dbt/dbt_project
[0m12:48:33.713076 [info ] [MainThread]: Using profiles.yml file at /home/janne/nerd-facts-dbt/dbt_project/profiles.yml
[0m12:48:33.713351 [info ] [MainThread]: Using dbt_project.yml file at /home/janne/nerd-facts-dbt/dbt_project/dbt_project.yml
[0m12:48:33.713739 [info ] [MainThread]: adapter type: postgres
[0m12:48:33.713984 [info ] [MainThread]: adapter version: 1.9.0
[0m12:48:33.797316 [info ] [MainThread]: Configuration:
[0m12:48:33.797824 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:48:33.798179 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:48:33.798492 [info ] [MainThread]: Required dependencies:
[0m12:48:33.798816 [debug] [MainThread]: Executing "git --help"
[0m12:48:33.800321 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:48:33.800669 [debug] [MainThread]: STDERR: "b''"
[0m12:48:33.800952 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:48:33.801274 [info ] [MainThread]: Connection:
[0m12:48:33.801625 [info ] [MainThread]:   host: localhost
[0m12:48:33.801920 [info ] [MainThread]:   port: 5432
[0m12:48:33.802208 [info ] [MainThread]:   user: dbt_user
[0m12:48:33.802490 [info ] [MainThread]:   database: nerd_facts
[0m12:48:33.802783 [info ] [MainThread]:   schema: public
[0m12:48:33.803067 [info ] [MainThread]:   connect_timeout: 10
[0m12:48:33.803353 [info ] [MainThread]:   role: None
[0m12:48:33.803629 [info ] [MainThread]:   search_path: None
[0m12:48:33.803916 [info ] [MainThread]:   keepalives_idle: 0
[0m12:48:33.804194 [info ] [MainThread]:   sslmode: None
[0m12:48:33.804482 [info ] [MainThread]:   sslcert: None
[0m12:48:33.804765 [info ] [MainThread]:   sslkey: None
[0m12:48:33.805053 [info ] [MainThread]:   sslrootcert: None
[0m12:48:33.805334 [info ] [MainThread]:   application_name: dbt
[0m12:48:33.805630 [info ] [MainThread]:   retries: 1
[0m12:48:33.806046 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:48:33.887743 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:48:33.908945 [debug] [MainThread]: Using postgres connection "debug"
[0m12:48:33.909337 [debug] [MainThread]: On debug: select 1 as id
[0m12:48:33.909662 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:33.922479 [debug] [MainThread]: SQL status: SELECT 1 in 0.013 seconds
[0m12:48:33.923457 [debug] [MainThread]: On debug: Close
[0m12:48:33.923983 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:48:33.924625 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:48:33.925751 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.31863078, "process_in_blocks": "32", "process_kernel_time": 0.063884, "process_mem_max_rss": "100936", "process_out_blocks": "24", "process_user_time": 1.153817}
[0m12:48:33.926286 [debug] [MainThread]: Command `dbt debug` succeeded at 12:48:33.926171 after 0.32 seconds
[0m12:48:33.926647 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:48:33.926973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8369b988b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836a9e5630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8369a69930>]}
[0m12:48:33.927340 [debug] [MainThread]: Flushing usage events
[0m12:48:34.329539 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:48:43.992391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbd3a4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbe2177c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbe217820>]}


============================== 12:48:43.994559 | 65757145-758a-49a2-8d78-60db90f70258 ==============================
[0m12:48:43.994559 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:48:43.994987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:48:44.129950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65757145-758a-49a2-8d78-60db90f70258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbe1c22f0>]}
[0m12:48:44.178211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65757145-758a-49a2-8d78-60db90f70258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbc41c4f0>]}
[0m12:48:44.178896 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:48:44.252141 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:48:44.306570 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:48:44.307006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '65757145-758a-49a2-8d78-60db90f70258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbcb319c0>]}
[0m12:48:45.069602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65757145-758a-49a2-8d78-60db90f70258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbb89b8e0>]}
[0m12:48:45.122264 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:48:45.124401 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:48:45.134326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65757145-758a-49a2-8d78-60db90f70258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbb9ff730>]}
[0m12:48:45.134803 [info ] [MainThread]: Found 1 model, 433 macros
[0m12:48:45.135189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65757145-758a-49a2-8d78-60db90f70258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbc6db370>]}
[0m12:48:45.136409 [info ] [MainThread]: 
[0m12:48:45.136735 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:48:45.136975 [info ] [MainThread]: 
[0m12:48:45.137360 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:48:45.138165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m12:48:45.168016 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m12:48:45.168421 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m12:48:45.168684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:45.182893 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m12:48:45.183944 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m12:48:45.185161 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public'
[0m12:48:45.190361 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:48:45.190695 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m12:48:45.190939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:45.204115 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:48:45.204542 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:48:45.204830 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:48:45.207312 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m12:48:45.208280 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m12:48:45.208692 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m12:48:45.212411 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:45.212800 [debug] [MainThread]: On master: BEGIN
[0m12:48:45.213046 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:45.225193 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:48:45.225580 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:45.225887 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:48:45.234227 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m12:48:45.235241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65757145-758a-49a2-8d78-60db90f70258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbb0fe2c0>]}
[0m12:48:45.235659 [debug] [MainThread]: On master: ROLLBACK
[0m12:48:45.236048 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:45.236295 [debug] [MainThread]: On master: BEGIN
[0m12:48:45.236754 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:48:45.237006 [debug] [MainThread]: On master: COMMIT
[0m12:48:45.237247 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:45.237487 [debug] [MainThread]: On master: COMMIT
[0m12:48:45.237799 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:48:45.238031 [debug] [MainThread]: On master: Close
[0m12:48:45.241566 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.pokemon
[0m12:48:45.242106 [info ] [Thread-1 (]: 1 of 1 START sql view model public.pokemon ..................................... [RUN]
[0m12:48:45.242542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.pokemon)
[0m12:48:45.242829 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.pokemon
[0m12:48:45.248288 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.pokemon"
[0m12:48:45.248857 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.pokemon
[0m12:48:45.278798 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.pokemon"
[0m12:48:45.279450 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m12:48:45.279794 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: BEGIN
[0m12:48:45.280053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:45.292380 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m12:48:45.292860 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m12:48:45.293170 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */

  create view "nerd_facts"."public"."pokemon__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM raw.pokeapi_pokemon
)

SELECT 
    id,
    name,
    CAST(height AS NUMERIC) AS height,  -- ✅ Convert to numeric
    CAST(weight AS NUMERIC) AS weight,  -- ✅ Convert to numeric
    ROUND(CAST(weight AS NUMERIC) / (CAST(height AS NUMERIC) * CAST(height AS NUMERIC)), 2) AS bmi
FROM source
  );
[0m12:48:45.295801 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:48:45.301772 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m12:48:45.302136 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */
alter table "nerd_facts"."public"."pokemon__dbt_tmp" rename to "pokemon"
[0m12:48:45.303044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:48:45.314497 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: COMMIT
[0m12:48:45.314887 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m12:48:45.315174 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: COMMIT
[0m12:48:45.322049 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m12:48:45.327346 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."pokemon__dbt_backup"
[0m12:48:45.330715 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m12:48:45.331059 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */
drop view if exists "nerd_facts"."public"."pokemon__dbt_backup" cascade
[0m12:48:45.331637 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:48:45.333813 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: Close
[0m12:48:45.335600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65757145-758a-49a2-8d78-60db90f70258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bba579c00>]}
[0m12:48:45.336360 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.pokemon ................................ [[32mCREATE VIEW[0m in 0.09s]
[0m12:48:45.336892 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.pokemon
[0m12:48:45.337890 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:45.338178 [debug] [MainThread]: On master: BEGIN
[0m12:48:45.338404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:48:45.350664 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:48:45.351060 [debug] [MainThread]: On master: COMMIT
[0m12:48:45.351323 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:45.351547 [debug] [MainThread]: On master: COMMIT
[0m12:48:45.351851 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:48:45.352096 [debug] [MainThread]: On master: Close
[0m12:48:45.352578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:45.352878 [debug] [MainThread]: Connection 'list_nerd_facts' was properly closed.
[0m12:48:45.353138 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.pokemon' was properly closed.
[0m12:48:45.353467 [info ] [MainThread]: 
[0m12:48:45.353898 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m12:48:45.354526 [debug] [MainThread]: Command end result
[0m12:48:45.370546 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:48:45.371869 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:48:45.376959 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m12:48:45.377310 [info ] [MainThread]: 
[0m12:48:45.377673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:48:45.377935 [info ] [MainThread]: 
[0m12:48:45.378203 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:48:45.378881 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4310274, "process_in_blocks": "3536", "process_kernel_time": 0.100062, "process_mem_max_rss": "110580", "process_out_blocks": "2536", "process_user_time": 2.176167}
[0m12:48:45.379234 [debug] [MainThread]: Command `dbt run` succeeded at 12:48:45.379153 after 1.43 seconds
[0m12:48:45.379523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbd3a4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbb683610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbe1c22f0>]}
[0m12:48:45.379818 [debug] [MainThread]: Flushing usage events
[0m12:48:45.766728 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:57:57.955438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc06d64970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc07c07760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc07c077c0>]}


============================== 12:57:57.958533 | 7199ce64-8df0-4a0c-b47f-2ea8170c05d0 ==============================
[0m12:57:57.958533 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:57:57.958977 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:57:58.096068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7199ce64-8df0-4a0c-b47f-2ea8170c05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc05e0f340>]}
[0m12:57:58.142484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7199ce64-8df0-4a0c-b47f-2ea8170c05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc07b67ac0>]}
[0m12:57:58.143467 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:57:58.217070 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:57:58.305350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:57:58.305887 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/pokemon.sql
[0m12:57:58.491290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7199ce64-8df0-4a0c-b47f-2ea8170c05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc04f86860>]}
[0m12:57:58.538635 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:57:58.540866 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:57:58.554423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7199ce64-8df0-4a0c-b47f-2ea8170c05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc04fc0970>]}
[0m12:57:58.554910 [info ] [MainThread]: Found 1 model, 433 macros
[0m12:57:58.555217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7199ce64-8df0-4a0c-b47f-2ea8170c05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc04fc0910>]}
[0m12:57:58.556503 [info ] [MainThread]: 
[0m12:57:58.556822 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:57:58.557051 [info ] [MainThread]: 
[0m12:57:58.557443 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:57:58.558205 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m12:57:58.594584 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m12:57:58.594973 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m12:57:58.595227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:58.610359 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m12:57:58.611563 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m12:57:58.613028 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public'
[0m12:57:58.619307 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:57:58.619692 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m12:57:58.619992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:58.632599 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:57:58.633026 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:57:58.633372 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:57:58.636211 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m12:57:58.637339 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m12:57:58.637801 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m12:57:58.642737 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:58.643130 [debug] [MainThread]: On master: BEGIN
[0m12:57:58.643426 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:58.655854 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:57:58.656268 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:58.656662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:57:58.665014 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m12:57:58.666214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7199ce64-8df0-4a0c-b47f-2ea8170c05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc04f5e170>]}
[0m12:57:58.666692 [debug] [MainThread]: On master: ROLLBACK
[0m12:57:58.667135 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:58.667448 [debug] [MainThread]: On master: BEGIN
[0m12:57:58.667911 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:57:58.668200 [debug] [MainThread]: On master: COMMIT
[0m12:57:58.668502 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:58.668778 [debug] [MainThread]: On master: COMMIT
[0m12:57:58.669133 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:57:58.669415 [debug] [MainThread]: On master: Close
[0m12:57:58.673007 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.pokemon
[0m12:57:58.673645 [info ] [Thread-1 (]: 1 of 1 START sql table model public.pokemon .................................... [RUN]
[0m12:57:58.674175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.pokemon)
[0m12:57:58.674530 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.pokemon
[0m12:57:58.682086 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.pokemon"
[0m12:57:58.682657 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.pokemon
[0m12:57:58.720937 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.pokemon"
[0m12:57:58.721697 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m12:57:58.722122 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: BEGIN
[0m12:57:58.722459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:58.735103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m12:57:58.735571 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m12:57:58.735954 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */

  
    

  create  table "nerd_facts"."public"."pokemon__dbt_tmp"
  
  
    as
  
  (
    

WITH source AS (
    SELECT * FROM raw.pokeapi_pokemon
)

SELECT 
    id,
    name,
    CAST(height AS NUMERIC) AS height,  -- ✅ Convert to numeric
    CAST(weight AS NUMERIC) AS weight,  -- ✅ Convert to numeric
    ROUND(CAST(weight AS NUMERIC) / (CAST(height AS NUMERIC) * CAST(height AS NUMERIC)), 2) AS bmi
FROM source
  );
  
[0m12:57:58.747749 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.011 seconds
[0m12:57:58.789578 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m12:57:58.789980 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */
alter table "nerd_facts"."public"."pokemon__dbt_tmp" rename to "pokemon"
[0m12:57:58.790673 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:57:58.805287 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: COMMIT
[0m12:57:58.805717 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m12:57:58.806002 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: COMMIT
[0m12:57:58.812039 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m12:57:58.817389 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."pokemon__dbt_backup"
[0m12:57:58.820751 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.pokemon"
[0m12:57:58.821105 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.pokemon"} */
drop table if exists "nerd_facts"."public"."pokemon__dbt_backup" cascade
[0m12:57:58.821637 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:57:58.823612 [debug] [Thread-1 (]: On model.nerd_facts_dbt.pokemon: Close
[0m12:57:58.825740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7199ce64-8df0-4a0c-b47f-2ea8170c05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc07fb6d10>]}
[0m12:57:58.826493 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.pokemon ............................... [[32mSELECT 10[0m in 0.15s]
[0m12:57:58.827062 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.pokemon
[0m12:57:58.828123 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:58.828435 [debug] [MainThread]: On master: BEGIN
[0m12:57:58.828669 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:58.840921 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:57:58.841315 [debug] [MainThread]: On master: COMMIT
[0m12:57:58.841607 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:58.841845 [debug] [MainThread]: On master: COMMIT
[0m12:57:58.842179 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:57:58.842426 [debug] [MainThread]: On master: Close
[0m12:57:58.842870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:58.843094 [debug] [MainThread]: Connection 'list_nerd_facts' was properly closed.
[0m12:57:58.843283 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.pokemon' was properly closed.
[0m12:57:58.843511 [info ] [MainThread]: 
[0m12:57:58.843764 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m12:57:58.844351 [debug] [MainThread]: Command end result
[0m12:57:58.860081 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:57:58.861485 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:57:58.866759 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m12:57:58.867130 [info ] [MainThread]: 
[0m12:57:58.867477 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:57:58.867750 [info ] [MainThread]: 
[0m12:57:58.868019 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:57:58.869113 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9574552, "process_in_blocks": "68480", "process_kernel_time": 0.111841, "process_mem_max_rss": "110876", "process_out_blocks": "2536", "process_user_time": 1.768886}
[0m12:57:58.869502 [debug] [MainThread]: Command `dbt run` succeeded at 12:57:58.869406 after 0.96 seconds
[0m12:57:58.869788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc06d64970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc06be6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc052e55d0>]}
[0m12:57:58.870082 [debug] [MainThread]: Flushing usage events
[0m12:57:59.259740 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:06:42.512832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2fb3c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae30b1e740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae30b1e6e0>]}


============================== 11:06:42.515500 | 3765f1c5-b50b-4096-9c77-2b3592b5078f ==============================
[0m11:06:42.515500 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:06:42.515949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:06:42.519926 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m11:06:42.520326 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "nerd_facts_dbt", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!
[0m11:06:42.521454 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.053266954, "process_in_blocks": "32744", "process_kernel_time": 0.09489, "process_mem_max_rss": "84924", "process_out_blocks": "16", "process_user_time": 0.945292}
[0m11:06:42.521928 [debug] [MainThread]: Command `dbt run` failed at 11:06:42.521824 after 0.05 seconds
[0m11:06:42.522257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2fb3c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae30ab3a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae30b1e920>]}
[0m11:06:42.522564 [debug] [MainThread]: Flushing usage events
[0m11:06:42.954812 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:07:42.921719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cafb4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cbe5f880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cbe5f8e0>]}


============================== 11:07:42.924450 | 56ba4d59-0281-4bcf-833e-9653127158e8 ==============================
[0m11:07:42.924450 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:07:42.924993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:07:43.033042 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'raw', 'schema': 'raw', 'tables': [{'name': 'swapi_people'}, {'name': 'swapi_planets'}, {'name': 'swapi_starships'}, {'name': 'swapi_vehicles'}, {'name': 'swapi_species'}, {'name': 'swapi_films'}, {'name': 'pokeapi_pokemon'}, {'name': 'pokeapi_types'}, {'name': 'pokeapi_abilities'}, {'name': 'pokeapi_moves'}, {'name': 'pokeapi_items'}]}] is not of type 'object'

Error encountered in /home/janne/nerd-facts-dbt/dbt_project/dbt_project.yml
[0m11:07:43.034013 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.15678445, "process_in_blocks": "27696", "process_kernel_time": 0.080984, "process_mem_max_rss": "92012", "process_out_blocks": "8", "process_user_time": 1.080477}
[0m11:07:43.034441 [debug] [MainThread]: Command `dbt run` failed at 11:07:43.034334 after 0.16 seconds
[0m11:07:43.034803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cafb4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ca7a53f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ca31ae00>]}
[0m11:07:43.035176 [debug] [MainThread]: Flushing usage events
[0m11:07:43.446375 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:10:51.959857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aac4588b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aad3fb7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aad3fb850>]}


============================== 11:10:51.962134 | 5a3646a3-8349-4c8f-a535-7ad48571958f ==============================
[0m11:10:51.962134 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:10:51.962575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:10:52.084759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a3646a3-8349-4c8f-a535-7ad48571958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aab503f10>]}
[0m11:10:52.131455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a3646a3-8349-4c8f-a535-7ad48571958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aab500520>]}
[0m11:10:52.141101 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:10:52.217609 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:10:52.273908 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:10:52.274350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5a3646a3-8349-4c8f-a535-7ad48571958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aabc0ad40>]}
[0m11:10:53.005040 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_swapi_people (models/swapi/stg_swapi_people.sql)
  invalid syntax for function call expression
    line 1
      {{ config(
[0m11:10:53.006019 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0907583, "process_in_blocks": "2384", "process_kernel_time": 0.088138, "process_mem_max_rss": "99560", "process_out_blocks": "16", "process_user_time": 1.948717}
[0m11:10:53.006470 [debug] [MainThread]: Command `dbt run` failed at 11:10:53.006369 after 1.09 seconds
[0m11:10:53.006832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aac4588b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aaa776ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aaa776e00>]}
[0m11:10:53.007199 [debug] [MainThread]: Flushing usage events
[0m11:10:53.395144 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:12:24.722009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb1b848e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb29fb7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb29fb850>]}


============================== 11:12:24.724251 | 8af75105-8af1-4637-927c-d9b4fbb8511a ==============================
[0m11:12:24.724251 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:12:24.724692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:12:24.852879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8af75105-8af1-4637-927c-d9b4fbb8511a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb0ebb700>]}
[0m11:12:24.900635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8af75105-8af1-4637-927c-d9b4fbb8511a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb0bfc7f0>]}
[0m11:12:24.901317 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:12:24.974835 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:12:25.033166 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:12:25.033618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8af75105-8af1-4637-927c-d9b4fbb8511a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb1354c40>]}
[0m11:12:25.910875 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.nerd_facts_dbt.marts
- models.nerd_facts_dbt.staging
[0m11:12:25.921980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8af75105-8af1-4637-927c-d9b4fbb8511a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbaf7fc0a0>]}
[0m11:12:25.994565 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:12:25.996924 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:12:26.010240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8af75105-8af1-4637-927c-d9b4fbb8511a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbaf7ff100>]}
[0m11:12:26.010732 [info ] [MainThread]: Found 5 models, 11 sources, 433 macros
[0m11:12:26.011118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8af75105-8af1-4637-927c-d9b4fbb8511a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb029b5e0>]}
[0m11:12:26.012665 [info ] [MainThread]: 
[0m11:12:26.013025 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:12:26.013342 [info ] [MainThread]: 
[0m11:12:26.013865 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:12:26.017671 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m11:12:26.052110 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m11:12:26.052555 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m11:12:26.052875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:26.067034 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m11:12:26.068256 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m11:12:26.069120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now create_nerd_facts_public_public)
[0m11:12:26.069725 [debug] [ThreadPool]: Creating schema "database: "nerd_facts"
schema: "public_public"
"
[0m11:12:26.075655 [debug] [ThreadPool]: Using postgres connection "create_nerd_facts_public_public"
[0m11:12:26.076004 [debug] [ThreadPool]: On create_nerd_facts_public_public: BEGIN
[0m11:12:26.076301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:12:26.089667 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m11:12:26.090147 [debug] [ThreadPool]: Using postgres connection "create_nerd_facts_public_public"
[0m11:12:26.090479 [debug] [ThreadPool]: On create_nerd_facts_public_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "create_nerd_facts_public_public"} */
create schema if not exists "public_public"
[0m11:12:26.091630 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m11:12:26.092531 [debug] [ThreadPool]: On create_nerd_facts_public_public: COMMIT
[0m11:12:26.092880 [debug] [ThreadPool]: Using postgres connection "create_nerd_facts_public_public"
[0m11:12:26.093177 [debug] [ThreadPool]: On create_nerd_facts_public_public: COMMIT
[0m11:12:26.099404 [debug] [ThreadPool]: SQL status: COMMIT in 0.006 seconds
[0m11:12:26.099764 [debug] [ThreadPool]: On create_nerd_facts_public_public: Close
[0m11:12:26.101694 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public_public'
[0m11:12:26.108035 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:12:26.108423 [debug] [ThreadPool]: On list_nerd_facts_public_public: BEGIN
[0m11:12:26.108720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:26.122108 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m11:12:26.122487 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:12:26.122794 [debug] [ThreadPool]: On list_nerd_facts_public_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m11:12:26.125411 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m11:12:26.126363 [debug] [ThreadPool]: On list_nerd_facts_public_public: ROLLBACK
[0m11:12:26.126773 [debug] [ThreadPool]: On list_nerd_facts_public_public: Close
[0m11:12:26.130960 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:26.131364 [debug] [MainThread]: On master: BEGIN
[0m11:12:26.131628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:12:26.144534 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m11:12:26.144922 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:26.145219 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:12:26.152061 [debug] [MainThread]: SQL status: SELECT 28 in 0.006 seconds
[0m11:12:26.153483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8af75105-8af1-4637-927c-d9b4fbb8511a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbaec77b80>]}
[0m11:12:26.153920 [debug] [MainThread]: On master: ROLLBACK
[0m11:12:26.154448 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:26.154708 [debug] [MainThread]: On master: BEGIN
[0m11:12:26.155126 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:12:26.155384 [debug] [MainThread]: On master: COMMIT
[0m11:12:26.155620 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:26.155844 [debug] [MainThread]: On master: COMMIT
[0m11:12:26.156132 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:12:26.156372 [debug] [MainThread]: On master: Close
[0m11:12:26.159145 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_swapi_people
[0m11:12:26.159577 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:12:26.161004 [info ] [Thread-2 (]: 2 of 5 START sql view model public_public.stg_swapi_planets .................... [RUN]
[0m11:12:26.160512 [info ] [Thread-1 (]: 1 of 5 START sql view model public_public.stg_swapi_people ..................... [RUN]
[0m11:12:26.161932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public_public, now model.nerd_facts_dbt.stg_swapi_people)
[0m11:12:26.161536 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly create_nerd_facts_public_public, now model.nerd_facts_dbt.stg_swapi_planets)
[0m11:12:26.162581 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_planets
[0m11:12:26.160068 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:12:26.162270 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_people
[0m11:12:26.169722 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:12:26.174268 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:12:26.170421 [info ] [Thread-3 (]: 3 of 5 START sql view model public_public.stg_swapi_starships .................. [RUN]
[0m11:12:26.175329 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_swapi_planets
[0m11:12:26.175664 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_swapi_people
[0m11:12:26.176168 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_starships'
[0m11:12:26.211668 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:12:26.213260 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_starships
[0m11:12:26.212789 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:12:26.216320 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:12:26.217129 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_starships
[0m11:12:26.220295 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:12:26.220944 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:12:26.221408 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:12:26.221821 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:12:26.222877 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: BEGIN
[0m11:12:26.222535 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: BEGIN
[0m11:12:26.223190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:26.222114 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: BEGIN
[0m11:12:26.224352 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:12:26.223545 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:12:26.249056 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m11:12:26.249765 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:12:26.250277 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */

  create view "nerd_facts"."public_public"."stg_swapi_planets__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    climate,
    terrain,
    diameter::INTEGER AS diameter,
    population::BIGINT AS population,
    gravity,
    orbital_period::INTEGER AS orbital_period,
    rotation_period::INTEGER AS rotation_period,
    surface_water::INTEGER AS surface_water,
    url
FROM "nerd_facts"."raw"."swapi_planets"
  );
[0m11:12:26.253233 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:12:26.262504 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:12:26.263152 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
alter table "nerd_facts"."public_public"."stg_swapi_planets__dbt_tmp" rename to "stg_swapi_planets"
[0m11:12:26.264137 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m11:12:26.265194 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:12:26.263771 [debug] [Thread-3 (]: SQL status: BEGIN in 0.039 seconds
[0m11:12:26.264825 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:12:26.265568 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */

  create view "nerd_facts"."public_public"."stg_swapi_people__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    height::DECIMAL AS height,
    mass::DECIMAL AS mass,
    hair_color,
    skin_color,
    eye_color,
    birth_year,
    gender,
    homeworld::INTEGER AS homeworld_id, -- Convert homeworld URL to integer UID
    species::JSONB AS species_ids, -- Store multiple species as JSONB
    url
FROM "nerd_facts"."raw"."swapi_people"
  );
[0m11:12:26.265917 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:12:26.280672 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: COMMIT
[0m11:12:26.281219 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */

  create view "nerd_facts"."public_public"."stg_swapi_starships__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    model,
    manufacturer,

    -- ✅ Use NULLIF to avoid errors if value is empty ('')
    NULLIF(cost_in_credits, '')::BIGINT AS cost_in_credits,
    NULLIF(length, '')::DECIMAL AS length,
    NULLIF(max_atmosphering_speed, '')::INTEGER AS max_atmosphering_speed,
    NULLIF(crew, '')::INTEGER AS crew,
    NULLIF(passengers, '')::INTEGER AS passengers,
    NULLIF(cargo_capacity, '')::BIGINT AS cargo_capacity,
    
    consumables,

    NULLIF(hyperdrive_rating, '')::DECIMAL AS hyperdrive_rating,
    NULLIF(MGLT, '')::INTEGER AS MGLT,
    
    starship_class,

    -- ✅ Ensure pilots column is always valid JSONB
    CASE 
        WHEN pilots IS NULL OR pilots = '' THEN '[]'::JSONB
        ELSE pilots::JSONB
    END AS pilot_ids,

    url

FROM "nerd_facts"."raw"."swapi_starships"
  );
[0m11:12:26.284665 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:12:26.282100 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:12:26.287778 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:12:26.281690 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "species" does not exist
LINE 20:     species::JSONB AS species_ids, -- Store multiple species...
             ^

[0m11:12:26.288207 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: COMMIT
[0m11:12:26.288954 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: ROLLBACK
[0m11:12:26.288590 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
alter table "nerd_facts"."public_public"."stg_swapi_starships__dbt_tmp" rename to "stg_swapi_starships"
[0m11:12:26.289644 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: Close
[0m11:12:26.290952 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:12:26.293066 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: COMMIT
[0m11:12:26.293525 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m11:12:26.294003 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:12:26.300339 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_planets__dbt_backup"
[0m11:12:26.301002 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: COMMIT
[0m11:12:26.305365 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:12:26.306125 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_planets__dbt_backup" cascade
[0m11:12:26.306930 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:12:26.309741 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: Close
[0m11:12:26.310313 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m11:12:26.314008 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_starships__dbt_backup"
[0m11:12:26.316519 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:12:26.316934 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8af75105-8af1-4637-927c-d9b4fbb8511a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbaec327d0>]}
[0m11:12:26.317566 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_starships__dbt_backup" cascade
[0m11:12:26.318213 [debug] [Thread-1 (]: Database Error in model stg_swapi_people (models/swapi/stg_swapi_people.sql)
  column "species" does not exist
  LINE 20:     species::JSONB AS species_ids, -- Store multiple species...
               ^
  compiled code at target/run/nerd_facts_dbt/models/swapi/stg_swapi_people.sql
[0m11:12:26.319425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8af75105-8af1-4637-927c-d9b4fbb8511a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbaeb501c0>]}
[0m11:12:26.318883 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_public.stg_swapi_planets ............... [[32mCREATE VIEW[0m in 0.15s]
[0m11:12:26.320243 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model public_public.stg_swapi_people ............ [[31mERROR[0m in 0.16s]
[0m11:12:26.321691 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_swapi_people
[0m11:12:26.320684 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:12:26.322183 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_people' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_people (models/swapi/stg_swapi_people.sql)
  column "species" does not exist
  LINE 20:     species::JSONB AS species_ids, -- Store multiple species...
               ^
  compiled code at target/run/nerd_facts_dbt/models/swapi/stg_swapi_people.sql.
[0m11:12:26.321180 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:12:26.323449 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: Close
[0m11:12:26.324742 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.dim_people
[0m11:12:26.325301 [info ] [Thread-4 (]: 4 of 5 SKIP relation public_public.dim_people .................................. [[33mSKIP[0m]
[0m11:12:26.325972 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.dim_people
[0m11:12:26.328375 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8af75105-8af1-4637-927c-d9b4fbb8511a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbaec32860>]}
[0m11:12:26.329060 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public_public.stg_swapi_starships ............. [[32mCREATE VIEW[0m in 0.15s]
[0m11:12:26.329658 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:12:26.330399 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m11:12:26.330810 [info ] [Thread-2 (]: 5 of 5 SKIP relation public_public.fact_starships .............................. [[33mSKIP[0m]
[0m11:12:26.331289 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m11:12:26.332402 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:26.332714 [debug] [MainThread]: On master: BEGIN
[0m11:12:26.332973 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:12:26.345620 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m11:12:26.346088 [debug] [MainThread]: On master: COMMIT
[0m11:12:26.346450 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:26.346752 [debug] [MainThread]: On master: COMMIT
[0m11:12:26.347155 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:12:26.347482 [debug] [MainThread]: On master: Close
[0m11:12:26.348119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:12:26.348467 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_planets' was properly closed.
[0m11:12:26.348781 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_people' was properly closed.
[0m11:12:26.349082 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_starships' was properly closed.
[0m11:12:26.349559 [info ] [MainThread]: 
[0m11:12:26.350039 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m11:12:26.351098 [debug] [MainThread]: Command end result
[0m11:12:26.374790 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:12:26.376309 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:12:26.382464 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m11:12:26.382880 [info ] [MainThread]: 
[0m11:12:26.383240 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:12:26.383547 [info ] [MainThread]: 
[0m11:12:26.383860 [error] [MainThread]:   Database Error in model stg_swapi_people (models/swapi/stg_swapi_people.sql)
  column "species" does not exist
  LINE 20:     species::JSONB AS species_ids, -- Store multiple species...
               ^
  compiled code at target/run/nerd_facts_dbt/models/swapi/stg_swapi_people.sql
[0m11:12:26.384119 [info ] [MainThread]: 
[0m11:12:26.384384 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
[0m11:12:26.385096 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7062106, "process_in_blocks": "2688", "process_kernel_time": 0.143554, "process_mem_max_rss": "114428", "process_out_blocks": "2752", "process_user_time": 2.499896}
[0m11:12:26.385460 [debug] [MainThread]: Command `dbt run` failed at 11:12:26.385364 after 1.71 seconds
[0m11:12:26.385757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb1b848e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbaf848280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb0eba500>]}
[0m11:12:26.386074 [debug] [MainThread]: Flushing usage events
[0m11:12:26.776766 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:18:52.106440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4cd90910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4bd519c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4bd51960>]}


============================== 11:18:52.108540 | af8aacb8-fec5-4910-8e79-62dfa81b3d8e ==============================
[0m11:18:52.108540 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:18:52.108970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m11:18:52.234082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af8aacb8-fec5-4910-8e79-62dfa81b3d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4be3aad0>]}
[0m11:18:52.285613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af8aacb8-fec5-4910-8e79-62dfa81b3d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4be384f0>]}
[0m11:18:52.286324 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:18:52.362283 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:18:52.459025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m11:18:52.459594 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/swapi/swapi_people_species.sql
[0m11:18:52.459977 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/swapi/people_with_species.sql
[0m11:18:52.460370 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/swapi/stg_swapi_people.sql
[0m11:18:52.692499 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.nerd_facts_dbt.marts
- models.nerd_facts_dbt.staging
[0m11:18:52.704971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af8aacb8-fec5-4910-8e79-62dfa81b3d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4afd5540>]}
[0m11:18:52.766207 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:18:52.768273 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:18:52.776610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af8aacb8-fec5-4910-8e79-62dfa81b3d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4aff27a0>]}
[0m11:18:52.777062 [info ] [MainThread]: Found 7 models, 11 sources, 433 macros
[0m11:18:52.777369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af8aacb8-fec5-4910-8e79-62dfa81b3d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4b1e56c0>]}
[0m11:18:52.778846 [info ] [MainThread]: 
[0m11:18:52.779173 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:18:52.779451 [info ] [MainThread]: 
[0m11:18:52.779857 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:18:52.783578 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public_public'
[0m11:18:52.815666 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:18:52.816142 [debug] [ThreadPool]: On list_nerd_facts_public_public: BEGIN
[0m11:18:52.816458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:52.829694 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m11:18:52.830109 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:18:52.830378 [debug] [ThreadPool]: On list_nerd_facts_public_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m11:18:52.833503 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m11:18:52.834590 [debug] [ThreadPool]: On list_nerd_facts_public_public: ROLLBACK
[0m11:18:52.835003 [debug] [ThreadPool]: On list_nerd_facts_public_public: Close
[0m11:18:52.842057 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:52.842502 [debug] [MainThread]: On master: BEGIN
[0m11:18:52.842893 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:18:52.855956 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m11:18:52.856352 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:52.856679 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:18:52.864646 [debug] [MainThread]: SQL status: SELECT 30 in 0.008 seconds
[0m11:18:52.866229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af8aacb8-fec5-4910-8e79-62dfa81b3d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4d032830>]}
[0m11:18:52.866649 [debug] [MainThread]: On master: ROLLBACK
[0m11:18:52.867034 [debug] [MainThread]: On master: Close
[0m11:18:52.869106 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_swapi_people
[0m11:18:52.869979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public_public, now model.nerd_facts_dbt.stg_swapi_people)
[0m11:18:52.870699 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_people
[0m11:18:52.870331 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:18:52.869576 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:18:52.876514 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.swapi_people_species
[0m11:18:52.878679 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:18:52.879312 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_starships'
[0m11:18:52.879772 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_planets'
[0m11:18:52.880197 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.swapi_people_species'
[0m11:18:52.881272 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.swapi_people_species
[0m11:18:52.880926 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_planets
[0m11:18:52.880634 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_starships
[0m11:18:52.881672 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_swapi_people
[0m11:18:52.921777 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.swapi_people_species"
[0m11:18:52.924501 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:18:52.927120 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:18:52.927897 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_swapi_people
[0m11:18:52.928722 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.swapi_people_species
[0m11:18:52.929449 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_swapi_planets
[0m11:18:52.930264 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.swapi_people_species
[0m11:18:52.930682 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_starships
[0m11:18:52.931952 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:18:52.932396 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.people_with_species
[0m11:18:52.932805 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_starships, now model.nerd_facts_dbt.people_with_species)
[0m11:18:52.933511 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.people_with_species
[0m11:18:52.933118 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m11:18:52.931275 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:18:52.936412 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.people_with_species"
[0m11:18:52.936913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_people, now model.nerd_facts_dbt.fact_starships)
[0m11:18:52.937569 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.dim_people
[0m11:18:52.937974 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m11:18:52.938370 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.swapi_people_species, now model.nerd_facts_dbt.dim_people)
[0m11:18:52.938646 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.people_with_species
[0m11:18:52.942804 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.people_with_species
[0m11:18:52.941807 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m11:18:52.942215 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.dim_people
[0m11:18:52.946110 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_people"
[0m11:18:52.946530 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m11:18:52.946970 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.dim_people
[0m11:18:52.947514 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m11:18:52.948097 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.dim_people
[0m11:18:52.949095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:52.949367 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_starships' was properly closed.
[0m11:18:52.949608 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.people_with_species' was properly closed.
[0m11:18:52.949810 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_planets' was properly closed.
[0m11:18:52.950005 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_people' was properly closed.
[0m11:18:52.951050 [debug] [MainThread]: Command end result
[0m11:18:52.969570 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:18:52.971020 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:18:52.976920 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m11:18:52.977754 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.915231, "process_in_blocks": "0", "process_kernel_time": 0.059807, "process_mem_max_rss": "111188", "process_out_blocks": "2784", "process_user_time": 1.748966}
[0m11:18:52.978126 [debug] [MainThread]: Command `dbt compile` succeeded at 11:18:52.978046 after 0.92 seconds
[0m11:18:52.978423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4cd90910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4db21120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4cb08ca0>]}
[0m11:18:52.978723 [debug] [MainThread]: Flushing usage events
[0m11:18:53.430654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:18:59.765807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cc2188b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cd08b7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cd08b850>]}


============================== 11:18:59.767871 | 0e321986-aeff-40d7-b400-9ad1a68091cf ==============================
[0m11:18:59.767871 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:18:59.768291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:18:59.898641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cb293f10>]}
[0m11:18:59.946416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cb290520>]}
[0m11:18:59.947124 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:19:00.033491 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:19:00.186554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:19:00.187118 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:19:00.195090 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.nerd_facts_dbt.marts
- models.nerd_facts_dbt.staging
[0m11:19:00.234230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ca4b9990>]}
[0m11:19:00.301011 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:19:00.302883 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:19:00.311879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ca4b82b0>]}
[0m11:19:00.312400 [info ] [MainThread]: Found 7 models, 11 sources, 433 macros
[0m11:19:00.312789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ca4b8370>]}
[0m11:19:00.314479 [info ] [MainThread]: 
[0m11:19:00.314904 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:19:00.315220 [info ] [MainThread]: 
[0m11:19:00.315725 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:19:00.320027 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m11:19:00.351728 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m11:19:00.352175 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m11:19:00.352495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:00.367995 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.015 seconds
[0m11:19:00.369511 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m11:19:00.372928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_public_public)
[0m11:19:00.380266 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:19:00.380691 [debug] [ThreadPool]: On list_nerd_facts_public_public: BEGIN
[0m11:19:00.381003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:19:00.393601 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m11:19:00.394022 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:19:00.394385 [debug] [ThreadPool]: On list_nerd_facts_public_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m11:19:00.397058 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m11:19:00.398290 [debug] [ThreadPool]: On list_nerd_facts_public_public: ROLLBACK
[0m11:19:00.398733 [debug] [ThreadPool]: On list_nerd_facts_public_public: Close
[0m11:19:00.404388 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:00.404766 [debug] [MainThread]: On master: BEGIN
[0m11:19:00.405066 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:19:00.417572 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:19:00.418009 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:00.418386 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:19:00.425910 [debug] [MainThread]: SQL status: SELECT 30 in 0.007 seconds
[0m11:19:00.427595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ca5f0d60>]}
[0m11:19:00.428062 [debug] [MainThread]: On master: ROLLBACK
[0m11:19:00.428501 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:00.428803 [debug] [MainThread]: On master: BEGIN
[0m11:19:00.429299 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:19:00.429612 [debug] [MainThread]: On master: COMMIT
[0m11:19:00.429904 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:00.430183 [debug] [MainThread]: On master: COMMIT
[0m11:19:00.430551 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:19:00.430840 [debug] [MainThread]: On master: Close
[0m11:19:00.434769 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_swapi_people
[0m11:19:00.435301 [info ] [Thread-1 (]: 1 of 7 START sql view model public_public.stg_swapi_people ..................... [RUN]
[0m11:19:00.435787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public_public, now model.nerd_facts_dbt.stg_swapi_people)
[0m11:19:00.436066 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_people
[0m11:19:00.442767 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:19:00.443123 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:19:00.443399 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.swapi_people_species
[0m11:19:00.444494 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:19:00.445051 [info ] [Thread-2 (]: 2 of 7 START sql view model public_public.stg_swapi_planets .................... [RUN]
[0m11:19:00.445457 [info ] [Thread-3 (]: 3 of 7 START sql view model public_public.stg_swapi_starships .................. [RUN]
[0m11:19:00.445827 [info ] [Thread-4 (]: 4 of 7 START sql table model public_public.swapi_people_species ................ [RUN]
[0m11:19:00.446702 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_planets'
[0m11:19:00.447208 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_starships'
[0m11:19:00.447629 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.swapi_people_species'
[0m11:19:00.448079 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_planets
[0m11:19:00.448491 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_swapi_people
[0m11:19:00.448808 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_starships
[0m11:19:00.449097 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.swapi_people_species
[0m11:19:00.451771 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:19:00.475046 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:19:00.487402 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.swapi_people_species"
[0m11:19:00.488020 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:19:00.488770 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_starships
[0m11:19:00.493156 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:19:00.489746 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.swapi_people_species
[0m11:19:00.489279 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_swapi_planets
[0m11:19:00.493859 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:19:00.507033 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:19:00.512906 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:19:00.513296 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: BEGIN
[0m11:19:00.516271 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.swapi_people_species"
[0m11:19:00.516847 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: BEGIN
[0m11:19:00.518162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:19:00.517583 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:19:00.518944 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: BEGIN
[0m11:19:00.519214 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:19:00.518514 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:19:00.517221 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:19:00.523870 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: BEGIN
[0m11:19:00.529723 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:19:00.545261 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m11:19:00.545798 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:19:00.546376 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */

  create view "nerd_facts"."public_public"."stg_swapi_people__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    height::DECIMAL AS height,
    mass::DECIMAL AS mass,
    hair_color,
    skin_color,
    eye_color,
    birth_year,
    gender,
    homeworld::INTEGER AS homeworld_id, -- Convert homeworld URL to integer UID    
    url
FROM "nerd_facts"."raw"."swapi_people"
  );
[0m11:19:00.546817 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m11:19:00.547515 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:19:00.547859 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */

  create view "nerd_facts"."public_public"."stg_swapi_planets__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    climate,
    terrain,
    diameter::INTEGER AS diameter,
    population::BIGINT AS population,
    gravity,
    orbital_period::INTEGER AS orbital_period,
    rotation_period::INTEGER AS rotation_period,
    surface_water::INTEGER AS surface_water,
    url
FROM "nerd_facts"."raw"."swapi_planets"
  );
[0m11:19:00.548983 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:19:00.547133 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m11:19:00.555355 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:19:00.554631 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m11:19:00.554956 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m11:19:00.558938 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:19:00.555730 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */

  create view "nerd_facts"."public_public"."stg_swapi_starships__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    model,
    manufacturer,

    -- ✅ Use NULLIF to avoid errors if value is empty ('')
    NULLIF(cost_in_credits, '')::BIGINT AS cost_in_credits,
    NULLIF(length, '')::DECIMAL AS length,
    NULLIF(max_atmosphering_speed, '')::INTEGER AS max_atmosphering_speed,
    NULLIF(crew, '')::INTEGER AS crew,
    NULLIF(passengers, '')::INTEGER AS passengers,
    NULLIF(cargo_capacity, '')::BIGINT AS cargo_capacity,
    
    consumables,

    NULLIF(hyperdrive_rating, '')::DECIMAL AS hyperdrive_rating,
    NULLIF(MGLT, '')::INTEGER AS MGLT,
    
    starship_class,

    -- ✅ Ensure pilots column is always valid JSONB
    CASE 
        WHEN pilots IS NULL OR pilots = '' THEN '[]'::JSONB
        ELSE pilots::JSONB
    END AS pilot_ids,

    url

FROM "nerd_facts"."raw"."swapi_starships"
  );
[0m11:19:00.558331 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:19:00.559864 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
alter table "nerd_facts"."public_public"."stg_swapi_planets" rename to "stg_swapi_planets__dbt_backup"
[0m11:19:00.560482 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:19:00.554250 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:19:00.559323 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.swapi_people_species"} */

  
    

  create  table "nerd_facts"."public_public"."swapi_people_species__dbt_tmp"
  
  
    as
  
  (
    

WITH species_data AS (
    SELECT
        id AS species_id,
        jsonb_array_elements_text(people)::INTEGER AS person_id  -- Extract JSONB array
    FROM "nerd_facts"."raw"."swapi_species"
)

SELECT
    person_id,
    species_id
FROM species_data
WHERE person_id IS NOT NULL
  );
  
[0m11:19:00.599855 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.040 seconds
[0m11:19:00.600893 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:19:00.601466 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */
alter table "nerd_facts"."public_public"."stg_swapi_people__dbt_tmp" rename to "stg_swapi_people"
[0m11:19:00.606061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:19:00.604934 [debug] [Thread-4 (]: Postgres adapter: Postgres error: function jsonb_array_elements_text(text) does not exist
LINE 17:         jsonb_array_elements_text(people)::INTEGER AS person...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m11:19:00.616859 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: ROLLBACK
[0m11:19:00.619071 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: Close
[0m11:19:00.605321 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
alter table "nerd_facts"."public_public"."stg_swapi_planets__dbt_tmp" rename to "stg_swapi_planets"
[0m11:19:00.618167 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: COMMIT
[0m11:19:00.604391 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:19:00.624437 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
alter table "nerd_facts"."public_public"."stg_swapi_starships" rename to "stg_swapi_starships__dbt_backup"
[0m11:19:00.623541 [debug] [Thread-4 (]: Database Error in model swapi_people_species (models/swapi/swapi_people_species.sql)
  function jsonb_array_elements_text(text) does not exist
  LINE 17:         jsonb_array_elements_text(people)::INTEGER AS person...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/swapi/swapi_people_species.sql
[0m11:19:00.624025 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:19:00.622277 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:19:00.625319 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:19:00.626458 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: COMMIT
[0m11:19:00.627570 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37c984eec0>]}
[0m11:19:00.634825 [error] [Thread-4 (]: 4 of 7 ERROR creating sql table model public_public.swapi_people_species ....... [[31mERROR[0m in 0.18s]
[0m11:19:00.633962 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:19:00.635408 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.swapi_people_species
[0m11:19:00.631010 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: COMMIT
[0m11:19:00.635798 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
alter table "nerd_facts"."public_public"."stg_swapi_starships__dbt_tmp" rename to "stg_swapi_starships"
[0m11:19:00.636353 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.swapi_people_species' to be skipped because of status 'error'.  Reason: Database Error in model swapi_people_species (models/swapi/swapi_people_species.sql)
  function jsonb_array_elements_text(text) does not exist
  LINE 17:         jsonb_array_elements_text(people)::INTEGER AS person...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/swapi/swapi_people_species.sql.
[0m11:19:00.636796 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:19:00.637111 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m11:19:00.637982 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:19:00.645315 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: COMMIT
[0m11:19:00.643895 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_people__dbt_backup"
[0m11:19:00.645703 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:19:00.638824 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: COMMIT
[0m11:19:00.649162 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:19:00.650229 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_people__dbt_backup" cascade
[0m11:19:00.649601 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: COMMIT
[0m11:19:00.650869 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:19:00.653471 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_people: Close
[0m11:19:00.654716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cd456c50>]}
[0m11:19:00.655556 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public_public.stg_swapi_people ................ [[32mCREATE VIEW[0m in 0.22s]
[0m11:19:00.656259 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_swapi_people
[0m11:19:00.653876 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m11:19:00.659442 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_planets__dbt_backup"
[0m11:19:00.659990 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m11:19:00.660864 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:19:00.661231 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.people_with_species
[0m11:19:00.664506 [info ] [Thread-4 (]: 5 of 7 SKIP relation public_public.people_with_species ......................... [[33mSKIP[0m]
[0m11:19:00.664103 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_planets__dbt_backup" cascade
[0m11:19:00.664921 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.people_with_species
[0m11:19:00.663690 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_starships__dbt_backup"
[0m11:19:00.666631 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:19:00.667031 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_starships__dbt_backup" cascade
[0m11:19:00.669296 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m11:19:00.670696 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_planets: Close
[0m11:19:00.671498 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37c97e5ae0>]}
[0m11:19:00.672327 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public_public.stg_swapi_planets ............... [[32mCREATE VIEW[0m in 0.22s]
[0m11:19:00.673132 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:19:00.674078 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m11:19:00.675397 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: Close
[0m11:19:00.676132 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ca509780>]}
[0m11:19:00.676906 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public_public.stg_swapi_starships ............. [[32mCREATE VIEW[0m in 0.23s]
[0m11:19:00.677597 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:19:00.678711 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.dim_people
[0m11:19:00.679057 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m11:19:00.679538 [info ] [Thread-1 (]: 6 of 7 START sql table model public_public.dim_people .......................... [RUN]
[0m11:19:00.679963 [info ] [Thread-4 (]: 7 of 7 START sql table model public_public.fact_starships ...................... [RUN]
[0m11:19:00.680566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_people, now model.nerd_facts_dbt.dim_people)
[0m11:19:00.680975 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.swapi_people_species, now model.nerd_facts_dbt.fact_starships)
[0m11:19:00.681337 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.dim_people
[0m11:19:00.681724 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m11:19:00.686399 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_people"
[0m11:19:00.689698 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m11:19:00.690391 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.dim_people
[0m11:19:00.690974 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m11:19:00.694615 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_people"
[0m11:19:00.698230 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m11:19:00.698983 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:19:00.699509 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m11:19:00.699927 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:19:00.700223 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:19:00.700557 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: BEGIN
[0m11:19:00.701095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:19:00.722267 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m11:19:00.722750 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m11:19:00.723172 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:19:00.723587 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:19:00.723962 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  
    

  create  table "nerd_facts"."public_public"."fact_starships__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    s.id AS starship_id,
    s.name AS starship_name,
    s.model,
    s.manufacturer,
    s.cost_in_credits,
    s.length,
    s.max_atmosphering_speed,
    s.crew,
    s.passengers,
    s.cargo_capacity,
    s.hyperdrive_rating,
    s.starship_class,
    p.id AS pilot_id,
    p.name AS pilot_name
FROM "nerd_facts"."public_public"."stg_swapi_starships" s
LEFT JOIN "nerd_facts"."public_public"."stg_swapi_people" p
ON p.id = ANY(ARRAY(SELECT jsonb_array_elements_text(s.pilot_ids)::INTEGER))
  );
  
[0m11:19:00.724342 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_people"} */

  
    

  create  table "nerd_facts"."public_public"."dim_people__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    p.id AS person_id,
    p.name,
    p.gender,
    p.skin_color,
    p.hair_color,
    p.height,
    p.eye_color,
    p.mass,
    pl.name AS homeworld_name,
    p.birth_year
FROM "nerd_facts"."public_public"."stg_swapi_people" p
LEFT JOIN "nerd_facts"."public_public"."stg_swapi_planets" pl
ON p.homeworld_id = pl.id
  );
  
[0m11:19:00.734411 [debug] [Thread-4 (]: Postgres adapter: Postgres error: invalid input syntax for type integer: "1000km"

[0m11:19:00.734996 [debug] [Thread-1 (]: Postgres adapter: Postgres error: invalid input syntax for type numeric: "unknown"

[0m11:19:00.735395 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_starships: ROLLBACK
[0m11:19:00.735788 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: ROLLBACK
[0m11:19:00.736372 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m11:19:00.736772 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: Close
[0m11:19:00.740813 [debug] [Thread-4 (]: Database Error in model fact_starships (models/swapi/fact_starships.sql)
  invalid input syntax for type integer: "1000km"
  compiled code at target/run/nerd_facts_dbt/models/swapi/fact_starships.sql
[0m11:19:00.741533 [debug] [Thread-1 (]: Database Error in model dim_people (models/swapi/dim_people.sql)
  invalid input syntax for type numeric: "unknown"
  compiled code at target/run/nerd_facts_dbt/models/swapi/dim_people.sql
[0m11:19:00.742043 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ca4cf0d0>]}
[0m11:19:00.742561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e321986-aeff-40d7-b400-9ad1a68091cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ca4b8580>]}
[0m11:19:00.743209 [error] [Thread-4 (]: 7 of 7 ERROR creating sql table model public_public.fact_starships ............. [[31mERROR[0m in 0.06s]
[0m11:19:00.743932 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model public_public.dim_people ................. [[31mERROR[0m in 0.06s]
[0m11:19:00.744520 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m11:19:00.745555 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_starships' to be skipped because of status 'error'.  Reason: Database Error in model fact_starships (models/swapi/fact_starships.sql)
  invalid input syntax for type integer: "1000km"
  compiled code at target/run/nerd_facts_dbt/models/swapi/fact_starships.sql.
[0m11:19:00.745024 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.dim_people
[0m11:19:00.746147 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.dim_people' to be skipped because of status 'error'.  Reason: Database Error in model dim_people (models/swapi/dim_people.sql)
  invalid input syntax for type numeric: "unknown"
  compiled code at target/run/nerd_facts_dbt/models/swapi/dim_people.sql.
[0m11:19:00.747372 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:00.747654 [debug] [MainThread]: On master: BEGIN
[0m11:19:00.747930 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:19:00.760495 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:19:00.760994 [debug] [MainThread]: On master: COMMIT
[0m11:19:00.761346 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:00.761605 [debug] [MainThread]: On master: COMMIT
[0m11:19:00.762004 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:19:00.762255 [debug] [MainThread]: On master: Close
[0m11:19:00.762742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:19:00.762982 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_people' was properly closed.
[0m11:19:00.763183 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_planets' was properly closed.
[0m11:19:00.763396 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_starships' was properly closed.
[0m11:19:00.763620 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_starships' was properly closed.
[0m11:19:00.763976 [info ] [MainThread]: 
[0m11:19:00.764338 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m11:19:00.765411 [debug] [MainThread]: Command end result
[0m11:19:00.784100 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:19:00.785403 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:19:00.790714 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m11:19:00.791065 [info ] [MainThread]: 
[0m11:19:00.791396 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m11:19:00.791690 [info ] [MainThread]: 
[0m11:19:00.791984 [error] [MainThread]:   Database Error in model swapi_people_species (models/swapi/swapi_people_species.sql)
  function jsonb_array_elements_text(text) does not exist
  LINE 17:         jsonb_array_elements_text(people)::INTEGER AS person...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/swapi/swapi_people_species.sql
[0m11:19:00.792229 [info ] [MainThread]: 
[0m11:19:00.792494 [error] [MainThread]:   Database Error in model fact_starships (models/swapi/fact_starships.sql)
  invalid input syntax for type integer: "1000km"
  compiled code at target/run/nerd_facts_dbt/models/swapi/fact_starships.sql
[0m11:19:00.792716 [info ] [MainThread]: 
[0m11:19:00.793005 [error] [MainThread]:   Database Error in model dim_people (models/swapi/dim_people.sql)
  invalid input syntax for type numeric: "unknown"
  compiled code at target/run/nerd_facts_dbt/models/swapi/dim_people.sql
[0m11:19:00.793228 [info ] [MainThread]: 
[0m11:19:00.793482 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=1 TOTAL=7
[0m11:19:00.794178 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.072439, "process_in_blocks": "0", "process_kernel_time": 0.088131, "process_mem_max_rss": "110568", "process_out_blocks": "1984", "process_user_time": 1.90333}
[0m11:19:00.794527 [debug] [MainThread]: Command `dbt run` failed at 11:19:00.794448 after 1.07 seconds
[0m11:19:00.794821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cc2188b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ca641360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37cc094160>]}
[0m11:19:00.795143 [debug] [MainThread]: Flushing usage events
[0m11:19:01.257118 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:20:57.121801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b24f48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b14a77c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b14a7820>]}


============================== 11:20:57.123896 | a92cee78-5d0f-43ba-b3da-cb61fcb7715b ==============================
[0m11:20:57.123896 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:20:57.124325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:20:57.254630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b1859e70>]}
[0m11:20:57.303012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b159c7c0>]}
[0m11:20:57.303769 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:20:57.388958 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:20:57.479212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m11:20:57.479800 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/swapi/dim_people.sql
[0m11:20:57.480157 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/swapi/swapi_people_species.sql
[0m11:20:57.480457 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/swapi/fact_starships.sql
[0m11:20:57.682597 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.nerd_facts_dbt.staging
- models.nerd_facts_dbt.marts
[0m11:20:57.695347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b07254e0>]}
[0m11:20:57.759183 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:20:57.761260 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:20:57.770569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b0762860>]}
[0m11:20:57.771074 [info ] [MainThread]: Found 7 models, 11 sources, 433 macros
[0m11:20:57.771384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b0762530>]}
[0m11:20:57.772913 [info ] [MainThread]: 
[0m11:20:57.773236 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:20:57.773520 [info ] [MainThread]: 
[0m11:20:57.773939 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:20:57.778130 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m11:20:57.807251 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m11:20:57.807703 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m11:20:57.808081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:57.821674 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.013 seconds
[0m11:20:57.823044 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m11:20:57.825273 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public_public'
[0m11:20:57.831451 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:20:57.831829 [debug] [ThreadPool]: On list_nerd_facts_public_public: BEGIN
[0m11:20:57.832130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:57.845281 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m11:20:57.845681 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:20:57.845950 [debug] [ThreadPool]: On list_nerd_facts_public_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m11:20:57.848781 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m11:20:57.849874 [debug] [ThreadPool]: On list_nerd_facts_public_public: ROLLBACK
[0m11:20:57.850313 [debug] [ThreadPool]: On list_nerd_facts_public_public: Close
[0m11:20:57.854621 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:57.854991 [debug] [MainThread]: On master: BEGIN
[0m11:20:57.855246 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:20:57.867575 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:20:57.868002 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:57.868306 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:20:57.875350 [debug] [MainThread]: SQL status: SELECT 31 in 0.007 seconds
[0m11:20:57.877393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b0199030>]}
[0m11:20:57.877909 [debug] [MainThread]: On master: ROLLBACK
[0m11:20:57.878467 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:57.878734 [debug] [MainThread]: On master: BEGIN
[0m11:20:57.879157 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:20:57.879400 [debug] [MainThread]: On master: COMMIT
[0m11:20:57.879690 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:57.879910 [debug] [MainThread]: On master: COMMIT
[0m11:20:57.880199 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:20:57.880441 [debug] [MainThread]: On master: Close
[0m11:20:57.882416 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.dim_people
[0m11:20:57.882939 [info ] [Thread-1 (]: 1 of 7 START sql view model public_public.dim_people ........................... [RUN]
[0m11:20:57.883380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public_public, now model.nerd_facts_dbt.dim_people)
[0m11:20:57.883723 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.dim_people
[0m11:20:57.924147 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m11:20:57.924753 [info ] [Thread-2 (]: 2 of 7 START sql view model public_public.fact_starships ....................... [RUN]
[0m11:20:57.925246 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_people
[0m11:20:57.925721 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_nerd_facts, now model.nerd_facts_dbt.fact_starships)
[0m11:20:57.926017 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:20:57.926958 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m11:20:57.926583 [info ] [Thread-3 (]: 3 of 7 START sql view model public_public.stg_swapi_people ..................... [RUN]
[0m11:20:57.931534 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_people"
[0m11:20:57.932132 [info ] [Thread-4 (]: 4 of 7 START sql view model public_public.stg_swapi_planets .................... [RUN]
[0m11:20:57.935036 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m11:20:57.935655 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_people'
[0m11:20:57.936335 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_planets'
[0m11:20:57.936910 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.dim_people
[0m11:20:57.937712 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_people
[0m11:20:57.938202 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_planets
[0m11:20:57.949695 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m11:20:57.953703 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:20:57.962751 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:20:57.988688 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_people"
[0m11:20:57.989762 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi_planets
[0m11:20:57.990531 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:20:57.994208 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:20:57.994549 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_people
[0m11:20:57.997252 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m11:20:57.997657 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: BEGIN
[0m11:20:57.998237 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:20:58.001690 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:20:58.002328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:20:58.002782 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: BEGIN
[0m11:20:58.004297 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:20:58.003424 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:20:58.003789 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:20:58.006563 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m11:20:58.006916 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:20:58.006099 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: BEGIN
[0m11:20:58.010899 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:20:58.029308 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m11:20:58.033634 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m11:20:58.034051 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:20:58.034499 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:20:58.034829 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m11:20:58.035159 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m11:20:58.035475 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */

  create view "nerd_facts"."public_public"."stg_swapi_planets__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    climate,
    terrain,
    diameter::INTEGER AS diameter,
    population::BIGINT AS population,
    gravity,
    orbital_period::INTEGER AS orbital_period,
    rotation_period::INTEGER AS rotation_period,
    surface_water::INTEGER AS surface_water,
    url
FROM "nerd_facts"."raw"."swapi_planets"
  );
[0m11:20:58.035869 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_people"} */

  create view "nerd_facts"."public_public"."dim_people__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    -- ✅ Convert `height` safely
    CASE 
        WHEN height ~ '^\d+$' THEN height::DECIMAL
        ELSE NULL
    END AS height,
    -- ✅ Convert `mass` safely
    CASE 
        WHEN mass ~ '^\d+$' THEN mass::DECIMAL
        ELSE NULL
    END AS mass,
    hair_color,
    skin_color,
    eye_color,
    birth_year,
    gender,
    homeworld::INTEGER AS homeworld_id,
    url
FROM "nerd_facts"."raw"."swapi_people"
  );
[0m11:20:58.036242 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:20:58.036536 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:20:58.038694 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:20:58.039119 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:20:58.039532 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  create view "nerd_facts"."public_public"."fact_starships__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    model,
    manufacturer,
    cost_in_credits::BIGINT AS cost_in_credits,
    length::DECIMAL AS length,
    -- ✅ Convert `max_atmosphering_speed` safely
    CASE
        WHEN max_atmosphering_speed ~ '^\d+$' THEN max_atmosphering_speed::INTEGER
        ELSE NULL
    END AS max_atmosphering_speed,  
    crew::INTEGER AS crew,
    passengers::INTEGER AS passengers,
    cargo_capacity::BIGINT AS cargo_capacity,
    consumables,
    hyperdrive_rating::DECIMAL AS hyperdrive_rating,
    MGLT::INTEGER AS MGLT,
    starship_class,
    pilots::JSONB AS pilot_ids, -- JSONB for linked pilots
    url
FROM "nerd_facts"."raw"."swapi_starships"
  );
[0m11:20:58.039988 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */

  create view "nerd_facts"."public_public"."stg_swapi_people__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    height::DECIMAL AS height,
    mass::DECIMAL AS mass,
    hair_color,
    skin_color,
    eye_color,
    birth_year,
    gender,
    homeworld::INTEGER AS homeworld_id, -- Convert homeworld URL to integer UID    
    url
FROM "nerd_facts"."raw"."swapi_people"
  );
[0m11:20:58.045506 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:20:58.048310 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:20:58.051707 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_people"} */
alter table "nerd_facts"."public_public"."dim_people__dbt_tmp" rename to "dim_people"
[0m11:20:58.050854 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:20:58.050451 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:20:58.051297 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
alter table "nerd_facts"."public_public"."stg_swapi_planets" rename to "stg_swapi_planets__dbt_backup"
[0m11:20:58.054484 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:20:58.054906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:20:58.058217 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:20:58.058899 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */
alter table "nerd_facts"."public_public"."fact_starships__dbt_tmp" rename to "fact_starships"
[0m11:20:58.059263 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:20:58.070747 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */
alter table "nerd_facts"."public_public"."stg_swapi_people" rename to "stg_swapi_people__dbt_backup"
[0m11:20:58.070330 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: COMMIT
[0m11:20:58.074662 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:20:58.073995 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:20:58.074300 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:20:58.073537 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:20:58.075004 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: COMMIT
[0m11:20:58.076345 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: COMMIT
[0m11:20:58.078958 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:20:58.079455 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
alter table "nerd_facts"."public_public"."stg_swapi_planets__dbt_tmp" rename to "stg_swapi_planets"
[0m11:20:58.080011 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:20:58.080443 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */
alter table "nerd_facts"."public_public"."stg_swapi_people__dbt_tmp" rename to "stg_swapi_people"
[0m11:20:58.080892 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: COMMIT
[0m11:20:58.081524 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:20:58.086235 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: COMMIT
[0m11:20:58.087560 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:20:58.087166 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m11:20:58.086806 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m11:20:58.087989 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: COMMIT
[0m11:20:58.088353 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m11:20:58.097842 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public_public"."fact_starships__dbt_backup"
[0m11:20:58.094063 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public_public"."dim_people__dbt_backup"
[0m11:20:58.095432 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: COMMIT
[0m11:20:58.103267 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:20:58.102175 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m11:20:58.102879 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:20:58.106247 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_people"} */
drop view if exists "nerd_facts"."public_public"."dim_people__dbt_backup" cascade
[0m11:20:58.103655 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: COMMIT
[0m11:20:58.105756 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_people__dbt_backup"
[0m11:20:58.101788 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:20:58.107295 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:20:58.108350 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_people__dbt_backup" cascade
[0m11:20:58.107978 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */
drop view if exists "nerd_facts"."public_public"."fact_starships__dbt_backup" cascade
[0m11:20:58.107683 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:20:58.109417 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:20:58.109779 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m11:20:58.112067 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: Close
[0m11:20:58.112528 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m11:20:58.120171 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: Close
[0m11:20:58.116705 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_planets__dbt_backup"
[0m11:20:58.121640 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:20:58.113763 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m11:20:58.122618 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b35f44c0>]}
[0m11:20:58.123232 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public_public.fact_starships .................. [[32mCREATE VIEW[0m in 0.20s]
[0m11:20:58.123823 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m11:20:58.124240 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:20:58.124778 [info ] [Thread-2 (]: 5 of 7 START sql view model public_public.stg_swapi_starships .................. [RUN]
[0m11:20:58.125220 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_starships, now model.nerd_facts_dbt.stg_swapi_starships)
[0m11:20:58.125557 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_starships
[0m11:20:58.128462 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:20:58.120885 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b34de710>]}
[0m11:20:58.129225 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public_public.stg_swapi_people ................ [[32mCREATE VIEW[0m in 0.19s]
[0m11:20:58.121999 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_planets__dbt_backup" cascade
[0m11:20:58.118772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b01981f0>]}
[0m11:20:58.129755 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_people
[0m11:20:58.130521 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public_public.dim_people ...................... [[32mCREATE VIEW[0m in 0.23s]
[0m11:20:58.131220 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.swapi_people_species
[0m11:20:58.132677 [info ] [Thread-3 (]: 6 of 7 START sql table model public_public.swapi_people_species ................ [RUN]
[0m11:20:58.132229 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.dim_people
[0m11:20:58.131788 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_swapi_starships
[0m11:20:58.133157 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:20:58.133603 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_people, now model.nerd_facts_dbt.swapi_people_species)
[0m11:20:58.138819 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.swapi_people_species
[0m11:20:58.138431 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: Close
[0m11:20:58.142145 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b0756e00>]}
[0m11:20:58.142694 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public_public.stg_swapi_planets ............... [[32mCREATE VIEW[0m in 0.21s]
[0m11:20:58.143353 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:20:58.137162 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:20:58.144147 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:20:58.141379 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.swapi_people_species"
[0m11:20:58.144582 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_starships: BEGIN
[0m11:20:58.145138 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.swapi_people_species
[0m11:20:58.145450 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:20:58.163892 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.swapi_people_species"
[0m11:20:58.164790 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:20:58.165145 [debug] [Thread-3 (]: On model.nerd_facts_dbt.swapi_people_species: BEGIN
[0m11:20:58.165448 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:20:58.178529 [debug] [Thread-2 (]: SQL status: BEGIN in 0.033 seconds
[0m11:20:58.179133 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:20:58.179558 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m11:20:58.179930 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */

  create view "nerd_facts"."public_public"."stg_swapi_starships__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    model,
    manufacturer,

    -- ✅ Use NULLIF to avoid errors if value is empty ('')
    NULLIF(cost_in_credits, '')::BIGINT AS cost_in_credits,
    NULLIF(length, '')::DECIMAL AS length,
    NULLIF(max_atmosphering_speed, '')::INTEGER AS max_atmosphering_speed,
    NULLIF(crew, '')::INTEGER AS crew,
    NULLIF(passengers, '')::INTEGER AS passengers,
    NULLIF(cargo_capacity, '')::BIGINT AS cargo_capacity,
    
    consumables,

    NULLIF(hyperdrive_rating, '')::DECIMAL AS hyperdrive_rating,
    NULLIF(MGLT, '')::INTEGER AS MGLT,
    
    starship_class,

    -- ✅ Ensure pilots column is always valid JSONB
    CASE 
        WHEN pilots IS NULL OR pilots = '' THEN '[]'::JSONB
        ELSE pilots::JSONB
    END AS pilot_ids,

    url

FROM "nerd_facts"."raw"."swapi_starships"
  );
[0m11:20:58.180320 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:20:58.180747 [debug] [Thread-3 (]: On model.nerd_facts_dbt.swapi_people_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.swapi_people_species"} */

  
    

  create  table "nerd_facts"."public_public"."swapi_people_species__dbt_tmp"
  
  
    as
  
  (
    

WITH species_data AS (
    SELECT
        id AS species_id,
        jsonb_array_elements_text(people::JSONB)::INTEGER AS person_id  -- ✅ Cast TEXT to JSONB
    FROM "nerd_facts"."raw"."swapi_species"
)

SELECT
    person_id,
    species_id
FROM species_data
WHERE person_id IS NOT NULL
  );
  
[0m11:20:58.182531 [debug] [Thread-3 (]: SQL status: SELECT 50 in 0.001 seconds
[0m11:20:58.183002 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:20:58.186050 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:20:58.189151 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:20:58.189631 [debug] [Thread-3 (]: On model.nerd_facts_dbt.swapi_people_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.swapi_people_species"} */
alter table "nerd_facts"."public_public"."swapi_people_species__dbt_tmp" rename to "swapi_people_species"
[0m11:20:58.189986 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
alter table "nerd_facts"."public_public"."stg_swapi_starships" rename to "stg_swapi_starships__dbt_backup"
[0m11:20:58.190689 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:20:58.191042 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:20:58.195597 [debug] [Thread-3 (]: On model.nerd_facts_dbt.swapi_people_species: COMMIT
[0m11:20:58.199202 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:20:58.199711 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:20:58.200071 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
alter table "nerd_facts"."public_public"."stg_swapi_starships__dbt_tmp" rename to "stg_swapi_starships"
[0m11:20:58.200441 [debug] [Thread-3 (]: On model.nerd_facts_dbt.swapi_people_species: COMMIT
[0m11:20:58.201168 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:20:58.202483 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_starships: COMMIT
[0m11:20:58.202898 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:20:58.203267 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m11:20:58.203656 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_starships: COMMIT
[0m11:20:58.205685 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public_public"."swapi_people_species__dbt_backup"
[0m11:20:58.208278 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:20:58.208720 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m11:20:58.209142 [debug] [Thread-3 (]: On model.nerd_facts_dbt.swapi_people_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.swapi_people_species"} */
drop table if exists "nerd_facts"."public_public"."swapi_people_species__dbt_backup" cascade
[0m11:20:58.211268 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_starships__dbt_backup"
[0m11:20:58.212119 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:20:58.212436 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_starships__dbt_backup" cascade
[0m11:20:58.212814 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m11:20:58.214111 [debug] [Thread-3 (]: On model.nerd_facts_dbt.swapi_people_species: Close
[0m11:20:58.215751 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:20:58.216953 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_starships: Close
[0m11:20:58.217539 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b0199c60>]}
[0m11:20:58.218442 [info ] [Thread-3 (]: 6 of 7 OK created sql table model public_public.swapi_people_species ........... [[32mSELECT 50[0m in 0.08s]
[0m11:20:58.219141 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.swapi_people_species
[0m11:20:58.220435 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b35f44c0>]}
[0m11:20:58.220816 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.people_with_species
[0m11:20:58.221345 [info ] [Thread-1 (]: 7 of 7 START sql view model public_public.people_with_species .................. [RUN]
[0m11:20:58.221773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_people, now model.nerd_facts_dbt.people_with_species)
[0m11:20:58.222067 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.people_with_species
[0m11:20:58.225061 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.people_with_species"
[0m11:20:58.226189 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.people_with_species
[0m11:20:58.225739 [info ] [Thread-2 (]: 5 of 7 OK created sql view model public_public.stg_swapi_starships ............. [[32mCREATE VIEW[0m in 0.10s]
[0m11:20:58.229811 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.people_with_species"
[0m11:20:58.230370 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:20:58.231135 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:20:58.231481 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: BEGIN
[0m11:20:58.231770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:20:58.244355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m11:20:58.244848 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:20:58.245201 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.people_with_species"} */

  create view "nerd_facts"."public_public"."people_with_species__dbt_tmp"
    
    
  as (
    

SELECT
    p.id,
    p.name,
    s.species_id
FROM "nerd_facts"."public_public"."stg_swapi_people" p
LEFT JOIN "nerd_facts"."public_public"."swapi_people_species" s ON p.id = s.person_id
  );
[0m11:20:58.246815 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m11:20:58.249596 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:20:58.249984 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.people_with_species"} */
alter table "nerd_facts"."public_public"."people_with_species__dbt_tmp" rename to "people_with_species"
[0m11:20:58.250623 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:20:58.251885 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: COMMIT
[0m11:20:58.252253 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:20:58.252586 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: COMMIT
[0m11:20:58.255148 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:20:58.257755 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public_public"."people_with_species__dbt_backup"
[0m11:20:58.258497 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:20:58.258865 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.people_with_species"} */
drop view if exists "nerd_facts"."public_public"."people_with_species__dbt_backup" cascade
[0m11:20:58.259454 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:20:58.260680 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: Close
[0m11:20:58.261505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92cee78-5d0f-43ba-b3da-cb61fcb7715b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b0199c60>]}
[0m11:20:58.262352 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public_public.people_with_species ............. [[32mCREATE VIEW[0m in 0.04s]
[0m11:20:58.263159 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.people_with_species
[0m11:20:58.264589 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:58.264890 [debug] [MainThread]: On master: BEGIN
[0m11:20:58.265177 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:20:58.277686 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:20:58.278204 [debug] [MainThread]: On master: COMMIT
[0m11:20:58.278557 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:58.278858 [debug] [MainThread]: On master: COMMIT
[0m11:20:58.279248 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:20:58.279565 [debug] [MainThread]: On master: Close
[0m11:20:58.280204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:20:58.280558 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_starships' was properly closed.
[0m11:20:58.280891 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.people_with_species' was properly closed.
[0m11:20:58.281203 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.swapi_people_species' was properly closed.
[0m11:20:58.281559 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_planets' was properly closed.
[0m11:20:58.282016 [info ] [MainThread]: 
[0m11:20:58.282556 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m11:20:58.284042 [debug] [MainThread]: Command end result
[0m11:20:58.305042 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:20:58.306448 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:20:58.312184 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m11:20:58.312563 [info ] [MainThread]: 
[0m11:20:58.312881 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:20:58.313144 [info ] [MainThread]: 
[0m11:20:58.313410 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m11:20:58.314139 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2359911, "process_in_blocks": "0", "process_kernel_time": 0.104852, "process_mem_max_rss": "114188", "process_out_blocks": "2888", "process_user_time": 2.064331}
[0m11:20:58.314511 [debug] [MainThread]: Command `dbt run` succeeded at 11:20:58.314403 after 1.24 seconds
[0m11:20:58.314811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b24f48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b238df30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2b0784ac0>]}
[0m11:20:58.315121 [debug] [MainThread]: Flushing usage events
[0m11:20:58.800666 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:25:05.224832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9a5c8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9957fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9957fd60>]}


============================== 11:25:05.227256 | 1933344c-7b00-440b-9811-f51768ab0f0c ==============================
[0m11:25:05.227256 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:25:05.227840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m11:25:05.318135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1933344c-7b00-440b-9811-f51768ab0f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9b5174f0>]}
[0m11:25:05.327935 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.14595011, "process_in_blocks": "8", "process_kernel_time": 0.047938, "process_mem_max_rss": "88712", "process_out_blocks": "8", "process_user_time": 1.070898}
[0m11:25:05.328505 [debug] [MainThread]: Command `dbt clean` succeeded at 11:25:05.328378 after 0.15 seconds
[0m11:25:05.328957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9a5c8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9b5152d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce99584250>]}
[0m11:25:05.329473 [debug] [MainThread]: Flushing usage events
[0m11:25:05.730760 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:25:10.122343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184c82c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184d645990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184d645930>]}


============================== 11:25:10.124612 | bf46cf0f-d09e-4250-acfd-2b46709348a5 ==============================
[0m11:25:10.124612 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:25:10.125024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:25:10.248417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184d63eb00>]}
[0m11:25:10.298230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184c59ca90>]}
[0m11:25:10.298929 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:25:10.372353 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:25:10.372929 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:25:10.373251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184af458a0>]}
[0m11:25:11.288482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184a62e7a0>]}
[0m11:25:11.356758 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:25:11.358740 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:25:11.367811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184c6c0880>]}
[0m11:25:11.368263 [info ] [MainThread]: Found 7 models, 11 sources, 433 macros
[0m11:25:11.368580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184a606500>]}
[0m11:25:11.370093 [info ] [MainThread]: 
[0m11:25:11.370419 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:25:11.370690 [info ] [MainThread]: 
[0m11:25:11.371108 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:25:11.375096 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m11:25:11.403993 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m11:25:11.404436 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m11:25:11.404749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:11.418179 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m11:25:11.419312 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m11:25:11.420057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now create_nerd_facts_public_public)
[0m11:25:11.420505 [debug] [ThreadPool]: Creating schema "database: "nerd_facts"
schema: "public_public"
"
[0m11:25:11.425252 [debug] [ThreadPool]: Using postgres connection "create_nerd_facts_public_public"
[0m11:25:11.425640 [debug] [ThreadPool]: On create_nerd_facts_public_public: BEGIN
[0m11:25:11.425888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:25:11.438193 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m11:25:11.438579 [debug] [ThreadPool]: Using postgres connection "create_nerd_facts_public_public"
[0m11:25:11.438849 [debug] [ThreadPool]: On create_nerd_facts_public_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "create_nerd_facts_public_public"} */
create schema if not exists "public_public"
[0m11:25:11.439485 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m11:25:11.440240 [debug] [ThreadPool]: On create_nerd_facts_public_public: COMMIT
[0m11:25:11.440502 [debug] [ThreadPool]: Using postgres connection "create_nerd_facts_public_public"
[0m11:25:11.440728 [debug] [ThreadPool]: On create_nerd_facts_public_public: COMMIT
[0m11:25:11.443113 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m11:25:11.443373 [debug] [ThreadPool]: On create_nerd_facts_public_public: Close
[0m11:25:11.444792 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public_public'
[0m11:25:11.450322 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:25:11.450674 [debug] [ThreadPool]: On list_nerd_facts_public_public: BEGIN
[0m11:25:11.450910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:11.463200 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m11:25:11.463606 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:25:11.463882 [debug] [ThreadPool]: On list_nerd_facts_public_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m11:25:11.466525 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m11:25:11.467444 [debug] [ThreadPool]: On list_nerd_facts_public_public: ROLLBACK
[0m11:25:11.467837 [debug] [ThreadPool]: On list_nerd_facts_public_public: Close
[0m11:25:11.471619 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:11.471978 [debug] [MainThread]: On master: BEGIN
[0m11:25:11.472233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:25:11.484903 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m11:25:11.485327 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:11.485677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:25:11.493302 [debug] [MainThread]: SQL status: SELECT 28 in 0.007 seconds
[0m11:25:11.494754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184d6fd120>]}
[0m11:25:11.495198 [debug] [MainThread]: On master: ROLLBACK
[0m11:25:11.495611 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:11.495901 [debug] [MainThread]: On master: BEGIN
[0m11:25:11.496302 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:25:11.496582 [debug] [MainThread]: On master: COMMIT
[0m11:25:11.496828 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:11.497052 [debug] [MainThread]: On master: COMMIT
[0m11:25:11.497342 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:25:11.497601 [debug] [MainThread]: On master: Close
[0m11:25:11.499728 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.dim_people
[0m11:25:11.500703 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m11:25:11.500331 [info ] [Thread-1 (]: 1 of 7 START sql view model public_public.dim_people ........................... [RUN]
[0m11:25:11.502385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public_public, now model.nerd_facts_dbt.dim_people)
[0m11:25:11.502683 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.dim_people
[0m11:25:11.501844 [info ] [Thread-2 (]: 2 of 7 START sql view model public_public.fact_starships ....................... [RUN]
[0m11:25:11.501470 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:25:11.501172 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_people
[0m11:25:11.509856 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_people"
[0m11:25:11.511473 [info ] [Thread-3 (]: 3 of 7 START sql view model public_public.stg_swapi_people ..................... [RUN]
[0m11:25:11.510966 [info ] [Thread-4 (]: 4 of 7 START sql view model public_public.stg_swapi_planets .................... [RUN]
[0m11:25:11.510449 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly create_nerd_facts_public_public, now model.nerd_facts_dbt.fact_starships)
[0m11:25:11.512930 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m11:25:11.512576 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_planets'
[0m11:25:11.512147 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_people'
[0m11:25:11.516564 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_people
[0m11:25:11.516207 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_planets
[0m11:25:11.515760 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m11:25:11.516881 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.dim_people
[0m11:25:11.519385 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:25:11.522087 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:25:11.538103 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m11:25:11.549925 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi_planets
[0m11:25:11.549572 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_people"
[0m11:25:11.550343 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_people
[0m11:25:11.560324 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:25:11.557251 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:25:11.554461 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m11:25:11.561270 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:25:11.561724 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:25:11.563066 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: BEGIN
[0m11:25:11.562395 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: BEGIN
[0m11:25:11.563669 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:25:11.563338 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:25:11.562066 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:25:11.564539 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m11:25:11.564844 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:25:11.562769 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:25:11.565589 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: BEGIN
[0m11:25:11.572179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:11.587028 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m11:25:11.587460 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:25:11.587898 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */

  create view "nerd_facts"."public_public"."stg_swapi_people__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    height::DECIMAL AS height,
    mass::DECIMAL AS mass,
    hair_color,
    skin_color,
    eye_color,
    birth_year,
    gender,
    homeworld::INTEGER AS homeworld_id, -- Convert homeworld URL to integer UID    
    url
FROM "nerd_facts"."raw"."swapi_people"
  );
[0m11:25:11.589819 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:25:11.596691 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:25:11.597285 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */
alter table "nerd_facts"."public_public"."stg_swapi_people__dbt_tmp" rename to "stg_swapi_people"
[0m11:25:11.598129 [debug] [Thread-4 (]: SQL status: BEGIN in 0.034 seconds
[0m11:25:11.598897 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:25:11.598441 [debug] [Thread-2 (]: SQL status: BEGIN in 0.034 seconds
[0m11:25:11.597778 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m11:25:11.599198 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:25:11.599483 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */

  create view "nerd_facts"."public_public"."stg_swapi_planets__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    climate,
    terrain,
    diameter::INTEGER AS diameter,
    population::BIGINT AS population,
    gravity,
    orbital_period::INTEGER AS orbital_period,
    rotation_period::INTEGER AS rotation_period,
    surface_water::INTEGER AS surface_water,
    url
FROM "nerd_facts"."raw"."swapi_planets"
  );
[0m11:25:11.599893 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:25:11.614587 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  create view "nerd_facts"."public_public"."fact_starships__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    model,
    manufacturer,
    cost_in_credits::BIGINT AS cost_in_credits,
    length::DECIMAL AS length,
    -- ✅ Convert `max_atmosphering_speed` safely
    CASE
        WHEN max_atmosphering_speed ~ '^\d+$' THEN max_atmosphering_speed::INTEGER
        ELSE NULL
    END AS max_atmosphering_speed,  
    crew::INTEGER AS crew,
    passengers::INTEGER AS passengers,
    cargo_capacity::BIGINT AS cargo_capacity,
    consumables,
    hyperdrive_rating::DECIMAL AS hyperdrive_rating,
    MGLT::INTEGER AS MGLT,
    starship_class,
    pilots::JSONB AS pilot_ids, -- JSONB for linked pilots
    url
FROM "nerd_facts"."raw"."swapi_starships"
  );
[0m11:25:11.616094 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:25:11.600228 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:25:11.613974 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: COMMIT
[0m11:25:11.619120 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:25:11.619550 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m11:25:11.619937 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_people"} */

  create view "nerd_facts"."public_public"."dim_people__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    -- ✅ Convert `height` safely
    CASE 
        WHEN height ~ '^\d+$' THEN height::DECIMAL
        ELSE NULL
    END AS height,
    -- ✅ Convert `mass` safely
    CASE 
        WHEN mass ~ '^\d+$' THEN mass::DECIMAL
        ELSE NULL
    END AS mass,
    hair_color,
    skin_color,
    eye_color,
    birth_year,
    gender,
    homeworld::INTEGER AS homeworld_id,
    url
FROM "nerd_facts"."raw"."swapi_people"
  );
[0m11:25:11.620402 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:25:11.624591 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: COMMIT
[0m11:25:11.624044 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:25:11.624939 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */
alter table "nerd_facts"."public_public"."fact_starships__dbt_tmp" rename to "fact_starships"
[0m11:25:11.625571 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:25:11.620964 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
alter table "nerd_facts"."public_public"."stg_swapi_planets__dbt_tmp" rename to "stg_swapi_planets"
[0m11:25:11.627162 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: COMMIT
[0m11:25:11.627578 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:25:11.628105 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:25:11.628401 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:25:11.636379 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: COMMIT
[0m11:25:11.634071 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m11:25:11.634536 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: COMMIT
[0m11:25:11.633229 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:25:11.636938 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:25:11.645020 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_people__dbt_backup"
[0m11:25:11.645909 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_people"} */
alter table "nerd_facts"."public_public"."dim_people__dbt_tmp" rename to "dim_people"
[0m11:25:11.646353 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: COMMIT
[0m11:25:11.650378 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:25:11.650843 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m11:25:11.651643 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:25:11.652062 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_people__dbt_backup" cascade
[0m11:25:11.654728 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public_public"."fact_starships__dbt_backup"
[0m11:25:11.655305 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m11:25:11.656528 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: COMMIT
[0m11:25:11.659887 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_planets__dbt_backup"
[0m11:25:11.657441 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:25:11.660210 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:25:11.660607 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:25:11.661247 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:25:11.661682 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */
drop view if exists "nerd_facts"."public_public"."fact_starships__dbt_backup" cascade
[0m11:25:11.663832 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: Close
[0m11:25:11.666494 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18498f0d00>]}
[0m11:25:11.664683 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_planets__dbt_backup" cascade
[0m11:25:11.667360 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:25:11.664309 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: COMMIT
[0m11:25:11.668749 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: Close
[0m11:25:11.669997 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m11:25:11.671250 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m11:25:11.669321 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public_public.stg_swapi_people ................ [[32mCREATE VIEW[0m in 0.15s]
[0m11:25:11.673556 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18498f1ed0>]}
[0m11:25:11.673990 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m11:25:11.674566 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_people
[0m11:25:11.678407 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:25:11.677871 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public_public"."dim_people__dbt_backup"
[0m11:25:11.679697 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:25:11.675028 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1849809e40>]}
[0m11:25:11.680598 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public_public.fact_starships .................. [[32mCREATE VIEW[0m in 0.16s]
[0m11:25:11.680029 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_people"} */
drop view if exists "nerd_facts"."public_public"."dim_people__dbt_backup" cascade
[0m11:25:11.675645 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public_public.stg_swapi_planets ............... [[32mCREATE VIEW[0m in 0.16s]
[0m11:25:11.681659 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:25:11.678967 [info ] [Thread-3 (]: 5 of 7 START sql view model public_public.stg_swapi_starships .................. [RUN]
[0m11:25:11.682908 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_people, now model.nerd_facts_dbt.stg_swapi_starships)
[0m11:25:11.683233 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_starships
[0m11:25:11.682473 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:25:11.687656 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: Close
[0m11:25:11.688326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18497b69b0>]}
[0m11:25:11.682045 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.swapi_people_species
[0m11:25:11.688870 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public_public.dim_people ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m11:25:11.689858 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.dim_people
[0m11:25:11.689333 [info ] [Thread-4 (]: 6 of 7 START sql table model public_public.swapi_people_species ................ [RUN]
[0m11:25:11.686396 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:25:11.690488 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_planets, now model.nerd_facts_dbt.swapi_people_species)
[0m11:25:11.690992 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.swapi_people_species
[0m11:25:11.681070 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m11:25:11.691323 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_starships
[0m11:25:11.694042 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.swapi_people_species"
[0m11:25:11.698477 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:25:11.699150 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.swapi_people_species
[0m11:25:11.715019 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:25:11.718304 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.swapi_people_species"
[0m11:25:11.718757 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: BEGIN
[0m11:25:11.719293 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:25:11.719669 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:25:11.720202 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: BEGIN
[0m11:25:11.720513 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:25:11.733234 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m11:25:11.733878 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:25:11.734215 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m11:25:11.734689 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */

  create view "nerd_facts"."public_public"."stg_swapi_starships__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    model,
    manufacturer,

    -- ✅ Use NULLIF to avoid errors if value is empty ('')
    NULLIF(cost_in_credits, '')::BIGINT AS cost_in_credits,
    NULLIF(length, '')::DECIMAL AS length,
    NULLIF(max_atmosphering_speed, '')::INTEGER AS max_atmosphering_speed,
    NULLIF(crew, '')::INTEGER AS crew,
    NULLIF(passengers, '')::INTEGER AS passengers,
    NULLIF(cargo_capacity, '')::BIGINT AS cargo_capacity,
    
    consumables,

    NULLIF(hyperdrive_rating, '')::DECIMAL AS hyperdrive_rating,
    NULLIF(MGLT, '')::INTEGER AS MGLT,
    
    starship_class,

    -- ✅ Ensure pilots column is always valid JSONB
    CASE 
        WHEN pilots IS NULL OR pilots = '' THEN '[]'::JSONB
        ELSE pilots::JSONB
    END AS pilot_ids,

    url

FROM "nerd_facts"."raw"."swapi_starships"
  );
[0m11:25:11.735119 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:25:11.735586 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.swapi_people_species"} */

  
    

  create  table "nerd_facts"."public_public"."swapi_people_species__dbt_tmp"
  
  
    as
  
  (
    

WITH species_data AS (
    SELECT
        id AS species_id,
        jsonb_array_elements_text(people::JSONB)::INTEGER AS person_id  -- ✅ Cast TEXT to JSONB
    FROM "nerd_facts"."raw"."swapi_species"
)

SELECT
    person_id,
    species_id
FROM species_data
WHERE person_id IS NOT NULL
  );
  
[0m11:25:11.737180 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:25:11.737641 [debug] [Thread-4 (]: SQL status: SELECT 50 in 0.002 seconds
[0m11:25:11.740294 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:25:11.742999 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:25:11.743410 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
alter table "nerd_facts"."public_public"."stg_swapi_starships__dbt_tmp" rename to "stg_swapi_starships"
[0m11:25:11.743774 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.swapi_people_species"} */
alter table "nerd_facts"."public_public"."swapi_people_species__dbt_tmp" rename to "swapi_people_species"
[0m11:25:11.744448 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:25:11.744751 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:25:11.748865 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: COMMIT
[0m11:25:11.750186 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: COMMIT
[0m11:25:11.750669 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:25:11.751082 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:25:11.751415 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: COMMIT
[0m11:25:11.751753 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: COMMIT
[0m11:25:11.754521 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m11:25:11.757145 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public_public"."swapi_people_species__dbt_backup"
[0m11:25:11.757623 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m11:25:11.759786 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:25:11.762029 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_starships__dbt_backup"
[0m11:25:11.762506 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.swapi_people_species"} */
drop table if exists "nerd_facts"."public_public"."swapi_people_species__dbt_backup" cascade
[0m11:25:11.763204 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:25:11.763655 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_starships__dbt_backup" cascade
[0m11:25:11.764035 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m11:25:11.764382 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:25:11.765575 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: Close
[0m11:25:11.766664 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: Close
[0m11:25:11.769645 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18498f0d00>]}
[0m11:25:11.770332 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1849844a60>]}
[0m11:25:11.770993 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public_public.stg_swapi_starships ............. [[32mCREATE VIEW[0m in 0.09s]
[0m11:25:11.771770 [info ] [Thread-4 (]: 6 of 7 OK created sql table model public_public.swapi_people_species ........... [[32mSELECT 50[0m in 0.08s]
[0m11:25:11.772345 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:25:11.772822 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.swapi_people_species
[0m11:25:11.773662 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.people_with_species
[0m11:25:11.774087 [info ] [Thread-1 (]: 7 of 7 START sql view model public_public.people_with_species .................. [RUN]
[0m11:25:11.774497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_people, now model.nerd_facts_dbt.people_with_species)
[0m11:25:11.774790 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.people_with_species
[0m11:25:11.777552 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.people_with_species"
[0m11:25:11.778063 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.people_with_species
[0m11:25:11.781879 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.people_with_species"
[0m11:25:11.782428 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:25:11.782724 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: BEGIN
[0m11:25:11.782977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:11.795361 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m11:25:11.795790 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:25:11.796101 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.people_with_species"} */

  create view "nerd_facts"."public_public"."people_with_species__dbt_tmp"
    
    
  as (
    

SELECT
    p.id,
    p.name,
    s.species_id
FROM "nerd_facts"."public_public"."stg_swapi_people" p
LEFT JOIN "nerd_facts"."public_public"."swapi_people_species" s ON p.id = s.person_id
  );
[0m11:25:11.797814 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m11:25:11.800500 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:25:11.800838 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.people_with_species"} */
alter table "nerd_facts"."public_public"."people_with_species__dbt_tmp" rename to "people_with_species"
[0m11:25:11.801447 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:25:11.802544 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: COMMIT
[0m11:25:11.802860 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:25:11.803121 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: COMMIT
[0m11:25:11.805536 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:25:11.807476 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public_public"."people_with_species__dbt_backup"
[0m11:25:11.808135 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:25:11.808422 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.people_with_species"} */
drop view if exists "nerd_facts"."public_public"."people_with_species__dbt_backup" cascade
[0m11:25:11.808892 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:25:11.809955 [debug] [Thread-1 (]: On model.nerd_facts_dbt.people_with_species: Close
[0m11:25:11.810534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf46cf0f-d09e-4250-acfd-2b46709348a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18486dc040>]}
[0m11:25:11.811068 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public_public.people_with_species ............. [[32mCREATE VIEW[0m in 0.04s]
[0m11:25:11.811647 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.people_with_species
[0m11:25:11.812997 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:11.813393 [debug] [MainThread]: On master: BEGIN
[0m11:25:11.813692 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:25:11.825997 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:25:11.826393 [debug] [MainThread]: On master: COMMIT
[0m11:25:11.826705 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:11.826963 [debug] [MainThread]: On master: COMMIT
[0m11:25:11.827315 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:25:11.827615 [debug] [MainThread]: On master: Close
[0m11:25:11.828127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:25:11.828358 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_starships' was properly closed.
[0m11:25:11.828568 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.people_with_species' was properly closed.
[0m11:25:11.828765 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_starships' was properly closed.
[0m11:25:11.828950 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.swapi_people_species' was properly closed.
[0m11:25:11.829252 [info ] [MainThread]: 
[0m11:25:11.829772 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m11:25:11.831016 [debug] [MainThread]: Command end result
[0m11:25:11.895132 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:25:11.896687 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:25:11.902293 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m11:25:11.902623 [info ] [MainThread]: 
[0m11:25:11.902941 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:25:11.903195 [info ] [MainThread]: 
[0m11:25:11.903449 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m11:25:11.904180 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8399521, "process_in_blocks": "0", "process_kernel_time": 0.076366, "process_mem_max_rss": "114836", "process_out_blocks": "2888", "process_user_time": 2.702949}
[0m11:25:11.904540 [debug] [MainThread]: Command `dbt run` succeeded at 11:25:11.904462 after 1.84 seconds
[0m11:25:11.904822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184c82c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184a62f880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184ccc6020>]}
[0m11:25:11.905118 [debug] [MainThread]: Flushing usage events
[0m11:25:12.368786 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:27:02.368660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf9e5cc8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf9f477d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf9f477dc0>]}


============================== 11:27:02.370756 | 06986961-811e-4cb7-9fe5-5d47e0dab419 ==============================
[0m11:27:02.370756 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:27:02.371174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:27:02.466100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06986961-811e-4cb7-9fe5-5d47e0dab419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf9ddbf910>]}
[0m11:27:02.475313 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.15169033, "process_in_blocks": "0", "process_kernel_time": 0.056024, "process_mem_max_rss": "88792", "process_out_blocks": "8", "process_user_time": 1.028115}
[0m11:27:02.475898 [debug] [MainThread]: Command `dbt clean` succeeded at 11:27:02.475778 after 0.15 seconds
[0m11:27:02.476342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf9e5cc8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf9dc34e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf9d628b50>]}
[0m11:27:02.476818 [debug] [MainThread]: Flushing usage events
[0m11:27:02.877514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:27:05.446066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b40604880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b414258d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b41425870>]}


============================== 11:27:05.448472 | abc4febd-373a-4860-adac-95a3139fa563 ==============================
[0m11:27:05.448472 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:27:05.449005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:27:05.579660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b415de6b0>]}
[0m11:27:05.629831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b41455f30>]}
[0m11:27:05.630627 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:27:05.717951 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:27:05.718615 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:27:05.719009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3eb49450>]}
[0m11:27:06.615159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3e4226e0>]}
[0m11:27:06.678279 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:27:06.680102 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:27:06.689149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b40499900>]}
[0m11:27:06.689638 [info ] [MainThread]: Found 7 models, 11 sources, 433 macros
[0m11:27:06.689953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3e3c2d40>]}
[0m11:27:06.691519 [info ] [MainThread]: 
[0m11:27:06.691905 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:27:06.692184 [info ] [MainThread]: 
[0m11:27:06.692619 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:27:06.696391 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m11:27:06.704925 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m11:27:06.726472 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m11:27:06.726899 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m11:27:06.727205 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m11:27:06.727501 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m11:27:06.727832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:06.728093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:06.742960 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m11:27:06.743392 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m11:27:06.744442 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m11:27:06.745501 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m11:27:06.748453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now create_nerd_facts_public_public)
[0m11:27:06.749075 [debug] [ThreadPool]: Creating schema "database: "nerd_facts"
schema: "public_public"
"
[0m11:27:06.753860 [debug] [ThreadPool]: Using postgres connection "create_nerd_facts_public_public"
[0m11:27:06.754239 [debug] [ThreadPool]: On create_nerd_facts_public_public: BEGIN
[0m11:27:06.754487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:27:06.766891 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m11:27:06.767275 [debug] [ThreadPool]: Using postgres connection "create_nerd_facts_public_public"
[0m11:27:06.767542 [debug] [ThreadPool]: On create_nerd_facts_public_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "create_nerd_facts_public_public"} */
create schema if not exists "public_public"
[0m11:27:06.768185 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m11:27:06.768887 [debug] [ThreadPool]: On create_nerd_facts_public_public: COMMIT
[0m11:27:06.769161 [debug] [ThreadPool]: Using postgres connection "create_nerd_facts_public_public"
[0m11:27:06.769390 [debug] [ThreadPool]: On create_nerd_facts_public_public: COMMIT
[0m11:27:06.771735 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m11:27:06.771997 [debug] [ThreadPool]: On create_nerd_facts_public_public: Close
[0m11:27:06.773372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nerd_facts_public_public, now list_nerd_facts_public)
[0m11:27:06.773854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_public_public)
[0m11:27:06.778932 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m11:27:06.781572 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:27:06.781946 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m11:27:06.782278 [debug] [ThreadPool]: On list_nerd_facts_public_public: BEGIN
[0m11:27:06.782544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:27:06.782864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:27:06.798210 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m11:27:06.798817 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m11:27:06.799142 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m11:27:06.799428 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public_public"
[0m11:27:06.799737 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:27:06.800021 [debug] [ThreadPool]: On list_nerd_facts_public_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m11:27:06.803886 [debug] [ThreadPool]: SQL status: SELECT 95 in 0.004 seconds
[0m11:27:06.806323 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m11:27:06.806761 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m11:27:06.807068 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m11:27:06.815317 [debug] [ThreadPool]: On list_nerd_facts_public_public: ROLLBACK
[0m11:27:06.820521 [debug] [ThreadPool]: On list_nerd_facts_public_public: Close
[0m11:27:06.826618 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:06.826986 [debug] [MainThread]: On master: BEGIN
[0m11:27:06.827250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:27:06.839557 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:27:06.839944 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:06.840238 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:27:06.846908 [debug] [MainThread]: SQL status: SELECT 28 in 0.006 seconds
[0m11:27:06.851879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b414d9060>]}
[0m11:27:06.852315 [debug] [MainThread]: On master: ROLLBACK
[0m11:27:06.852711 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:06.852949 [debug] [MainThread]: On master: BEGIN
[0m11:27:06.853323 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:27:06.853573 [debug] [MainThread]: On master: COMMIT
[0m11:27:06.853795 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:06.854004 [debug] [MainThread]: On master: COMMIT
[0m11:27:06.854375 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:27:06.854649 [debug] [MainThread]: On master: Close
[0m11:27:06.856616 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.dim_people
[0m11:27:06.857139 [info ] [Thread-1 (]: 1 of 7 START sql view model public.dim_people .................................. [RUN]
[0m11:27:06.857603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public_public, now model.nerd_facts_dbt.dim_people)
[0m11:27:06.857896 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.dim_people
[0m11:27:06.864518 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_people"
[0m11:27:06.864965 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m11:27:06.865375 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_people
[0m11:27:06.866410 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:27:06.865960 [info ] [Thread-2 (]: 2 of 7 START sql view model public.fact_starships .............................. [RUN]
[0m11:27:06.867739 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.dim_people
[0m11:27:06.866911 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_swapi_people ............................ [RUN]
[0m11:27:06.884232 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_people'
[0m11:27:06.894865 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_people
[0m11:27:06.900465 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:27:06.868327 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.fact_starships)
[0m11:27:06.897237 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_people"
[0m11:27:06.867350 [info ] [Thread-4 (]: 4 of 7 START sql view model public_public.stg_swapi_planets .................... [RUN]
[0m11:27:06.901716 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_planets'
[0m11:27:06.902042 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_planets
[0m11:27:06.904965 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:27:06.901044 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m11:27:06.907799 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m11:27:06.908282 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_people
[0m11:27:06.908618 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:27:06.908919 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi_planets
[0m11:27:06.913389 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_people"
[0m11:27:06.919155 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:27:06.919587 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: BEGIN
[0m11:27:06.918391 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:27:06.913979 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m11:27:06.914500 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: BEGIN
[0m11:27:06.919924 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:27:06.920380 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:27:06.925949 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: BEGIN
[0m11:27:06.926233 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:27:06.925379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:06.924942 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m11:27:06.938310 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:27:06.938749 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m11:27:06.939053 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:27:06.944724 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m11:27:06.945204 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:27:06.945567 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */

  create view "nerd_facts"."public"."stg_swapi_people__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    height::DECIMAL AS height,
    mass::DECIMAL AS mass,
    hair_color,
    skin_color,
    eye_color,
    birth_year,
    gender,
    homeworld::INTEGER AS homeworld_id, -- Convert homeworld URL to integer UID    
    url
FROM "nerd_facts"."raw"."swapi_people"
  );
[0m11:27:06.948151 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:27:06.959317 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:27:06.959787 [debug] [Thread-4 (]: SQL status: BEGIN in 0.034 seconds
[0m11:27:06.960245 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */
alter table "nerd_facts"."public"."stg_swapi_people__dbt_tmp" rename to "stg_swapi_people"
[0m11:27:06.960581 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:27:06.962327 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */

  create view "nerd_facts"."public_public"."stg_swapi_planets__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    climate,
    terrain,
    diameter::INTEGER AS diameter,
    population::BIGINT AS population,
    gravity,
    orbital_period::INTEGER AS orbital_period,
    rotation_period::INTEGER AS rotation_period,
    surface_water::INTEGER AS surface_water,
    url
FROM "nerd_facts"."raw"."swapi_planets"
  );
[0m11:27:06.960898 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m11:27:06.962775 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:27:06.963081 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_people"} */

  create view "nerd_facts"."public"."dim_people__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    -- ✅ Convert `height` safely
    CASE 
        WHEN height ~ '^\d+$' THEN height::DECIMAL
        ELSE NULL
    END AS height,
    -- ✅ Convert `mass` safely
    CASE 
        WHEN mass ~ '^\d+$' THEN mass::DECIMAL
        ELSE NULL
    END AS mass,
    hair_color,
    skin_color,
    eye_color,
    birth_year,
    gender,
    homeworld::INTEGER AS homeworld_id,
    url
FROM "nerd_facts"."raw"."swapi_people"
  );
[0m11:27:06.962025 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:27:06.961382 [debug] [Thread-2 (]: SQL status: BEGIN in 0.022 seconds
[0m11:27:06.969918 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m11:27:06.976457 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:27:06.975909 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: COMMIT
[0m11:27:06.970270 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m11:27:06.982267 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:27:06.979478 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  create view "nerd_facts"."public"."fact_starships__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    model,
    manufacturer,
    cost_in_credits::BIGINT AS cost_in_credits,
    length::DECIMAL AS length,
    -- ✅ Convert `max_atmosphering_speed` safely
    CASE
        WHEN max_atmosphering_speed ~ '^\d+$' THEN max_atmosphering_speed::INTEGER
        ELSE NULL
    END AS max_atmosphering_speed,  
    crew::INTEGER AS crew,
    passengers::INTEGER AS passengers,
    cargo_capacity::BIGINT AS cargo_capacity,
    consumables,
    hyperdrive_rating::DECIMAL AS hyperdrive_rating,
    MGLT::INTEGER AS MGLT,
    starship_class,
    pilots::JSONB AS pilot_ids, -- JSONB for linked pilots
    url
FROM "nerd_facts"."raw"."swapi_starships"
  );
[0m11:27:06.979916 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:27:06.979058 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:27:06.982579 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_people"} */
alter table "nerd_facts"."public"."dim_people__dbt_tmp" rename to "dim_people"
[0m11:27:06.984993 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
alter table "nerd_facts"."public_public"."stg_swapi_planets__dbt_tmp" rename to "stg_swapi_planets"
[0m11:27:06.984604 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: COMMIT
[0m11:27:06.985801 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:27:06.986096 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:27:06.994598 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: COMMIT
[0m11:27:06.995173 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m11:27:06.996603 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: COMMIT
[0m11:27:06.997236 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:27:06.997739 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m11:27:07.000800 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:27:07.008037 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */
alter table "nerd_facts"."public"."fact_starships__dbt_tmp" rename to "fact_starships"
[0m11:27:07.001264 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:27:07.008559 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: COMMIT
[0m11:27:07.001633 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: COMMIT
[0m11:27:07.007598 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."stg_swapi_people__dbt_backup"
[0m11:27:07.009343 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:27:07.013565 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m11:27:07.015186 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: COMMIT
[0m11:27:07.015597 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m11:27:07.015991 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */
drop view if exists "nerd_facts"."public"."stg_swapi_people__dbt_backup" cascade
[0m11:27:07.016717 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m11:27:07.016371 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:27:07.019232 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."dim_people__dbt_backup"
[0m11:27:07.024035 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_people"
[0m11:27:07.022080 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:27:07.022470 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: COMMIT
[0m11:27:07.024409 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_people"} */
drop view if exists "nerd_facts"."public"."dim_people__dbt_backup" cascade
[0m11:27:07.021746 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public_public"."stg_swapi_planets__dbt_backup"
[0m11:27:07.026772 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_people: Close
[0m11:27:07.030320 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b41842c20>]}
[0m11:27:07.031286 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_swapi_people ....................... [[32mCREATE VIEW[0m in 0.14s]
[0m11:27:07.027791 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m11:27:07.032087 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_people
[0m11:27:07.032466 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m11:27:07.036201 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."fact_starships__dbt_backup"
[0m11:27:07.032841 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */
drop view if exists "nerd_facts"."public_public"."stg_swapi_planets__dbt_backup" cascade
[0m11:27:07.037569 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:27:07.033156 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m11:27:07.039960 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_people: Close
[0m11:27:07.038791 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_planets: Close
[0m11:27:07.036923 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m11:27:07.033593 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:27:07.043371 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */
drop view if exists "nerd_facts"."public"."fact_starships__dbt_backup" cascade
[0m11:27:07.044089 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3c4a02b0>]}
[0m11:27:07.044672 [info ] [Thread-3 (]: 5 of 7 START sql view model public.stg_swapi_starships ......................... [RUN]
[0m11:27:07.046951 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_people, now model.nerd_facts_dbt.stg_swapi_starships)
[0m11:27:07.047306 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_starships
[0m11:27:07.046460 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public_public.stg_swapi_planets ............... [[32mCREATE VIEW[0m in 0.14s]
[0m11:27:07.051240 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi_planets
[0m11:27:07.045226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3ce05870>]}
[0m11:27:07.045888 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:27:07.053687 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m11:27:07.054275 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3cdad420>]}
[0m11:27:07.054802 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.fact_starships ......................... [[32mCREATE VIEW[0m in 0.19s]
[0m11:27:07.055314 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m11:27:07.050648 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:27:07.055858 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_starships
[0m11:27:07.052320 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.dim_people ............................. [[32mCREATE VIEW[0m in 0.19s]
[0m11:27:07.061126 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.dim_people
[0m11:27:07.051656 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.swapi_people_species
[0m11:27:07.060438 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:27:07.061778 [info ] [Thread-4 (]: 6 of 7 START sql table model public.swapi_people_species ....................... [RUN]
[0m11:27:07.062375 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_planets, now model.nerd_facts_dbt.swapi_people_species)
[0m11:27:07.062747 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:27:07.063068 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.swapi_people_species
[0m11:27:07.063368 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: BEGIN
[0m11:27:07.066583 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.swapi_people_species"
[0m11:27:07.067071 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:27:07.067800 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.swapi_people_species
[0m11:27:07.096322 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.swapi_people_species"
[0m11:27:07.097033 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:27:07.097394 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m11:27:07.097798 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: BEGIN
[0m11:27:07.098194 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:27:07.098588 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:27:07.099023 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */

  create view "nerd_facts"."public"."stg_swapi_starships__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    name,
    model,
    manufacturer,

    -- ✅ Use NULLIF to avoid errors if value is empty ('')
    NULLIF(cost_in_credits, '')::BIGINT AS cost_in_credits,
    NULLIF(length, '')::DECIMAL AS length,
    NULLIF(max_atmosphering_speed, '')::INTEGER AS max_atmosphering_speed,
    NULLIF(crew, '')::INTEGER AS crew,
    NULLIF(passengers, '')::INTEGER AS passengers,
    NULLIF(cargo_capacity, '')::BIGINT AS cargo_capacity,
    
    consumables,

    NULLIF(hyperdrive_rating, '')::DECIMAL AS hyperdrive_rating,
    NULLIF(MGLT, '')::INTEGER AS MGLT,
    
    starship_class,

    -- ✅ Ensure pilots column is always valid JSONB
    CASE 
        WHEN pilots IS NULL OR pilots = '' THEN '[]'::JSONB
        ELSE pilots::JSONB
    END AS pilot_ids,

    url

FROM "nerd_facts"."raw"."swapi_starships"
  );
[0m11:27:07.101899 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:27:07.104973 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:27:07.105481 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
alter table "nerd_facts"."public"."stg_swapi_starships__dbt_tmp" rename to "stg_swapi_starships"
[0m11:27:07.106251 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:27:07.107472 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: COMMIT
[0m11:27:07.107867 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:27:07.108205 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: COMMIT
[0m11:27:07.110727 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m11:27:07.113783 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."stg_swapi_starships__dbt_backup"
[0m11:27:07.114545 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m11:27:07.114899 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */
drop view if exists "nerd_facts"."public"."stg_swapi_starships__dbt_backup" cascade
[0m11:27:07.115207 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m11:27:07.115687 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:27:07.116000 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:27:07.116339 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.swapi_people_species"} */

  
    

  create  table "nerd_facts"."public"."swapi_people_species__dbt_tmp"
  
  
    as
  
  (
    

WITH species_data AS (
    SELECT
        id AS species_id,
        jsonb_array_elements_text(people::JSONB)::INTEGER AS person_id  -- ✅ Cast TEXT to JSONB
    FROM "nerd_facts"."raw"."swapi_species"
)

SELECT
    person_id,
    species_id
FROM species_data
WHERE person_id IS NOT NULL
  );
  
[0m11:27:07.117490 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: Close
[0m11:27:07.119340 [debug] [Thread-4 (]: SQL status: SELECT 50 in 0.001 seconds
[0m11:27:07.165569 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3c348700>]}
[0m11:27:07.167136 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:27:07.168342 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.swapi_people_species"} */
alter table "nerd_facts"."public"."swapi_people_species__dbt_tmp" rename to "swapi_people_species"
[0m11:27:07.167925 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public.stg_swapi_starships .................... [[32mCREATE VIEW[0m in 0.12s]
[0m11:27:07.169033 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_starships
[0m11:27:07.169355 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:27:07.173417 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: COMMIT
[0m11:27:07.173815 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:27:07.174091 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: COMMIT
[0m11:27:07.176749 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m11:27:07.178904 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."swapi_people_species__dbt_backup"
[0m11:27:07.180992 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.swapi_people_species"
[0m11:27:07.181324 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.swapi_people_species"} */
drop table if exists "nerd_facts"."public"."swapi_people_species__dbt_backup" cascade
[0m11:27:07.181869 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m11:27:07.182915 [debug] [Thread-4 (]: On model.nerd_facts_dbt.swapi_people_species: Close
[0m11:27:07.185499 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3c52ffd0>]}
[0m11:27:07.186145 [info ] [Thread-4 (]: 6 of 7 OK created sql table model public.swapi_people_species .................. [[32mSELECT 50[0m in 0.12s]
[0m11:27:07.186654 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.swapi_people_species
[0m11:27:07.187391 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.people_with_species
[0m11:27:07.187917 [info ] [Thread-2 (]: 7 of 7 START sql view model public.people_with_species ......................... [RUN]
[0m11:27:07.188461 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_starships, now model.nerd_facts_dbt.people_with_species)
[0m11:27:07.188744 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.people_with_species
[0m11:27:07.191970 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.people_with_species"
[0m11:27:07.192542 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.people_with_species
[0m11:27:07.198818 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.people_with_species"
[0m11:27:07.199585 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:27:07.200060 [debug] [Thread-2 (]: On model.nerd_facts_dbt.people_with_species: BEGIN
[0m11:27:07.200401 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:27:07.213680 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m11:27:07.214171 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:27:07.214567 [debug] [Thread-2 (]: On model.nerd_facts_dbt.people_with_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.people_with_species"} */

  create view "nerd_facts"."public"."people_with_species__dbt_tmp"
    
    
  as (
    

SELECT
    p.id,
    p.name,
    s.species_id
FROM "nerd_facts"."public"."stg_swapi_people" p
LEFT JOIN "nerd_facts"."public"."swapi_people_species" s ON p.id = s.person_id
  );
[0m11:27:07.216392 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m11:27:07.219400 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:27:07.219797 [debug] [Thread-2 (]: On model.nerd_facts_dbt.people_with_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.people_with_species"} */
alter table "nerd_facts"."public"."people_with_species__dbt_tmp" rename to "people_with_species"
[0m11:27:07.220474 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:27:07.222089 [debug] [Thread-2 (]: On model.nerd_facts_dbt.people_with_species: COMMIT
[0m11:27:07.222533 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:27:07.222880 [debug] [Thread-2 (]: On model.nerd_facts_dbt.people_with_species: COMMIT
[0m11:27:07.225616 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m11:27:07.228495 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."people_with_species__dbt_backup"
[0m11:27:07.229347 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.people_with_species"
[0m11:27:07.229769 [debug] [Thread-2 (]: On model.nerd_facts_dbt.people_with_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.people_with_species"} */
drop view if exists "nerd_facts"."public"."people_with_species__dbt_backup" cascade
[0m11:27:07.230354 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:27:07.231585 [debug] [Thread-2 (]: On model.nerd_facts_dbt.people_with_species: Close
[0m11:27:07.232570 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abc4febd-373a-4860-adac-95a3139fa563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3fdfd690>]}
[0m11:27:07.233400 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.people_with_species .................... [[32mCREATE VIEW[0m in 0.04s]
[0m11:27:07.234095 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.people_with_species
[0m11:27:07.235696 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:07.236043 [debug] [MainThread]: On master: BEGIN
[0m11:27:07.236331 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:27:07.251437 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m11:27:07.252004 [debug] [MainThread]: On master: COMMIT
[0m11:27:07.252333 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:07.252629 [debug] [MainThread]: On master: COMMIT
[0m11:27:07.253031 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:27:07.253332 [debug] [MainThread]: On master: Close
[0m11:27:07.256081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:27:07.256443 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.people_with_species' was properly closed.
[0m11:27:07.256724 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_people' was properly closed.
[0m11:27:07.256999 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_starships' was properly closed.
[0m11:27:07.257263 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.swapi_people_species' was properly closed.
[0m11:27:07.257675 [info ] [MainThread]: 
[0m11:27:07.258029 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m11:27:07.259410 [debug] [MainThread]: Command end result
[0m11:27:07.282785 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m11:27:07.284381 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m11:27:07.290477 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m11:27:07.290841 [info ] [MainThread]: 
[0m11:27:07.291257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:27:07.291610 [info ] [MainThread]: 
[0m11:27:07.291952 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m11:27:07.292741 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.893422, "process_in_blocks": "0", "process_kernel_time": 0.111823, "process_mem_max_rss": "115548", "process_out_blocks": "2880", "process_user_time": 2.68294}
[0m11:27:07.293151 [debug] [MainThread]: Command `dbt run` succeeded at 11:27:07.293056 after 1.89 seconds
[0m11:27:07.293512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b40604880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3e3ef130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3e366e90>]}
[0m11:27:07.293892 [debug] [MainThread]: Flushing usage events
[0m11:27:07.758050 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:02:41.608555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29a344c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29a2403d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29a2403df0>]}


============================== 12:02:41.611831 | 5f75730b-f8d6-40aa-a73f-c34095e2d580 ==============================
[0m12:02:41.611831 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:02:41.612396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m12:02:41.715420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f75730b-f8d6-40aa-a73f-c34095e2d580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29a434fd90>]}
[0m12:02:41.726487 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16302001, "process_in_blocks": "18496", "process_kernel_time": 0.077729, "process_mem_max_rss": "88896", "process_out_blocks": "8", "process_user_time": 1.097446}
[0m12:02:41.727175 [debug] [MainThread]: Command `dbt clean` succeeded at 12:02:41.727027 after 0.16 seconds
[0m12:02:41.727696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29a344c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29a434ee60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29a240b970>]}
[0m12:02:41.728222 [debug] [MainThread]: Flushing usage events
[0m12:02:42.125900 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:02:47.501517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc695d3c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc694cf37f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc694cf3850>]}


============================== 12:02:47.503951 | 1fd5f0fd-df37-4b1a-8898-76cea4eb93ff ==============================
[0m12:02:47.503951 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:02:47.504493 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:02:47.556338 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "nerd_facts_dbt", target "dev" invalid: 'schema' is a required property
[0m12:02:47.557179 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.10035523, "process_in_blocks": "144", "process_kernel_time": 0.044186, "process_mem_max_rss": "91036", "process_out_blocks": "8", "process_user_time": 1.015943}
[0m12:02:47.557577 [debug] [MainThread]: Command `dbt run` failed at 12:02:47.557489 after 0.10 seconds
[0m12:02:47.557872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc695d3c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc694cf2320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc696cbe6e0>]}
[0m12:02:47.558188 [debug] [MainThread]: Flushing usage events
[0m12:02:47.933673 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:04:13.548386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d121fc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d1309b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d1309b820>]}


============================== 12:04:13.550618 | b09e0e59-8c49-487e-b5b5-90749d7cbfef ==============================
[0m12:04:13.550618 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:04:13.551079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:04:13.680583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b09e0e59-8c49-487e-b5b5-90749d7cbfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d112a4100>]}
[0m12:04:13.733947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b09e0e59-8c49-487e-b5b5-90749d7cbfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d1309b790>]}
[0m12:04:13.734763 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:04:13.826206 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:04:13.826890 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:04:13.827301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b09e0e59-8c49-487e-b5b5-90749d7cbfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d1307e080>]}
[0m12:04:14.748081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b09e0e59-8c49-487e-b5b5-90749d7cbfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d10424430>]}
[0m12:04:14.810995 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:04:14.812853 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:04:14.822558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b09e0e59-8c49-487e-b5b5-90749d7cbfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d10770a30>]}
[0m12:04:14.823036 [info ] [MainThread]: Found 9 models, 11 sources, 433 macros
[0m12:04:14.823354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b09e0e59-8c49-487e-b5b5-90749d7cbfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d10772440>]}
[0m12:04:14.825069 [info ] [MainThread]: 
[0m12:04:14.825414 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:04:14.825719 [info ] [MainThread]: 
[0m12:04:14.826144 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:04:14.830744 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m12:04:14.868713 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m12:04:14.869141 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m12:04:14.869405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:14.883082 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m12:04:14.884235 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m12:04:14.886770 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public'
[0m12:04:14.892038 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:04:14.892413 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m12:04:14.892655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:14.905098 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:04:14.905511 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:04:14.905781 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:04:14.908556 [debug] [ThreadPool]: SQL status: SELECT 94 in 0.002 seconds
[0m12:04:14.910690 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m12:04:14.911199 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m12:04:14.924634 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:14.925009 [debug] [MainThread]: On master: BEGIN
[0m12:04:14.925252 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:04:14.938146 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:04:14.938568 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:14.938891 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:04:14.946091 [debug] [MainThread]: SQL status: SELECT 28 in 0.007 seconds
[0m12:04:14.950970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b09e0e59-8c49-487e-b5b5-90749d7cbfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d115624d0>]}
[0m12:04:14.951390 [debug] [MainThread]: On master: ROLLBACK
[0m12:04:14.951829 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:14.952133 [debug] [MainThread]: On master: BEGIN
[0m12:04:14.952537 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:04:14.952784 [debug] [MainThread]: On master: COMMIT
[0m12:04:14.953038 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:14.953264 [debug] [MainThread]: On master: COMMIT
[0m12:04:14.953605 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:04:14.953867 [debug] [MainThread]: On master: Close
[0m12:04:14.956538 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_netrunner
[0m12:04:14.956995 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_pokeapi
[0m12:04:14.957339 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi
[0m12:04:14.957776 [info ] [Thread-1 (]: 1 of 9 START sql view model public.stg_netrunner ............................... [RUN]
[0m12:04:14.958260 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_pokeapi ................................. [RUN]
[0m12:04:14.959696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_nerd_facts, now model.nerd_facts_dbt.stg_pokeapi)
[0m12:04:14.959280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.stg_netrunner)
[0m12:04:14.960053 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_pokeapi
[0m12:04:14.958693 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_swapi ................................... [RUN]
[0m12:04:14.960395 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner
[0m12:04:14.967238 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:04:14.967899 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi'
[0m12:04:14.970227 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi
[0m12:04:14.969583 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:04:14.971754 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi"
[0m12:04:14.972346 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_netrunner
[0m12:04:14.972791 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_pokeapi
[0m12:04:14.973117 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi
[0m12:04:15.012319 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:04:15.015309 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:04:15.016627 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi"
[0m12:04:15.017549 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:04:15.018002 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:04:15.018578 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: BEGIN
[0m12:04:15.018950 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:04:15.019944 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi: BEGIN
[0m12:04:15.019620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:15.019331 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_pokeapi: BEGIN
[0m12:04:15.020658 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:04:15.020242 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:04:15.033235 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m12:04:15.033731 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:04:15.034046 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */

  create view "nerd_facts"."public"."stg_netrunner__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.netrunner_cards
)
SELECT
    id,
    title AS card_name,
    faction_code,
    (SELECT name FROM raw.netrunner_factions f WHERE f.code = raw_data.faction_code) AS faction_name,
    type_code,
    (SELECT name FROM raw.netrunner_types t WHERE t.code = raw_data.type_code) AS type_name,
    cost::INTEGER,
    text AS description
FROM raw_data
  );
[0m12:04:15.036431 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:04:15.043100 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:04:15.043516 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner__dbt_tmp" rename to "stg_netrunner"
[0m12:04:15.044227 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:04:15.056471 [debug] [Thread-3 (]: SQL status: BEGIN in 0.036 seconds
[0m12:04:15.057151 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:04:15.057541 [debug] [Thread-2 (]: SQL status: BEGIN in 0.037 seconds
[0m12:04:15.057976 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:04:15.059005 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:04:15.058666 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:04:15.059627 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */

  create view "nerd_facts"."public"."stg_pokeapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.pokeapi_pokemon
)
SELECT
    id,
    name AS pokemon_name,
    height / 10.0 AS height_m,
    weight / 10.0 AS weight_kg,
    base_experience,
    jsonb_array_length(abilities) AS num_abilities,
    abilities AS abilities_json,
    types->0->>'type' AS primary_type
FROM raw_data
  );
[0m12:04:15.058356 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */

  create view "nerd_facts"."public"."stg_swapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.swapi_starships
)
SELECT
    id,
    name AS starship_name,
    model,
    manufacturer,
    CASE 
        WHEN max_atmosphering_speed ~ '^[0-9]+$' THEN max_atmosphering_speed::NUMERIC
        ELSE NULL 
    END AS max_speed,
    crew::INTEGER,
    passengers::INTEGER
FROM raw_data
  );
[0m12:04:15.059333 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:04:15.062208 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:04:15.062627 [debug] [Thread-2 (]: Postgres adapter: Postgres error: operator does not exist: text / numeric
LINE 13:     height / 10.0 AS height_m,
                    ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m12:04:15.066252 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_pokeapi: ROLLBACK
[0m12:04:15.065876 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:04:15.066644 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi__dbt_tmp" rename to "stg_swapi"
[0m12:04:15.066970 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_pokeapi: Close
[0m12:04:15.067260 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m12:04:15.070121 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:04:15.076416 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner__dbt_backup"
[0m12:04:15.078065 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:04:15.081821 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:04:15.082406 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:04:15.082909 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
drop view if exists "nerd_facts"."public"."stg_netrunner__dbt_backup" cascade
[0m12:04:15.083402 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:04:15.084099 [debug] [Thread-2 (]: Database Error in model stg_pokeapi (models/staging/stg_pokeapi.sql)
  operator does not exist: text / numeric
  LINE 13:     height / 10.0 AS height_m,
                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/stg_pokeapi.sql
[0m12:04:15.084918 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:04:15.088420 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: Close
[0m12:04:15.088878 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m12:04:15.091311 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b09e0e59-8c49-487e-b5b5-90749d7cbfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d1231a3e0>]}
[0m12:04:15.091970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b09e0e59-8c49-487e-b5b5-90749d7cbfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d1344ecb0>]}
[0m12:04:15.094402 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."stg_swapi__dbt_backup"
[0m12:04:15.095027 [error] [Thread-2 (]: 2 of 9 ERROR creating sql view model public.stg_pokeapi ........................ [[31mERROR[0m in 0.13s]
[0m12:04:15.095696 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.stg_netrunner .......................... [[32mCREATE VIEW[0m in 0.13s]
[0m12:04:15.096904 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_pokeapi
[0m12:04:15.096440 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:04:15.097395 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_netrunner
[0m12:04:15.097787 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
drop view if exists "nerd_facts"."public"."stg_swapi__dbt_backup" cascade
[0m12:04:15.098205 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_pokeapi' to be skipped because of status 'error'.  Reason: Database Error in model stg_pokeapi (models/staging/stg_pokeapi.sql)
  operator does not exist: text / numeric
  LINE 13:     height / 10.0 AS height_m,
                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/stg_pokeapi.sql.
[0m12:04:15.098911 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:04:15.099862 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:04:15.100151 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:04:15.100420 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:04:15.101627 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi: Close
[0m12:04:15.102061 [info ] [Thread-4 (]: 4 of 9 START sql table model public.dim_netrunner_factions ..................... [RUN]
[0m12:04:15.103617 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.dim_netrunner_factions'
[0m12:04:15.102814 [info ] [Thread-1 (]: 6 of 9 START sql table model public.fact_netrunner_cards ....................... [RUN]
[0m12:04:15.103997 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:04:15.108371 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:04:15.104584 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b09e0e59-8c49-487e-b5b5-90749d7cbfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0f1af9a0>]}
[0m12:04:15.105737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner, now model.nerd_facts_dbt.fact_netrunner_cards)
[0m12:04:15.102384 [info ] [Thread-2 (]: 5 of 9 SKIP relation public.dim_pokemon_types .................................. [[33mSKIP[0m]
[0m12:04:15.109060 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:04:15.109972 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:04:15.109614 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_swapi .............................. [[32mCREATE VIEW[0m in 0.14s]
[0m12:04:15.134478 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi
[0m12:04:15.134821 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.fact_pokemon
[0m12:04:15.133865 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:04:15.110395 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:04:15.135939 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:04:15.135134 [info ] [Thread-3 (]: 7 of 9 SKIP relation public.fact_pokemon ....................................... [[33mSKIP[0m]
[0m12:04:15.136892 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.fact_pokemon
[0m12:04:15.126067 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:04:15.136512 [info ] [Thread-2 (]: 8 of 9 START sql table model public.dim_starship_manufacturers ................. [RUN]
[0m12:04:15.137308 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m12:04:15.137953 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:04:15.138507 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_pokeapi, now model.nerd_facts_dbt.dim_starship_manufacturers)
[0m12:04:15.140296 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:04:15.139043 [info ] [Thread-3 (]: 9 of 9 START sql table model public.fact_starships ............................. [RUN]
[0m12:04:15.143818 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi, now model.nerd_facts_dbt.fact_starships)
[0m12:04:15.144223 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m12:04:15.143278 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:04:15.147748 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:04:15.147139 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m12:04:15.139487 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:04:15.139953 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: BEGIN
[0m12:04:15.153000 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:04:15.158297 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:04:15.158724 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m12:04:15.159128 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:04:15.159872 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:04:15.166761 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: BEGIN
[0m12:04:15.167267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:15.165404 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:04:15.168018 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: BEGIN
[0m12:04:15.168425 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:04:15.166104 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m12:04:15.169323 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:04:15.169932 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m12:04:15.171344 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:04:15.208095 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m12:04:15.208799 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:04:15.209302 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */

  
    

  create  table "nerd_facts"."public"."fact_netrunner_cards__dbt_tmp"
  
  
    as
  
  (
    WITH cards AS (
    SELECT * FROM "nerd_facts"."public"."stg_netrunner"
)
SELECT
    id,
    card_name,
    faction_name,
    type_name,
    cost,
    description
FROM cards
  );
  
[0m12:04:15.211972 [debug] [Thread-4 (]: SQL status: BEGIN in 0.053 seconds
[0m12:04:15.212520 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:04:15.212975 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */

  
    

  create  table "nerd_facts"."public"."dim_netrunner_factions__dbt_tmp"
  
  
    as
  
  (
    WITH factions AS (
    SELECT DISTINCT
        faction_name,
        COUNT(*) AS num_cards
    FROM "nerd_facts"."public"."stg_netrunner"
    GROUP BY faction_name
)
SELECT * FROM factions
  );
  
[0m12:04:15.214228 [debug] [Thread-3 (]: SQL status: BEGIN in 0.043 seconds
[0m12:04:15.214736 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:04:15.215218 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  
    

  create  table "nerd_facts"."public"."fact_starships__dbt_tmp"
  
  
    as
  
  (
    WITH starships AS (
    SELECT * FROM "nerd_facts"."public"."stg_swapi"
)
SELECT
    id,
    starship_name,
    model,
    manufacturer,
    max_speed,
    crew,
    passengers
FROM starships
  );
  
[0m12:04:15.215859 [debug] [Thread-2 (]: SQL status: BEGIN in 0.047 seconds
[0m12:04:15.216330 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:04:15.216781 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */

  
    

  create  table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp"
  
  
    as
  
  (
    WITH manufacturers AS (
    SELECT DISTINCT
        manufacturer,
        COUNT(*) AS num_starships
    FROM "nerd_facts"."public"."stg_swapi"
    GROUP BY manufacturer
)
SELECT * FROM manufacturers
  );
  
[0m12:04:15.225076 [debug] [Thread-2 (]: SQL status: SELECT 27 in 0.008 seconds
[0m12:04:15.229501 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:04:15.230056 [debug] [Thread-3 (]: Postgres adapter: Postgres error: invalid input syntax for type integer: "30-165"

[0m12:04:15.231041 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_starships: ROLLBACK
[0m12:04:15.230580 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp" rename to "dim_starship_manufacturers"
[0m12:04:15.231948 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:04:15.250582 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m12:04:15.252091 [debug] [Thread-3 (]: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:04:15.252685 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b09e0e59-8c49-487e-b5b5-90749d7cbfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0f1af340>]}
[0m12:04:15.253263 [error] [Thread-3 (]: 9 of 9 ERROR creating sql table model public.fact_starships .................... [[31mERROR[0m in 0.11s]
[0m12:04:15.253829 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m12:04:15.254276 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_starships' to be skipped because of status 'error'.  Reason: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql.
[0m12:04:15.254608 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:04:15.254952 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:04:15.255304 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:04:15.257911 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m12:04:15.260392 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup"
[0m12:04:15.262778 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:04:15.263357 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
drop table if exists "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup" cascade
[0m12:04:15.264409 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:04:15.271478 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: Close
[0m12:04:15.273150 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b09e0e59-8c49-487e-b5b5-90749d7cbfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0c0ab8e0>]}
[0m12:04:15.274492 [info ] [Thread-2 (]: 8 of 9 OK created sql table model public.dim_starship_manufacturers ............ [[32mSELECT 27[0m in 0.13s]
[0m12:04:15.275688 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:04:15.359800 [debug] [Thread-4 (]: Postgres adapter: Postgres error: more than one row returned by a subquery used as an expression

[0m12:04:15.360291 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: ROLLBACK
[0m12:04:15.360809 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: Close
[0m12:04:15.361730 [debug] [Thread-4 (]: Database Error in model dim_netrunner_factions (models/marts/dim_netrunner_factions.sql)
  more than one row returned by a subquery used as an expression
  compiled code at target/run/nerd_facts_dbt/models/marts/dim_netrunner_factions.sql
[0m12:04:15.362322 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b09e0e59-8c49-487e-b5b5-90749d7cbfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0c0e1ba0>]}
[0m12:04:15.362772 [debug] [Thread-1 (]: Postgres adapter: Postgres error: more than one row returned by a subquery used as an expression

[0m12:04:15.363848 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: ROLLBACK
[0m12:04:15.363505 [error] [Thread-4 (]: 4 of 9 ERROR creating sql table model public.dim_netrunner_factions ............ [[31mERROR[0m in 0.26s]
[0m12:04:15.364624 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:04:15.365072 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: Close
[0m12:04:15.366167 [debug] [Thread-1 (]: Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  more than one row returned by a subquery used as an expression
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql
[0m12:04:15.366683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b09e0e59-8c49-487e-b5b5-90749d7cbfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0c1208e0>]}
[0m12:04:15.373390 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.dim_netrunner_factions' to be skipped because of status 'error'.  Reason: Database Error in model dim_netrunner_factions (models/marts/dim_netrunner_factions.sql)
  more than one row returned by a subquery used as an expression
  compiled code at target/run/nerd_facts_dbt/models/marts/dim_netrunner_factions.sql.
[0m12:04:15.371800 [error] [Thread-1 (]: 6 of 9 ERROR creating sql table model public.fact_netrunner_cards .............. [[31mERROR[0m in 0.26s]
[0m12:04:15.374733 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:04:15.375618 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_netrunner_cards' to be skipped because of status 'error'.  Reason: Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  more than one row returned by a subquery used as an expression
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql.
[0m12:04:15.377108 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:15.377542 [debug] [MainThread]: On master: BEGIN
[0m12:04:15.377831 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:04:15.391614 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m12:04:15.392129 [debug] [MainThread]: On master: COMMIT
[0m12:04:15.392446 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:15.392696 [debug] [MainThread]: On master: COMMIT
[0m12:04:15.393030 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:04:15.393286 [debug] [MainThread]: On master: Close
[0m12:04:15.393771 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:15.394010 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_starship_manufacturers' was properly closed.
[0m12:04:15.394217 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_netrunner_cards' was properly closed.
[0m12:04:15.394412 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_starships' was properly closed.
[0m12:04:15.394601 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_netrunner_factions' was properly closed.
[0m12:04:15.395429 [info ] [MainThread]: 
[0m12:04:15.395826 [info ] [MainThread]: Finished running 6 table models, 3 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m12:04:15.397086 [debug] [MainThread]: Command end result
[0m12:04:15.459889 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:04:15.461220 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:04:15.466636 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m12:04:15.466961 [info ] [MainThread]: 
[0m12:04:15.467352 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m12:04:15.467658 [info ] [MainThread]: 
[0m12:04:15.467992 [error] [MainThread]:   Database Error in model stg_pokeapi (models/staging/stg_pokeapi.sql)
  operator does not exist: text / numeric
  LINE 13:     height / 10.0 AS height_m,
                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/stg_pokeapi.sql
[0m12:04:15.468280 [info ] [MainThread]: 
[0m12:04:15.468580 [error] [MainThread]:   Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:04:15.468873 [info ] [MainThread]: 
[0m12:04:15.469168 [error] [MainThread]:   Database Error in model dim_netrunner_factions (models/marts/dim_netrunner_factions.sql)
  more than one row returned by a subquery used as an expression
  compiled code at target/run/nerd_facts_dbt/models/marts/dim_netrunner_factions.sql
[0m12:04:15.469443 [info ] [MainThread]: 
[0m12:04:15.469760 [error] [MainThread]:   Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  more than one row returned by a subquery used as an expression
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql
[0m12:04:15.470034 [info ] [MainThread]: 
[0m12:04:15.470313 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=4 SKIP=2 TOTAL=9
[0m12:04:15.471363 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9690347, "process_in_blocks": "3216", "process_kernel_time": 0.148255, "process_mem_max_rss": "114768", "process_out_blocks": "2888", "process_user_time": 2.643782}
[0m12:04:15.471724 [debug] [MainThread]: Command `dbt run` failed at 12:04:15.471643 after 1.97 seconds
[0m12:04:15.472038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d121fc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d103ff010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0c0f1b40>]}
[0m12:04:15.472346 [debug] [MainThread]: Flushing usage events
[0m12:04:15.966207 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:07:05.309707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadf644970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae0491a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae04919c0>]}


============================== 12:07:05.311868 | ad6b0434-187b-424c-aa33-6bd42c69970f ==============================
[0m12:07:05.311868 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:07:05.312342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:07:05.439941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad6b0434-187b-424c-aa33-6bd42c69970f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffade9ab7c0>]}
[0m12:07:05.486496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad6b0434-187b-424c-aa33-6bd42c69970f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffade6ec7f0>]}
[0m12:07:05.487216 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:07:05.562258 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:07:05.657224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m12:07:05.657851 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/stg_swapi.sql
[0m12:07:05.658210 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/dim_netrunner_factions.sql
[0m12:07:05.658547 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/stg_pokeapi.sql
[0m12:07:05.658844 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/fact_netrunner_cards.sql
[0m12:07:05.875058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad6b0434-187b-424c-aa33-6bd42c69970f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadd2d2140>]}
[0m12:07:05.936129 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:07:05.938260 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:07:05.947255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad6b0434-187b-424c-aa33-6bd42c69970f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadd88aef0>]}
[0m12:07:05.947767 [info ] [MainThread]: Found 9 models, 11 sources, 433 macros
[0m12:07:05.948113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad6b0434-187b-424c-aa33-6bd42c69970f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadd929fc0>]}
[0m12:07:05.949668 [info ] [MainThread]: 
[0m12:07:05.949996 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:07:05.950270 [info ] [MainThread]: 
[0m12:07:05.950698 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:07:05.954734 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m12:07:05.983669 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m12:07:05.984142 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m12:07:05.984445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:05.998438 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m12:07:05.999583 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m12:07:06.001896 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public'
[0m12:07:06.007961 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:07:06.008416 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m12:07:06.008758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:06.022398 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m12:07:06.022878 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:07:06.023210 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:07:06.026016 [debug] [ThreadPool]: SQL status: SELECT 97 in 0.003 seconds
[0m12:07:06.028911 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m12:07:06.029441 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m12:07:06.087223 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:06.087656 [debug] [MainThread]: On master: BEGIN
[0m12:07:06.088003 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:07:06.100718 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:07:06.101173 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:06.101579 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:07:06.108975 [debug] [MainThread]: SQL status: SELECT 32 in 0.007 seconds
[0m12:07:06.114817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad6b0434-187b-424c-aa33-6bd42c69970f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadd86e6b0>]}
[0m12:07:06.115295 [debug] [MainThread]: On master: ROLLBACK
[0m12:07:06.115761 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:06.116080 [debug] [MainThread]: On master: BEGIN
[0m12:07:06.116581 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:07:06.116886 [debug] [MainThread]: On master: COMMIT
[0m12:07:06.117188 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:06.117487 [debug] [MainThread]: On master: COMMIT
[0m12:07:06.117893 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:07:06.118207 [debug] [MainThread]: On master: Close
[0m12:07:06.121039 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:07:06.121728 [info ] [Thread-1 (]: 1 of 9 START sql table model public.fact_netrunner_cards ....................... [RUN]
[0m12:07:06.122259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.fact_netrunner_cards)
[0m12:07:06.122554 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:07:06.128979 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:07:06.129390 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_netrunner
[0m12:07:06.130683 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_netrunner ............................... [RUN]
[0m12:07:06.130143 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi
[0m12:07:06.129820 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_pokeapi
[0m12:07:06.131202 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:07:06.131643 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_nerd_facts, now model.nerd_facts_dbt.stg_netrunner)
[0m12:07:06.132124 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_swapi ................................... [RUN]
[0m12:07:06.132611 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_pokeapi ................................. [RUN]
[0m12:07:06.172827 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_pokeapi'
[0m12:07:06.159359 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi'
[0m12:07:06.172199 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:07:06.173237 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_pokeapi
[0m12:07:06.175839 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:07:06.148955 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner
[0m12:07:06.173627 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi
[0m12:07:06.178935 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:07:06.179398 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:07:06.181537 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi"
[0m12:07:06.181898 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_pokeapi
[0m12:07:06.182455 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: BEGIN
[0m12:07:06.188745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:06.188343 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_netrunner
[0m12:07:06.194693 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi
[0m12:07:06.203775 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:07:06.218545 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:07:06.219078 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: BEGIN
[0m12:07:06.222676 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:07:06.217570 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi"
[0m12:07:06.225800 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:07:06.226522 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: BEGIN
[0m12:07:06.227000 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:07:06.222244 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:07:06.224741 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m12:07:06.230151 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:07:06.230664 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */

  
    

  create  table "nerd_facts"."public"."fact_netrunner_cards__dbt_tmp"
  
  
    as
  
  (
    WITH raw_data AS (
    SELECT * FROM raw.netrunner_cards
)
SELECT
    c.id,
    c.title AS card_name,
    f.name AS faction_name,  -- ✅ JOIN instead of subquery
    t.name AS type_name,  -- ✅ JOIN instead of subquery
    c.cost::INTEGER,
    c.text AS description
FROM raw_data c
LEFT JOIN raw.netrunner_factions f ON c.faction_code = f.code
LEFT JOIN raw.netrunner_types t ON c.type_code = t.code
  );
  
[0m12:07:06.229590 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:07:06.234426 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner: BEGIN
[0m12:07:06.234941 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:07:06.245164 [debug] [Thread-1 (]: Postgres adapter: Postgres error: invalid input syntax for type integer: "0.0"

[0m12:07:06.245930 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: ROLLBACK
[0m12:07:06.249791 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: Close
[0m12:07:06.255597 [debug] [Thread-1 (]: Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  invalid input syntax for type integer: "0.0"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql
[0m12:07:06.258084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad6b0434-187b-424c-aa33-6bd42c69970f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaddcc7cd0>]}
[0m12:07:06.262565 [debug] [Thread-3 (]: SQL status: BEGIN in 0.040 seconds
[0m12:07:06.262016 [error] [Thread-1 (]: 1 of 9 ERROR creating sql table model public.fact_netrunner_cards .............. [[31mERROR[0m in 0.13s]
[0m12:07:06.263215 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:07:06.265309 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */

  create view "nerd_facts"."public"."stg_pokeapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.pokeapi_pokemon
)
SELECT
    id,
    name AS pokemon_name,
    height::NUMERIC / 10.0 AS height_m,  -- ✅ Convert TEXT to NUMERIC before division
    weight::NUMERIC / 10.0 AS weight_kg, -- ✅ Convert TEXT to NUMERIC before division
    base_experience,
    jsonb_array_length(abilities) AS num_abilities,
    abilities AS abilities_json,
    types->0->>'type' AS primary_type
FROM raw_data
  );
[0m12:07:06.264744 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:07:06.266589 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_netrunner_cards' to be skipped because of status 'error'.  Reason: Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  invalid input syntax for type integer: "0.0"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql.
[0m12:07:06.267038 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function jsonb_array_length(text) does not exist
LINE 16:     jsonb_array_length(abilities) AS num_abilities,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m12:07:06.270305 [debug] [Thread-2 (]: SQL status: BEGIN in 0.035 seconds
[0m12:07:06.270750 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: ROLLBACK
[0m12:07:06.272040 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: Close
[0m12:07:06.271471 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:07:06.272554 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */

  create view "nerd_facts"."public"."stg_netrunner__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.netrunner_cards
)
SELECT
    id,
    title AS card_name,
    faction_code,
    (SELECT name FROM raw.netrunner_factions f WHERE f.code = raw_data.faction_code) AS faction_name,
    type_code,
    (SELECT name FROM raw.netrunner_types t WHERE t.code = raw_data.type_code) AS type_name,
    cost::INTEGER,
    text AS description
FROM raw_data
  );
[0m12:07:06.274416 [debug] [Thread-3 (]: Database Error in model stg_pokeapi (models/staging/stg_pokeapi.sql)
  function jsonb_array_length(text) does not exist
  LINE 16:     jsonb_array_length(abilities) AS num_abilities,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/stg_pokeapi.sql
[0m12:07:06.275131 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad6b0434-187b-424c-aa33-6bd42c69970f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadd940a30>]}
[0m12:07:06.271100 [debug] [Thread-4 (]: SQL status: BEGIN in 0.044 seconds
[0m12:07:06.276525 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:07:06.277042 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */

  create view "nerd_facts"."public"."stg_swapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.swapi_starships
)
SELECT
    id,
    name AS starship_name,
    model,
    manufacturer,
    NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '[^0-9]', '', 'g'), '')::INTEGER AS max_speed,  -- ✅ Extract numbers only
    crew::INTEGER,
    passengers::INTEGER
FROM raw_data
  );
[0m12:07:06.278054 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:07:06.285023 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:07:06.276024 [error] [Thread-3 (]: 3 of 9 ERROR creating sql view model public.stg_pokeapi ........................ [[31mERROR[0m in 0.10s]
[0m12:07:06.286663 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:07:06.291471 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:07:06.292991 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi" rename to "stg_swapi__dbt_backup"
[0m12:07:06.292598 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner" rename to "stg_netrunner__dbt_backup"
[0m12:07:06.292187 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_pokeapi
[0m12:07:06.293825 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:07:06.294515 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:07:06.295041 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_pokeapi' to be skipped because of status 'error'.  Reason: Database Error in model stg_pokeapi (models/staging/stg_pokeapi.sql)
  function jsonb_array_length(text) does not exist
  LINE 16:     jsonb_array_length(abilities) AS num_abilities,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/stg_pokeapi.sql.
[0m12:07:06.298109 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:07:06.301100 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:07:06.301766 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:07:06.302126 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.fact_pokemon
[0m12:07:06.302483 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi__dbt_tmp" rename to "stg_swapi"
[0m12:07:06.302838 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner__dbt_tmp" rename to "stg_netrunner"
[0m12:07:06.303223 [info ] [Thread-1 (]: 5 of 9 SKIP relation public.dim_pokemon_types .................................. [[33mSKIP[0m]
[0m12:07:06.303586 [info ] [Thread-3 (]: 6 of 9 SKIP relation public.fact_pokemon ....................................... [[33mSKIP[0m]
[0m12:07:06.304564 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:07:06.305026 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.fact_pokemon
[0m12:07:06.305365 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:07:06.305941 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:07:06.320273 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:07:06.321929 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:07:06.322394 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:07:06.322813 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:07:06.323177 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:07:06.323547 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:07:06.330108 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m12:07:06.336696 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."stg_swapi__dbt_backup"
[0m12:07:06.337194 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m12:07:06.341338 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:07:06.344017 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner__dbt_backup"
[0m12:07:06.344434 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
drop view if exists "nerd_facts"."public"."stg_swapi__dbt_backup" cascade
[0m12:07:06.345148 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:07:06.346368 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
drop view if exists "nerd_facts"."public"."stg_netrunner__dbt_backup" cascade
[0m12:07:06.348395 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:07:06.350765 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: Close
[0m12:07:06.351206 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:07:06.353054 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner: Close
[0m12:07:06.355090 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad6b0434-187b-424c-aa33-6bd42c69970f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae0896d10>]}
[0m12:07:06.356653 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad6b0434-187b-424c-aa33-6bd42c69970f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadc675a80>]}
[0m12:07:06.356006 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_swapi .............................. [[32mCREATE VIEW[0m in 0.20s]
[0m12:07:06.357403 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_netrunner .......................... [[32mCREATE VIEW[0m in 0.23s]
[0m12:07:06.358010 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi
[0m12:07:06.358487 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_netrunner
[0m12:07:06.359151 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:07:06.359522 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m12:07:06.360148 [info ] [Thread-1 (]: 7 of 9 START sql table model public.dim_starship_manufacturers ................. [RUN]
[0m12:07:06.360976 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:07:06.361344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_netrunner_cards, now model.nerd_facts_dbt.dim_starship_manufacturers)
[0m12:07:06.362263 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:07:06.360663 [info ] [Thread-2 (]: 8 of 9 START sql table model public.fact_starships ............................. [RUN]
[0m12:07:06.365573 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner, now model.nerd_facts_dbt.fact_starships)
[0m12:07:06.365066 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:07:06.366536 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:07:06.361930 [info ] [Thread-4 (]: 9 of 9 START sql table model public.dim_netrunner_factions ..................... [RUN]
[0m12:07:06.365957 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m12:07:06.372417 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:07:06.377414 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:07:06.376718 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m12:07:06.377867 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: BEGIN
[0m12:07:06.372924 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi, now model.nerd_facts_dbt.dim_netrunner_factions)
[0m12:07:06.379125 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:07:06.378775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:06.378458 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m12:07:06.381986 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:07:06.388623 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m12:07:06.391606 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:07:06.397567 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:07:06.405283 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:07:06.405807 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m12:07:06.406961 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:07:06.407626 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:07:06.408124 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: BEGIN
[0m12:07:06.406474 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m12:07:06.408585 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:07:06.409098 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:07:06.410445 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */

  
    

  create  table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp"
  
  
    as
  
  (
    WITH manufacturers AS (
    SELECT DISTINCT
        manufacturer,
        COUNT(*) AS num_starships
    FROM "nerd_facts"."public"."stg_swapi"
    GROUP BY manufacturer
)
SELECT * FROM manufacturers
  );
  
[0m12:07:06.423489 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.011 seconds
[0m12:07:06.430567 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:07:06.431339 [debug] [Thread-2 (]: SQL status: BEGIN in 0.024 seconds
[0m12:07:06.432325 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:07:06.432759 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  
    

  create  table "nerd_facts"."public"."fact_starships__dbt_tmp"
  
  
    as
  
  (
    WITH starships AS (
    SELECT * FROM "nerd_facts"."public"."stg_swapi"
)
SELECT
    id,
    starship_name,
    model,
    manufacturer,
    max_speed,
    crew,
    passengers
FROM starships
  );
  
[0m12:07:06.431844 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers" rename to "dim_starship_manufacturers__dbt_backup"
[0m12:07:06.436097 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:07:06.440129 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:07:06.440642 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp" rename to "dim_starship_manufacturers"
[0m12:07:06.441046 [debug] [Thread-4 (]: SQL status: BEGIN in 0.032 seconds
[0m12:07:06.441565 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:07:06.441965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:07:06.442254 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */

  
    

  create  table "nerd_facts"."public"."dim_netrunner_factions__dbt_tmp"
  
  
    as
  
  (
    WITH factions AS (
    SELECT DISTINCT ON (faction_name)
        faction_name,
        COUNT(*) OVER (PARTITION BY faction_name) AS num_cards
    FROM "nerd_facts"."public"."stg_netrunner"
)
SELECT * FROM factions
  );
  
[0m12:07:06.447796 [debug] [Thread-2 (]: Postgres adapter: Postgres error: invalid input syntax for type integer: "30-165"

[0m12:07:06.448792 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: ROLLBACK
[0m12:07:06.449505 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m12:07:06.454040 [debug] [Thread-2 (]: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:07:06.454944 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad6b0434-187b-424c-aa33-6bd42c69970f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadc675a80>]}
[0m12:07:06.455823 [error] [Thread-2 (]: 8 of 9 ERROR creating sql table model public.fact_starships .................... [[31mERROR[0m in 0.09s]
[0m12:07:06.456663 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m12:07:06.457339 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_starships' to be skipped because of status 'error'.  Reason: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql.
[0m12:07:06.448208 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:07:06.458051 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:07:06.458526 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:07:06.461596 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:07:06.466722 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup"
[0m12:07:06.470217 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:07:06.470803 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
drop table if exists "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup" cascade
[0m12:07:06.474633 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:07:06.476050 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: Close
[0m12:07:06.477924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad6b0434-187b-424c-aa33-6bd42c69970f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadc683670>]}
[0m12:07:06.478821 [info ] [Thread-1 (]: 7 of 9 OK created sql table model public.dim_starship_manufacturers ............ [[32mSELECT 27[0m in 0.12s]
[0m12:07:06.479602 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:07:06.486599 [debug] [Thread-4 (]: Postgres adapter: Postgres error: more than one row returned by a subquery used as an expression

[0m12:07:06.487482 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: ROLLBACK
[0m12:07:06.488119 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: Close
[0m12:07:06.489384 [debug] [Thread-4 (]: Database Error in model dim_netrunner_factions (models/marts/dim_netrunner_factions.sql)
  more than one row returned by a subquery used as an expression
  compiled code at target/run/nerd_facts_dbt/models/marts/dim_netrunner_factions.sql
[0m12:07:06.490201 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad6b0434-187b-424c-aa33-6bd42c69970f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadd940a30>]}
[0m12:07:06.491038 [error] [Thread-4 (]: 9 of 9 ERROR creating sql table model public.dim_netrunner_factions ............ [[31mERROR[0m in 0.12s]
[0m12:07:06.492129 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:07:06.492760 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.dim_netrunner_factions' to be skipped because of status 'error'.  Reason: Database Error in model dim_netrunner_factions (models/marts/dim_netrunner_factions.sql)
  more than one row returned by a subquery used as an expression
  compiled code at target/run/nerd_facts_dbt/models/marts/dim_netrunner_factions.sql.
[0m12:07:06.494356 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:06.494683 [debug] [MainThread]: On master: BEGIN
[0m12:07:06.494951 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:07:06.507623 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:07:06.508097 [debug] [MainThread]: On master: COMMIT
[0m12:07:06.508456 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:06.508799 [debug] [MainThread]: On master: COMMIT
[0m12:07:06.509189 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:07:06.509514 [debug] [MainThread]: On master: Close
[0m12:07:06.510178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:06.510557 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_starships' was properly closed.
[0m12:07:06.510901 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_starship_manufacturers' was properly closed.
[0m12:07:06.511233 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_netrunner_factions' was properly closed.
[0m12:07:06.511561 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_pokeapi' was properly closed.
[0m12:07:06.512057 [info ] [MainThread]: 
[0m12:07:06.512460 [info ] [MainThread]: Finished running 6 table models, 3 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m12:07:06.514056 [debug] [MainThread]: Command end result
[0m12:07:06.537946 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:07:06.539548 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:07:06.546055 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m12:07:06.546475 [info ] [MainThread]: 
[0m12:07:06.546883 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m12:07:06.547230 [info ] [MainThread]: 
[0m12:07:06.547610 [error] [MainThread]:   Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  invalid input syntax for type integer: "0.0"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql
[0m12:07:06.547928 [info ] [MainThread]: 
[0m12:07:06.548308 [error] [MainThread]:   Database Error in model stg_pokeapi (models/staging/stg_pokeapi.sql)
  function jsonb_array_length(text) does not exist
  LINE 16:     jsonb_array_length(abilities) AS num_abilities,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/stg_pokeapi.sql
[0m12:07:06.548655 [info ] [MainThread]: 
[0m12:07:06.549017 [error] [MainThread]:   Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:07:06.549320 [info ] [MainThread]: 
[0m12:07:06.549700 [error] [MainThread]:   Database Error in model dim_netrunner_factions (models/marts/dim_netrunner_factions.sql)
  more than one row returned by a subquery used as an expression
  compiled code at target/run/nerd_facts_dbt/models/marts/dim_netrunner_factions.sql
[0m12:07:06.550036 [info ] [MainThread]: 
[0m12:07:06.550373 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=4 SKIP=2 TOTAL=9
[0m12:07:06.551192 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2861497, "process_in_blocks": "1656", "process_kernel_time": 0.096038, "process_mem_max_rss": "114484", "process_out_blocks": "2904", "process_user_time": 2.127962}
[0m12:07:06.551601 [debug] [MainThread]: Command `dbt run` failed at 12:07:06.551508 after 1.29 seconds
[0m12:07:06.551981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadf644970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadfae6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadc64fbe0>]}
[0m12:07:06.552354 [debug] [MainThread]: Flushing usage events
[0m12:07:07.065409 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:08:43.890207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5cea4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5be5fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5be5fd30>]}


============================== 12:08:43.892632 | 8736f6a5-5f5a-48d0-9fb4-ce3c51c1f043 ==============================
[0m12:08:43.892632 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:08:43.893085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:08:43.978344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8736f6a5-5f5a-48d0-9fb4-ce3c51c1f043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5ddfbf10>]}
[0m12:08:43.996347 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1499627, "process_in_blocks": "88", "process_kernel_time": 0.063925, "process_mem_max_rss": "88732", "process_out_blocks": "8", "process_user_time": 1.01598}
[0m12:08:43.996782 [debug] [MainThread]: Command `dbt clean` succeeded at 12:08:43.996695 after 0.15 seconds
[0m12:08:43.997109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5cea4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5de26350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5ddfbf10>]}
[0m12:08:43.997498 [debug] [MainThread]: Flushing usage events
[0m12:08:44.400312 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:08:47.750539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ac88c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ad703b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ad703be0>]}


============================== 12:08:47.752972 | 3a1e5b00-2cb5-48e4-9e4a-82ea04df221a ==============================
[0m12:08:47.752972 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:08:47.753533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:08:47.887315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a1e5b00-2cb5-48e4-9e4a-82ea04df221a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ab904100>]}
[0m12:08:47.937652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a1e5b00-2cb5-48e4-9e4a-82ea04df221a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ad703b50>]}
[0m12:08:47.938359 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:08:48.010567 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:08:48.011153 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:08:48.011476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3a1e5b00-2cb5-48e4-9e4a-82ea04df221a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ad6de080>]}
[0m12:08:48.892206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a1e5b00-2cb5-48e4-9e4a-82ea04df221a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25aa6743d0>]}
[0m12:08:48.961955 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:08:48.964339 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:08:48.974673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a1e5b00-2cb5-48e4-9e4a-82ea04df221a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25aa66eb90>]}
[0m12:08:48.975227 [info ] [MainThread]: Found 9 models, 11 sources, 433 macros
[0m12:08:48.975642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a1e5b00-2cb5-48e4-9e4a-82ea04df221a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25aa66ebf0>]}
[0m12:08:48.977485 [info ] [MainThread]: 
[0m12:08:48.977869 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:08:48.978181 [info ] [MainThread]: 
[0m12:08:48.978679 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:08:48.982836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m12:08:49.012519 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m12:08:49.012972 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m12:08:49.013284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:49.026670 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m12:08:49.027946 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m12:08:49.031067 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_public)
[0m12:08:49.037101 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:08:49.037497 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m12:08:49.037804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:49.050794 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:08:49.051156 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:08:49.051419 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:08:49.054370 [debug] [ThreadPool]: SQL status: SELECT 97 in 0.003 seconds
[0m12:08:49.057018 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m12:08:49.057500 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m12:08:49.073580 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:49.074010 [debug] [MainThread]: On master: BEGIN
[0m12:08:49.074259 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:08:49.086853 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:08:49.087250 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:49.087599 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:08:49.094704 [debug] [MainThread]: SQL status: SELECT 32 in 0.007 seconds
[0m12:08:49.099798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a1e5b00-2cb5-48e4-9e4a-82ea04df221a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25aa667700>]}
[0m12:08:49.100338 [debug] [MainThread]: On master: ROLLBACK
[0m12:08:49.100953 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:49.101273 [debug] [MainThread]: On master: BEGIN
[0m12:08:49.101748 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:08:49.102041 [debug] [MainThread]: On master: COMMIT
[0m12:08:49.102286 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:49.102503 [debug] [MainThread]: On master: COMMIT
[0m12:08:49.102800 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:08:49.103040 [debug] [MainThread]: On master: Close
[0m12:08:49.106445 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:08:49.106985 [info ] [Thread-1 (]: 1 of 9 START sql table model public.fact_netrunner_cards ....................... [RUN]
[0m12:08:49.107440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.fact_netrunner_cards)
[0m12:08:49.107727 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:08:49.114809 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_netrunner
[0m12:08:49.115521 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_pokeapi
[0m12:08:49.115793 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi
[0m12:08:49.115223 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:08:49.116270 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_netrunner ............................... [RUN]
[0m12:08:49.116729 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_pokeapi ................................. [RUN]
[0m12:08:49.118661 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_pokeapi'
[0m12:08:49.118146 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_netrunner'
[0m12:08:49.118957 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_pokeapi
[0m12:08:49.121096 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:08:49.119260 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner
[0m12:08:49.117309 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_swapi ................................... [RUN]
[0m12:08:49.121495 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:08:49.123232 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:08:49.123727 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_pokeapi
[0m12:08:49.124270 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi'
[0m12:08:49.156375 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:08:49.162924 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_netrunner
[0m12:08:49.163368 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi
[0m12:08:49.174203 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:08:49.175077 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:08:49.179788 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:08:49.181579 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi"
[0m12:08:49.182079 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: BEGIN
[0m12:08:49.182676 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi
[0m12:08:49.183091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:49.188395 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:08:49.183419 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:08:49.189810 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: BEGIN
[0m12:08:49.190151 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:08:49.187670 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi"
[0m12:08:49.191704 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:08:49.192083 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: BEGIN
[0m12:08:49.192427 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:08:49.188706 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner: BEGIN
[0m12:08:49.193628 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:08:49.209671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m12:08:49.210101 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:08:49.210411 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */

  
    

  create  table "nerd_facts"."public"."fact_netrunner_cards__dbt_tmp"
  
  
    as
  
  (
    WITH raw_data AS (
    SELECT * FROM raw.netrunner_cards
)
SELECT
    c.id,
    c.title AS card_name,
    f.name AS faction_name,  -- ✅ JOIN instead of subquery
    t.name AS type_name,  -- ✅ JOIN instead of subquery
    c.cost::INTEGER,
    c.text AS description
FROM raw_data c
LEFT JOIN raw.netrunner_factions f ON c.faction_code = f.code
LEFT JOIN raw.netrunner_types t ON c.type_code = t.code
  );
  
[0m12:08:49.217793 [debug] [Thread-1 (]: Postgres adapter: Postgres error: invalid input syntax for type integer: "0.0"

[0m12:08:49.218239 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: ROLLBACK
[0m12:08:49.218778 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: Close
[0m12:08:49.220389 [debug] [Thread-2 (]: SQL status: BEGIN in 0.027 seconds
[0m12:08:49.220875 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:08:49.221885 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */

  create view "nerd_facts"."public"."stg_netrunner__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.netrunner_cards
)
SELECT
    id,
    title AS card_name,
    faction_code,
    type_code,
    cost::NUMERIC::INTEGER AS cost,  -- ✅ Double cast to handle decimals safely
    text AS description
FROM raw_data
  );
[0m12:08:49.223623 [debug] [Thread-1 (]: Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  invalid input syntax for type integer: "0.0"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql
[0m12:08:49.221572 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m12:08:49.225752 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:08:49.226830 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */

  create view "nerd_facts"."public"."stg_pokeapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.pokeapi_pokemon
)
SELECT
    id,
    name AS pokemon_name,
    height::NUMERIC / 10.0 AS height_m,
    weight::NUMERIC / 10.0 AS weight_kg,
    base_experience,
    jsonb_array_length(abilities::JSONB) AS num_abilities,  -- ✅ Cast abilities to JSONB
    abilities::JSONB AS abilities_json,  -- ✅ Ensure abilities are stored as JSONB
    types->0->>'type' AS primary_type
FROM raw_data
  );
[0m12:08:49.226181 [debug] [Thread-4 (]: SQL status: BEGIN in 0.034 seconds
[0m12:08:49.227323 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:08:49.225175 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m12:08:49.227622 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */

  create view "nerd_facts"."public"."stg_swapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.swapi_starships
)
SELECT
    id,
    name AS starship_name,
    model,
    manufacturer,
    NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '[^0-9]', '', 'g'), '')::INTEGER AS max_speed,  -- ✅ Extract numbers only
    crew::INTEGER,
    passengers::INTEGER
FROM raw_data
  );
[0m12:08:49.226460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a1e5b00-2cb5-48e4-9e4a-82ea04df221a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ac9aa3e0>]}
[0m12:08:49.227943 [debug] [Thread-3 (]: Postgres adapter: Postgres error: operator does not exist: text -> integer
LINE 18:     types->0->>'type' AS primary_type
                  ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m12:08:49.234273 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:08:49.237329 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: ROLLBACK
[0m12:08:49.237711 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m12:08:49.236905 [error] [Thread-1 (]: 1 of 9 ERROR creating sql table model public.fact_netrunner_cards .............. [[31mERROR[0m in 0.12s]
[0m12:08:49.238647 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: Close
[0m12:08:49.242611 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:08:49.241991 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:08:49.238151 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner" rename to "stg_netrunner__dbt_backup"
[0m12:08:49.245738 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_netrunner_cards' to be skipped because of status 'error'.  Reason: Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  invalid input syntax for type integer: "0.0"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql.
[0m12:08:49.246233 [debug] [Thread-3 (]: Database Error in model stg_pokeapi (models/staging/stg_pokeapi.sql)
  operator does not exist: text -> integer
  LINE 18:     types->0->>'type' AS primary_type
                    ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/stg_pokeapi.sql
[0m12:08:49.246703 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi" rename to "stg_swapi__dbt_backup"
[0m12:08:49.247738 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a1e5b00-2cb5-48e4-9e4a-82ea04df221a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25a9875210>]}
[0m12:08:49.248576 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:08:49.249171 [error] [Thread-3 (]: 3 of 9 ERROR creating sql view model public.stg_pokeapi ........................ [[31mERROR[0m in 0.13s]
[0m12:08:49.252937 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_pokeapi
[0m12:08:49.252385 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:08:49.253383 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_pokeapi' to be skipped because of status 'error'.  Reason: Database Error in model stg_pokeapi (models/staging/stg_pokeapi.sql)
  operator does not exist: text -> integer
  LINE 18:     types->0->>'type' AS primary_type
                    ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/stg_pokeapi.sql.
[0m12:08:49.249572 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:08:49.253733 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi__dbt_tmp" rename to "stg_swapi"
[0m12:08:49.257617 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:08:49.258724 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner__dbt_tmp" rename to "stg_netrunner"
[0m12:08:49.258368 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.fact_pokemon
[0m12:08:49.257995 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:08:49.260154 [info ] [Thread-1 (]: 5 of 9 SKIP relation public.dim_pokemon_types .................................. [[33mSKIP[0m]
[0m12:08:49.259455 [info ] [Thread-3 (]: 6 of 9 SKIP relation public.fact_pokemon ....................................... [[33mSKIP[0m]
[0m12:08:49.260947 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.fact_pokemon
[0m12:08:49.260608 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:08:49.259118 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:08:49.259786 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:49.274107 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:08:49.275550 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:08:49.276010 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:08:49.276392 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:08:49.276727 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:08:49.277019 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:08:49.279667 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m12:08:49.285665 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."stg_swapi__dbt_backup"
[0m12:08:49.286081 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m12:08:49.289934 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:08:49.292303 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner__dbt_backup"
[0m12:08:49.292696 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
drop view if exists "nerd_facts"."public"."stg_swapi__dbt_backup" cascade
[0m12:08:49.293407 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:08:49.294506 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
drop view if exists "nerd_facts"."public"."stg_netrunner__dbt_backup" cascade
[0m12:08:49.296618 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:08:49.298851 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: Close
[0m12:08:49.299557 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a1e5b00-2cb5-48e4-9e4a-82ea04df221a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25adacacb0>]}
[0m12:08:49.300126 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_swapi .............................. [[32mCREATE VIEW[0m in 0.18s]
[0m12:08:49.300701 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi
[0m12:08:49.301106 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m12:08:49.302283 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner: Close
[0m12:08:49.305162 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a1e5b00-2cb5-48e4-9e4a-82ea04df221a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25a99069b0>]}
[0m12:08:49.305626 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:08:49.306293 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_netrunner .......................... [[32mCREATE VIEW[0m in 0.19s]
[0m12:08:49.306783 [info ] [Thread-3 (]: 7 of 9 START sql table model public.dim_starship_manufacturers ................. [RUN]
[0m12:08:49.308231 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_pokeapi, now model.nerd_facts_dbt.dim_starship_manufacturers)
[0m12:08:49.307750 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_netrunner
[0m12:08:49.308543 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:08:49.307268 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m12:08:49.311173 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:08:49.311760 [info ] [Thread-1 (]: 8 of 9 START sql table model public.fact_starships ............................. [RUN]
[0m12:08:49.312390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_netrunner_cards, now model.nerd_facts_dbt.fact_starships)
[0m12:08:49.312781 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:08:49.313062 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:08:49.313381 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m12:08:49.318179 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:08:49.321830 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:08:49.321138 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m12:08:49.322175 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: BEGIN
[0m12:08:49.318694 [info ] [Thread-4 (]: 9 of 9 START sql table model public.dim_netrunner_factions ..................... [RUN]
[0m12:08:49.322642 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m12:08:49.322981 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:08:49.323399 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi, now model.nerd_facts_dbt.dim_netrunner_factions)
[0m12:08:49.330095 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:08:49.329160 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m12:08:49.333086 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:08:49.333477 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m12:08:49.333791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:49.332445 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:08:49.341837 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:08:49.346623 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:08:49.347192 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:08:49.347496 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: BEGIN
[0m12:08:49.347762 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:08:49.348704 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m12:08:49.349086 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:08:49.349412 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  
    

  create  table "nerd_facts"."public"."fact_starships__dbt_tmp"
  
  
    as
  
  (
    WITH starships AS (
    SELECT * FROM "nerd_facts"."public"."stg_swapi"
)
SELECT
    id,
    starship_name,
    model,
    manufacturer,
    max_speed,
    crew,
    passengers
FROM starships
  );
  
[0m12:08:49.353089 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m12:08:49.353619 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:08:49.353967 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */

  
    

  create  table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp"
  
  
    as
  
  (
    WITH manufacturers AS (
    SELECT DISTINCT
        manufacturer,
        COUNT(*) AS num_starships
    FROM "nerd_facts"."public"."stg_swapi"
    GROUP BY manufacturer
)
SELECT * FROM manufacturers
  );
  
[0m12:08:49.357328 [debug] [Thread-1 (]: Postgres adapter: Postgres error: invalid input syntax for type integer: "30-165"

[0m12:08:49.357832 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: ROLLBACK
[0m12:08:49.358407 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m12:08:49.360741 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m12:08:49.361260 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:08:49.361655 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */

  
    

  create  table "nerd_facts"."public"."dim_netrunner_factions__dbt_tmp"
  
  
    as
  
  (
    WITH factions AS (
    SELECT DISTINCT ON (faction_name)
        faction_name,
        COUNT(*) OVER (PARTITION BY faction_name) AS num_cards
    FROM "nerd_facts"."public"."stg_netrunner"
)
SELECT * FROM factions
  );
  
[0m12:08:49.362496 [debug] [Thread-1 (]: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:08:49.363018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a1e5b00-2cb5-48e4-9e4a-82ea04df221a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25a875bd00>]}
[0m12:08:49.363604 [error] [Thread-1 (]: 8 of 9 ERROR creating sql table model public.fact_starships .................... [[31mERROR[0m in 0.05s]
[0m12:08:49.364015 [debug] [Thread-3 (]: SQL status: SELECT 27 in 0.010 seconds
[0m12:08:49.364430 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "faction_name" does not exist
LINE 14:         faction_name,
                 ^
HINT:  Perhaps you meant to reference the column "stg_netrunner.faction_code".

[0m12:08:49.368474 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: ROLLBACK
[0m12:08:49.368057 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:08:49.364855 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m12:08:49.369096 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: Close
[0m12:08:49.370891 [debug] [Thread-4 (]: Database Error in model dim_netrunner_factions (models/marts/dim_netrunner_factions.sql)
  column "faction_name" does not exist
  LINE 14:         faction_name,
                   ^
  HINT:  Perhaps you meant to reference the column "stg_netrunner.faction_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/dim_netrunner_factions.sql
[0m12:08:49.371395 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a1e5b00-2cb5-48e4-9e4a-82ea04df221a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25a995cdc0>]}
[0m12:08:49.370019 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_starships' to be skipped because of status 'error'.  Reason: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql.
[0m12:08:49.369400 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers" rename to "dim_starship_manufacturers__dbt_backup"
[0m12:08:49.372115 [error] [Thread-4 (]: 9 of 9 ERROR creating sql table model public.dim_netrunner_factions ............ [[31mERROR[0m in 0.05s]
[0m12:08:49.372978 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:08:49.373491 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:08:49.376153 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:08:49.376684 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.dim_netrunner_factions' to be skipped because of status 'error'.  Reason: Database Error in model dim_netrunner_factions (models/marts/dim_netrunner_factions.sql)
  column "faction_name" does not exist
  LINE 14:         faction_name,
                   ^
  HINT:  Perhaps you meant to reference the column "stg_netrunner.faction_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/dim_netrunner_factions.sql.
[0m12:08:49.377033 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp" rename to "dim_starship_manufacturers"
[0m12:08:49.377721 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:08:49.381844 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:08:49.382227 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:08:49.382505 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:08:49.384868 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m12:08:49.387148 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup"
[0m12:08:49.389260 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:08:49.389624 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
drop table if exists "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup" cascade
[0m12:08:49.392985 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:08:49.394248 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: Close
[0m12:08:49.394935 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a1e5b00-2cb5-48e4-9e4a-82ea04df221a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25a877bc70>]}
[0m12:08:49.395486 [info ] [Thread-3 (]: 7 of 9 OK created sql table model public.dim_starship_manufacturers ............ [[32mSELECT 27[0m in 0.09s]
[0m12:08:49.396113 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:08:49.397387 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:49.397719 [debug] [MainThread]: On master: BEGIN
[0m12:08:49.397954 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:08:49.410529 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:08:49.411081 [debug] [MainThread]: On master: COMMIT
[0m12:08:49.411405 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:49.411662 [debug] [MainThread]: On master: COMMIT
[0m12:08:49.412055 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:08:49.412353 [debug] [MainThread]: On master: Close
[0m12:08:49.412850 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:08:49.413072 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_starships' was properly closed.
[0m12:08:49.413261 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_netrunner' was properly closed.
[0m12:08:49.413495 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_starship_manufacturers' was properly closed.
[0m12:08:49.413697 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_netrunner_factions' was properly closed.
[0m12:08:49.414013 [info ] [MainThread]: 
[0m12:08:49.414275 [info ] [MainThread]: Finished running 6 table models, 3 view models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m12:08:49.415556 [debug] [MainThread]: Command end result
[0m12:08:49.478764 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:08:49.480200 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:08:49.485804 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m12:08:49.486141 [info ] [MainThread]: 
[0m12:08:49.486460 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m12:08:49.486717 [info ] [MainThread]: 
[0m12:08:49.486999 [error] [MainThread]:   Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  invalid input syntax for type integer: "0.0"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql
[0m12:08:49.487234 [info ] [MainThread]: 
[0m12:08:49.487502 [error] [MainThread]:   Database Error in model stg_pokeapi (models/staging/stg_pokeapi.sql)
  operator does not exist: text -> integer
  LINE 18:     types->0->>'type' AS primary_type
                    ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/stg_pokeapi.sql
[0m12:08:49.487729 [info ] [MainThread]: 
[0m12:08:49.487985 [error] [MainThread]:   Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:08:49.488357 [info ] [MainThread]: 
[0m12:08:49.488656 [error] [MainThread]:   Database Error in model dim_netrunner_factions (models/marts/dim_netrunner_factions.sql)
  column "faction_name" does not exist
  LINE 14:         faction_name,
                   ^
  HINT:  Perhaps you meant to reference the column "stg_netrunner.faction_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/dim_netrunner_factions.sql
[0m12:08:49.488905 [info ] [MainThread]: 
[0m12:08:49.489172 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=4 SKIP=2 TOTAL=9
[0m12:08:49.489893 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7842261, "process_in_blocks": "0", "process_kernel_time": 0.0918, "process_mem_max_rss": "114924", "process_out_blocks": "2896", "process_user_time": 2.620603}
[0m12:08:49.490260 [debug] [MainThread]: Command `dbt run` failed at 12:08:49.490159 after 1.78 seconds
[0m12:08:49.490557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ac88c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25a8735db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25a8735d50>]}
[0m12:08:49.490856 [debug] [MainThread]: Flushing usage events
[0m12:08:49.955245 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:10.779499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5671560940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56705177f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5670517850>]}


============================== 12:11:10.781709 | 7f6f0f2b-8fea-490f-b792-60cec0873b6a ==============================
[0m12:11:10.781709 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:11:10.782207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:11:10.905343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f6f0f2b-8fea-490f-b792-60cec0873b6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5670609c00>]}
[0m12:11:10.953388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f6f0f2b-8fea-490f-b792-60cec0873b6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56706084c0>]}
[0m12:11:10.954133 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:11:11.027850 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:11:11.119862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:11:11.120480 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/fact_netrunner_cards.sql
[0m12:11:11.120844 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/stg_netrunner.sql
[0m12:11:11.271097 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nerd_facts_dbt.fact_netrunner_cards' (models/marts/fact_netrunner_cards.sql) depends on a node named 'stg_netrunner_factions' which was not found
[0m12:11:11.272043 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5355715, "process_in_blocks": "0", "process_kernel_time": 0.076077, "process_mem_max_rss": "101552", "process_out_blocks": "24", "process_user_time": 1.413122}
[0m12:11:11.272447 [debug] [MainThread]: Command `dbt run` failed at 12:11:11.272350 after 0.54 seconds
[0m12:11:11.272760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5671560940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566f834400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566f834460>]}
[0m12:11:11.273091 [debug] [MainThread]: Flushing usage events
[0m12:11:11.731852 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:13:06.660144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27843b08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27833637f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2783363850>]}


============================== 12:13:06.662342 | fff7a3bd-ee89-4bfd-9c16-9f3fe972f78d ==============================
[0m12:13:06.662342 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:13:06.662768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:13:06.786730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fff7a3bd-ee89-4bfd-9c16-9f3fe972f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2783717700>]}
[0m12:13:06.833513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fff7a3bd-ee89-4bfd-9c16-9f3fe972f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2785232020>]}
[0m12:13:06.834211 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:13:06.907829 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:13:06.997339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m12:13:06.997897 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/stg_netrunner_factions.sql
[0m12:13:06.998255 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/fact_netrunner_cards.sql
[0m12:13:06.998565 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/stg_netrunner.sql
[0m12:13:07.207160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fff7a3bd-ee89-4bfd-9c16-9f3fe972f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278203e380>]}
[0m12:13:07.269872 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:13:07.271889 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:13:07.280954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fff7a3bd-ee89-4bfd-9c16-9f3fe972f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278205ba60>]}
[0m12:13:07.281466 [info ] [MainThread]: Found 10 models, 11 sources, 433 macros
[0m12:13:07.281774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fff7a3bd-ee89-4bfd-9c16-9f3fe972f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2782058cd0>]}
[0m12:13:07.283298 [info ] [MainThread]: 
[0m12:13:07.283617 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:13:07.283887 [info ] [MainThread]: 
[0m12:13:07.284321 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:13:07.288225 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m12:13:07.316776 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m12:13:07.317225 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m12:13:07.317544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:07.332380 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m12:13:07.334004 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m12:13:07.336436 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public'
[0m12:13:07.342933 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:13:07.343355 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m12:13:07.343672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:07.356968 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:13:07.357410 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:13:07.357790 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:13:07.360677 [debug] [ThreadPool]: SQL status: SELECT 97 in 0.003 seconds
[0m12:13:07.364011 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m12:13:07.364530 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m12:13:07.421756 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:07.422169 [debug] [MainThread]: On master: BEGIN
[0m12:13:07.422483 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:13:07.435080 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:13:07.435529 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:07.435911 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:13:07.443857 [debug] [MainThread]: SQL status: SELECT 30 in 0.008 seconds
[0m12:13:07.449603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fff7a3bd-ee89-4bfd-9c16-9f3fe972f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2786c77ac0>]}
[0m12:13:07.450054 [debug] [MainThread]: On master: ROLLBACK
[0m12:13:07.450534 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:07.450847 [debug] [MainThread]: On master: BEGIN
[0m12:13:07.451341 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:13:07.451639 [debug] [MainThread]: On master: COMMIT
[0m12:13:07.451937 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:07.452230 [debug] [MainThread]: On master: COMMIT
[0m12:13:07.452602 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:13:07.452910 [debug] [MainThread]: On master: Close
[0m12:13:07.456864 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_netrunner
[0m12:13:07.457317 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:13:07.457737 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_pokeapi
[0m12:13:07.458052 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi
[0m12:13:07.459533 [info ] [Thread-3 (]: 3 of 10 START sql view model public.stg_pokeapi ................................ [RUN]
[0m12:13:07.459127 [info ] [Thread-2 (]: 2 of 10 START sql view model public.stg_netrunner_factions ..................... [RUN]
[0m12:13:07.460589 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_pokeapi'
[0m12:13:07.461473 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_pokeapi
[0m12:13:07.460004 [info ] [Thread-4 (]: 4 of 10 START sql view model public.stg_swapi .................................. [RUN]
[0m12:13:07.461100 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_nerd_facts, now model.nerd_facts_dbt.stg_netrunner_factions)
[0m12:13:07.468768 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:13:07.468381 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi'
[0m12:13:07.471109 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi
[0m12:13:07.472817 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi"
[0m12:13:07.470737 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:13:07.467832 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:13:07.458497 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_netrunner .............................. [RUN]
[0m12:13:07.473342 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi
[0m12:13:07.473985 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_pokeapi
[0m12:13:07.474396 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:13:07.474910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.stg_netrunner)
[0m12:13:07.533644 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi"
[0m12:13:07.534174 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:13:07.534556 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner
[0m12:13:07.535598 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:13:07.537887 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:13:07.538496 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:13:07.540100 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: BEGIN
[0m12:13:07.540410 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:13:07.539320 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:13:07.541273 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: BEGIN
[0m12:13:07.541591 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:13:07.539749 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:13:07.540785 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_netrunner
[0m12:13:07.543192 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: BEGIN
[0m12:13:07.558640 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:13:07.558060 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:13:07.561931 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:13:07.562371 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: BEGIN
[0m12:13:07.562744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:13:07.560289 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m12:13:07.564889 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:13:07.569906 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */

  create view "nerd_facts"."public"."stg_pokeapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.pokeapi_pokemon
)
SELECT
    id,
    name AS pokemon_name,
    height::NUMERIC / 10.0 AS height_m,
    weight::NUMERIC / 10.0 AS weight_kg,
    base_experience,
    jsonb_array_length(abilities::JSONB) AS num_abilities,  -- ✅ Cast abilities to JSONB
    abilities::JSONB AS abilities_json,  -- ✅ Ensure abilities are stored as JSONB
    types->0->>'type' AS primary_type
FROM raw_data
  );
[0m12:13:07.573048 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m12:13:07.577760 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:13:07.578082 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */

  create view "nerd_facts"."public"."stg_netrunner_factions__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT DISTINCT code, name
    FROM raw.netrunner_factions
)
SELECT
    code AS faction_code,
    name AS faction_name
FROM raw_data
  );
[0m12:13:07.574581 [debug] [Thread-3 (]: Postgres adapter: Postgres error: operator does not exist: text -> integer
LINE 18:     types->0->>'type' AS primary_type
                  ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m12:13:07.578447 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: ROLLBACK
[0m12:13:07.580918 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: Close
[0m12:13:07.574214 [debug] [Thread-4 (]: SQL status: BEGIN in 0.034 seconds
[0m12:13:07.583729 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:13:07.584687 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:13:07.585061 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */

  create view "nerd_facts"."public"."stg_swapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.swapi_starships
)
SELECT
    id,
    name AS starship_name,
    model,
    manufacturer,
    NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '[^0-9]', '', 'g'), '')::INTEGER AS max_speed,  -- ✅ Extract numbers only
    crew::INTEGER,
    passengers::INTEGER
FROM raw_data
  );
[0m12:13:07.586434 [debug] [Thread-3 (]: Database Error in model stg_pokeapi (models/staging/stg_pokeapi.sql)
  operator does not exist: text -> integer
  LINE 18:     types->0->>'type' AS primary_type
                    ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/stg_pokeapi.sql
[0m12:13:07.593876 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fff7a3bd-ee89-4bfd-9c16-9f3fe972f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2782a82dd0>]}
[0m12:13:07.591986 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:13:07.595691 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
alter table "nerd_facts"."public"."stg_netrunner_factions__dbt_tmp" rename to "stg_netrunner_factions"
[0m12:13:07.595005 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m12:13:07.596795 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:13:07.594560 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model public.stg_pokeapi ....................... [[31mERROR[0m in 0.13s]
[0m12:13:07.596482 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:13:07.597121 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */

  create view "nerd_facts"."public"."stg_netrunner__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.netrunner_cards
)
SELECT
    id,
    title AS card_name,
    faction_code,
    type_code,
    NULLIF(cost, '')::NUMERIC::INTEGER AS cost,  -- ✅ Double casting to handle decimals safely
    text AS description
FROM raw_data
  );
[0m12:13:07.595305 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m12:13:07.597762 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_pokeapi
[0m12:13:07.609641 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: COMMIT
[0m12:13:07.614217 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:13:07.614758 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:13:07.615317 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_pokeapi' to be skipped because of status 'error'.  Reason: Database Error in model stg_pokeapi (models/staging/stg_pokeapi.sql)
  operator does not exist: text -> integer
  LINE 18:     types->0->>'type' AS primary_type
                    ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/stg_pokeapi.sql.
[0m12:13:07.615786 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:13:07.616182 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi" rename to "stg_swapi__dbt_backup"
[0m12:13:07.619306 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:13:07.620328 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:13:07.622086 [info ] [Thread-3 (]: 5 of 10 SKIP relation public.dim_pokemon_types ................................. [[33mSKIP[0m]
[0m12:13:07.622691 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:13:07.621700 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:13:07.623199 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.fact_pokemon
[0m12:13:07.628138 [info ] [Thread-3 (]: 6 of 10 SKIP relation public.fact_pokemon ...................................... [[33mSKIP[0m]
[0m12:13:07.628739 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.fact_pokemon
[0m12:13:07.621181 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner" rename to "stg_netrunner__dbt_backup"
[0m12:13:07.620675 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: COMMIT
[0m12:13:07.627403 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:13:07.630349 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:13:07.630978 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi__dbt_tmp" rename to "stg_swapi"
[0m12:13:07.634423 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:13:07.634860 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m12:13:07.635332 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner__dbt_tmp" rename to "stg_netrunner"
[0m12:13:07.635678 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:13:07.641205 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner_factions__dbt_backup"
[0m12:13:07.644435 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:13:07.644903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:13:07.648345 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:13:07.650212 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:13:07.650994 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:13:07.650613 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
drop view if exists "nerd_facts"."public"."stg_netrunner_factions__dbt_backup" cascade
[0m12:13:07.651322 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:13:07.648832 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:13:07.652084 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:13:07.652499 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:13:07.655009 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: Close
[0m12:13:07.657701 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m12:13:07.658375 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fff7a3bd-ee89-4bfd-9c16-9f3fe972f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2785602c80>]}
[0m12:13:07.661264 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner__dbt_backup"
[0m12:13:07.661680 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m12:13:07.665608 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."stg_swapi__dbt_backup"
[0m12:13:07.663221 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:13:07.666311 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:13:07.662341 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public.stg_netrunner_factions ................ [[32mCREATE VIEW[0m in 0.20s]
[0m12:13:07.667569 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:13:07.666691 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
drop view if exists "nerd_facts"."public"."stg_netrunner__dbt_backup" cascade
[0m12:13:07.667049 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
drop view if exists "nerd_facts"."public"."stg_swapi__dbt_backup" cascade
[0m12:13:07.671353 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:13:07.671750 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:13:07.673084 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: Close
[0m12:13:07.674367 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: Close
[0m12:13:07.678123 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fff7a3bd-ee89-4bfd-9c16-9f3fe972f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278208bcd0>]}
[0m12:13:07.678783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fff7a3bd-ee89-4bfd-9c16-9f3fe972f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278205bd00>]}
[0m12:13:07.679428 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public.stg_swapi ............................. [[32mCREATE VIEW[0m in 0.21s]
[0m12:13:07.680073 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_netrunner ......................... [[32mCREATE VIEW[0m in 0.20s]
[0m12:13:07.680818 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi
[0m12:13:07.681317 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_netrunner
[0m12:13:07.682012 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:13:07.682339 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m12:13:07.682974 [info ] [Thread-1 (]: 7 of 10 START sql table model public.dim_starship_manufacturers ................ [RUN]
[0m12:13:07.684544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner, now model.nerd_facts_dbt.dim_starship_manufacturers)
[0m12:13:07.683731 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:13:07.683393 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:13:07.684138 [info ] [Thread-3 (]: 8 of 10 START sql table model public.fact_starships ............................ [RUN]
[0m12:13:07.684985 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:13:07.685414 [info ] [Thread-2 (]: 10 of 10 START sql table model public.fact_netrunner_cards ..................... [RUN]
[0m12:13:07.685952 [info ] [Thread-4 (]: 9 of 10 START sql table model public.dim_netrunner_factions .................... [RUN]
[0m12:13:07.686391 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_pokeapi, now model.nerd_facts_dbt.fact_starships)
[0m12:13:07.690415 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:13:07.690980 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner_factions, now model.nerd_facts_dbt.fact_netrunner_cards)
[0m12:13:07.691431 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi, now model.nerd_facts_dbt.dim_netrunner_factions)
[0m12:13:07.691812 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m12:13:07.692290 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:13:07.692643 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:13:07.695401 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m12:13:07.698041 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:13:07.700821 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:13:07.701214 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:13:07.701852 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m12:13:07.702302 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:13:07.724060 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:13:07.726171 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:13:07.731128 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m12:13:07.736398 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:13:07.743911 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:13:07.742884 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:13:07.744560 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m12:13:07.744252 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_netrunner_cards: BEGIN
[0m12:13:07.745145 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:13:07.744852 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:13:07.743305 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:13:07.741878 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:13:07.752558 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:13:07.753059 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: BEGIN
[0m12:13:07.753408 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:13:07.745987 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: BEGIN
[0m12:13:07.757705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:13:07.773295 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m12:13:07.773743 [debug] [Thread-2 (]: SQL status: BEGIN in 0.029 seconds
[0m12:13:07.775245 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:13:07.774647 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:13:07.775882 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  
    

  create  table "nerd_facts"."public"."fact_starships__dbt_tmp"
  
  
    as
  
  (
    WITH starships AS (
    SELECT * FROM "nerd_facts"."public"."stg_swapi"
)
SELECT
    id,
    starship_name,
    model,
    manufacturer,
    max_speed,
    crew,
    passengers
FROM starships
  );
  
[0m12:13:07.775549 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */

  
    

  create  table "nerd_facts"."public"."fact_netrunner_cards__dbt_tmp"
  
  
    as
  
  (
    WITH raw_data AS (
    SELECT * FROM "nerd_facts"."public"."stg_netrunner"
)
SELECT
    c.id,
    c.card_name,
    f.faction_name,  
    c.type_name,  
    c.cost,  
    c.description
FROM raw_data c
LEFT JOIN "nerd_facts"."public"."stg_netrunner_factions" f ON c.faction_code = f.faction_code
  );
  
[0m12:13:07.777007 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column c.type_name does not exist
LINE 19:     c.type_name,  
             ^
HINT:  Perhaps you meant to reference the column "c.type_code".

[0m12:13:07.777401 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_netrunner_cards: ROLLBACK
[0m12:13:07.774936 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m12:13:07.777918 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_netrunner_cards: Close
[0m12:13:07.774339 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m12:13:07.778312 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:13:07.781213 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:13:07.783659 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */

  
    

  create  table "nerd_facts"."public"."dim_netrunner_factions__dbt_tmp"
  
  
    as
  
  (
    WITH factions AS (
    SELECT DISTINCT ON (faction_name)
        faction_name,
        COUNT(*) OVER (PARTITION BY faction_name) AS num_cards
    FROM "nerd_facts"."public"."stg_netrunner"
)
SELECT * FROM factions
  );
  
[0m12:13:07.784566 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "faction_name" does not exist
LINE 14:         faction_name,
                 ^
HINT:  Perhaps you meant to reference the column "stg_netrunner.faction_code".

[0m12:13:07.783259 [debug] [Thread-3 (]: Postgres adapter: Postgres error: invalid input syntax for type integer: "30-165"

[0m12:13:07.784914 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: ROLLBACK
[0m12:13:07.782645 [debug] [Thread-2 (]: Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  column c.type_name does not exist
  LINE 19:     c.type_name,  
               ^
  HINT:  Perhaps you meant to reference the column "c.type_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql
[0m12:13:07.785828 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fff7a3bd-ee89-4bfd-9c16-9f3fe972f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278267ed10>]}
[0m12:13:07.785227 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_starships: ROLLBACK
[0m12:13:07.786822 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: Close
[0m12:13:07.787320 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m12:13:07.781904 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */

  
    

  create  table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp"
  
  
    as
  
  (
    WITH manufacturers AS (
    SELECT DISTINCT
        manufacturer,
        COUNT(*) AS num_starships
    FROM "nerd_facts"."public"."stg_swapi"
    GROUP BY manufacturer
)
SELECT * FROM manufacturers
  );
  
[0m12:13:07.790006 [debug] [Thread-4 (]: Database Error in model dim_netrunner_factions (models/marts/dim_netrunner_factions.sql)
  column "faction_name" does not exist
  LINE 14:         faction_name,
                   ^
  HINT:  Perhaps you meant to reference the column "stg_netrunner.faction_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/dim_netrunner_factions.sql
[0m12:13:07.790699 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fff7a3bd-ee89-4bfd-9c16-9f3fe972f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27813bb400>]}
[0m12:13:07.786421 [error] [Thread-2 (]: 10 of 10 ERROR creating sql table model public.fact_netrunner_cards ............ [[31mERROR[0m in 0.09s]
[0m12:13:07.791888 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:13:07.793155 [debug] [Thread-3 (]: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:13:07.793712 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_netrunner_cards' to be skipped because of status 'error'.  Reason: Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  column c.type_name does not exist
  LINE 19:     c.type_name,  
               ^
  HINT:  Perhaps you meant to reference the column "c.type_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql.
[0m12:13:07.791360 [error] [Thread-4 (]: 9 of 10 ERROR creating sql table model public.dim_netrunner_factions ........... [[31mERROR[0m in 0.10s]
[0m12:13:07.794320 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fff7a3bd-ee89-4bfd-9c16-9f3fe972f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27813c0310>]}
[0m12:13:07.795014 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:13:07.795645 [error] [Thread-3 (]: 8 of 10 ERROR creating sql table model public.fact_starships ................... [[31mERROR[0m in 0.11s]
[0m12:13:07.796215 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.dim_netrunner_factions' to be skipped because of status 'error'.  Reason: Database Error in model dim_netrunner_factions (models/marts/dim_netrunner_factions.sql)
  column "faction_name" does not exist
  LINE 14:         faction_name,
                   ^
  HINT:  Perhaps you meant to reference the column "stg_netrunner.faction_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/dim_netrunner_factions.sql.
[0m12:13:07.796760 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m12:13:07.797324 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_starships' to be skipped because of status 'error'.  Reason: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql.
[0m12:13:07.804328 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.015 seconds
[0m12:13:07.807601 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:13:07.807945 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers" rename to "dim_starship_manufacturers__dbt_backup"
[0m12:13:07.808532 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:13:07.810939 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:13:07.811256 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp" rename to "dim_starship_manufacturers"
[0m12:13:07.811721 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:13:07.815890 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:13:07.816295 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:13:07.816574 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:13:07.819241 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:13:07.821524 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup"
[0m12:13:07.823657 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:13:07.823988 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
drop table if exists "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup" cascade
[0m12:13:07.827285 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:13:07.828531 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: Close
[0m12:13:07.829237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fff7a3bd-ee89-4bfd-9c16-9f3fe972f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2782a81f60>]}
[0m12:13:07.829818 [info ] [Thread-1 (]: 7 of 10 OK created sql table model public.dim_starship_manufacturers ........... [[32mSELECT 27[0m in 0.14s]
[0m12:13:07.830285 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:13:07.831549 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:07.831859 [debug] [MainThread]: On master: BEGIN
[0m12:13:07.832113 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:13:07.844759 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:13:07.845275 [debug] [MainThread]: On master: COMMIT
[0m12:13:07.845618 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:07.845869 [debug] [MainThread]: On master: COMMIT
[0m12:13:07.846236 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:13:07.846493 [debug] [MainThread]: On master: Close
[0m12:13:07.846976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:07.847209 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_netrunner_cards' was properly closed.
[0m12:13:07.847476 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_starship_manufacturers' was properly closed.
[0m12:13:07.847717 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_starships' was properly closed.
[0m12:13:07.847946 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_netrunner_factions' was properly closed.
[0m12:13:07.848339 [info ] [MainThread]: 
[0m12:13:07.848727 [info ] [MainThread]: Finished running 6 table models, 4 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m12:13:07.850056 [debug] [MainThread]: Command end result
[0m12:13:07.869568 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:13:07.871139 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:13:07.877336 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m12:13:07.877768 [info ] [MainThread]: 
[0m12:13:07.878206 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m12:13:07.878557 [info ] [MainThread]: 
[0m12:13:07.878942 [error] [MainThread]:   Database Error in model stg_pokeapi (models/staging/stg_pokeapi.sql)
  operator does not exist: text -> integer
  LINE 18:     types->0->>'type' AS primary_type
                    ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/stg_pokeapi.sql
[0m12:13:07.879279 [info ] [MainThread]: 
[0m12:13:07.879660 [error] [MainThread]:   Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  column c.type_name does not exist
  LINE 19:     c.type_name,  
               ^
  HINT:  Perhaps you meant to reference the column "c.type_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql
[0m12:13:07.880001 [info ] [MainThread]: 
[0m12:13:07.880374 [error] [MainThread]:   Database Error in model dim_netrunner_factions (models/marts/dim_netrunner_factions.sql)
  column "faction_name" does not exist
  LINE 14:         faction_name,
                   ^
  HINT:  Perhaps you meant to reference the column "stg_netrunner.faction_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/dim_netrunner_factions.sql
[0m12:13:07.880701 [info ] [MainThread]: 
[0m12:13:07.881063 [error] [MainThread]:   Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:13:07.881371 [info ] [MainThread]: 
[0m12:13:07.881717 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=2 TOTAL=10
[0m12:13:07.882562 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2675452, "process_in_blocks": "0", "process_kernel_time": 0.074843, "process_mem_max_rss": "114744", "process_out_blocks": "2936", "process_user_time": 2.122633}
[0m12:13:07.882947 [debug] [MainThread]: Command `dbt run` failed at 12:13:07.882860 after 1.27 seconds
[0m12:13:07.883284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27843b08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27825e3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278205b6d0>]}
[0m12:13:07.883610 [debug] [MainThread]: Flushing usage events
[0m12:13:08.376115 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:14:37.956746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90dca08b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90eb477f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90eb47850>]}


============================== 12:14:37.959188 | 468ce6a7-65ea-441e-a6f0-1414efae033a ==============================
[0m12:14:37.959188 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:14:37.959729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:14:38.098315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '468ce6a7-65ea-441e-a6f0-1414efae033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90d3ba4d0>]}
[0m12:14:38.147441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '468ce6a7-65ea-441e-a6f0-1414efae033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90eaa7a00>]}
[0m12:14:38.148207 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:14:38.232346 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:14:38.323643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:14:38.324249 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/stg_pokeapi.sql
[0m12:14:38.541039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '468ce6a7-65ea-441e-a6f0-1414efae033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90befe140>]}
[0m12:14:38.610532 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:14:38.612824 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:14:38.622443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '468ce6a7-65ea-441e-a6f0-1414efae033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90bec8910>]}
[0m12:14:38.623008 [info ] [MainThread]: Found 10 models, 11 sources, 433 macros
[0m12:14:38.623413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '468ce6a7-65ea-441e-a6f0-1414efae033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90beca1d0>]}
[0m12:14:38.625247 [info ] [MainThread]: 
[0m12:14:38.625668 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:14:38.625992 [info ] [MainThread]: 
[0m12:14:38.626504 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:14:38.630828 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m12:14:38.662005 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m12:14:38.662444 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m12:14:38.662764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:38.677111 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m12:14:38.678429 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m12:14:38.680913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public'
[0m12:14:38.687049 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:14:38.687442 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m12:14:38.687751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:38.700371 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:14:38.700815 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:14:38.701169 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:14:38.704111 [debug] [ThreadPool]: SQL status: SELECT 98 in 0.003 seconds
[0m12:14:38.707202 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m12:14:38.707758 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m12:14:38.764650 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:38.765037 [debug] [MainThread]: On master: BEGIN
[0m12:14:38.765440 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:14:38.778605 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:14:38.779052 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:38.779433 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:14:38.787038 [debug] [MainThread]: SQL status: SELECT 31 in 0.007 seconds
[0m12:14:38.792503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '468ce6a7-65ea-441e-a6f0-1414efae033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90c0feb60>]}
[0m12:14:38.792958 [debug] [MainThread]: On master: ROLLBACK
[0m12:14:38.793441 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:38.793749 [debug] [MainThread]: On master: BEGIN
[0m12:14:38.794227 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:14:38.794512 [debug] [MainThread]: On master: COMMIT
[0m12:14:38.794795 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:38.795060 [debug] [MainThread]: On master: COMMIT
[0m12:14:38.795413 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:14:38.795706 [debug] [MainThread]: On master: Close
[0m12:14:38.799719 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_netrunner
[0m12:14:38.800128 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:14:38.800446 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_pokeapi
[0m12:14:38.800758 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi
[0m12:14:38.801270 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_netrunner .............................. [RUN]
[0m12:14:38.801792 [info ] [Thread-2 (]: 2 of 10 START sql view model public.stg_netrunner_factions ..................... [RUN]
[0m12:14:38.802427 [info ] [Thread-3 (]: 3 of 10 START sql view model public.stg_pokeapi ................................ [RUN]
[0m12:14:38.802819 [info ] [Thread-4 (]: 4 of 10 START sql view model public.stg_swapi .................................. [RUN]
[0m12:14:38.803407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.stg_netrunner)
[0m12:14:38.803818 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_nerd_facts, now model.nerd_facts_dbt.stg_netrunner_factions)
[0m12:14:38.804273 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_pokeapi'
[0m12:14:38.804713 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi'
[0m12:14:38.805058 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner
[0m12:14:38.805391 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:14:38.805756 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_pokeapi
[0m12:14:38.806090 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi
[0m12:14:38.812363 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:14:38.814372 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:14:38.816248 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:14:38.818096 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi"
[0m12:14:38.818700 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_netrunner
[0m12:14:38.819288 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_pokeapi
[0m12:14:38.852368 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi
[0m12:14:38.863135 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:14:38.886776 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:14:38.889582 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:14:38.891517 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:14:38.885818 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi"
[0m12:14:38.892458 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:14:38.892867 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:14:38.893377 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:14:38.894730 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: BEGIN
[0m12:14:38.894997 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:14:38.894399 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: BEGIN
[0m12:14:38.893784 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: BEGIN
[0m12:14:38.896221 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:14:38.895815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:38.894125 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:14:38.897755 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: BEGIN
[0m12:14:38.898119 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:14:38.911177 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m12:14:38.911677 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:14:38.912027 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */

  create view "nerd_facts"."public"."stg_netrunner_factions__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT DISTINCT code, name
    FROM raw.netrunner_factions
)
SELECT
    code AS faction_code,
    name AS faction_name
FROM raw_data
  );
[0m12:14:38.913742 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:14:38.919905 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:14:38.920362 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
alter table "nerd_facts"."public"."stg_netrunner_factions" rename to "stg_netrunner_factions__dbt_backup"
[0m12:14:38.921088 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:14:38.924275 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:14:38.925599 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
alter table "nerd_facts"."public"."stg_netrunner_factions__dbt_tmp" rename to "stg_netrunner_factions"
[0m12:14:38.926224 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:14:38.940440 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: COMMIT
[0m12:14:38.941642 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:14:38.941303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m12:14:38.940978 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m12:14:38.941992 [debug] [Thread-4 (]: SQL status: BEGIN in 0.044 seconds
[0m12:14:38.942301 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: COMMIT
[0m12:14:38.942655 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:14:38.943013 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:14:38.943356 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:14:38.943775 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */

  create view "nerd_facts"."public"."stg_netrunner__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.netrunner_cards
)
SELECT
    id,
    title AS card_name,
    faction_code,
    type_code,
    NULLIF(cost, '')::NUMERIC::INTEGER AS cost,  -- ✅ Double casting to handle decimals safely
    text AS description
FROM raw_data
  );
[0m12:14:38.944652 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */

  create view "nerd_facts"."public"."stg_swapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.swapi_starships
)
SELECT
    id,
    name AS starship_name,
    model,
    manufacturer,
    NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '[^0-9]', '', 'g'), '')::INTEGER AS max_speed,  -- ✅ Extract numbers only
    crew::INTEGER,
    passengers::INTEGER
FROM raw_data
  );
[0m12:14:38.944251 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */

  create view "nerd_facts"."public"."stg_pokeapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.pokeapi_pokemon
)
SELECT
    id,
    name AS pokemon_name,
    height::NUMERIC / 10.0 AS height_m,
    weight::NUMERIC / 10.0 AS weight_kg,
    base_experience,
    jsonb_array_length(abilities::JSONB) AS num_abilities,  -- ✅ Cast abilities to JSONB
    abilities::JSONB AS abilities_json,  -- ✅ Ensure abilities are stored as JSONB
    (types::JSONB)->0->'type'->>'name' AS primary_type  -- ✅ Ensure types is JSONB before extracting
FROM raw_data
  );
[0m12:14:38.947858 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m12:14:38.947489 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:14:38.957307 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:14:38.950552 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m12:14:38.954215 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:14:38.950204 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:14:38.965813 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:14:38.957709 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi" rename to "stg_swapi__dbt_backup"
[0m12:14:38.963218 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner" rename to "stg_netrunner__dbt_backup"
[0m12:14:38.967025 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:14:38.966175 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
alter table "nerd_facts"."public"."stg_pokeapi__dbt_tmp" rename to "stg_pokeapi"
[0m12:14:38.969724 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:14:38.962699 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner_factions__dbt_backup"
[0m12:14:38.970061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:14:38.979022 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:14:38.971123 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:14:38.980671 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: COMMIT
[0m12:14:38.970821 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi__dbt_tmp" rename to "stg_swapi"
[0m12:14:38.979391 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner__dbt_tmp" rename to "stg_netrunner"
[0m12:14:38.975303 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:14:38.981082 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:14:38.981878 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
drop view if exists "nerd_facts"."public"."stg_netrunner_factions__dbt_backup" cascade
[0m12:14:38.982198 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:14:38.982552 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: COMMIT
[0m12:14:38.982818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:14:38.985045 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:14:38.986737 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:14:38.987176 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:14:38.990465 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: Close
[0m12:14:38.992091 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '468ce6a7-65ea-441e-a6f0-1414efae033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90bf8ce50>]}
[0m12:14:38.992810 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public.stg_netrunner_factions ................ [[32mCREATE VIEW[0m in 0.19s]
[0m12:14:38.987602 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:14:38.987992 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m12:14:38.996030 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."stg_pokeapi__dbt_backup"
[0m12:14:38.993763 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:14:38.993448 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:14:38.988383 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:14:38.996729 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:14:38.997547 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:14:38.997901 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
drop view if exists "nerd_facts"."public"."stg_pokeapi__dbt_backup" cascade
[0m12:14:38.998553 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:14:38.999954 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: Close
[0m12:14:39.000323 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m12:14:39.002872 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."stg_swapi__dbt_backup"
[0m12:14:39.003644 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:14:39.004215 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '468ce6a7-65ea-441e-a6f0-1414efae033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90c21b370>]}
[0m12:14:39.004546 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
drop view if exists "nerd_facts"."public"."stg_swapi__dbt_backup" cascade
[0m12:14:39.004835 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m12:14:39.005369 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public.stg_pokeapi ........................... [[32mCREATE VIEW[0m in 0.20s]
[0m12:14:39.008038 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner__dbt_backup"
[0m12:14:39.008729 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_pokeapi
[0m12:14:39.009127 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:14:39.009805 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:14:39.011199 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: Close
[0m12:14:39.012883 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '468ce6a7-65ea-441e-a6f0-1414efae033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90bf792d0>]}
[0m12:14:39.011537 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:14:39.013463 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public.stg_swapi ............................. [[32mCREATE VIEW[0m in 0.21s]
[0m12:14:39.012156 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
drop view if exists "nerd_facts"."public"."stg_netrunner__dbt_backup" cascade
[0m12:14:39.014515 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi
[0m12:14:39.013981 [info ] [Thread-2 (]: 5 of 10 START sql table model public.dim_pokemon_types ......................... [RUN]
[0m12:14:39.016066 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner_factions, now model.nerd_facts_dbt.dim_pokemon_types)
[0m12:14:39.016782 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.dim_pokemon_types
[0m12:14:39.011857 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.fact_pokemon
[0m12:14:39.020190 [info ] [Thread-3 (]: 6 of 10 START sql table model public.fact_pokemon .............................. [RUN]
[0m12:14:39.016477 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:14:39.019698 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m12:14:39.022457 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: Close
[0m12:14:39.020714 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_pokeapi, now model.nerd_facts_dbt.fact_pokemon)
[0m12:14:39.021156 [info ] [Thread-4 (]: 7 of 10 START sql table model public.dim_starship_manufacturers ................ [RUN]
[0m12:14:39.026517 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi, now model.nerd_facts_dbt.dim_starship_manufacturers)
[0m12:14:39.019298 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:14:39.027339 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.dim_pokemon_types
[0m12:14:39.026892 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:14:39.045201 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:14:39.026071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '468ce6a7-65ea-441e-a6f0-1414efae033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90bf7f3a0>]}
[0m12:14:39.025394 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.fact_pokemon
[0m12:14:39.049205 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:14:39.053776 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_pokemon"
[0m12:14:39.050056 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_netrunner ......................... [[32mCREATE VIEW[0m in 0.22s]
[0m12:14:39.054572 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:14:39.055204 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.fact_pokemon
[0m12:14:39.055652 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_netrunner
[0m12:14:39.055973 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:14:39.065575 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: BEGIN
[0m12:14:39.064559 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_pokemon"
[0m12:14:39.066377 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:14:39.065865 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:14:39.060327 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:14:39.067744 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:14:39.068580 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: BEGIN
[0m12:14:39.068884 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:14:39.065034 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m12:14:39.069884 [info ] [Thread-1 (]: 8 of 10 START sql table model public.fact_starships ............................ [RUN]
[0m12:14:39.070521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner, now model.nerd_facts_dbt.fact_starships)
[0m12:14:39.070873 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m12:14:39.066687 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_pokemon: BEGIN
[0m12:14:39.074546 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:14:39.073307 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m12:14:39.075670 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m12:14:39.095451 [debug] [Thread-4 (]: SQL status: BEGIN in 0.026 seconds
[0m12:14:39.095886 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:14:39.096211 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */

  
    

  create  table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp"
  
  
    as
  
  (
    WITH manufacturers AS (
    SELECT DISTINCT
        manufacturer,
        COUNT(*) AS num_starships
    FROM "nerd_facts"."public"."stg_swapi"
    GROUP BY manufacturer
)
SELECT * FROM manufacturers
  );
  
[0m12:14:39.090509 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m12:14:39.099233 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m12:14:39.099888 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:14:39.100248 [debug] [Thread-2 (]: SQL status: BEGIN in 0.034 seconds
[0m12:14:39.100598 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:14:39.101750 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m12:14:39.101398 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:14:39.102364 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */

  
    

  create  table "nerd_facts"."public"."dim_pokemon_types__dbt_tmp"
  
  
    as
  
  (
    WITH types AS (
    SELECT DISTINCT
        primary_type,
        COUNT(*) AS num_pokemon
    FROM "nerd_facts"."public"."stg_pokeapi"
    GROUP BY primary_type
)
SELECT * FROM types
  );
  
[0m12:14:39.102073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:39.105194 [debug] [Thread-4 (]: SQL status: SELECT 27 in 0.009 seconds
[0m12:14:39.108775 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:14:39.101032 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */

  
    

  create  table "nerd_facts"."public"."fact_pokemon__dbt_tmp"
  
  
    as
  
  (
    WITH pokemon AS (
    SELECT * FROM "nerd_facts"."public"."stg_pokeapi"
)
SELECT
    id,
    pokemon_name,
    height_m,
    weight_kg,
    num_abilities,
    primary_type
FROM pokemon
  );
  
[0m12:14:39.109390 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers" rename to "dim_starship_manufacturers__dbt_backup"
[0m12:14:39.112050 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:14:39.115881 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:14:39.116342 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp" rename to "dim_starship_manufacturers"
[0m12:14:39.118582 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m12:14:39.119018 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m12:14:39.121765 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:14:39.125032 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
alter table "nerd_facts"."public"."dim_pokemon_types__dbt_tmp" rename to "dim_pokemon_types"
[0m12:14:39.124203 [debug] [Thread-3 (]: SQL status: SELECT 1302 in 0.014 seconds
[0m12:14:39.124628 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:14:39.129014 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  
    

  create  table "nerd_facts"."public"."fact_starships__dbt_tmp"
  
  
    as
  
  (
    WITH starships AS (
    SELECT * FROM "nerd_facts"."public"."stg_swapi"
)
SELECT
    id,
    starship_name,
    model,
    manufacturer,
    max_speed,
    crew,
    passengers
FROM starships
  );
  
[0m12:14:39.128477 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:14:39.130025 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
alter table "nerd_facts"."public"."fact_pokemon__dbt_tmp" rename to "fact_pokemon"
[0m12:14:39.129541 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:14:39.122076 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:14:39.135760 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: COMMIT
[0m12:14:39.136183 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:14:39.138882 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:14:39.139408 [debug] [Thread-1 (]: Postgres adapter: Postgres error: invalid input syntax for type integer: "30-165"

[0m12:14:39.139859 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:14:39.141350 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_pokemon: COMMIT
[0m12:14:39.141815 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:14:39.142181 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: ROLLBACK
[0m12:14:39.142558 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: COMMIT
[0m12:14:39.142911 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:14:39.144280 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_pokemon: COMMIT
[0m12:14:39.143879 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m12:14:39.143278 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:14:39.146859 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m12:14:39.149878 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."dim_pokemon_types__dbt_backup"
[0m12:14:39.150309 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m12:14:39.150648 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m12:14:39.153146 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:14:39.155746 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."fact_pokemon__dbt_backup"
[0m12:14:39.158727 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup"
[0m12:14:39.159301 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
drop table if exists "nerd_facts"."public"."dim_pokemon_types__dbt_backup" cascade
[0m12:14:39.160027 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:14:39.161970 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
drop table if exists "nerd_facts"."public"."fact_pokemon__dbt_backup" cascade
[0m12:14:39.161545 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:14:39.160863 [debug] [Thread-1 (]: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:14:39.162434 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
drop table if exists "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup" cascade
[0m12:14:39.162929 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:14:39.163235 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:14:39.163734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '468ce6a7-65ea-441e-a6f0-1414efae033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90ad04dc0>]}
[0m12:14:39.168168 [error] [Thread-1 (]: 8 of 10 ERROR creating sql table model public.fact_starships ................... [[31mERROR[0m in 0.09s]
[0m12:14:39.167091 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: Close
[0m12:14:39.167552 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:14:39.170897 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: Close
[0m12:14:39.165741 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_pokemon: Close
[0m12:14:39.172710 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '468ce6a7-65ea-441e-a6f0-1414efae033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90c399cf0>]}
[0m12:14:39.173673 [info ] [Thread-2 (]: 5 of 10 OK created sql table model public.dim_pokemon_types .................... [[32mSELECT 1[0m in 0.16s]
[0m12:14:39.174514 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:14:39.175820 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:14:39.175229 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '468ce6a7-65ea-441e-a6f0-1414efae033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90c3793f0>]}
[0m12:14:39.168749 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m12:14:39.177915 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '468ce6a7-65ea-441e-a6f0-1414efae033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90acb6050>]}
[0m12:14:39.178531 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:14:39.178901 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_starships' to be skipped because of status 'error'.  Reason: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql.
[0m12:14:39.176469 [info ] [Thread-2 (]: 9 of 10 START sql table model public.dim_netrunner_factions .................... [RUN]
[0m12:14:39.177260 [info ] [Thread-3 (]: 6 of 10 OK created sql table model public.fact_pokemon ......................... [[32mSELECT 1302[0m in 0.15s]
[0m12:14:39.181958 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.fact_pokemon
[0m12:14:39.179529 [info ] [Thread-4 (]: 7 of 10 OK created sql table model public.dim_starship_manufacturers ........... [[32mSELECT 27[0m in 0.15s]
[0m12:14:39.182561 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:14:39.181394 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_pokemon_types, now model.nerd_facts_dbt.dim_netrunner_factions)
[0m12:14:39.180215 [info ] [Thread-1 (]: 10 of 10 START sql table model public.fact_netrunner_cards ..................... [RUN]
[0m12:14:39.183031 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:14:39.183473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_starships, now model.nerd_facts_dbt.fact_netrunner_cards)
[0m12:14:39.186199 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:14:39.186676 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:14:39.191002 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:14:39.191533 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:14:39.197456 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:14:39.198066 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:14:39.198587 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:14:39.204301 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:14:39.204729 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_netrunner_factions: BEGIN
[0m12:14:39.205277 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:14:39.205766 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:14:39.206738 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: BEGIN
[0m12:14:39.207234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:39.225970 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m12:14:39.226403 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:14:39.226818 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */

  
    

  create  table "nerd_facts"."public"."dim_netrunner_factions__dbt_tmp"
  
  
    as
  
  (
    WITH factions AS (
    SELECT DISTINCT ON (faction_name)
        faction_name,
        COUNT(*) OVER (PARTITION BY faction_name) AS num_cards
    FROM "nerd_facts"."public"."stg_netrunner"
)
SELECT * FROM factions
  );
  
[0m12:14:39.227135 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m12:14:39.227604 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:14:39.227950 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */

  
    

  create  table "nerd_facts"."public"."fact_netrunner_cards__dbt_tmp"
  
  
    as
  
  (
    WITH raw_data AS (
    SELECT * FROM "nerd_facts"."public"."stg_netrunner"
)
SELECT
    c.id,
    c.card_name,
    f.faction_name,  
    c.type_name,  
    c.cost,  
    c.description
FROM raw_data c
LEFT JOIN "nerd_facts"."public"."stg_netrunner_factions" f ON c.faction_code = f.faction_code
  );
  
[0m12:14:39.228314 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "faction_name" does not exist
LINE 14:         faction_name,
                 ^
HINT:  Perhaps you meant to reference the column "stg_netrunner.faction_code".

[0m12:14:39.228675 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_netrunner_factions: ROLLBACK
[0m12:14:39.229114 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_netrunner_factions: Close
[0m12:14:39.229418 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column c.type_name does not exist
LINE 19:     c.type_name,  
             ^
HINT:  Perhaps you meant to reference the column "c.type_code".

[0m12:14:39.229884 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: ROLLBACK
[0m12:14:39.230344 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: Close
[0m12:14:39.232294 [debug] [Thread-2 (]: Database Error in model dim_netrunner_factions (models/marts/dim_netrunner_factions.sql)
  column "faction_name" does not exist
  LINE 14:         faction_name,
                   ^
  HINT:  Perhaps you meant to reference the column "stg_netrunner.faction_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/dim_netrunner_factions.sql
[0m12:14:39.233139 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '468ce6a7-65ea-441e-a6f0-1414efae033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90c0fe0b0>]}
[0m12:14:39.234309 [debug] [Thread-1 (]: Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  column c.type_name does not exist
  LINE 19:     c.type_name,  
               ^
  HINT:  Perhaps you meant to reference the column "c.type_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql
[0m12:14:39.233748 [error] [Thread-2 (]: 9 of 10 ERROR creating sql table model public.dim_netrunner_factions ........... [[31mERROR[0m in 0.05s]
[0m12:14:39.234842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '468ce6a7-65ea-441e-a6f0-1414efae033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90bf8faf0>]}
[0m12:14:39.235345 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:14:39.236044 [error] [Thread-1 (]: 10 of 10 ERROR creating sql table model public.fact_netrunner_cards ............ [[31mERROR[0m in 0.05s]
[0m12:14:39.236648 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.dim_netrunner_factions' to be skipped because of status 'error'.  Reason: Database Error in model dim_netrunner_factions (models/marts/dim_netrunner_factions.sql)
  column "faction_name" does not exist
  LINE 14:         faction_name,
                   ^
  HINT:  Perhaps you meant to reference the column "stg_netrunner.faction_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/dim_netrunner_factions.sql.
[0m12:14:39.237117 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:14:39.237686 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_netrunner_cards' to be skipped because of status 'error'.  Reason: Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  column c.type_name does not exist
  LINE 19:     c.type_name,  
               ^
  HINT:  Perhaps you meant to reference the column "c.type_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql.
[0m12:14:39.238811 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:39.239102 [debug] [MainThread]: On master: BEGIN
[0m12:14:39.239336 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:14:39.251676 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:14:39.252110 [debug] [MainThread]: On master: COMMIT
[0m12:14:39.252434 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:39.252666 [debug] [MainThread]: On master: COMMIT
[0m12:14:39.253004 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:14:39.253255 [debug] [MainThread]: On master: Close
[0m12:14:39.253755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:39.254020 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_netrunner_factions' was properly closed.
[0m12:14:39.254248 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_netrunner_cards' was properly closed.
[0m12:14:39.254467 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_pokemon' was properly closed.
[0m12:14:39.254693 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_starship_manufacturers' was properly closed.
[0m12:14:39.255045 [info ] [MainThread]: 
[0m12:14:39.255443 [info ] [MainThread]: Finished running 6 table models, 4 view models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m12:14:39.257193 [debug] [MainThread]: Command end result
[0m12:14:39.275565 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:14:39.277030 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:14:39.282756 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m12:14:39.283110 [info ] [MainThread]: 
[0m12:14:39.283435 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m12:14:39.283711 [info ] [MainThread]: 
[0m12:14:39.284011 [error] [MainThread]:   Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:14:39.284292 [info ] [MainThread]: 
[0m12:14:39.284578 [error] [MainThread]:   Database Error in model dim_netrunner_factions (models/marts/dim_netrunner_factions.sql)
  column "faction_name" does not exist
  LINE 14:         faction_name,
                   ^
  HINT:  Perhaps you meant to reference the column "stg_netrunner.faction_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/dim_netrunner_factions.sql
[0m12:14:39.284854 [info ] [MainThread]: 
[0m12:14:39.285150 [error] [MainThread]:   Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  column c.type_name does not exist
  LINE 19:     c.type_name,  
               ^
  HINT:  Perhaps you meant to reference the column "c.type_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql
[0m12:14:39.285402 [info ] [MainThread]: 
[0m12:14:39.285677 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=0 TOTAL=10
[0m12:14:39.286415 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3745524, "process_in_blocks": "0", "process_kernel_time": 0.091665, "process_mem_max_rss": "115464", "process_out_blocks": "2992", "process_user_time": 2.215549}
[0m12:14:39.286755 [debug] [MainThread]: Command `dbt run` failed at 12:14:39.286678 after 1.38 seconds
[0m12:14:39.287068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90dca08b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90beef6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90beef880>]}
[0m12:14:39.287382 [debug] [MainThread]: Flushing usage events
[0m12:14:39.774450 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:16:04.991684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d76a44970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d7789da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d7789d9c0>]}


============================== 12:16:04.994203 | 47332a2e-ae08-4591-8bab-c6917a175f7b ==============================
[0m12:16:04.994203 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:16:04.994742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:16:05.130061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47332a2e-ae08-4591-8bab-c6917a175f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d75dab7c0>]}
[0m12:16:05.178170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47332a2e-ae08-4591-8bab-c6917a175f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d75af07f0>]}
[0m12:16:05.178890 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:16:05.253352 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:16:05.344922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:16:05.345619 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/stg_swapi.sql
[0m12:16:05.570732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47332a2e-ae08-4591-8bab-c6917a175f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d74c9a1d0>]}
[0m12:16:05.641618 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:16:05.644204 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:16:05.653603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47332a2e-ae08-4591-8bab-c6917a175f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d74c94310>]}
[0m12:16:05.654115 [info ] [MainThread]: Found 10 models, 11 sources, 433 macros
[0m12:16:05.654416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47332a2e-ae08-4591-8bab-c6917a175f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d74c940a0>]}
[0m12:16:05.655942 [info ] [MainThread]: 
[0m12:16:05.656273 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:16:05.656511 [info ] [MainThread]: 
[0m12:16:05.656904 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:16:05.660791 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m12:16:05.689389 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m12:16:05.689865 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m12:16:05.690155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:05.705107 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m12:16:05.706297 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m12:16:05.708080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_public)
[0m12:16:05.713586 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:16:05.714005 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m12:16:05.714253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:05.726763 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:16:05.727138 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:16:05.727429 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:16:05.730162 [debug] [ThreadPool]: SQL status: SELECT 101 in 0.002 seconds
[0m12:16:05.733117 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m12:16:05.733681 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m12:16:05.786614 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:05.786998 [debug] [MainThread]: On master: BEGIN
[0m12:16:05.787254 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:16:05.799526 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:16:05.799981 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:05.800391 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:16:05.807617 [debug] [MainThread]: SQL status: SELECT 32 in 0.007 seconds
[0m12:16:05.814125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47332a2e-ae08-4591-8bab-c6917a175f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d74c9a710>]}
[0m12:16:05.814830 [debug] [MainThread]: On master: ROLLBACK
[0m12:16:05.815597 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:05.816049 [debug] [MainThread]: On master: BEGIN
[0m12:16:05.816675 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:16:05.816949 [debug] [MainThread]: On master: COMMIT
[0m12:16:05.817214 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:05.817473 [debug] [MainThread]: On master: COMMIT
[0m12:16:05.817910 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:16:05.818193 [debug] [MainThread]: On master: Close
[0m12:16:05.820464 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_netrunner
[0m12:16:05.821476 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:16:05.821858 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_pokeapi
[0m12:16:05.821061 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_netrunner .............................. [RUN]
[0m12:16:05.822304 [info ] [Thread-2 (]: 2 of 10 START sql view model public.stg_netrunner_factions ..................... [RUN]
[0m12:16:05.824208 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_netrunner_factions'
[0m12:16:05.824535 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:16:05.823663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.stg_netrunner)
[0m12:16:05.830828 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner
[0m12:16:05.823153 [info ] [Thread-3 (]: 3 of 10 START sql view model public.stg_pokeapi ................................ [RUN]
[0m12:16:05.833059 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_pokeapi'
[0m12:16:05.822722 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi
[0m12:16:05.833925 [info ] [Thread-4 (]: 4 of 10 START sql view model public.stg_swapi .................................. [RUN]
[0m12:16:05.830366 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:16:05.833378 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_pokeapi
[0m12:16:05.834464 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi'
[0m12:16:05.837137 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi
[0m12:16:05.836279 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:16:05.839581 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_pokeapi
[0m12:16:05.836810 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:16:05.838971 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi"
[0m12:16:05.832553 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:16:05.884542 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:16:05.884895 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:16:05.885614 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_netrunner
[0m12:16:05.886382 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi
[0m12:16:05.886779 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:16:05.891803 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:16:05.896170 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi"
[0m12:16:05.896596 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:16:05.897040 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: BEGIN
[0m12:16:05.898729 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:16:05.898120 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:16:05.897729 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:16:05.899912 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: BEGIN
[0m12:16:05.900251 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:16:05.898435 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: BEGIN
[0m12:16:05.901744 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:16:05.899555 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: BEGIN
[0m12:16:05.902476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:05.918713 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m12:16:05.919395 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:16:05.919769 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */

  create view "nerd_facts"."public"."stg_netrunner_factions__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT DISTINCT code, name
    FROM raw.netrunner_factions
)
SELECT
    code AS faction_code,
    name AS faction_name
FROM raw_data
  );
[0m12:16:05.921707 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:16:05.927661 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:16:05.928064 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
alter table "nerd_facts"."public"."stg_netrunner_factions" rename to "stg_netrunner_factions__dbt_backup"
[0m12:16:05.928764 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:16:05.933952 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:16:05.934387 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
alter table "nerd_facts"."public"."stg_netrunner_factions__dbt_tmp" rename to "stg_netrunner_factions"
[0m12:16:05.935080 [debug] [Thread-4 (]: SQL status: BEGIN in 0.035 seconds
[0m12:16:05.935572 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:16:05.935866 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:16:05.950558 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */

  create view "nerd_facts"."public"."stg_swapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.swapi_starships
)
SELECT
    id,
    name AS starship_name,
    model,
    manufacturer,
    NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '[^0-9]', '', 'g'), '')::INTEGER AS max_speed,  -- ✅ Extracts only numbers
    NULLIF(crew, '')::INTEGER AS crew,  -- ✅ Converts crew safely
    NULLIF(passengers, '')::INTEGER AS passengers  -- ✅ Converts passengers safely
FROM raw_data
  );
[0m12:16:05.936399 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m12:16:05.950124 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: COMMIT
[0m12:16:05.936147 [debug] [Thread-3 (]: SQL status: BEGIN in 0.034 seconds
[0m12:16:05.954379 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:16:05.954722 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */

  create view "nerd_facts"."public"."stg_pokeapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.pokeapi_pokemon
)
SELECT
    id,
    name AS pokemon_name,
    height::NUMERIC / 10.0 AS height_m,
    weight::NUMERIC / 10.0 AS weight_kg,
    base_experience,
    jsonb_array_length(abilities::JSONB) AS num_abilities,  -- ✅ Cast abilities to JSONB
    abilities::JSONB AS abilities_json,  -- ✅ Ensure abilities are stored as JSONB
    (types::JSONB)->0->'type'->>'name' AS primary_type  -- ✅ Ensure types is JSONB before extracting
FROM raw_data
  );
[0m12:16:05.953611 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m12:16:05.954023 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:16:05.953216 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:16:05.958922 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:16:05.959389 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m12:16:05.959703 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: COMMIT
[0m12:16:05.960123 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */

  create view "nerd_facts"."public"."stg_netrunner__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.netrunner_cards
)
SELECT
    id,
    title AS card_name,
    faction_code,
    type_code,
    NULLIF(cost, '')::NUMERIC::INTEGER AS cost,  -- ✅ Double casting to handle decimals safely
    text AS description
FROM raw_data
  );
[0m12:16:05.960564 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi" rename to "stg_swapi__dbt_backup"
[0m12:16:05.963721 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:16:05.965642 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
alter table "nerd_facts"."public"."stg_pokeapi" rename to "stg_pokeapi__dbt_backup"
[0m12:16:05.966142 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:16:05.969267 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:16:05.969638 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:16:05.969999 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:16:05.976560 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:16:05.973942 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:16:05.970433 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi__dbt_tmp" rename to "stg_swapi"
[0m12:16:05.976919 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
alter table "nerd_facts"."public"."stg_pokeapi__dbt_tmp" rename to "stg_pokeapi"
[0m12:16:05.977278 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m12:16:05.977616 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner" rename to "stg_netrunner__dbt_backup"
[0m12:16:05.978436 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:16:05.978737 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:16:05.984512 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner_factions__dbt_backup"
[0m12:16:05.985939 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: COMMIT
[0m12:16:05.986288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:16:05.988608 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:16:05.992384 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:16:05.992847 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:16:05.995535 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:16:05.996004 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:16:05.996441 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
drop view if exists "nerd_facts"."public"."stg_netrunner_factions__dbt_backup" cascade
[0m12:16:05.996792 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: COMMIT
[0m12:16:05.997184 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner__dbt_tmp" rename to "stg_netrunner"
[0m12:16:05.997524 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:16:05.999211 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:16:06.001030 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:16:06.001448 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:16:06.001768 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:16:06.002180 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:16:06.002683 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m12:16:06.005054 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: Close
[0m12:16:06.005524 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:16:06.008172 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."stg_pokeapi__dbt_backup"
[0m12:16:06.014994 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:16:06.010909 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner__dbt_backup"
[0m12:16:06.008490 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m12:16:06.015518 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
drop view if exists "nerd_facts"."public"."stg_pokeapi__dbt_backup" cascade
[0m12:16:06.016286 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:16:06.019325 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
drop view if exists "nerd_facts"."public"."stg_netrunner__dbt_backup" cascade
[0m12:16:06.016685 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47332a2e-ae08-4591-8bab-c6917a175f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d74d1c2e0>]}
[0m12:16:06.019994 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public.stg_netrunner_factions ................ [[32mCREATE VIEW[0m in 0.19s]
[0m12:16:06.018750 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."stg_swapi__dbt_backup"
[0m12:16:06.020703 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:16:06.021562 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:16:06.022244 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:16:06.022556 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
drop view if exists "nerd_facts"."public"."stg_swapi__dbt_backup" cascade
[0m12:16:06.023792 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: Close
[0m12:16:06.024207 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m12:16:06.026409 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: Close
[0m12:16:06.028027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47332a2e-ae08-4591-8bab-c6917a175f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d75adcfa0>]}
[0m12:16:06.028783 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_netrunner ......................... [[32mCREATE VIEW[0m in 0.20s]
[0m12:16:06.029532 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_netrunner
[0m12:16:06.027100 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47332a2e-ae08-4591-8bab-c6917a175f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d74df50c0>]}
[0m12:16:06.030102 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.006 seconds
[0m12:16:06.032116 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: Close
[0m12:16:06.030866 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public.stg_pokeapi ........................... [[32mCREATE VIEW[0m in 0.19s]
[0m12:16:06.033310 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_pokeapi
[0m12:16:06.032571 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:16:06.033933 [info ] [Thread-2 (]: 5 of 10 START sql table model public.dim_netrunner_factions .................... [RUN]
[0m12:16:06.034361 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner_factions, now model.nerd_facts_dbt.dim_netrunner_factions)
[0m12:16:06.034657 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:16:06.037345 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:16:06.032855 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:16:06.037960 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47332a2e-ae08-4591-8bab-c6917a175f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d74d00c10>]}
[0m12:16:06.038336 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:16:06.039269 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:16:06.038873 [info ] [Thread-1 (]: 6 of 10 START sql table model public.fact_netrunner_cards ...................... [RUN]
[0m12:16:06.039964 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public.stg_swapi ............................. [[32mCREATE VIEW[0m in 0.20s]
[0m12:16:06.040494 [info ] [Thread-3 (]: 7 of 10 START sql table model public.dim_pokemon_types ......................... [RUN]
[0m12:16:06.058807 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:16:06.059349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner, now model.nerd_facts_dbt.fact_netrunner_cards)
[0m12:16:06.060807 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:16:06.064414 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:16:06.059941 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi
[0m12:16:06.060336 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_pokeapi, now model.nerd_facts_dbt.dim_pokemon_types)
[0m12:16:06.064898 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:16:06.065451 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.fact_pokemon
[0m12:16:06.065898 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.dim_pokemon_types
[0m12:16:06.066427 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_netrunner_factions: BEGIN
[0m12:16:06.066742 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:16:06.067187 [info ] [Thread-4 (]: 8 of 10 START sql table model public.fact_pokemon .............................. [RUN]
[0m12:16:06.069943 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:16:06.070369 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:16:06.075050 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:16:06.075554 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi, now model.nerd_facts_dbt.fact_pokemon)
[0m12:16:06.077243 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.fact_pokemon
[0m12:16:06.079704 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_pokemon"
[0m12:16:06.080289 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.fact_pokemon
[0m12:16:06.076705 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.dim_pokemon_types
[0m12:16:06.084867 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_pokemon"
[0m12:16:06.091059 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:16:06.090038 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:16:06.090514 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m12:16:06.089395 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:16:06.091674 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: BEGIN
[0m12:16:06.092787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:06.091998 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:16:06.093233 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */

  
    

  create  table "nerd_facts"."public"."dim_netrunner_factions__dbt_tmp"
  
  
    as
  
  (
    WITH factions AS (
    SELECT DISTINCT ON (faction_name)
        faction_name,
        COUNT(*) OVER (PARTITION BY faction_name) AS num_cards
    FROM "nerd_facts"."public"."stg_netrunner"
)
SELECT * FROM factions
  );
  
[0m12:16:06.092500 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:16:06.094833 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: BEGIN
[0m12:16:06.094238 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "faction_name" does not exist
LINE 14:         faction_name,
                 ^
HINT:  Perhaps you meant to reference the column "stg_netrunner.faction_code".

[0m12:16:06.095467 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_netrunner_factions: ROLLBACK
[0m12:16:06.095958 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_netrunner_factions: Close
[0m12:16:06.091383 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: BEGIN
[0m12:16:06.100007 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:16:06.099543 [debug] [Thread-2 (]: Database Error in model dim_netrunner_factions (models/marts/dim_netrunner_factions.sql)
  column "faction_name" does not exist
  LINE 14:         faction_name,
                   ^
  HINT:  Perhaps you meant to reference the column "stg_netrunner.faction_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/dim_netrunner_factions.sql
[0m12:16:06.095138 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:16:06.101953 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47332a2e-ae08-4591-8bab-c6917a175f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d742a9690>]}
[0m12:16:06.105409 [error] [Thread-2 (]: 5 of 10 ERROR creating sql table model public.dim_netrunner_factions ........... [[31mERROR[0m in 0.07s]
[0m12:16:06.109960 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:16:06.110355 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:16:06.110775 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.dim_netrunner_factions' to be skipped because of status 'error'.  Reason: Database Error in model dim_netrunner_factions (models/marts/dim_netrunner_factions.sql)
  column "faction_name" does not exist
  LINE 14:         faction_name,
                   ^
  HINT:  Perhaps you meant to reference the column "stg_netrunner.faction_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/dim_netrunner_factions.sql.
[0m12:16:06.114425 [info ] [Thread-2 (]: 9 of 10 START sql table model public.dim_starship_manufacturers ................ [RUN]
[0m12:16:06.115426 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_netrunner_factions, now model.nerd_facts_dbt.dim_starship_manufacturers)
[0m12:16:06.115731 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:16:06.122902 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:16:06.123717 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:16:06.124191 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m12:16:06.129972 [debug] [Thread-3 (]: SQL status: BEGIN in 0.035 seconds
[0m12:16:06.131360 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:16:06.130743 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:16:06.132024 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */

  
    

  create  table "nerd_facts"."public"."fact_netrunner_cards__dbt_tmp"
  
  
    as
  
  (
    WITH raw_data AS (
    SELECT * FROM "nerd_facts"."public"."stg_netrunner"
)
SELECT
    c.id,
    c.card_name,
    f.faction_name,  
    c.type_name,  
    c.cost,  
    c.description
FROM raw_data c
LEFT JOIN "nerd_facts"."public"."stg_netrunner_factions" f ON c.faction_code = f.faction_code
  );
  
[0m12:16:06.131713 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */

  
    

  create  table "nerd_facts"."public"."dim_pokemon_types__dbt_tmp"
  
  
    as
  
  (
    WITH types AS (
    SELECT DISTINCT
        primary_type,
        COUNT(*) AS num_pokemon
    FROM "nerd_facts"."public"."stg_pokeapi"
    GROUP BY primary_type
)
SELECT * FROM types
  );
  
[0m12:16:06.130360 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:16:06.132889 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:16:06.133273 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: BEGIN
[0m12:16:06.133620 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:16:06.135902 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column c.type_name does not exist
LINE 19:     c.type_name,  
             ^
HINT:  Perhaps you meant to reference the column "c.type_code".

[0m12:16:06.136400 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: ROLLBACK
[0m12:16:06.131031 [debug] [Thread-4 (]: SQL status: BEGIN in 0.031 seconds
[0m12:16:06.136826 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:16:06.137154 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */

  
    

  create  table "nerd_facts"."public"."fact_pokemon__dbt_tmp"
  
  
    as
  
  (
    WITH pokemon AS (
    SELECT * FROM "nerd_facts"."public"."stg_pokeapi"
)
SELECT
    id,
    pokemon_name,
    height_m,
    weight_kg,
    num_abilities,
    primary_type
FROM pokemon
  );
  
[0m12:16:06.137719 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: Close
[0m12:16:06.140852 [debug] [Thread-1 (]: Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  column c.type_name does not exist
  LINE 19:     c.type_name,  
               ^
  HINT:  Perhaps you meant to reference the column "c.type_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql
[0m12:16:06.141510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47332a2e-ae08-4591-8bab-c6917a175f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d742457b0>]}
[0m12:16:06.143844 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m12:16:06.147482 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:16:06.147826 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
alter table "nerd_facts"."public"."dim_pokemon_types" rename to "dim_pokemon_types__dbt_backup"
[0m12:16:06.148441 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:16:06.151127 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:16:06.143504 [error] [Thread-1 (]: 6 of 10 ERROR creating sql table model public.fact_netrunner_cards ............. [[31mERROR[0m in 0.08s]
[0m12:16:06.152534 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:16:06.152902 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m12:16:06.153360 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_netrunner_cards' to be skipped because of status 'error'.  Reason: Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  column c.type_name does not exist
  LINE 19:     c.type_name,  
               ^
  HINT:  Perhaps you meant to reference the column "c.type_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql.
[0m12:16:06.153910 [info ] [Thread-1 (]: 10 of 10 START sql table model public.fact_starships ........................... [RUN]
[0m12:16:06.154592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_netrunner_cards, now model.nerd_facts_dbt.fact_starships)
[0m12:16:06.154948 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m12:16:06.151658 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
alter table "nerd_facts"."public"."dim_pokemon_types__dbt_tmp" rename to "dim_pokemon_types"
[0m12:16:06.151981 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m12:16:06.158421 [debug] [Thread-4 (]: SQL status: SELECT 1302 in 0.021 seconds
[0m12:16:06.158068 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m12:16:06.158950 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:16:06.162201 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:16:06.163418 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
alter table "nerd_facts"."public"."fact_pokemon" rename to "fact_pokemon__dbt_backup"
[0m12:16:06.163064 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */

  
    

  create  table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp"
  
  
    as
  
  (
    WITH manufacturers AS (
    SELECT DISTINCT
        manufacturer,
        COUNT(*) AS num_starships
    FROM "nerd_facts"."public"."stg_swapi"
    GROUP BY manufacturer
)
SELECT * FROM manufacturers
  );
  
[0m12:16:06.162548 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:16:06.168682 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: COMMIT
[0m12:16:06.169166 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:16:06.164286 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:16:06.172070 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:16:06.169505 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: COMMIT
[0m12:16:06.163912 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m12:16:06.172529 [debug] [Thread-2 (]: SQL status: SELECT 27 in 0.008 seconds
[0m12:16:06.172896 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
alter table "nerd_facts"."public"."fact_pokemon__dbt_tmp" rename to "fact_pokemon"
[0m12:16:06.179229 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m12:16:06.179624 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m12:16:06.182853 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:16:06.185653 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."dim_pokemon_types__dbt_backup"
[0m12:16:06.186118 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:16:06.190798 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: COMMIT
[0m12:16:06.186957 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:16:06.189362 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:16:06.186553 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers" rename to "dim_starship_manufacturers__dbt_backup"
[0m12:16:06.191118 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:16:06.191451 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m12:16:06.192775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:06.192464 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: COMMIT
[0m12:16:06.191778 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
drop table if exists "nerd_facts"."public"."dim_pokemon_types__dbt_backup" cascade
[0m12:16:06.193317 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:16:06.197631 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:16:06.198231 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m12:16:06.202452 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."fact_pokemon__dbt_backup"
[0m12:16:06.203471 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:16:06.203946 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
drop table if exists "nerd_facts"."public"."fact_pokemon__dbt_backup" cascade
[0m12:16:06.198781 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp" rename to "dim_starship_manufacturers"
[0m12:16:06.205191 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.011 seconds
[0m12:16:06.206957 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: Close
[0m12:16:06.211010 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47332a2e-ae08-4591-8bab-c6917a175f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d7421ea70>]}
[0m12:16:06.211956 [info ] [Thread-3 (]: 7 of 10 OK created sql table model public.dim_pokemon_types .................... [[32mSELECT 1[0m in 0.15s]
[0m12:16:06.212796 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:16:06.213412 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m12:16:06.215672 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:16:06.216148 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:16:06.216564 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:16:06.217165 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.013 seconds
[0m12:16:06.218827 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: Close
[0m12:16:06.219386 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m12:16:06.224327 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup"
[0m12:16:06.225244 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m12:16:06.226547 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:16:06.226891 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  
    

  create  table "nerd_facts"."public"."fact_starships__dbt_tmp"
  
  
    as
  
  (
    WITH starships AS (
    SELECT * FROM "nerd_facts"."public"."stg_swapi"
)
SELECT
    id,
    starship_name,
    model,
    manufacturer,
    max_speed,
    crew,
    passengers
FROM starships
  );
  
[0m12:16:06.224901 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47332a2e-ae08-4591-8bab-c6917a175f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d74217ca0>]}
[0m12:16:06.227702 [info ] [Thread-4 (]: 8 of 10 OK created sql table model public.fact_pokemon ......................... [[32mSELECT 1302[0m in 0.15s]
[0m12:16:06.228421 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.fact_pokemon
[0m12:16:06.226161 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:16:06.229012 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
drop table if exists "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup" cascade
[0m12:16:06.232707 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:16:06.234155 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: Close
[0m12:16:06.236060 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47332a2e-ae08-4591-8bab-c6917a175f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d74e452d0>]}
[0m12:16:06.237152 [info ] [Thread-2 (]: 9 of 10 OK created sql table model public.dim_starship_manufacturers ........... [[32mSELECT 27[0m in 0.12s]
[0m12:16:06.237749 [debug] [Thread-1 (]: Postgres adapter: Postgres error: invalid input syntax for type integer: "30-165"

[0m12:16:06.238686 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: ROLLBACK
[0m12:16:06.238308 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:16:06.239316 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m12:16:06.240560 [debug] [Thread-1 (]: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:16:06.241181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47332a2e-ae08-4591-8bab-c6917a175f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d74223ee0>]}
[0m12:16:06.242001 [error] [Thread-1 (]: 10 of 10 ERROR creating sql table model public.fact_starships .................. [[31mERROR[0m in 0.09s]
[0m12:16:06.242808 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m12:16:06.243288 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_starships' to be skipped because of status 'error'.  Reason: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql.
[0m12:16:06.244652 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:06.244994 [debug] [MainThread]: On master: BEGIN
[0m12:16:06.245285 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:16:06.257988 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:16:06.258495 [debug] [MainThread]: On master: COMMIT
[0m12:16:06.258863 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:06.259166 [debug] [MainThread]: On master: COMMIT
[0m12:16:06.259566 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:16:06.259874 [debug] [MainThread]: On master: Close
[0m12:16:06.260533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:06.260879 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_starships' was properly closed.
[0m12:16:06.261206 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_starship_manufacturers' was properly closed.
[0m12:16:06.261549 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_pokemon_types' was properly closed.
[0m12:16:06.261848 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_pokemon' was properly closed.
[0m12:16:06.262304 [info ] [MainThread]: 
[0m12:16:06.262874 [info ] [MainThread]: Finished running 6 table models, 4 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m12:16:06.264621 [debug] [MainThread]: Command end result
[0m12:16:06.289441 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:16:06.291048 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:16:06.297654 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m12:16:06.298072 [info ] [MainThread]: 
[0m12:16:06.298496 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m12:16:06.298851 [info ] [MainThread]: 
[0m12:16:06.299249 [error] [MainThread]:   Database Error in model dim_netrunner_factions (models/marts/dim_netrunner_factions.sql)
  column "faction_name" does not exist
  LINE 14:         faction_name,
                   ^
  HINT:  Perhaps you meant to reference the column "stg_netrunner.faction_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/dim_netrunner_factions.sql
[0m12:16:06.299579 [info ] [MainThread]: 
[0m12:16:06.299950 [error] [MainThread]:   Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  column c.type_name does not exist
  LINE 19:     c.type_name,  
               ^
  HINT:  Perhaps you meant to reference the column "c.type_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql
[0m12:16:06.300288 [info ] [MainThread]: 
[0m12:16:06.300662 [error] [MainThread]:   Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:16:06.300961 [info ] [MainThread]: 
[0m12:16:06.301306 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=0 TOTAL=10
[0m12:16:06.302173 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3590268, "process_in_blocks": "0", "process_kernel_time": 0.099666, "process_mem_max_rss": "115100", "process_out_blocks": "2992", "process_user_time": 2.195972}
[0m12:16:06.302568 [debug] [MainThread]: Command `dbt run` failed at 12:16:06.302487 after 1.36 seconds
[0m12:16:06.302872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d76a44970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d7784b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d76908dc0>]}
[0m12:16:06.303184 [debug] [MainThread]: Flushing usage events
[0m12:16:06.793797 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:17:53.647455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e1fc0940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e2e6b7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e2e6b850>]}


============================== 12:17:53.649955 | 3450f51e-c9b2-453d-9d8d-6e684f49e3a8 ==============================
[0m12:17:53.649955 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:17:53.650500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:17:53.782418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3450f51e-c9b2-453d-9d8d-6e684f49e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e106dc00>]}
[0m12:17:53.831382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3450f51e-c9b2-453d-9d8d-6e684f49e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e106c4c0>]}
[0m12:17:53.832083 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:17:53.905291 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:17:53.999546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:17:54.000215 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/dim_netrunner_factions.sql
[0m12:17:54.215938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3450f51e-c9b2-453d-9d8d-6e684f49e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e021a230>]}
[0m12:17:54.286100 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:17:54.288368 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:17:54.297938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3450f51e-c9b2-453d-9d8d-6e684f49e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e02105b0>]}
[0m12:17:54.298502 [info ] [MainThread]: Found 10 models, 11 sources, 433 macros
[0m12:17:54.298916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3450f51e-c9b2-453d-9d8d-6e684f49e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e02135b0>]}
[0m12:17:54.300750 [info ] [MainThread]: 
[0m12:17:54.301126 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:17:54.301466 [info ] [MainThread]: 
[0m12:17:54.301979 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:17:54.306184 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m12:17:54.336597 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m12:17:54.337001 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m12:17:54.337329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:54.351248 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m12:17:54.352719 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m12:17:54.355150 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public'
[0m12:17:54.361299 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:17:54.361718 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m12:17:54.362020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:54.374792 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:17:54.375232 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:17:54.375575 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:17:54.378501 [debug] [ThreadPool]: SQL status: SELECT 101 in 0.003 seconds
[0m12:17:54.381536 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m12:17:54.382085 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m12:17:54.439729 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:54.440156 [debug] [MainThread]: On master: BEGIN
[0m12:17:54.440472 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:54.453241 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:17:54.453630 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:54.453961 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:17:54.461013 [debug] [MainThread]: SQL status: SELECT 32 in 0.007 seconds
[0m12:17:54.466099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3450f51e-c9b2-453d-9d8d-6e684f49e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e021bac0>]}
[0m12:17:54.466604 [debug] [MainThread]: On master: ROLLBACK
[0m12:17:54.467258 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:54.467565 [debug] [MainThread]: On master: BEGIN
[0m12:17:54.468168 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:17:54.468503 [debug] [MainThread]: On master: COMMIT
[0m12:17:54.468816 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:54.469103 [debug] [MainThread]: On master: COMMIT
[0m12:17:54.469532 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:54.469835 [debug] [MainThread]: On master: Close
[0m12:17:54.472066 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_netrunner
[0m12:17:54.472572 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:17:54.474288 [info ] [Thread-2 (]: 2 of 10 START sql view model public.stg_netrunner_factions ..................... [RUN]
[0m12:17:54.474736 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_nerd_facts, now model.nerd_facts_dbt.stg_netrunner_factions)
[0m12:17:54.473718 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_netrunner .............................. [RUN]
[0m12:17:54.475028 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:17:54.472944 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_pokeapi
[0m12:17:54.473283 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi
[0m12:17:54.475400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.stg_netrunner)
[0m12:17:54.480986 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:17:54.481541 [info ] [Thread-3 (]: 3 of 10 START sql view model public.stg_pokeapi ................................ [RUN]
[0m12:17:54.482096 [info ] [Thread-4 (]: 4 of 10 START sql view model public.stg_swapi .................................. [RUN]
[0m12:17:54.482599 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner
[0m12:17:54.485561 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:17:54.483608 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi'
[0m12:17:54.483159 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_pokeapi'
[0m12:17:54.486021 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi
[0m12:17:54.486356 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_pokeapi
[0m12:17:54.488170 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi"
[0m12:17:54.488504 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_netrunner
[0m12:17:54.488902 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:17:54.490840 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:17:54.512263 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi
[0m12:17:54.535438 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:17:54.540045 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi"
[0m12:17:54.540785 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_pokeapi
[0m12:17:54.541359 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:17:54.548702 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: BEGIN
[0m12:17:54.549511 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:17:54.548195 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:17:54.550770 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:17:54.549151 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:17:54.551119 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: BEGIN
[0m12:17:54.552042 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:17:54.543284 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:17:54.551657 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: BEGIN
[0m12:17:54.553914 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:17:54.553354 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:17:54.555304 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: BEGIN
[0m12:17:54.556108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:54.567460 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m12:17:54.567951 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:17:54.568308 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */

  create view "nerd_facts"."public"."stg_netrunner_factions__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT DISTINCT code, name
    FROM raw.netrunner_factions
)
SELECT
    code AS faction_code,
    name AS faction_name
FROM raw_data
  );
[0m12:17:54.570881 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:17:54.577187 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:17:54.578283 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
alter table "nerd_facts"."public"."stg_netrunner_factions" rename to "stg_netrunner_factions__dbt_backup"
[0m12:17:54.578919 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:17:54.581466 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:17:54.577974 [debug] [Thread-3 (]: SQL status: BEGIN in 0.026 seconds
[0m12:17:54.582143 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:17:54.582471 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */

  create view "nerd_facts"."public"."stg_pokeapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.pokeapi_pokemon
)
SELECT
    id,
    name AS pokemon_name,
    height::NUMERIC / 10.0 AS height_m,
    weight::NUMERIC / 10.0 AS weight_kg,
    base_experience,
    jsonb_array_length(abilities::JSONB) AS num_abilities,  -- ✅ Cast abilities to JSONB
    abilities::JSONB AS abilities_json,  -- ✅ Ensure abilities are stored as JSONB
    (types::JSONB)->0->'type'->>'name' AS primary_type  -- ✅ Ensure types is JSONB before extracting
FROM raw_data
  );
[0m12:17:54.584728 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:17:54.588802 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:17:54.581827 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
alter table "nerd_facts"."public"."stg_netrunner_factions__dbt_tmp" rename to "stg_netrunner_factions"
[0m12:17:54.589350 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
alter table "nerd_facts"."public"."stg_pokeapi" rename to "stg_pokeapi__dbt_backup"
[0m12:17:54.589939 [debug] [Thread-4 (]: SQL status: BEGIN in 0.036 seconds
[0m12:17:54.590291 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:17:54.590620 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m12:17:54.590996 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:17:54.596494 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:17:54.608833 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:17:54.605305 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:17:54.609552 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */

  create view "nerd_facts"."public"."stg_netrunner__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.netrunner_cards
)
SELECT
    id,
    title AS card_name,
    faction_code,
    type_code,
    NULLIF(cost, '')::NUMERIC::INTEGER AS cost,  -- ✅ Double casting to handle decimals safely
    text AS description
FROM raw_data
  );
[0m12:17:54.604790 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: COMMIT
[0m12:17:54.609163 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
alter table "nerd_facts"."public"."stg_pokeapi__dbt_tmp" rename to "stg_pokeapi"
[0m12:17:54.611909 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:17:54.612753 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: COMMIT
[0m12:17:54.605845 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */

  create view "nerd_facts"."public"."stg_swapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.swapi_starships
)
SELECT
    id,
    name AS starship_name,
    model,
    manufacturer,
    NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '[^0-9]', '', 'g'), '')::INTEGER AS max_speed,  -- ✅ Extracts only numbers
    NULLIF(crew, '')::INTEGER AS crew,  -- ✅ Converts crew safely
    NULLIF(passengers, '')::INTEGER AS passengers  -- ✅ Converts passengers safely
FROM raw_data
  );
[0m12:17:54.613204 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:17:54.612306 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:17:54.614772 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: COMMIT
[0m12:17:54.615143 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:17:54.618432 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:17:54.618916 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:17:54.622782 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:17:54.623206 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m12:17:54.623654 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner" rename to "stg_netrunner__dbt_backup"
[0m12:17:54.624062 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: COMMIT
[0m12:17:54.624440 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi" rename to "stg_swapi__dbt_backup"
[0m12:17:54.629961 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner_factions__dbt_backup"
[0m12:17:54.634953 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:17:54.635376 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m12:17:54.635776 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:17:54.642661 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:17:54.636413 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
drop view if exists "nerd_facts"."public"."stg_netrunner_factions__dbt_backup" cascade
[0m12:17:54.639106 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."stg_pokeapi__dbt_backup"
[0m12:17:54.636084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:17:54.643086 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi__dbt_tmp" rename to "stg_swapi"
[0m12:17:54.644674 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:17:54.647379 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:17:54.647773 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:17:54.651722 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: Close
[0m12:17:54.648253 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
drop view if exists "nerd_facts"."public"."stg_pokeapi__dbt_backup" cascade
[0m12:17:54.649348 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner__dbt_tmp" rename to "stg_netrunner"
[0m12:17:54.652887 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:17:54.649001 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:17:54.656854 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:17:54.659565 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:17:54.658748 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m12:17:54.661200 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: Close
[0m12:17:54.654923 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:17:54.661721 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:17:54.662207 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:17:54.659944 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:17:54.664636 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3450f51e-c9b2-453d-9d8d-6e684f49e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e028a3b0>]}
[0m12:17:54.659142 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3450f51e-c9b2-453d-9d8d-6e684f49e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e029d060>]}
[0m12:17:54.666430 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public.stg_netrunner_factions ................ [[32mCREATE VIEW[0m in 0.18s]
[0m12:17:54.665356 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public.stg_pokeapi ........................... [[32mCREATE VIEW[0m in 0.18s]
[0m12:17:54.667122 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:17:54.665750 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:17:54.671037 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner__dbt_backup"
[0m12:17:54.667950 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_pokeapi
[0m12:17:54.667490 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m12:17:54.671811 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:17:54.672440 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:17:54.676290 [info ] [Thread-2 (]: 5 of 10 START sql table model public.dim_pokemon_types ......................... [RUN]
[0m12:17:54.676761 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner_factions, now model.nerd_facts_dbt.dim_pokemon_types)
[0m12:17:54.675800 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
drop view if exists "nerd_facts"."public"."stg_netrunner__dbt_backup" cascade
[0m12:17:54.677113 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.dim_pokemon_types
[0m12:17:54.675048 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."stg_swapi__dbt_backup"
[0m12:17:54.675441 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.fact_pokemon
[0m12:17:54.682176 [info ] [Thread-3 (]: 6 of 10 START sql table model public.fact_pokemon .............................. [RUN]
[0m12:17:54.680831 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:17:54.683943 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: Close
[0m12:17:54.680352 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:17:54.684700 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.dim_pokemon_types
[0m12:17:54.682667 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_pokeapi, now model.nerd_facts_dbt.fact_pokemon)
[0m12:17:54.681664 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:17:54.711382 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
drop view if exists "nerd_facts"."public"."stg_swapi__dbt_backup" cascade
[0m12:17:54.702876 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.fact_pokemon
[0m12:17:54.710876 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:17:54.692872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3450f51e-c9b2-453d-9d8d-6e684f49e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e02774c0>]}
[0m12:17:54.717281 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_netrunner ......................... [[32mCREATE VIEW[0m in 0.22s]
[0m12:17:54.716533 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:17:54.717981 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_netrunner
[0m12:17:54.715580 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_pokemon"
[0m12:17:54.718382 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: BEGIN
[0m12:17:54.719182 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:17:54.719541 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:17:54.720162 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.fact_pokemon
[0m12:17:54.729653 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.018 seconds
[0m12:17:54.731537 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: Close
[0m12:17:54.720815 [info ] [Thread-1 (]: 7 of 10 START sql table model public.dim_netrunner_factions .................... [RUN]
[0m12:17:54.732530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner, now model.nerd_facts_dbt.dim_netrunner_factions)
[0m12:17:54.733042 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:17:54.737243 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:17:54.738124 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3450f51e-c9b2-453d-9d8d-6e684f49e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e2e469e0>]}
[0m12:17:54.742123 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public.stg_swapi ............................. [[32mCREATE VIEW[0m in 0.25s]
[0m12:17:54.743018 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi
[0m12:17:54.743762 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:17:54.743383 [debug] [Thread-2 (]: SQL status: BEGIN in 0.024 seconds
[0m12:17:54.741089 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_pokemon"
[0m12:17:54.744462 [info ] [Thread-4 (]: 8 of 10 START sql table model public.fact_netrunner_cards ...................... [RUN]
[0m12:17:54.746030 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi, now model.nerd_facts_dbt.fact_netrunner_cards)
[0m12:17:54.746798 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:17:54.744974 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:17:54.750490 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */

  
    

  create  table "nerd_facts"."public"."dim_pokemon_types__dbt_tmp"
  
  
    as
  
  (
    WITH types AS (
    SELECT DISTINCT
        primary_type,
        COUNT(*) AS num_pokemon
    FROM "nerd_facts"."public"."stg_pokeapi"
    GROUP BY primary_type
)
SELECT * FROM types
  );
  
[0m12:17:54.750015 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:17:54.745363 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:17:54.746431 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:17:54.757109 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:17:54.757639 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_pokemon: BEGIN
[0m12:17:54.758072 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:17:54.758615 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:17:54.764709 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:17:54.765174 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:17:54.770673 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: BEGIN
[0m12:17:54.771141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:54.766742 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m12:17:54.770087 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:17:54.779047 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_netrunner_cards: BEGIN
[0m12:17:54.779501 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:17:54.778416 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:17:54.790431 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
alter table "nerd_facts"."public"."dim_pokemon_types" rename to "dim_pokemon_types__dbt_backup"
[0m12:17:54.794918 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:17:54.800588 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:17:54.801262 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
alter table "nerd_facts"."public"."dim_pokemon_types__dbt_tmp" rename to "dim_pokemon_types"
[0m12:17:54.802153 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m12:17:54.802635 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:17:54.803486 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */

  
    

  create  table "nerd_facts"."public"."dim_netrunner_factions__dbt_tmp"
  
  
    as
  
  (
    WITH factions AS (
    SELECT DISTINCT ON (f.faction_name)
        f.faction_name,
        COUNT(*) OVER (PARTITION BY f.faction_name) AS num_cards
    FROM "nerd_facts"."public"."stg_netrunner" n
    LEFT JOIN "nerd_facts"."public"."stg_netrunner_factions" f ON n.faction_code = f.faction_code
)
SELECT * FROM factions
  );
  
[0m12:17:54.803096 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:17:54.810601 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: COMMIT
[0m12:17:54.818061 [debug] [Thread-3 (]: SQL status: BEGIN in 0.059 seconds
[0m12:17:54.818734 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:17:54.819251 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */

  
    

  create  table "nerd_facts"."public"."fact_pokemon__dbt_tmp"
  
  
    as
  
  (
    WITH pokemon AS (
    SELECT * FROM "nerd_facts"."public"."stg_pokeapi"
)
SELECT
    id,
    pokemon_name,
    height_m,
    weight_kg,
    num_abilities,
    primary_type
FROM pokemon
  );
  
[0m12:17:54.811293 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:17:54.823004 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: COMMIT
[0m12:17:54.823843 [debug] [Thread-4 (]: SQL status: BEGIN in 0.044 seconds
[0m12:17:54.824348 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:17:54.824832 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */

  
    

  create  table "nerd_facts"."public"."fact_netrunner_cards__dbt_tmp"
  
  
    as
  
  (
    WITH raw_data AS (
    SELECT * FROM "nerd_facts"."public"."stg_netrunner"
)
SELECT
    c.id,
    c.card_name,
    f.faction_name,  
    c.type_name,  
    c.cost,  
    c.description
FROM raw_data c
LEFT JOIN "nerd_facts"."public"."stg_netrunner_factions" f ON c.faction_code = f.faction_code
  );
  
[0m12:17:54.826211 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column c.type_name does not exist
LINE 19:     c.type_name,  
             ^
HINT:  Perhaps you meant to reference the column "c.type_code".

[0m12:17:54.826707 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_netrunner_cards: ROLLBACK
[0m12:17:54.840715 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_netrunner_cards: Close
[0m12:17:54.841372 [debug] [Thread-3 (]: SQL status: SELECT 1302 in 0.022 seconds
[0m12:17:54.847225 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:17:54.841828 [debug] [Thread-2 (]: SQL status: COMMIT in 0.018 seconds
[0m12:17:54.849044 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.044 seconds
[0m12:17:54.857218 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:17:54.857634 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */
alter table "nerd_facts"."public"."dim_netrunner_factions__dbt_tmp" rename to "dim_netrunner_factions"
[0m12:17:54.854205 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."dim_pokemon_types__dbt_backup"
[0m12:17:54.851436 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
alter table "nerd_facts"."public"."fact_pokemon" rename to "fact_pokemon__dbt_backup"
[0m12:17:54.851011 [debug] [Thread-4 (]: Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  column c.type_name does not exist
  LINE 19:     c.type_name,  
               ^
  HINT:  Perhaps you meant to reference the column "c.type_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql
[0m12:17:54.860282 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:17:54.860647 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:17:54.863604 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: COMMIT
[0m12:17:54.863971 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:17:54.862153 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
drop table if exists "nerd_facts"."public"."dim_pokemon_types__dbt_backup" cascade
[0m12:17:54.864318 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: COMMIT
[0m12:17:54.861828 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:17:54.861356 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3450f51e-c9b2-453d-9d8d-6e684f49e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e029f3a0>]}
[0m12:17:54.868500 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:17:54.870598 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
alter table "nerd_facts"."public"."fact_pokemon__dbt_tmp" rename to "fact_pokemon"
[0m12:17:54.869698 [error] [Thread-4 (]: 8 of 10 ERROR creating sql table model public.fact_netrunner_cards ............. [[31mERROR[0m in 0.12s]
[0m12:17:54.870295 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:17:54.868866 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:17:54.875528 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: Close
[0m12:17:54.878029 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3450f51e-c9b2-453d-9d8d-6e684f49e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59df00dea0>]}
[0m12:17:54.871278 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:17:54.879452 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:17:54.874231 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."dim_netrunner_factions__dbt_backup"
[0m12:17:54.878864 [info ] [Thread-2 (]: 5 of 10 OK created sql table model public.dim_pokemon_types .................... [[32mSELECT 1[0m in 0.20s]
[0m12:17:54.881804 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:17:54.879891 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_netrunner_cards' to be skipped because of status 'error'.  Reason: Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  column c.type_name does not exist
  LINE 19:     c.type_name,  
               ^
  HINT:  Perhaps you meant to reference the column "c.type_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql.
[0m12:17:54.880365 [info ] [Thread-4 (]: 9 of 10 START sql table model public.dim_starship_manufacturers ................ [RUN]
[0m12:17:54.881264 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:17:54.871656 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:17:54.885297 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_pokemon: COMMIT
[0m12:17:54.885723 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:17:54.883637 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */
drop table if exists "nerd_facts"."public"."dim_netrunner_factions__dbt_backup" cascade
[0m12:17:54.886075 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_pokemon: COMMIT
[0m12:17:54.883216 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_netrunner_cards, now model.nerd_facts_dbt.dim_starship_manufacturers)
[0m12:17:54.887224 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:17:54.886816 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:17:54.882177 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m12:17:54.892303 [info ] [Thread-2 (]: 10 of 10 START sql table model public.fact_starships ........................... [RUN]
[0m12:17:54.892832 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_pokemon_types, now model.nerd_facts_dbt.fact_starships)
[0m12:17:54.891787 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: Close
[0m12:17:54.893183 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m12:17:54.890544 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m12:17:54.890068 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:17:54.893901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3450f51e-c9b2-453d-9d8d-6e684f49e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59dc63cdf0>]}
[0m12:17:54.899467 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m12:17:54.903358 [info ] [Thread-1 (]: 7 of 10 OK created sql table model public.dim_netrunner_factions ............... [[32mSELECT 11[0m in 0.16s]
[0m12:17:54.902728 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:17:54.904180 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:17:54.902071 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."fact_pokemon__dbt_backup"
[0m12:17:54.904577 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m12:17:54.908891 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:17:54.909831 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:17:54.914715 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
drop table if exists "nerd_facts"."public"."fact_pokemon__dbt_backup" cascade
[0m12:17:54.914121 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m12:17:54.915954 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:17:54.916574 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: BEGIN
[0m12:17:54.916968 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:17:54.917286 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:17:54.917653 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m12:17:54.919376 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:17:54.918850 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:17:54.922513 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_pokemon: Close
[0m12:17:54.927143 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3450f51e-c9b2-453d-9d8d-6e684f49e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59defe8910>]}
[0m12:17:54.928403 [info ] [Thread-3 (]: 6 of 10 OK created sql table model public.fact_pokemon ......................... [[32mSELECT 1302[0m in 0.24s]
[0m12:17:54.929211 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.fact_pokemon
[0m12:17:54.938609 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m12:17:54.939310 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:17:54.939790 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */

  
    

  create  table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp"
  
  
    as
  
  (
    WITH manufacturers AS (
    SELECT DISTINCT
        manufacturer,
        COUNT(*) AS num_starships
    FROM "nerd_facts"."public"."stg_swapi"
    GROUP BY manufacturer
)
SELECT * FROM manufacturers
  );
  
[0m12:17:54.945771 [debug] [Thread-2 (]: SQL status: BEGIN in 0.026 seconds
[0m12:17:54.946242 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:17:54.946629 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  
    

  create  table "nerd_facts"."public"."fact_starships__dbt_tmp"
  
  
    as
  
  (
    WITH starships AS (
    SELECT * FROM "nerd_facts"."public"."stg_swapi"
)
SELECT
    id,
    starship_name,
    model,
    manufacturer,
    max_speed,
    crew,
    passengers
FROM starships
  );
  
[0m12:17:54.947997 [debug] [Thread-4 (]: SQL status: SELECT 27 in 0.008 seconds
[0m12:17:54.951644 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:17:54.952018 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers" rename to "dim_starship_manufacturers__dbt_backup"
[0m12:17:54.952706 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:17:54.955344 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:17:54.955722 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp" rename to "dim_starship_manufacturers"
[0m12:17:54.956382 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:17:54.958295 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:17:54.958628 [debug] [Thread-2 (]: Postgres adapter: Postgres error: invalid input syntax for type integer: "30-165"

[0m12:17:54.959332 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: ROLLBACK
[0m12:17:54.958995 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:17:54.959758 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:17:54.960138 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m12:17:54.961478 [debug] [Thread-2 (]: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:17:54.962112 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3450f51e-c9b2-453d-9d8d-6e684f49e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59df00dea0>]}
[0m12:17:54.962877 [error] [Thread-2 (]: 10 of 10 ERROR creating sql table model public.fact_starships .................. [[31mERROR[0m in 0.07s]
[0m12:17:54.963715 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m12:17:54.964284 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_starships' to be skipped because of status 'error'.  Reason: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql.
[0m12:17:54.966128 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m12:17:54.968448 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup"
[0m12:17:54.969081 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:17:54.969412 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
drop table if exists "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup" cascade
[0m12:17:54.972947 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:17:54.974319 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: Close
[0m12:17:54.974987 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3450f51e-c9b2-453d-9d8d-6e684f49e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e2e469e0>]}
[0m12:17:54.975600 [info ] [Thread-4 (]: 9 of 10 OK created sql table model public.dim_starship_manufacturers ........... [[32mSELECT 27[0m in 0.09s]
[0m12:17:54.976296 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:17:54.977611 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:54.977929 [debug] [MainThread]: On master: BEGIN
[0m12:17:54.978193 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:54.990638 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:17:54.991032 [debug] [MainThread]: On master: COMMIT
[0m12:17:54.991333 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:54.991570 [debug] [MainThread]: On master: COMMIT
[0m12:17:54.991902 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:54.992176 [debug] [MainThread]: On master: Close
[0m12:17:54.992690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:54.992913 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_starships' was properly closed.
[0m12:17:54.993106 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_netrunner_factions' was properly closed.
[0m12:17:54.993298 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_pokemon' was properly closed.
[0m12:17:54.993530 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_starship_manufacturers' was properly closed.
[0m12:17:54.993854 [info ] [MainThread]: 
[0m12:17:54.994122 [info ] [MainThread]: Finished running 6 table models, 4 view models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m12:17:54.995667 [debug] [MainThread]: Command end result
[0m12:17:55.014090 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:17:55.015538 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:17:55.021529 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m12:17:55.021919 [info ] [MainThread]: 
[0m12:17:55.022240 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m12:17:55.022623 [info ] [MainThread]: 
[0m12:17:55.022945 [error] [MainThread]:   Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  column c.type_name does not exist
  LINE 19:     c.type_name,  
               ^
  HINT:  Perhaps you meant to reference the column "c.type_code".
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql
[0m12:17:55.023198 [info ] [MainThread]: 
[0m12:17:55.023549 [error] [MainThread]:   Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:17:55.023894 [info ] [MainThread]: 
[0m12:17:55.024295 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m12:17:55.025670 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.427548, "process_in_blocks": "120", "process_kernel_time": 0.112639, "process_mem_max_rss": "115604", "process_out_blocks": "2984", "process_user_time": 2.263753}
[0m12:17:55.026159 [debug] [MainThread]: Command `dbt run` failed at 12:17:55.026047 after 1.43 seconds
[0m12:17:55.026561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e1fc0940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e1e84b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59dc6317e0>]}
[0m12:17:55.026978 [debug] [MainThread]: Flushing usage events
[0m12:17:55.520397 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:19:33.378949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ed428940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ee24d930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ee24d8d0>]}


============================== 12:19:33.381065 | 13d44971-ada3-4871-af95-6d6b01012467 ==============================
[0m12:19:33.381065 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:19:33.381504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:19:33.508320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13d44971-ada3-4871-af95-6d6b01012467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ec4a1db0>]}
[0m12:19:33.556109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13d44971-ada3-4871-af95-6d6b01012467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ee24d960>]}
[0m12:19:33.556815 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:19:33.634106 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:19:33.727232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:19:33.727818 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/stg_netrunner.sql
[0m12:19:33.728207 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/fact_netrunner_cards.sql
[0m12:19:33.945261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13d44971-ada3-4871-af95-6d6b01012467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0eb64a2f0>]}
[0m12:19:34.006556 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:19:34.008709 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:19:34.017930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13d44971-ada3-4871-af95-6d6b01012467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0eb60d300>]}
[0m12:19:34.018406 [info ] [MainThread]: Found 10 models, 11 sources, 433 macros
[0m12:19:34.018708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13d44971-ada3-4871-af95-6d6b01012467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0eb60e9b0>]}
[0m12:19:34.020326 [info ] [MainThread]: 
[0m12:19:34.020661 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:19:34.020913 [info ] [MainThread]: 
[0m12:19:34.021312 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:19:34.025340 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m12:19:34.058501 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m12:19:34.058959 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m12:19:34.059285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:34.072633 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m12:19:34.073762 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m12:19:34.075478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public'
[0m12:19:34.081631 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:19:34.082006 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m12:19:34.082250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:34.094985 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:19:34.095377 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:19:34.095670 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:19:34.098483 [debug] [ThreadPool]: SQL status: SELECT 102 in 0.003 seconds
[0m12:19:34.144337 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m12:19:34.145176 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m12:19:34.163618 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:34.164000 [debug] [MainThread]: On master: BEGIN
[0m12:19:34.164257 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:19:34.176925 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:19:34.177332 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:34.177655 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:19:34.184655 [debug] [MainThread]: SQL status: SELECT 32 in 0.007 seconds
[0m12:19:34.189459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13d44971-ada3-4871-af95-6d6b01012467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0eda452a0>]}
[0m12:19:34.189851 [debug] [MainThread]: On master: ROLLBACK
[0m12:19:34.190337 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:34.190599 [debug] [MainThread]: On master: BEGIN
[0m12:19:34.191045 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:19:34.191289 [debug] [MainThread]: On master: COMMIT
[0m12:19:34.191520 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:34.191730 [debug] [MainThread]: On master: COMMIT
[0m12:19:34.192216 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:19:34.192453 [debug] [MainThread]: On master: Close
[0m12:19:34.194622 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_netrunner
[0m12:19:34.195166 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_netrunner .............................. [RUN]
[0m12:19:34.195621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.stg_netrunner)
[0m12:19:34.195945 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner
[0m12:19:34.201446 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:19:34.201877 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:19:34.202205 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_pokeapi
[0m12:19:34.203631 [info ] [Thread-3 (]: 3 of 10 START sql view model public.stg_pokeapi ................................ [RUN]
[0m12:19:34.203012 [info ] [Thread-2 (]: 2 of 10 START sql view model public.stg_netrunner_factions ..................... [RUN]
[0m12:19:34.204872 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_nerd_facts, now model.nerd_facts_dbt.stg_netrunner_factions)
[0m12:19:34.204162 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_pokeapi'
[0m12:19:34.204474 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_netrunner
[0m12:19:34.205173 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:19:34.202495 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi
[0m12:19:34.228341 [info ] [Thread-4 (]: 4 of 10 START sql view model public.stg_swapi .................................. [RUN]
[0m12:19:34.212344 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:19:34.205473 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_pokeapi
[0m12:19:34.234145 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi'
[0m12:19:34.239836 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:19:34.239180 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:19:34.241719 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:19:34.242169 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi
[0m12:19:34.246955 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:19:34.247764 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:19:34.249485 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi"
[0m12:19:34.250211 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_pokeapi
[0m12:19:34.250797 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: BEGIN
[0m12:19:34.255686 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:19:34.256160 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi
[0m12:19:34.256634 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:19:34.256980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:34.261496 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi"
[0m12:19:34.262002 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:19:34.264005 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: BEGIN
[0m12:19:34.264327 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:19:34.262366 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: BEGIN
[0m12:19:34.265733 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:19:34.263570 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:19:34.266480 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: BEGIN
[0m12:19:34.266792 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:19:34.281684 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m12:19:34.282178 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:19:34.282539 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */

  create view "nerd_facts"."public"."stg_netrunner__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.netrunner_cards
)
SELECT
    c.id,
    c.title AS card_name,
    c.faction_code,
    f.name AS faction_name,  -- ✅ Join to get faction_name
    c.type_code,
    t.name AS type_name,  -- ✅ Join to get type_name
    c.cost::NUMERIC::INTEGER AS cost,
    c.text AS description
FROM raw_data c
LEFT JOIN raw.netrunner_factions f ON c.faction_code = f.code
LEFT JOIN raw.netrunner_types t ON c.type_code = t.code  -- ✅ Ensure type_name is available
  );
[0m12:19:34.285114 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:19:34.292162 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:19:34.292722 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner" rename to "stg_netrunner__dbt_backup"
[0m12:19:34.293526 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:19:34.298126 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:19:34.298970 [debug] [Thread-2 (]: SQL status: BEGIN in 0.033 seconds
[0m12:19:34.299337 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner__dbt_tmp" rename to "stg_netrunner"
[0m12:19:34.299996 [debug] [Thread-4 (]: SQL status: BEGIN in 0.033 seconds
[0m12:19:34.301014 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:19:34.300655 [debug] [Thread-3 (]: SQL status: BEGIN in 0.036 seconds
[0m12:19:34.300351 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:19:34.301307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:19:34.301627 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */

  create view "nerd_facts"."public"."stg_swapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.swapi_starships
)
SELECT
    id,
    name AS starship_name,
    model,
    manufacturer,
    NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '[^0-9]', '', 'g'), '')::INTEGER AS max_speed,  -- ✅ Extracts only numbers
    NULLIF(crew, '')::INTEGER AS crew,  -- ✅ Converts crew safely
    NULLIF(passengers, '')::INTEGER AS passengers  -- ✅ Converts passengers safely
FROM raw_data
  );
[0m12:19:34.301948 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:19:34.317795 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */

  create view "nerd_facts"."public"."stg_pokeapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.pokeapi_pokemon
)
SELECT
    id,
    name AS pokemon_name,
    height::NUMERIC / 10.0 AS height_m,
    weight::NUMERIC / 10.0 AS weight_kg,
    base_experience,
    jsonb_array_length(abilities::JSONB) AS num_abilities,  -- ✅ Cast abilities to JSONB
    abilities::JSONB AS abilities_json,  -- ✅ Ensure abilities are stored as JSONB
    (types::JSONB)->0->'type'->>'name' AS primary_type  -- ✅ Ensure types is JSONB before extracting
FROM raw_data
  );
[0m12:19:34.317224 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:19:34.318319 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:19:34.318607 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:19:34.320422 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:19:34.302284 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */

  create view "nerd_facts"."public"."stg_netrunner_factions__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT DISTINCT code, name
    FROM raw.netrunner_factions
)
SELECT
    code AS faction_code,
    name AS faction_name
FROM raw_data
  );
[0m12:19:34.323952 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:19:34.325314 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
alter table "nerd_facts"."public"."stg_pokeapi" rename to "stg_pokeapi__dbt_backup"
[0m12:19:34.326180 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:19:34.324342 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:19:34.324708 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m12:19:34.328811 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:19:34.329317 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m12:19:34.334527 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner__dbt_backup"
[0m12:19:34.337832 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:19:34.338273 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
alter table "nerd_facts"."public"."stg_pokeapi__dbt_tmp" rename to "stg_pokeapi"
[0m12:19:34.341366 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:19:34.345282 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:19:34.345827 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi" rename to "stg_swapi__dbt_backup"
[0m12:19:34.346352 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
alter table "nerd_facts"."public"."stg_netrunner_factions" rename to "stg_netrunner_factions__dbt_backup"
[0m12:19:34.346701 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:19:34.347017 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
drop view if exists "nerd_facts"."public"."stg_netrunner__dbt_backup" cascade
[0m12:19:34.348482 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: COMMIT
[0m12:19:34.348829 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:19:34.349152 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:19:34.349550 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:19:34.354301 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:19:34.354774 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m12:19:34.357904 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:19:34.358270 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: COMMIT
[0m12:19:34.358679 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
alter table "nerd_facts"."public"."stg_netrunner_factions__dbt_tmp" rename to "stg_netrunner_factions"
[0m12:19:34.360998 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: Close
[0m12:19:34.363636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13d44971-ada3-4871-af95-6d6b01012467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0eb6d1210>]}
[0m12:19:34.361544 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi__dbt_tmp" rename to "stg_swapi"
[0m12:19:34.364510 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m12:19:34.365448 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:19:34.365078 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_netrunner ......................... [[32mCREATE VIEW[0m in 0.17s]
[0m12:19:34.367879 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."stg_pokeapi__dbt_backup"
[0m12:19:34.368326 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:19:34.372091 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:19:34.370846 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:19:34.372727 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
drop view if exists "nerd_facts"."public"."stg_pokeapi__dbt_backup" cascade
[0m12:19:34.369588 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: COMMIT
[0m12:19:34.372419 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:19:34.373841 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:19:34.374511 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: COMMIT
[0m12:19:34.374200 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:19:34.370108 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_netrunner
[0m12:19:34.375242 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:19:34.376124 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:19:34.377226 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: Close
[0m12:19:34.377913 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m12:19:34.380825 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."stg_swapi__dbt_backup"
[0m12:19:34.382667 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:19:34.383004 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
drop view if exists "nerd_facts"."public"."stg_swapi__dbt_backup" cascade
[0m12:19:34.381901 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13d44971-ada3-4871-af95-6d6b01012467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0eba7ac80>]}
[0m12:19:34.381258 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m12:19:34.375813 [info ] [Thread-1 (]: 5 of 10 START sql table model public.fact_netrunner_cards ...................... [RUN]
[0m12:19:34.384331 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public.stg_pokeapi ........................... [[32mCREATE VIEW[0m in 0.18s]
[0m12:19:34.388261 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_pokeapi
[0m12:19:34.386921 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner_factions__dbt_backup"
[0m12:19:34.387763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner, now model.nerd_facts_dbt.fact_netrunner_cards)
[0m12:19:34.387387 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:19:34.390855 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: Close
[0m12:19:34.391478 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13d44971-ada3-4871-af95-6d6b01012467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0eb6b1c60>]}
[0m12:19:34.392052 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public.stg_swapi ............................. [[32mCREATE VIEW[0m in 0.16s]
[0m12:19:34.392579 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi
[0m12:19:34.388796 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:19:34.393679 [info ] [Thread-3 (]: 6 of 10 START sql table model public.dim_pokemon_types ......................... [RUN]
[0m12:19:34.389730 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:19:34.392961 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.fact_pokemon
[0m12:19:34.394093 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_pokeapi, now model.nerd_facts_dbt.dim_pokemon_types)
[0m12:19:34.389390 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:19:34.396800 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:19:34.397719 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.dim_pokemon_types
[0m12:19:34.397327 [info ] [Thread-4 (]: 7 of 10 START sql table model public.fact_pokemon .............................. [RUN]
[0m12:19:34.398198 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
drop view if exists "nerd_facts"."public"."stg_netrunner_factions__dbt_backup" cascade
[0m12:19:34.400807 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:19:34.401311 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:19:34.401749 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi, now model.nerd_facts_dbt.fact_pokemon)
[0m12:19:34.408217 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m12:19:34.418498 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.dim_pokemon_types
[0m12:19:34.418948 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.fact_pokemon
[0m12:19:34.424210 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:19:34.425553 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: Close
[0m12:19:34.430444 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:19:34.433779 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:19:34.434133 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: BEGIN
[0m12:19:34.434410 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:19:34.436200 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13d44971-ada3-4871-af95-6d6b01012467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0eb0c2260>]}
[0m12:19:34.436967 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public.stg_netrunner_factions ................ [[32mCREATE VIEW[0m in 0.23s]
[0m12:19:34.437689 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:19:34.438021 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:19:34.438387 [info ] [Thread-2 (]: 8 of 10 START sql table model public.dim_starship_manufacturers ................ [RUN]
[0m12:19:34.439097 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner_factions, now model.nerd_facts_dbt.dim_starship_manufacturers)
[0m12:19:34.439478 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:19:34.442361 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:19:34.442819 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:19:34.443721 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: BEGIN
[0m12:19:34.444070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:34.432866 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_pokemon"
[0m12:19:34.445041 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.fact_pokemon
[0m12:19:34.450085 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_pokemon"
[0m12:19:34.450970 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:19:34.451649 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: BEGIN
[0m12:19:34.443303 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:19:34.451955 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:19:34.451394 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m12:19:34.460408 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:19:34.460749 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */

  
    

  create  table "nerd_facts"."public"."dim_pokemon_types__dbt_tmp"
  
  
    as
  
  (
    WITH types AS (
    SELECT DISTINCT
        primary_type,
        COUNT(*) AS num_pokemon
    FROM "nerd_facts"."public"."stg_pokeapi"
    GROUP BY primary_type
)
SELECT * FROM types
  );
  
[0m12:19:34.459499 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:19:34.466074 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:19:34.466582 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: BEGIN
[0m12:19:34.466914 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:19:34.475301 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m12:19:34.475835 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m12:19:34.477643 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:19:34.482557 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:19:34.478010 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:19:34.482971 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
alter table "nerd_facts"."public"."dim_pokemon_types" rename to "dim_pokemon_types__dbt_backup"
[0m12:19:34.476301 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:19:34.484054 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */

  
    

  create  table "nerd_facts"."public"."fact_netrunner_cards__dbt_tmp"
  
  
    as
  
  (
    WITH cards AS (
    SELECT * FROM "nerd_facts"."public"."stg_netrunner"
)
SELECT
    c.id,
    c.card_name,
    c.faction_name,  -- ✅ Already included in stg_netrunner
    c.type_name,  -- ✅ Now available in stg_netrunner
    c.cost,
    c.description
FROM cards c
  );
  
[0m12:19:34.484700 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m12:19:34.485841 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:19:34.486140 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */

  
    

  create  table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp"
  
  
    as
  
  (
    WITH manufacturers AS (
    SELECT DISTINCT
        manufacturer,
        COUNT(*) AS num_starships
    FROM "nerd_facts"."public"."stg_swapi"
    GROUP BY manufacturer
)
SELECT * FROM manufacturers
  );
  
[0m12:19:34.485010 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:19:34.485365 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */

  
    

  create  table "nerd_facts"."public"."fact_pokemon__dbt_tmp"
  
  
    as
  
  (
    WITH pokemon AS (
    SELECT * FROM "nerd_facts"."public"."stg_pokeapi"
)
SELECT
    id,
    pokemon_name,
    height_m,
    weight_kg,
    num_abilities,
    primary_type
FROM pokemon
  );
  
[0m12:19:34.491694 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:19:34.493636 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
alter table "nerd_facts"."public"."dim_pokemon_types__dbt_tmp" rename to "dim_pokemon_types"
[0m12:19:34.494472 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:19:34.499450 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: COMMIT
[0m12:19:34.500223 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:19:34.500578 [debug] [Thread-2 (]: SQL status: SELECT 27 in 0.014 seconds
[0m12:19:34.501018 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: COMMIT
[0m12:19:34.510116 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:19:34.510534 [debug] [Thread-4 (]: SQL status: SELECT 1302 in 0.018 seconds
[0m12:19:34.511132 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers" rename to "dim_starship_manufacturers__dbt_backup"
[0m12:19:34.516484 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:19:34.517123 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m12:19:34.517613 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
alter table "nerd_facts"."public"."fact_pokemon" rename to "fact_pokemon__dbt_backup"
[0m12:19:34.521559 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:19:34.520678 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."dim_pokemon_types__dbt_backup"
[0m12:19:34.518099 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:19:34.536018 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:19:34.536491 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cannot convert NaN to integer

[0m12:19:34.538609 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:19:34.541668 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:19:34.542107 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
drop table if exists "nerd_facts"."public"."dim_pokemon_types__dbt_backup" cascade
[0m12:19:34.542486 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: ROLLBACK
[0m12:19:34.543973 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_netrunner_cards: Close
[0m12:19:34.542848 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
alter table "nerd_facts"."public"."fact_pokemon__dbt_tmp" rename to "fact_pokemon"
[0m12:19:34.544954 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:19:34.548018 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: COMMIT
[0m12:19:34.548513 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:19:34.543228 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp" rename to "dim_starship_manufacturers"
[0m12:19:34.549003 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:19:34.552818 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: COMMIT
[0m12:19:34.552263 [debug] [Thread-1 (]: Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  cannot convert NaN to integer
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql
[0m12:19:34.553927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13d44971-ada3-4871-af95-6d6b01012467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0eb7bfdc0>]}
[0m12:19:34.554613 [error] [Thread-1 (]: 5 of 10 ERROR creating sql table model public.fact_netrunner_cards ............. [[31mERROR[0m in 0.17s]
[0m12:19:34.555231 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:19:34.550610 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: Close
[0m12:19:34.553283 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:19:34.555605 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m12:19:34.556137 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_netrunner_cards' to be skipped because of status 'error'.  Reason: Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  cannot convert NaN to integer
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql.
[0m12:19:34.556537 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m12:19:34.559542 [info ] [Thread-1 (]: 9 of 10 START sql table model public.fact_starships ............................ [RUN]
[0m12:19:34.558898 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:19:34.565419 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."fact_pokemon__dbt_backup"
[0m12:19:34.566146 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13d44971-ada3-4871-af95-6d6b01012467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e82a7d90>]}
[0m12:19:34.566672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_netrunner_cards, now model.nerd_facts_dbt.fact_starships)
[0m12:19:34.567115 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:19:34.567855 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:19:34.568507 [info ] [Thread-3 (]: 6 of 10 OK created sql table model public.dim_pokemon_types .................... [[32mSELECT 1[0m in 0.17s]
[0m12:19:34.568938 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m12:19:34.569306 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:19:34.569671 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
drop table if exists "nerd_facts"."public"."fact_pokemon__dbt_backup" cascade
[0m12:19:34.570167 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:19:34.573007 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m12:19:34.574017 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:19:34.574832 [info ] [Thread-3 (]: 10 of 10 START sql table model public.dim_netrunner_factions ................... [RUN]
[0m12:19:34.575415 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_pokemon_types, now model.nerd_facts_dbt.dim_netrunner_factions)
[0m12:19:34.575911 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:19:34.576306 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m12:19:34.579521 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:19:34.579994 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m12:19:34.587611 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m12:19:34.582686 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup"
[0m12:19:34.589045 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:19:34.588252 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:19:34.580369 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m12:19:34.589393 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
drop table if exists "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup" cascade
[0m12:19:34.595540 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: Close
[0m12:19:34.594218 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:19:34.597969 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:19:34.598422 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_netrunner_factions: BEGIN
[0m12:19:34.598794 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:19:34.599362 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:19:34.601879 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: Close
[0m12:19:34.602537 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13d44971-ada3-4871-af95-6d6b01012467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0eb7e9d20>]}
[0m12:19:34.599985 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13d44971-ada3-4871-af95-6d6b01012467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0eda452a0>]}
[0m12:19:34.596145 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:19:34.603997 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m12:19:34.604320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:34.603106 [info ] [Thread-2 (]: 8 of 10 OK created sql table model public.dim_starship_manufacturers ........... [[32mSELECT 27[0m in 0.16s]
[0m12:19:34.605778 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:19:34.603676 [info ] [Thread-4 (]: 7 of 10 OK created sql table model public.fact_pokemon ......................... [[32mSELECT 1302[0m in 0.20s]
[0m12:19:34.606927 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.fact_pokemon
[0m12:19:34.621320 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m12:19:34.621901 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:19:34.622266 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */

  
    

  create  table "nerd_facts"."public"."dim_netrunner_factions__dbt_tmp"
  
  
    as
  
  (
    WITH factions AS (
    SELECT DISTINCT ON (f.faction_name)
        f.faction_name,
        COUNT(*) OVER (PARTITION BY f.faction_name) AS num_cards
    FROM "nerd_facts"."public"."stg_netrunner" n
    LEFT JOIN "nerd_facts"."public"."stg_netrunner_factions" f ON n.faction_code = f.faction_code
)
SELECT * FROM factions
  );
  
[0m12:19:34.627482 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m12:19:34.628095 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:19:34.628510 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  
    

  create  table "nerd_facts"."public"."fact_starships__dbt_tmp"
  
  
    as
  
  (
    WITH starships AS (
    SELECT * FROM "nerd_facts"."public"."stg_swapi"
)
SELECT
    id,
    starship_name,
    model,
    manufacturer,
    max_speed,
    crew,
    passengers
FROM starships
  );
  
[0m12:19:34.637729 [debug] [Thread-1 (]: Postgres adapter: Postgres error: invalid input syntax for type integer: "30-165"

[0m12:19:34.638330 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: ROLLBACK
[0m12:19:34.638899 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m12:19:34.642574 [debug] [Thread-1 (]: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:19:34.643198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13d44971-ada3-4871-af95-6d6b01012467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ea4468f0>]}
[0m12:19:34.643865 [error] [Thread-1 (]: 9 of 10 ERROR creating sql table model public.fact_starships ................... [[31mERROR[0m in 0.08s]
[0m12:19:34.644438 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m12:19:34.644952 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_starships' to be skipped because of status 'error'.  Reason: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql.
[0m12:19:36.670580 [debug] [Thread-3 (]: SQL status: SELECT 11 in 2.041 seconds
[0m12:19:36.675715 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:19:36.676348 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */
alter table "nerd_facts"."public"."dim_netrunner_factions" rename to "dim_netrunner_factions__dbt_backup"
[0m12:19:36.677633 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:19:36.682374 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:19:36.682813 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */
alter table "nerd_facts"."public"."dim_netrunner_factions__dbt_tmp" rename to "dim_netrunner_factions"
[0m12:19:36.683478 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:19:36.685070 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_netrunner_factions: COMMIT
[0m12:19:36.685449 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:19:36.685814 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_netrunner_factions: COMMIT
[0m12:19:36.688330 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m12:19:36.690415 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."dim_netrunner_factions__dbt_backup"
[0m12:19:36.691111 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:19:36.691419 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */
drop table if exists "nerd_facts"."public"."dim_netrunner_factions__dbt_backup" cascade
[0m12:19:36.694715 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:19:36.695866 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_netrunner_factions: Close
[0m12:19:36.696581 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13d44971-ada3-4871-af95-6d6b01012467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0eb846500>]}
[0m12:19:36.697149 [info ] [Thread-3 (]: 10 of 10 OK created sql table model public.dim_netrunner_factions .............. [[32mSELECT 11[0m in 2.12s]
[0m12:19:36.697653 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:19:36.698881 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:36.699216 [debug] [MainThread]: On master: BEGIN
[0m12:19:36.699459 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:19:36.712099 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:19:36.712523 [debug] [MainThread]: On master: COMMIT
[0m12:19:36.712805 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:36.713033 [debug] [MainThread]: On master: COMMIT
[0m12:19:36.713353 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:19:36.713617 [debug] [MainThread]: On master: Close
[0m12:19:36.714071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:36.714301 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_starship_manufacturers' was properly closed.
[0m12:19:36.714495 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_starships' was properly closed.
[0m12:19:36.714681 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_netrunner_factions' was properly closed.
[0m12:19:36.714869 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_pokemon' was properly closed.
[0m12:19:36.715190 [info ] [MainThread]: 
[0m12:19:36.715478 [info ] [MainThread]: Finished running 6 table models, 4 view models in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m12:19:36.716976 [debug] [MainThread]: Command end result
[0m12:19:36.734859 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:19:36.736324 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:19:36.743250 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m12:19:36.743692 [info ] [MainThread]: 
[0m12:19:36.744116 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m12:19:36.744464 [info ] [MainThread]: 
[0m12:19:36.744846 [error] [MainThread]:   Database Error in model fact_netrunner_cards (models/marts/fact_netrunner_cards.sql)
  cannot convert NaN to integer
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_netrunner_cards.sql
[0m12:19:36.745168 [info ] [MainThread]: 
[0m12:19:36.745552 [error] [MainThread]:   Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:19:36.745880 [info ] [MainThread]: 
[0m12:19:36.746221 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m12:19:36.747244 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.4132016, "process_in_blocks": "1728", "process_kernel_time": 0.124339, "process_mem_max_rss": "115284", "process_out_blocks": "2984", "process_user_time": 2.209246}
[0m12:19:36.747644 [debug] [MainThread]: Command `dbt run` failed at 12:19:36.747531 after 3.41 seconds
[0m12:19:36.748099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ed428940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0eb63bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ea3b17b0>]}
[0m12:19:36.748486 [debug] [MainThread]: Flushing usage events
[0m12:19:37.246051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:21:16.809907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e97dc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ea6877c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ea687820>]}


============================== 12:21:16.812781 | e6769030-418f-4258-850a-1e69ba05a210 ==============================
[0m12:21:16.812781 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:21:16.813209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:21:16.941079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6769030-418f-4258-850a-1e69ba05a210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e8888100>]}
[0m12:21:16.990591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6769030-418f-4258-850a-1e69ba05a210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ea687790>]}
[0m12:21:16.991377 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:21:17.088963 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:21:17.183538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:21:17.184180 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/stg_netrunner.sql
[0m12:21:17.406458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6769030-418f-4258-850a-1e69ba05a210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e7a3a170>]}
[0m12:21:17.476221 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:21:17.478540 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:21:17.488519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6769030-418f-4258-850a-1e69ba05a210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e7a07b50>]}
[0m12:21:17.489069 [info ] [MainThread]: Found 10 models, 11 sources, 433 macros
[0m12:21:17.489476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6769030-418f-4258-850a-1e69ba05a210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e7a05180>]}
[0m12:21:17.491302 [info ] [MainThread]: 
[0m12:21:17.491692 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:21:17.492032 [info ] [MainThread]: 
[0m12:21:17.492548 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:21:17.497107 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m12:21:17.528832 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m12:21:17.529247 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m12:21:17.529665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:17.545356 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m12:21:17.546678 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m12:21:17.549192 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public'
[0m12:21:17.555364 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:21:17.555806 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m12:21:17.556144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:17.568795 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:21:17.569243 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:21:17.569613 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:21:17.572417 [debug] [ThreadPool]: SQL status: SELECT 102 in 0.002 seconds
[0m12:21:17.575844 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m12:21:17.576389 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m12:21:17.635733 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:17.636160 [debug] [MainThread]: On master: BEGIN
[0m12:21:17.636407 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:21:17.648697 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:21:17.649153 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:17.649564 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:21:17.656949 [debug] [MainThread]: SQL status: SELECT 34 in 0.007 seconds
[0m12:21:17.662058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6769030-418f-4258-850a-1e69ba05a210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e7a39f60>]}
[0m12:21:17.662492 [debug] [MainThread]: On master: ROLLBACK
[0m12:21:17.663100 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:17.663400 [debug] [MainThread]: On master: BEGIN
[0m12:21:17.664034 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:21:17.664333 [debug] [MainThread]: On master: COMMIT
[0m12:21:17.664611 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:17.664862 [debug] [MainThread]: On master: COMMIT
[0m12:21:17.665352 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:21:17.665667 [debug] [MainThread]: On master: Close
[0m12:21:17.667861 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_netrunner
[0m12:21:17.668402 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:21:17.669984 [info ] [Thread-2 (]: 2 of 10 START sql view model public.stg_netrunner_factions ..................... [RUN]
[0m12:21:17.670418 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_nerd_facts, now model.nerd_facts_dbt.stg_netrunner_factions)
[0m12:21:17.669454 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_netrunner .............................. [RUN]
[0m12:21:17.670713 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:21:17.668743 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_pokeapi
[0m12:21:17.669008 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi
[0m12:21:17.671087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.stg_netrunner)
[0m12:21:17.676596 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:21:17.677110 [info ] [Thread-3 (]: 3 of 10 START sql view model public.stg_pokeapi ................................ [RUN]
[0m12:21:17.677564 [info ] [Thread-4 (]: 4 of 10 START sql view model public.stg_swapi .................................. [RUN]
[0m12:21:17.678139 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner
[0m12:21:17.678699 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_pokeapi'
[0m12:21:17.681664 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_pokeapi
[0m12:21:17.683200 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:21:17.681252 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:21:17.683705 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_pokeapi
[0m12:21:17.679163 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi'
[0m12:21:17.679604 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:21:17.689406 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi
[0m12:21:17.705184 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_netrunner
[0m12:21:17.723615 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi"
[0m12:21:17.721888 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:21:17.727991 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:21:17.729558 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:21:17.730210 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi
[0m12:21:17.731007 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:21:17.731365 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:21:17.736198 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi"
[0m12:21:17.736698 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: BEGIN
[0m12:21:17.737072 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: BEGIN
[0m12:21:17.737540 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:21:17.739201 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: BEGIN
[0m12:21:17.739517 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:21:17.738855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:17.738035 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:21:17.738547 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:21:17.743115 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: BEGIN
[0m12:21:17.744102 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:21:17.769896 [debug] [Thread-4 (]: SQL status: BEGIN in 0.026 seconds
[0m12:21:17.770538 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:21:17.771032 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */

  create view "nerd_facts"."public"."stg_swapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.swapi_starships
)
SELECT
    id,
    name AS starship_name,
    model,
    manufacturer,
    NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '[^0-9]', '', 'g'), '')::INTEGER AS max_speed,  -- ✅ Extracts only numbers
    NULLIF(crew, '')::INTEGER AS crew,  -- ✅ Converts crew safely
    NULLIF(passengers, '')::INTEGER AS passengers  -- ✅ Converts passengers safely
FROM raw_data
  );
[0m12:21:17.774210 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m12:21:17.786078 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:21:17.786665 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi" rename to "stg_swapi__dbt_backup"
[0m12:21:17.787689 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:21:17.792901 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:21:17.793718 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi__dbt_tmp" rename to "stg_swapi"
[0m12:21:17.794414 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m12:21:17.794942 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:21:17.795332 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:21:17.795765 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */

  create view "nerd_facts"."public"."stg_netrunner__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.netrunner_cards
)
SELECT
    c.id,
    c.title AS card_name,
    c.faction_code,
    f.name AS faction_name,  
    c.type_code,
    t.name AS type_name,  
    CASE 
        WHEN c.cost IN ('NaN', '') THEN NULL  -- ✅ Replace NaN or empty strings with NULL
        ELSE c.cost::NUMERIC::INTEGER 
    END AS cost,  -- ✅ Convert only valid numbers
    c.text AS description
FROM raw_data c
LEFT JOIN raw.netrunner_factions f ON c.faction_code = f.code
LEFT JOIN raw.netrunner_types t ON c.type_code = t.code
  );
[0m12:21:17.796110 [debug] [Thread-3 (]: SQL status: BEGIN in 0.058 seconds
[0m12:21:17.815829 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:21:17.815032 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:21:17.815473 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m12:21:17.796397 [debug] [Thread-2 (]: SQL status: BEGIN in 0.057 seconds
[0m12:21:17.816281 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */

  create view "nerd_facts"."public"."stg_pokeapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.pokeapi_pokemon
)
SELECT
    id,
    name AS pokemon_name,
    height::NUMERIC / 10.0 AS height_m,
    weight::NUMERIC / 10.0 AS weight_kg,
    base_experience,
    jsonb_array_length(abilities::JSONB) AS num_abilities,  -- ✅ Cast abilities to JSONB
    abilities::JSONB AS abilities_json,  -- ✅ Ensure abilities are stored as JSONB
    (types::JSONB)->0->'type'->>'name' AS primary_type  -- ✅ Ensure types is JSONB before extracting
FROM raw_data
  );
[0m12:21:17.816709 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:21:17.820711 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:21:17.821202 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:21:17.823747 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:21:17.824185 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m12:21:17.828492 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:21:17.825046 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */

  create view "nerd_facts"."public"."stg_netrunner_factions__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT DISTINCT code, name
    FROM raw.netrunner_factions
)
SELECT
    code AS faction_code,
    name AS faction_name
FROM raw_data
  );
[0m12:21:17.824632 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner" rename to "stg_netrunner__dbt_backup"
[0m12:21:17.828998 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
alter table "nerd_facts"."public"."stg_pokeapi" rename to "stg_pokeapi__dbt_backup"
[0m12:21:17.831082 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:21:17.831617 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:21:17.838613 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:21:17.835122 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:21:17.841873 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:21:17.831977 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m12:21:17.838986 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
alter table "nerd_facts"."public"."stg_netrunner_factions" rename to "stg_netrunner_factions__dbt_backup"
[0m12:21:17.834811 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:21:17.848478 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner__dbt_tmp" rename to "stg_netrunner"
[0m12:21:17.847864 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."stg_swapi__dbt_backup"
[0m12:21:17.842251 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
alter table "nerd_facts"."public"."stg_pokeapi__dbt_tmp" rename to "stg_pokeapi"
[0m12:21:17.853369 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:21:17.853815 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:21:17.856630 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:21:17.857023 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:21:17.855143 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
drop view if exists "nerd_facts"."public"."stg_swapi__dbt_backup" cascade
[0m12:21:17.854352 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:21:17.857355 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:21:17.854769 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:21:17.863110 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: COMMIT
[0m12:21:17.861531 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:21:17.863486 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:21:17.866128 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: COMMIT
[0m12:21:17.865709 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: Close
[0m12:21:17.861128 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:21:17.867240 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
alter table "nerd_facts"."public"."stg_netrunner_factions__dbt_tmp" rename to "stg_netrunner_factions"
[0m12:21:17.866694 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:21:17.871111 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner__dbt_backup"
[0m12:21:17.871488 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:21:17.875820 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: COMMIT
[0m12:21:17.873611 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6769030-418f-4258-850a-1e69ba05a210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e7abc2b0>]}
[0m12:21:17.876876 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public.stg_swapi ............................. [[32mCREATE VIEW[0m in 0.19s]
[0m12:21:17.871805 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m12:21:17.876204 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:21:17.880473 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: COMMIT
[0m12:21:17.880073 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."stg_pokeapi__dbt_backup"
[0m12:21:17.881401 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:21:17.874345 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:21:17.881798 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
drop view if exists "nerd_facts"."public"."stg_pokeapi__dbt_backup" cascade
[0m12:21:17.877479 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi
[0m12:21:17.882193 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
drop view if exists "nerd_facts"."public"."stg_netrunner__dbt_backup" cascade
[0m12:21:17.883291 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m12:21:17.884017 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:21:17.887552 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner_factions__dbt_backup"
[0m12:21:17.889401 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:21:17.888241 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:21:17.887961 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m12:21:17.888612 [info ] [Thread-4 (]: 5 of 10 START sql table model public.dim_starship_manufacturers ................ [RUN]
[0m12:21:17.889863 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
drop view if exists "nerd_facts"."public"."stg_netrunner_factions__dbt_backup" cascade
[0m12:21:17.891025 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: Close
[0m12:21:17.893292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6769030-418f-4258-850a-1e69ba05a210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e7b1c1f0>]}
[0m12:21:17.892561 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi, now model.nerd_facts_dbt.dim_starship_manufacturers)
[0m12:21:17.894484 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:21:17.892142 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: Close
[0m12:21:17.897213 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:21:17.897676 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m12:21:17.901099 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: Close
[0m12:21:17.898415 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6769030-418f-4258-850a-1e69ba05a210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e8853a00>]}
[0m12:21:17.901832 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public.stg_pokeapi ........................... [[32mCREATE VIEW[0m in 0.22s]
[0m12:21:17.894064 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_netrunner ......................... [[32mCREATE VIEW[0m in 0.22s]
[0m12:21:17.904659 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:21:17.905177 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_pokeapi
[0m12:21:17.905753 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6769030-418f-4258-850a-1e69ba05a210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e7eb1b10>]}
[0m12:21:17.906317 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_netrunner
[0m12:21:17.917191 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m12:21:17.928470 [info ] [Thread-3 (]: 6 of 10 START sql table model public.fact_starships ............................ [RUN]
[0m12:21:17.927292 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public.stg_netrunner_factions ................ [[32mCREATE VIEW[0m in 0.24s]
[0m12:21:17.927875 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:21:17.929898 [info ] [Thread-1 (]: 7 of 10 START sql table model public.dim_pokemon_types ......................... [RUN]
[0m12:21:17.930357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner, now model.nerd_facts_dbt.dim_pokemon_types)
[0m12:21:17.929496 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:21:17.931035 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.fact_pokemon
[0m12:21:17.926411 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:21:17.928969 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_pokeapi, now model.nerd_facts_dbt.fact_starships)
[0m12:21:17.932142 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m12:21:17.931495 [info ] [Thread-2 (]: 8 of 10 START sql table model public.fact_pokemon .............................. [RUN]
[0m12:21:17.930682 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.dim_pokemon_types
[0m12:21:17.932555 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:21:17.935879 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m12:21:17.936395 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner_factions, now model.nerd_facts_dbt.fact_pokemon)
[0m12:21:17.938726 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:21:17.939165 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: BEGIN
[0m12:21:17.939586 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.fact_pokemon
[0m12:21:17.940113 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m12:21:17.940516 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.dim_pokemon_types
[0m12:21:17.940815 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:21:17.943085 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_pokemon"
[0m12:21:17.947417 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m12:21:17.951743 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:21:17.952942 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.fact_pokemon
[0m12:21:17.962051 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_pokemon"
[0m12:21:17.962687 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:21:17.963472 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_pokemon_types: BEGIN
[0m12:21:17.963796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:17.963018 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:21:17.967693 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m12:21:17.968018 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:21:17.965352 [debug] [Thread-4 (]: SQL status: BEGIN in 0.024 seconds
[0m12:21:17.976660 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:21:17.977078 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */

  
    

  create  table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp"
  
  
    as
  
  (
    WITH manufacturers AS (
    SELECT DISTINCT
        manufacturer,
        COUNT(*) AS num_starships
    FROM "nerd_facts"."public"."stg_swapi"
    GROUP BY manufacturer
)
SELECT * FROM manufacturers
  );
  
[0m12:21:17.969458 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:21:17.977571 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_pokemon: BEGIN
[0m12:21:17.977881 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:21:17.980621 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m12:21:17.981093 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:21:17.981480 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */

  
    

  create  table "nerd_facts"."public"."dim_pokemon_types__dbt_tmp"
  
  
    as
  
  (
    WITH types AS (
    SELECT DISTINCT
        primary_type,
        COUNT(*) AS num_pokemon
    FROM "nerd_facts"."public"."stg_pokeapi"
    GROUP BY primary_type
)
SELECT * FROM types
  );
  
[0m12:21:17.984544 [debug] [Thread-4 (]: SQL status: SELECT 27 in 0.007 seconds
[0m12:21:17.988301 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:21:17.988774 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers" rename to "dim_starship_manufacturers__dbt_backup"
[0m12:21:17.989508 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:21:17.993562 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:21:17.993908 [debug] [Thread-3 (]: SQL status: BEGIN in 0.026 seconds
[0m12:21:17.994660 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:21:17.994964 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  
    

  create  table "nerd_facts"."public"."fact_starships__dbt_tmp"
  
  
    as
  
  (
    WITH starships AS (
    SELECT * FROM "nerd_facts"."public"."stg_swapi"
)
SELECT
    id,
    starship_name,
    model,
    manufacturer,
    max_speed,
    crew,
    passengers
FROM starships
  );
  
[0m12:21:17.994332 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp" rename to "dim_starship_manufacturers"
[0m12:21:17.996201 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m12:21:17.996616 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:21:17.996952 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */

  
    

  create  table "nerd_facts"."public"."fact_pokemon__dbt_tmp"
  
  
    as
  
  (
    WITH pokemon AS (
    SELECT * FROM "nerd_facts"."public"."stg_pokeapi"
)
SELECT
    id,
    pokemon_name,
    height_m,
    weight_kg,
    num_abilities,
    primary_type
FROM pokemon
  );
  
[0m12:21:17.997675 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:21:18.001942 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:21:18.002495 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:21:18.003112 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:21:18.004579 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.023 seconds
[0m12:21:18.008741 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:21:18.009168 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
alter table "nerd_facts"."public"."dim_pokemon_types" rename to "dim_pokemon_types__dbt_backup"
[0m12:21:18.009919 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:21:18.013493 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:21:18.013997 [debug] [Thread-3 (]: Postgres adapter: Postgres error: invalid input syntax for type integer: "30-165"

[0m12:21:18.015045 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_starships: ROLLBACK
[0m12:21:18.014669 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
alter table "nerd_facts"."public"."dim_pokemon_types__dbt_tmp" rename to "dim_pokemon_types"
[0m12:21:18.014350 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m12:21:18.015636 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m12:21:18.017987 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup"
[0m12:21:18.023770 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:21:18.020790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:21:18.025910 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_pokemon_types: COMMIT
[0m12:21:18.024301 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
drop table if exists "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup" cascade
[0m12:21:18.020398 [debug] [Thread-2 (]: SQL status: SELECT 1302 in 0.023 seconds
[0m12:21:18.026367 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:21:18.031266 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:21:18.031824 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_pokemon_types: COMMIT
[0m12:21:18.032704 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
alter table "nerd_facts"."public"."fact_pokemon" rename to "fact_pokemon__dbt_backup"
[0m12:21:18.033260 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:21:18.034249 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:21:18.035950 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: Close
[0m12:21:18.036446 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:21:18.044186 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."dim_pokemon_types__dbt_backup"
[0m12:21:18.046865 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:21:18.047350 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
drop table if exists "nerd_facts"."public"."dim_pokemon_types__dbt_backup" cascade
[0m12:21:18.039348 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:21:18.048458 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
alter table "nerd_facts"."public"."fact_pokemon__dbt_tmp" rename to "fact_pokemon"
[0m12:21:18.047965 [debug] [Thread-3 (]: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:21:18.044944 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6769030-418f-4258-850a-1e69ba05a210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e6789450>]}
[0m12:21:18.049082 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6769030-418f-4258-850a-1e69ba05a210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e68aa4d0>]}
[0m12:21:18.050422 [error] [Thread-3 (]: 6 of 10 ERROR creating sql table model public.fact_starships ................... [[31mERROR[0m in 0.12s]
[0m12:21:18.050999 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m12:21:18.051323 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:21:18.053102 [info ] [Thread-3 (]: 9 of 10 START sql table model public.fact_netrunner_cards ...................... [RUN]
[0m12:21:18.051745 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_starships' to be skipped because of status 'error'.  Reason: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql.
[0m12:21:18.052625 [info ] [Thread-4 (]: 5 of 10 OK created sql table model public.dim_starship_manufacturers ........... [[32mSELECT 27[0m in 0.15s]
[0m12:21:18.055045 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:21:18.053601 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:21:18.053999 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_starships, now model.nerd_facts_dbt.fact_netrunner_cards)
[0m12:21:18.056996 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:21:18.055363 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:21:18.056620 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_pokemon_types: Close
[0m12:21:18.059321 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:21:18.049538 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:21:18.061572 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_pokemon: COMMIT
[0m12:21:18.062056 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:21:18.062468 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_pokemon: COMMIT
[0m12:21:18.059900 [info ] [Thread-4 (]: 10 of 10 START sql table model public.dim_netrunner_factions ................... [RUN]
[0m12:21:18.063292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6769030-418f-4258-850a-1e69ba05a210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e7b1c1f0>]}
[0m12:21:18.063830 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:21:18.064521 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_starship_manufacturers, now model.nerd_facts_dbt.dim_netrunner_factions)
[0m12:21:18.071067 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:21:18.070278 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:21:18.070683 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m12:21:18.073943 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:21:18.065140 [info ] [Thread-1 (]: 7 of 10 OK created sql table model public.dim_pokemon_types .................... [[32mSELECT 1[0m in 0.13s]
[0m12:21:18.076190 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."fact_pokemon__dbt_backup"
[0m12:21:18.078379 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:21:18.077244 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:21:18.077672 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:21:18.078675 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
drop table if exists "nerd_facts"."public"."fact_pokemon__dbt_backup" cascade
[0m12:21:18.076809 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:21:18.083524 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:21:18.084861 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: BEGIN
[0m12:21:18.085354 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:21:18.085781 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:21:18.086208 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: BEGIN
[0m12:21:18.086954 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:21:18.087650 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:21:18.089062 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_pokemon: Close
[0m12:21:18.092351 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6769030-418f-4258-850a-1e69ba05a210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e67f0640>]}
[0m12:21:18.093020 [info ] [Thread-2 (]: 8 of 10 OK created sql table model public.fact_pokemon ......................... [[32mSELECT 1302[0m in 0.16s]
[0m12:21:18.093740 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.fact_pokemon
[0m12:21:18.103151 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m12:21:18.103578 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:21:18.104859 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */

  
    

  create  table "nerd_facts"."public"."fact_netrunner_cards__dbt_tmp"
  
  
    as
  
  (
    WITH cards AS (
    SELECT * FROM "nerd_facts"."public"."stg_netrunner"
)
SELECT
    c.id,
    c.card_name,
    c.faction_name,  -- ✅ Already included in stg_netrunner
    c.type_name,  -- ✅ Now available in stg_netrunner
    c.cost,
    c.description
FROM cards c
  );
  
[0m12:21:18.105219 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m12:21:18.105613 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:21:18.105902 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */

  
    

  create  table "nerd_facts"."public"."dim_netrunner_factions__dbt_tmp"
  
  
    as
  
  (
    WITH factions AS (
    SELECT DISTINCT ON (f.faction_name)
        f.faction_name,
        COUNT(*) OVER (PARTITION BY f.faction_name) AS num_cards
    FROM "nerd_facts"."public"."stg_netrunner" n
    LEFT JOIN "nerd_facts"."public"."stg_netrunner_factions" f ON n.faction_code = f.faction_code
)
SELECT * FROM factions
  );
  
[0m12:21:20.690804 [debug] [Thread-4 (]: SQL status: SELECT 11 in 2.584 seconds
[0m12:21:20.696087 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:21:20.696576 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */
alter table "nerd_facts"."public"."dim_netrunner_factions" rename to "dim_netrunner_factions__dbt_backup"
[0m12:21:20.697449 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:21:20.700946 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:21:20.701402 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */
alter table "nerd_facts"."public"."dim_netrunner_factions__dbt_tmp" rename to "dim_netrunner_factions"
[0m12:21:20.702087 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:21:20.703453 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: COMMIT
[0m12:21:20.703827 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:21:20.704173 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: COMMIT
[0m12:21:20.711267 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m12:21:20.714004 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."dim_netrunner_factions__dbt_backup"
[0m12:21:20.714763 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:21:20.715094 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */
drop table if exists "nerd_facts"."public"."dim_netrunner_factions__dbt_backup" cascade
[0m12:21:20.719105 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:21:20.720622 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: Close
[0m12:21:20.722477 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6769030-418f-4258-850a-1e69ba05a210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e79ffa00>]}
[0m12:21:20.723213 [info ] [Thread-4 (]: 10 of 10 OK created sql table model public.dim_netrunner_factions .............. [[32mSELECT 11[0m in 2.66s]
[0m12:21:20.723990 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:21:24.312498 [debug] [Thread-3 (]: SQL status: SELECT 3044070 in 6.207 seconds
[0m12:21:24.315226 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:21:24.315566 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */
alter table "nerd_facts"."public"."fact_netrunner_cards__dbt_tmp" rename to "fact_netrunner_cards"
[0m12:21:24.316421 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:21:24.317823 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: COMMIT
[0m12:21:24.318134 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:21:24.318403 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: COMMIT
[0m12:21:24.327297 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m12:21:24.330886 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."fact_netrunner_cards__dbt_backup"
[0m12:21:24.331848 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:21:24.332301 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */
drop table if exists "nerd_facts"."public"."fact_netrunner_cards__dbt_backup" cascade
[0m12:21:24.333037 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:21:24.334643 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: Close
[0m12:21:24.335807 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6769030-418f-4258-850a-1e69ba05a210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e68aa4d0>]}
[0m12:21:24.336585 [info ] [Thread-3 (]: 9 of 10 OK created sql table model public.fact_netrunner_cards ................. [[32mSELECT 3044070[0m in 6.28s]
[0m12:21:24.337274 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:21:24.340935 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:24.341399 [debug] [MainThread]: On master: BEGIN
[0m12:21:24.341768 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:21:24.365609 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m12:21:24.366088 [debug] [MainThread]: On master: COMMIT
[0m12:21:24.366419 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:24.366685 [debug] [MainThread]: On master: COMMIT
[0m12:21:24.367047 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:21:24.367325 [debug] [MainThread]: On master: Close
[0m12:21:24.367847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:24.368135 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_pokemon' was properly closed.
[0m12:21:24.368399 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_pokemon_types' was properly closed.
[0m12:21:24.368670 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_netrunner_cards' was properly closed.
[0m12:21:24.368901 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_netrunner_factions' was properly closed.
[0m12:21:24.371670 [info ] [MainThread]: 
[0m12:21:24.372157 [info ] [MainThread]: Finished running 6 table models, 4 view models in 0 hours 0 minutes and 6.88 seconds (6.88s).
[0m12:21:24.373756 [debug] [MainThread]: Command end result
[0m12:21:24.395895 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:21:24.397616 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:21:24.403632 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m12:21:24.404054 [info ] [MainThread]: 
[0m12:21:24.404395 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:21:24.404682 [info ] [MainThread]: 
[0m12:21:24.405029 [error] [MainThread]:   Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "30-165"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:21:24.405396 [info ] [MainThread]: 
[0m12:21:24.406278 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m12:21:24.410930 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.6486306, "process_in_blocks": "7536", "process_kernel_time": 0.091821, "process_mem_max_rss": "114380", "process_out_blocks": "3000", "process_user_time": 2.282203}
[0m12:21:24.411489 [debug] [MainThread]: Command `dbt run` failed at 12:21:24.411370 after 7.65 seconds
[0m12:21:24.411919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e97dc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e7a07b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e9c76020>]}
[0m12:21:24.412311 [debug] [MainThread]: Flushing usage events
[0m12:21:24.892185 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:23:24.929132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44da3908e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d93477c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d9347820>]}


============================== 12:23:24.932212 | 2df35051-8255-4887-9dde-cc0897017a3d ==============================
[0m12:23:24.932212 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:23:24.932712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:23:25.083365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2df35051-8255-4887-9dde-cc0897017a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d96f5e70>]}
[0m12:23:25.131824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2df35051-8255-4887-9dde-cc0897017a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d9403a30>]}
[0m12:23:25.133004 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:23:25.212077 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:23:25.326851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:23:25.327465 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/stg_swapi.sql
[0m12:23:25.534989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2df35051-8255-4887-9dde-cc0897017a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d3f3a140>]}
[0m12:23:25.601149 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:23:25.603507 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:23:25.617650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2df35051-8255-4887-9dde-cc0897017a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d85b9f90>]}
[0m12:23:25.618113 [info ] [MainThread]: Found 10 models, 11 sources, 433 macros
[0m12:23:25.618429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2df35051-8255-4887-9dde-cc0897017a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d868bfd0>]}
[0m12:23:25.620099 [info ] [MainThread]: 
[0m12:23:25.620437 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:23:25.620707 [info ] [MainThread]: 
[0m12:23:25.621102 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:23:25.625111 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m12:23:25.662252 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m12:23:25.662721 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m12:23:25.663074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:25.679714 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m12:23:25.681021 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m12:23:25.685164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_public)
[0m12:23:25.690489 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:23:25.690833 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m12:23:25.691071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:25.703638 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:23:25.704063 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:23:25.704334 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:23:25.707640 [debug] [ThreadPool]: SQL status: SELECT 103 in 0.003 seconds
[0m12:23:25.710477 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m12:23:25.710972 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m12:23:25.764745 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:25.765124 [debug] [MainThread]: On master: BEGIN
[0m12:23:25.765384 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:23:25.778270 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:23:25.778661 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:25.778994 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:23:25.786675 [debug] [MainThread]: SQL status: SELECT 34 in 0.007 seconds
[0m12:23:25.791855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2df35051-8255-4887-9dde-cc0897017a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d85a78e0>]}
[0m12:23:25.792291 [debug] [MainThread]: On master: ROLLBACK
[0m12:23:25.792752 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:25.793023 [debug] [MainThread]: On master: BEGIN
[0m12:23:25.793535 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:23:25.793821 [debug] [MainThread]: On master: COMMIT
[0m12:23:25.794081 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:25.794318 [debug] [MainThread]: On master: COMMIT
[0m12:23:25.794616 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:23:25.794864 [debug] [MainThread]: On master: Close
[0m12:23:25.797681 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_netrunner
[0m12:23:25.798212 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_netrunner .............................. [RUN]
[0m12:23:25.798705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.stg_netrunner)
[0m12:23:25.799004 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner
[0m12:23:25.805102 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:23:25.805617 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:23:25.806887 [info ] [Thread-2 (]: 2 of 10 START sql view model public.stg_netrunner_factions ..................... [RUN]
[0m12:23:25.806442 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_pokeapi
[0m12:23:25.806090 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_netrunner
[0m12:23:25.807434 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_netrunner_factions'
[0m12:23:25.818907 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:23:25.808213 [info ] [Thread-3 (]: 3 of 10 START sql view model public.stg_pokeapi ................................ [RUN]
[0m12:23:25.807783 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi
[0m12:23:25.842835 [info ] [Thread-4 (]: 4 of 10 START sql view model public.stg_swapi .................................. [RUN]
[0m12:23:25.843412 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi'
[0m12:23:25.842154 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:23:25.844490 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:23:25.834857 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_pokeapi'
[0m12:23:25.843762 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi
[0m12:23:25.825815 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:23:25.844996 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: BEGIN
[0m12:23:25.845372 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_pokeapi
[0m12:23:25.848011 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi"
[0m12:23:25.848745 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:23:25.849070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:25.850758 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:23:25.855316 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:23:25.855936 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi
[0m12:23:25.857108 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_pokeapi
[0m12:23:25.867668 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:23:25.868382 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:23:25.868915 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:23:25.870297 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi"
[0m12:23:25.870704 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: BEGIN
[0m12:23:25.871851 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:23:25.871385 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: BEGIN
[0m12:23:25.872311 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:23:25.871100 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m12:23:25.873579 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:23:25.873909 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */

  create view "nerd_facts"."public"."stg_netrunner__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.netrunner_cards
)
SELECT
    c.id,
    c.title AS card_name,
    c.faction_code,
    f.name AS faction_name,  
    c.type_code,
    t.name AS type_name,  
    CASE 
        WHEN c.cost IN ('NaN', '') THEN NULL  -- ✅ Replace NaN or empty strings with NULL
        ELSE c.cost::NUMERIC::INTEGER 
    END AS cost,  -- ✅ Convert only valid numbers
    c.text AS description
FROM raw_data c
LEFT JOIN raw.netrunner_factions f ON c.faction_code = f.code
LEFT JOIN raw.netrunner_types t ON c.type_code = t.code
  );
[0m12:23:25.872684 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:23:25.874414 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: BEGIN
[0m12:23:25.874670 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:23:25.877175 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m12:23:25.884564 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:23:25.885019 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner" rename to "stg_netrunner__dbt_backup"
[0m12:23:25.886955 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:23:25.898715 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:23:25.900143 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m12:23:25.900942 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:23:25.901282 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */

  create view "nerd_facts"."public"."stg_pokeapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.pokeapi_pokemon
)
SELECT
    id,
    name AS pokemon_name,
    height::NUMERIC / 10.0 AS height_m,
    weight::NUMERIC / 10.0 AS weight_kg,
    base_experience,
    jsonb_array_length(abilities::JSONB) AS num_abilities,  -- ✅ Cast abilities to JSONB
    abilities::JSONB AS abilities_json,  -- ✅ Ensure abilities are stored as JSONB
    (types::JSONB)->0->'type'->>'name' AS primary_type  -- ✅ Ensure types is JSONB before extracting
FROM raw_data
  );
[0m12:23:25.903544 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:23:25.908021 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:23:25.900586 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner__dbt_tmp" rename to "stg_netrunner"
[0m12:23:25.908767 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
alter table "nerd_facts"."public"."stg_pokeapi" rename to "stg_pokeapi__dbt_backup"
[0m12:23:25.909139 [debug] [Thread-2 (]: SQL status: BEGIN in 0.037 seconds
[0m12:23:25.909943 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:23:25.911173 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */

  create view "nerd_facts"."public"."stg_netrunner_factions__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT DISTINCT code, name
    FROM raw.netrunner_factions
)
SELECT
    code AS faction_code,
    name AS faction_name
FROM raw_data
  );
[0m12:23:25.909397 [debug] [Thread-4 (]: SQL status: BEGIN in 0.035 seconds
[0m12:23:25.911582 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:23:25.911919 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */

  create view "nerd_facts"."public"."stg_swapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.swapi_starships
)
SELECT
    id,
    name AS starship_name,
    model,
    manufacturer,
    NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '^(\\d+).*', '\\1'), '')::INTEGER AS max_speed,  -- ✅ Extracts only the first number
    NULLIF(crew, '')::INTEGER AS crew,  
    NULLIF(passengers, '')::INTEGER AS passengers  
FROM raw_data
  );
[0m12:23:25.910862 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:23:25.910487 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:23:25.915571 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:23:25.915936 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m12:23:25.916269 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m12:23:25.927803 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
alter table "nerd_facts"."public"."stg_pokeapi__dbt_tmp" rename to "stg_pokeapi"
[0m12:23:25.930411 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:23:25.933747 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:23:25.938555 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
alter table "nerd_facts"."public"."stg_netrunner_factions" rename to "stg_netrunner_factions__dbt_backup"
[0m12:23:25.936946 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:23:25.937826 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:23:25.938171 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:23:25.939227 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:23:25.943707 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:23:25.940639 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: COMMIT
[0m12:23:25.944425 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:23:25.938943 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi" rename to "stg_swapi__dbt_backup"
[0m12:23:25.944066 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
alter table "nerd_facts"."public"."stg_netrunner_factions__dbt_tmp" rename to "stg_netrunner_factions"
[0m12:23:25.941059 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:23:25.944752 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: COMMIT
[0m12:23:25.945523 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:23:25.945848 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:23:25.949028 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:23:25.951665 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi__dbt_tmp" rename to "stg_swapi"
[0m12:23:25.949406 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:23:25.951293 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m12:23:25.960696 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."stg_pokeapi__dbt_backup"
[0m12:23:25.957562 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:23:25.958357 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner__dbt_backup"
[0m12:23:25.950864 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: COMMIT
[0m12:23:25.964475 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:23:25.965867 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:23:25.966653 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:23:25.967054 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:23:25.967392 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
drop view if exists "nerd_facts"."public"."stg_pokeapi__dbt_backup" cascade
[0m12:23:25.967799 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:23:25.968132 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
drop view if exists "nerd_facts"."public"."stg_netrunner__dbt_backup" cascade
[0m12:23:25.968451 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: COMMIT
[0m12:23:25.969539 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:23:25.971794 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:23:25.974190 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: Close
[0m12:23:25.974506 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m12:23:25.976657 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: Close
[0m12:23:25.978796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2df35051-8255-4887-9dde-cc0897017a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d866b760>]}
[0m12:23:25.974769 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m12:23:25.975055 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m12:23:25.984688 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner_factions__dbt_backup"
[0m12:23:25.981813 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."stg_swapi__dbt_backup"
[0m12:23:25.986021 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:23:25.986323 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
drop view if exists "nerd_facts"."public"."stg_swapi__dbt_backup" cascade
[0m12:23:25.985328 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:23:25.986719 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
drop view if exists "nerd_facts"."public"."stg_netrunner_factions__dbt_backup" cascade
[0m12:23:25.979324 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2df35051-8255-4887-9dde-cc0897017a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d32c3bb0>]}
[0m12:23:25.987710 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public.stg_pokeapi ........................... [[32mCREATE VIEW[0m in 0.14s]
[0m12:23:25.988280 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_pokeapi
[0m12:23:25.982439 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_netrunner ......................... [[32mCREATE VIEW[0m in 0.18s]
[0m12:23:25.988890 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:23:25.989492 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_netrunner
[0m12:23:25.989857 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:23:25.992268 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: Close
[0m12:23:25.993352 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2df35051-8255-4887-9dde-cc0897017a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d89089a0>]}
[0m12:23:25.993918 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public.stg_swapi ............................. [[32mCREATE VIEW[0m in 0.15s]
[0m12:23:25.992684 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m12:23:25.990298 [info ] [Thread-3 (]: 5 of 10 START sql table model public.dim_pokemon_types ......................... [RUN]
[0m12:23:25.995654 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: Close
[0m12:23:25.996786 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2df35051-8255-4887-9dde-cc0897017a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d85fc4f0>]}
[0m12:23:25.990774 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.fact_pokemon
[0m12:23:25.997849 [info ] [Thread-1 (]: 6 of 10 START sql table model public.fact_pokemon .............................. [RUN]
[0m12:23:25.998229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner, now model.nerd_facts_dbt.fact_pokemon)
[0m12:23:25.996137 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_pokeapi, now model.nerd_facts_dbt.dim_pokemon_types)
[0m12:23:25.998886 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.dim_pokemon_types
[0m12:23:25.994388 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi
[0m12:23:26.002218 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:23:26.002683 [info ] [Thread-4 (]: 7 of 10 START sql table model public.fact_netrunner_cards ...................... [RUN]
[0m12:23:26.001769 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:23:26.003702 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.dim_pokemon_types
[0m12:23:25.998535 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.fact_pokemon
[0m12:23:26.003165 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi, now model.nerd_facts_dbt.fact_netrunner_cards)
[0m12:23:25.997336 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public.stg_netrunner_factions ................ [[32mCREATE VIEW[0m in 0.19s]
[0m12:23:26.022632 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_pokemon"
[0m12:23:26.026479 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:23:26.026947 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:23:26.027459 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:23:26.030185 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:23:26.032189 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:23:26.030717 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.fact_pokemon
[0m12:23:26.031525 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:23:26.036897 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:23:26.031164 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:23:26.041137 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_pokemon"
[0m12:23:26.041688 [info ] [Thread-2 (]: 8 of 10 START sql table model public.dim_starship_manufacturers ................ [RUN]
[0m12:23:26.043273 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner_factions, now model.nerd_facts_dbt.dim_starship_manufacturers)
[0m12:23:26.043707 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:23:26.046074 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:23:26.042276 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: BEGIN
[0m12:23:26.042734 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:23:26.047684 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_netrunner_cards: BEGIN
[0m12:23:26.047028 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:23:26.047316 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:23:26.046552 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:23:26.053510 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_pokemon: BEGIN
[0m12:23:26.053829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:26.047973 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:23:26.052607 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:23:26.055445 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:23:26.055928 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: BEGIN
[0m12:23:26.056237 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:23:26.077324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m12:23:26.077850 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:23:26.078291 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */

  
    

  create  table "nerd_facts"."public"."fact_pokemon__dbt_tmp"
  
  
    as
  
  (
    WITH pokemon AS (
    SELECT * FROM "nerd_facts"."public"."stg_pokeapi"
)
SELECT
    id,
    pokemon_name,
    height_m,
    weight_kg,
    num_abilities,
    primary_type
FROM pokemon
  );
  
[0m12:23:26.078777 [debug] [Thread-4 (]: SQL status: BEGIN in 0.031 seconds
[0m12:23:26.079097 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:23:26.079417 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */

  
    

  create  table "nerd_facts"."public"."fact_netrunner_cards__dbt_tmp"
  
  
    as
  
  (
    WITH cards AS (
    SELECT * FROM "nerd_facts"."public"."stg_netrunner"
)
SELECT
    c.id,
    c.card_name,
    c.faction_name,  -- ✅ Already included in stg_netrunner
    c.type_name,  -- ✅ Now available in stg_netrunner
    c.cost,
    c.description
FROM cards c
  );
  
[0m12:23:26.083236 [debug] [Thread-3 (]: SQL status: BEGIN in 0.036 seconds
[0m12:23:26.083756 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:23:26.084161 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */

  
    

  create  table "nerd_facts"."public"."dim_pokemon_types__dbt_tmp"
  
  
    as
  
  (
    WITH types AS (
    SELECT DISTINCT
        primary_type,
        COUNT(*) AS num_pokemon
    FROM "nerd_facts"."public"."stg_pokeapi"
    GROUP BY primary_type
)
SELECT * FROM types
  );
  
[0m12:23:26.088173 [debug] [Thread-2 (]: SQL status: BEGIN in 0.032 seconds
[0m12:23:26.088617 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:23:26.088955 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */

  
    

  create  table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp"
  
  
    as
  
  (
    WITH manufacturers AS (
    SELECT DISTINCT
        manufacturer,
        COUNT(*) AS num_starships
    FROM "nerd_facts"."public"."stg_swapi"
    GROUP BY manufacturer
)
SELECT * FROM manufacturers
  );
  
[0m12:23:26.095289 [debug] [Thread-1 (]: SQL status: SELECT 1302 in 0.017 seconds
[0m12:23:26.102681 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:23:26.103173 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
alter table "nerd_facts"."public"."fact_pokemon" rename to "fact_pokemon__dbt_backup"
[0m12:23:26.103594 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.019 seconds
[0m12:23:26.109317 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:23:26.109764 [debug] [Thread-2 (]: SQL status: SELECT 27 in 0.020 seconds
[0m12:23:26.114696 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:23:26.110020 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:23:26.118481 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:23:26.118916 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
alter table "nerd_facts"."public"."fact_pokemon__dbt_tmp" rename to "fact_pokemon"
[0m12:23:26.110407 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
alter table "nerd_facts"."public"."dim_pokemon_types" rename to "dim_pokemon_types__dbt_backup"
[0m12:23:26.115259 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers" rename to "dim_starship_manufacturers__dbt_backup"
[0m12:23:26.119795 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:23:26.124908 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_pokemon: COMMIT
[0m12:23:26.120218 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:23:26.128681 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:23:26.129046 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
alter table "nerd_facts"."public"."dim_pokemon_types__dbt_tmp" rename to "dim_pokemon_types"
[0m12:23:26.125589 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:23:26.132196 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:23:26.133054 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp" rename to "dim_starship_manufacturers"
[0m12:23:26.132707 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:23:26.135002 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: COMMIT
[0m12:23:26.135771 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:23:26.136177 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: COMMIT
[0m12:23:26.125939 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:23:26.136728 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_pokemon: COMMIT
[0m12:23:26.135431 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:23:26.138350 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:23:26.138723 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:23:26.139365 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:23:26.139086 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m12:23:26.141980 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."dim_pokemon_types__dbt_backup"
[0m12:23:26.142477 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:23:26.148412 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."fact_pokemon__dbt_backup"
[0m12:23:26.149266 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:23:26.149644 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
drop table if exists "nerd_facts"."public"."fact_pokemon__dbt_backup" cascade
[0m12:23:26.145094 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:23:26.150397 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
drop table if exists "nerd_facts"."public"."dim_pokemon_types__dbt_backup" cascade
[0m12:23:26.150130 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m12:23:26.153528 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup"
[0m12:23:26.153878 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:23:26.155842 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_pokemon: Close
[0m12:23:26.156421 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:23:26.157535 [debug] [Thread-3 (]: On model.nerd_facts_dbt.dim_pokemon_types: Close
[0m12:23:26.158714 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2df35051-8255-4887-9dde-cc0897017a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d32ea4a0>]}
[0m12:23:26.158146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2df35051-8255-4887-9dde-cc0897017a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d32c3670>]}
[0m12:23:26.159336 [info ] [Thread-3 (]: 5 of 10 OK created sql table model public.dim_pokemon_types .................... [[32mSELECT 1[0m in 0.16s]
[0m12:23:26.160689 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:23:26.161142 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m12:23:26.159993 [info ] [Thread-1 (]: 6 of 10 OK created sql table model public.fact_pokemon ......................... [[32mSELECT 1302[0m in 0.16s]
[0m12:23:26.162245 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.fact_pokemon
[0m12:23:26.162685 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:23:26.154611 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:23:26.163637 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
drop table if exists "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup" cascade
[0m12:23:26.161712 [info ] [Thread-3 (]: 9 of 10 START sql table model public.fact_starships ............................ [RUN]
[0m12:23:26.164489 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_pokemon_types, now model.nerd_facts_dbt.fact_starships)
[0m12:23:26.164840 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m12:23:26.163219 [info ] [Thread-1 (]: 10 of 10 START sql table model public.dim_netrunner_factions ................... [RUN]
[0m12:23:26.168646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_pokemon, now model.nerd_facts_dbt.dim_netrunner_factions)
[0m12:23:26.169049 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:23:26.171801 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:23:26.172591 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:23:26.172945 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.009 seconds
[0m12:23:26.178955 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: Close
[0m12:23:26.168089 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m12:23:26.179749 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m12:23:26.184527 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m12:23:26.177706 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:23:26.185067 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2df35051-8255-4887-9dde-cc0897017a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d8668d90>]}
[0m12:23:26.185733 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:23:26.186964 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:23:26.186564 [info ] [Thread-2 (]: 8 of 10 OK created sql table model public.dim_starship_manufacturers ........... [[32mSELECT 27[0m in 0.14s]
[0m12:23:26.188629 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:23:26.187536 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m12:23:26.188081 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: BEGIN
[0m12:23:26.189162 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:23:26.189547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:26.209247 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m12:23:26.209750 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:23:26.210078 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */

  
    

  create  table "nerd_facts"."public"."dim_netrunner_factions__dbt_tmp"
  
  
    as
  
  (
    WITH factions AS (
    SELECT DISTINCT ON (f.faction_name)
        f.faction_name,
        COUNT(*) OVER (PARTITION BY f.faction_name) AS num_cards
    FROM "nerd_facts"."public"."stg_netrunner" n
    LEFT JOIN "nerd_facts"."public"."stg_netrunner_factions" f ON n.faction_code = f.faction_code
)
SELECT * FROM factions
  );
  
[0m12:23:26.215884 [debug] [Thread-3 (]: SQL status: BEGIN in 0.027 seconds
[0m12:23:26.216516 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:23:26.216980 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  
    

  create  table "nerd_facts"."public"."fact_starships__dbt_tmp"
  
  
    as
  
  (
    WITH starships AS (
    SELECT * FROM "nerd_facts"."public"."stg_swapi"
)
SELECT
    id,
    starship_name,
    model,
    manufacturer,
    max_speed,
    crew,
    passengers
FROM starships
  );
  
[0m12:23:26.228429 [debug] [Thread-3 (]: Postgres adapter: Postgres error: invalid input syntax for type integer: "1000km"

[0m12:23:26.229226 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_starships: ROLLBACK
[0m12:23:26.230048 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m12:23:26.234848 [debug] [Thread-3 (]: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "1000km"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:23:26.235771 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2df35051-8255-4887-9dde-cc0897017a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d8680a60>]}
[0m12:23:26.236709 [error] [Thread-3 (]: 9 of 10 ERROR creating sql table model public.fact_starships ................... [[31mERROR[0m in 0.07s]
[0m12:23:26.237513 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m12:23:26.238224 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_starships' to be skipped because of status 'error'.  Reason: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "1000km"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql.
[0m12:23:28.695382 [debug] [Thread-1 (]: SQL status: SELECT 11 in 2.485 seconds
[0m12:23:28.699530 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:23:28.699976 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */
alter table "nerd_facts"."public"."dim_netrunner_factions" rename to "dim_netrunner_factions__dbt_backup"
[0m12:23:28.701041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:23:28.704709 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:23:28.705082 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */
alter table "nerd_facts"."public"."dim_netrunner_factions__dbt_tmp" rename to "dim_netrunner_factions"
[0m12:23:28.706994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:23:28.708808 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: COMMIT
[0m12:23:28.709187 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:23:28.709533 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: COMMIT
[0m12:23:28.713838 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:23:28.716028 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."dim_netrunner_factions__dbt_backup"
[0m12:23:28.716727 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:23:28.717028 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */
drop table if exists "nerd_facts"."public"."dim_netrunner_factions__dbt_backup" cascade
[0m12:23:28.721372 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:23:28.722629 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: Close
[0m12:23:28.723268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2df35051-8255-4887-9dde-cc0897017a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d32c3670>]}
[0m12:23:28.723865 [info ] [Thread-1 (]: 10 of 10 OK created sql table model public.dim_netrunner_factions .............. [[32mSELECT 11[0m in 2.55s]
[0m12:23:28.724403 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:23:31.531876 [debug] [Thread-4 (]: SQL status: SELECT 3044070 in 5.452 seconds
[0m12:23:31.535614 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:23:31.536033 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */
alter table "nerd_facts"."public"."fact_netrunner_cards" rename to "fact_netrunner_cards__dbt_backup"
[0m12:23:31.538003 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:23:31.540964 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:23:31.541351 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */
alter table "nerd_facts"."public"."fact_netrunner_cards__dbt_tmp" rename to "fact_netrunner_cards"
[0m12:23:31.542092 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:23:31.543409 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_netrunner_cards: COMMIT
[0m12:23:31.543746 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:23:31.544025 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_netrunner_cards: COMMIT
[0m12:23:31.583990 [debug] [Thread-4 (]: SQL status: COMMIT in 0.040 seconds
[0m12:23:31.586857 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."fact_netrunner_cards__dbt_backup"
[0m12:23:31.587689 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:23:31.588027 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */
drop table if exists "nerd_facts"."public"."fact_netrunner_cards__dbt_backup" cascade
[0m12:23:31.606372 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.018 seconds
[0m12:23:31.608125 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_netrunner_cards: Close
[0m12:23:31.609525 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2df35051-8255-4887-9dde-cc0897017a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d89089a0>]}
[0m12:23:31.610372 [info ] [Thread-4 (]: 7 of 10 OK created sql table model public.fact_netrunner_cards ................. [[32mSELECT 3044070[0m in 5.61s]
[0m12:23:31.611144 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:23:31.613170 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:31.613591 [debug] [MainThread]: On master: BEGIN
[0m12:23:31.613976 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:23:31.630743 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m12:23:31.631271 [debug] [MainThread]: On master: COMMIT
[0m12:23:31.631677 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:31.631995 [debug] [MainThread]: On master: COMMIT
[0m12:23:31.632482 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:23:31.632850 [debug] [MainThread]: On master: Close
[0m12:23:31.633640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:31.634044 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_netrunner_factions' was properly closed.
[0m12:23:31.634372 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_starship_manufacturers' was properly closed.
[0m12:23:31.634684 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_starships' was properly closed.
[0m12:23:31.634975 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_netrunner_cards' was properly closed.
[0m12:23:31.636171 [info ] [MainThread]: 
[0m12:23:31.636537 [info ] [MainThread]: Finished running 6 table models, 4 view models in 0 hours 0 minutes and 6.01 seconds (6.01s).
[0m12:23:31.638472 [debug] [MainThread]: Command end result
[0m12:23:31.663880 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:23:31.665514 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:23:31.671804 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m12:23:31.672228 [info ] [MainThread]: 
[0m12:23:31.672628 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:23:31.672961 [info ] [MainThread]: 
[0m12:23:31.673329 [error] [MainThread]:   Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "1000km"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:23:31.673681 [info ] [MainThread]: 
[0m12:23:31.674033 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m12:23:31.678341 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.7953777, "process_in_blocks": "63872", "process_kernel_time": 0.140267, "process_mem_max_rss": "114476", "process_out_blocks": "3000", "process_user_time": 2.269987}
[0m12:23:31.678830 [debug] [MainThread]: Command `dbt run` failed at 12:23:31.678730 after 6.80 seconds
[0m12:23:31.679201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44da3908e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d3f00070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d3f00e50>]}
[0m12:23:31.679590 [debug] [MainThread]: Flushing usage events
[0m12:23:32.187867 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:24:48.674271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c58a0c8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c579c3bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c579c3c10>]}


============================== 12:24:48.677261 | ed995d09-dc8c-44fe-a949-f34c673f8c83 ==============================
[0m12:24:48.677261 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:24:48.677722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:24:48.825634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed995d09-dc8c-44fe-a949-f34c673f8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c581264d0>]}
[0m12:24:48.873576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed995d09-dc8c-44fe-a949-f34c673f8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c5980fa00>]}
[0m12:24:48.874671 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:24:48.953292 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:24:49.069713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:24:49.070300 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/stg_swapi.sql
[0m12:24:49.296982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed995d09-dc8c-44fe-a949-f34c673f8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c5669a140>]}
[0m12:24:49.358233 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:24:49.360407 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:24:49.375636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed995d09-dc8c-44fe-a949-f34c673f8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c56c31cc0>]}
[0m12:24:49.376136 [info ] [MainThread]: Found 10 models, 11 sources, 433 macros
[0m12:24:49.376451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed995d09-dc8c-44fe-a949-f34c673f8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c56c33280>]}
[0m12:24:49.378028 [info ] [MainThread]: 
[0m12:24:49.378355 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:24:49.378606 [info ] [MainThread]: 
[0m12:24:49.379014 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:24:49.383228 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m12:24:49.415768 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m12:24:49.416189 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m12:24:49.416441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:49.434515 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m12:24:49.435723 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m12:24:49.440502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_public)
[0m12:24:49.445596 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:24:49.445980 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m12:24:49.446270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:49.459228 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:24:49.459626 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:24:49.459899 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:24:49.463471 [debug] [ThreadPool]: SQL status: SELECT 103 in 0.003 seconds
[0m12:24:49.466178 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m12:24:49.466751 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m12:24:49.520300 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:49.520669 [debug] [MainThread]: On master: BEGIN
[0m12:24:49.520916 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:24:49.533580 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:24:49.533964 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:49.534273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:24:49.542255 [debug] [MainThread]: SQL status: SELECT 34 in 0.008 seconds
[0m12:24:49.547412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed995d09-dc8c-44fe-a949-f34c673f8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c56c696c0>]}
[0m12:24:49.547864 [debug] [MainThread]: On master: ROLLBACK
[0m12:24:49.548345 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:49.548622 [debug] [MainThread]: On master: BEGIN
[0m12:24:49.549141 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:24:49.549415 [debug] [MainThread]: On master: COMMIT
[0m12:24:49.549681 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:49.549900 [debug] [MainThread]: On master: COMMIT
[0m12:24:49.550266 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:24:49.550539 [debug] [MainThread]: On master: Close
[0m12:24:49.554175 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_netrunner
[0m12:24:49.554594 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:24:49.554945 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_pokeapi
[0m12:24:49.555223 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi
[0m12:24:49.555718 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_netrunner .............................. [RUN]
[0m12:24:49.556295 [info ] [Thread-2 (]: 2 of 10 START sql view model public.stg_netrunner_factions ..................... [RUN]
[0m12:24:49.558160 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_netrunner_factions'
[0m12:24:49.556695 [info ] [Thread-3 (]: 3 of 10 START sql view model public.stg_pokeapi ................................ [RUN]
[0m12:24:49.558905 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_pokeapi'
[0m12:24:49.558477 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:24:49.557565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.stg_netrunner)
[0m12:24:49.559245 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_pokeapi
[0m12:24:49.566934 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:24:49.564973 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:24:49.557044 [info ] [Thread-4 (]: 4 of 10 START sql view model public.stg_swapi .................................. [RUN]
[0m12:24:49.567759 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi'
[0m12:24:49.565386 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner
[0m12:24:49.568350 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi
[0m12:24:49.568756 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_pokeapi
[0m12:24:49.571661 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:24:49.573405 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi"
[0m12:24:49.594536 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:24:49.607272 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:24:49.607876 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi
[0m12:24:49.608380 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_netrunner
[0m12:24:49.613383 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:24:49.618514 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi"
[0m12:24:49.624597 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:24:49.625337 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:24:49.627742 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: BEGIN
[0m12:24:49.626808 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:24:49.627209 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:24:49.629012 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: BEGIN
[0m12:24:49.626233 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:24:49.628623 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: BEGIN
[0m12:24:49.628172 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:24:49.629351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:49.629693 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: BEGIN
[0m12:24:49.631317 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:24:49.630101 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:24:49.655672 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m12:24:49.656233 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:24:49.656648 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */

  create view "nerd_facts"."public"."stg_swapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.swapi_starships
)
SELECT
    id,
    name AS starship_name,
    model,
    manufacturer,
    NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '^(\\d+).*', '\\1'), '')::INTEGER AS max_speed,  -- ✅ Extracts only the first number
    NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER AS crew,  -- ✅ Removes non-numeric characters
    NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER AS passengers  -- ✅ Removes non-numeric characters
FROM raw_data
  );
[0m12:24:49.660083 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m12:24:49.666821 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:24:49.667347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m12:24:49.667833 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi" rename to "stg_swapi__dbt_backup"
[0m12:24:49.668196 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:24:49.669153 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */

  create view "nerd_facts"."public"."stg_netrunner__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.netrunner_cards
)
SELECT
    c.id,
    c.title AS card_name,
    c.faction_code,
    f.name AS faction_name,  
    c.type_code,
    t.name AS type_name,  
    CASE 
        WHEN c.cost IN ('NaN', '') THEN NULL  -- ✅ Replace NaN or empty strings with NULL
        ELSE c.cost::NUMERIC::INTEGER 
    END AS cost,  -- ✅ Convert only valid numbers
    c.text AS description
FROM raw_data c
LEFT JOIN raw.netrunner_factions f ON c.faction_code = f.code
LEFT JOIN raw.netrunner_types t ON c.type_code = t.code
  );
[0m12:24:49.668721 [debug] [Thread-3 (]: SQL status: BEGIN in 0.041 seconds
[0m12:24:49.671869 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:24:49.669477 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:24:49.672304 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */

  create view "nerd_facts"."public"."stg_pokeapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.pokeapi_pokemon
)
SELECT
    id,
    name AS pokemon_name,
    height::NUMERIC / 10.0 AS height_m,
    weight::NUMERIC / 10.0 AS weight_kg,
    base_experience,
    jsonb_array_length(abilities::JSONB) AS num_abilities,  -- ✅ Cast abilities to JSONB
    abilities::JSONB AS abilities_json,  -- ✅ Ensure abilities are stored as JSONB
    (types::JSONB)->0->'type'->>'name' AS primary_type  -- ✅ Ensure types is JSONB before extracting
FROM raw_data
  );
[0m12:24:49.668478 [debug] [Thread-2 (]: SQL status: BEGIN in 0.037 seconds
[0m12:24:49.674941 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:24:49.675516 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:24:49.678695 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */

  create view "nerd_facts"."public"."stg_netrunner_factions__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT DISTINCT code, name
    FROM raw.netrunner_factions
)
SELECT
    code AS faction_code,
    name AS faction_name
FROM raw_data
  );
[0m12:24:49.676617 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi__dbt_tmp" rename to "stg_swapi"
[0m12:24:49.679099 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m12:24:49.675843 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:24:49.680607 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:24:49.680930 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:24:49.684925 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:24:49.688327 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:24:49.691503 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:24:49.706540 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
alter table "nerd_facts"."public"."stg_netrunner_factions" rename to "stg_netrunner_factions__dbt_backup"
[0m12:24:49.705196 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:24:49.705725 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
alter table "nerd_facts"."public"."stg_pokeapi" rename to "stg_pokeapi__dbt_backup"
[0m12:24:49.706133 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner" rename to "stg_netrunner__dbt_backup"
[0m12:24:49.707281 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:24:49.711308 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:24:49.706984 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:24:49.708619 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:24:49.708271 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:24:49.711673 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
alter table "nerd_facts"."public"."stg_netrunner_factions__dbt_tmp" rename to "stg_netrunner_factions"
[0m12:24:49.712038 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:24:49.714899 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:24:49.717951 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:24:49.719631 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
alter table "nerd_facts"."public"."stg_pokeapi__dbt_tmp" rename to "stg_pokeapi"
[0m12:24:49.719273 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner__dbt_tmp" rename to "stg_netrunner"
[0m12:24:49.718892 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:24:49.721322 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: COMMIT
[0m12:24:49.721776 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m12:24:49.722089 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:24:49.722349 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:24:49.722622 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:24:49.728650 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."stg_swapi__dbt_backup"
[0m12:24:49.730132 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:24:49.731413 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: COMMIT
[0m12:24:49.731821 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: COMMIT
[0m12:24:49.735495 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:24:49.736002 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:24:49.736382 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:24:49.736862 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
drop view if exists "nerd_facts"."public"."stg_swapi__dbt_backup" cascade
[0m12:24:49.737261 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:24:49.737684 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: COMMIT
[0m12:24:49.739670 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m12:24:49.742477 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner_factions__dbt_backup"
[0m12:24:49.742834 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:24:49.744223 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:24:49.743374 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m12:24:49.746443 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner__dbt_backup"
[0m12:24:49.743091 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m12:24:49.749164 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."stg_pokeapi__dbt_backup"
[0m12:24:49.746925 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
drop view if exists "nerd_facts"."public"."stg_netrunner_factions__dbt_backup" cascade
[0m12:24:49.755548 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: Close
[0m12:24:49.753344 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:24:49.756319 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:24:49.759219 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
drop view if exists "nerd_facts"."public"."stg_netrunner__dbt_backup" cascade
[0m12:24:49.759911 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed995d09-dc8c-44fe-a949-f34c673f8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c56ce4370>]}
[0m12:24:49.760283 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
drop view if exists "nerd_facts"."public"."stg_pokeapi__dbt_backup" cascade
[0m12:24:49.760620 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:24:49.764187 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: Close
[0m12:24:49.765230 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed995d09-dc8c-44fe-a949-f34c673f8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c57aa1f00>]}
[0m12:24:49.764554 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:24:49.767073 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: Close
[0m12:24:49.768219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed995d09-dc8c-44fe-a949-f34c673f8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c56cea140>]}
[0m12:24:49.767462 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m12:24:49.765866 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public.stg_netrunner_factions ................ [[32mCREATE VIEW[0m in 0.21s]
[0m12:24:49.762057 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public.stg_swapi ............................. [[32mCREATE VIEW[0m in 0.19s]
[0m12:24:49.771149 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi
[0m12:24:49.768789 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_netrunner ......................... [[32mCREATE VIEW[0m in 0.21s]
[0m12:24:49.770669 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:24:49.770042 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: Close
[0m12:24:49.771866 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_netrunner
[0m12:24:49.772179 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:24:49.773249 [info ] [Thread-4 (]: 5 of 10 START sql table model public.dim_starship_manufacturers ................ [RUN]
[0m12:24:49.773823 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi, now model.nerd_facts_dbt.dim_starship_manufacturers)
[0m12:24:49.774149 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:24:49.772537 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m12:24:49.778556 [info ] [Thread-2 (]: 6 of 10 START sql table model public.fact_starships ............................ [RUN]
[0m12:24:49.778973 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner_factions, now model.nerd_facts_dbt.fact_starships)
[0m12:24:49.778051 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:24:49.779271 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m12:24:49.777702 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed995d09-dc8c-44fe-a949-f34c673f8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c56e2e770>]}
[0m12:24:49.776967 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:24:49.779686 [info ] [Thread-1 (]: 7 of 10 START sql table model public.dim_netrunner_factions .................... [RUN]
[0m12:24:49.782307 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m12:24:49.782974 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public.stg_pokeapi ........................... [[32mCREATE VIEW[0m in 0.22s]
[0m12:24:49.783684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner, now model.nerd_facts_dbt.dim_netrunner_factions)
[0m12:24:49.785325 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:24:49.787833 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:24:49.784980 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m12:24:49.784081 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:24:49.784680 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_pokeapi
[0m12:24:49.793534 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:24:49.819003 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m12:24:49.821064 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:24:49.821631 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:24:49.826847 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:24:49.827754 [info ] [Thread-3 (]: 8 of 10 START sql table model public.fact_netrunner_cards ...................... [RUN]
[0m12:24:49.828468 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_pokeapi, now model.nerd_facts_dbt.fact_netrunner_cards)
[0m12:24:49.828847 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:24:49.832349 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:24:49.829224 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:24:49.832901 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: BEGIN
[0m12:24:49.829596 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:24:49.829927 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:24:49.833238 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:24:49.833559 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:24:49.833867 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: BEGIN
[0m12:24:49.834224 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m12:24:49.840414 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:24:49.839839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:49.839221 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:24:49.841869 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:24:49.843519 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: BEGIN
[0m12:24:49.844100 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:24:49.869672 [debug] [Thread-2 (]: SQL status: BEGIN in 0.029 seconds
[0m12:24:49.870122 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:24:49.870444 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  
    

  create  table "nerd_facts"."public"."fact_starships__dbt_tmp"
  
  
    as
  
  (
    WITH starships AS (
    SELECT * FROM "nerd_facts"."public"."stg_swapi"
)
SELECT
    id,
    starship_name,
    model,
    manufacturer,
    max_speed,
    crew,
    passengers
FROM starships
  );
  
[0m12:24:49.872290 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m12:24:49.872724 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:24:49.873084 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */

  
    

  create  table "nerd_facts"."public"."dim_netrunner_factions__dbt_tmp"
  
  
    as
  
  (
    WITH factions AS (
    SELECT DISTINCT ON (f.faction_name)
        f.faction_name,
        COUNT(*) OVER (PARTITION BY f.faction_name) AS num_cards
    FROM "nerd_facts"."public"."stg_netrunner" n
    LEFT JOIN "nerd_facts"."public"."stg_netrunner_factions" f ON n.faction_code = f.faction_code
)
SELECT * FROM factions
  );
  
[0m12:24:49.873914 [debug] [Thread-4 (]: SQL status: BEGIN in 0.040 seconds
[0m12:24:49.874306 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:24:49.874644 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */

  
    

  create  table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp"
  
  
    as
  
  (
    WITH manufacturers AS (
    SELECT DISTINCT
        manufacturer,
        COUNT(*) AS num_starships
    FROM "nerd_facts"."public"."stg_swapi"
    GROUP BY manufacturer
)
SELECT * FROM manufacturers
  );
  
[0m12:24:49.875922 [debug] [Thread-3 (]: SQL status: BEGIN in 0.032 seconds
[0m12:24:49.876371 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:24:49.876732 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */

  
    

  create  table "nerd_facts"."public"."fact_netrunner_cards__dbt_tmp"
  
  
    as
  
  (
    WITH cards AS (
    SELECT * FROM "nerd_facts"."public"."stg_netrunner"
)
SELECT
    c.id,
    c.card_name,
    c.faction_name,  -- ✅ Already included in stg_netrunner
    c.type_name,  -- ✅ Now available in stg_netrunner
    c.cost,
    c.description
FROM cards c
  );
  
[0m12:24:49.890084 [debug] [Thread-2 (]: Postgres adapter: Postgres error: invalid input syntax for type integer: "1000km"

[0m12:24:49.890621 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: ROLLBACK
[0m12:24:49.891469 [debug] [Thread-2 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m12:24:49.891998 [debug] [Thread-4 (]: SQL status: SELECT 27 in 0.017 seconds
[0m12:24:49.896751 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:24:49.900383 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers" rename to "dim_starship_manufacturers__dbt_backup"
[0m12:24:49.905855 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:24:49.910208 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:24:49.910927 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp" rename to "dim_starship_manufacturers"
[0m12:24:49.911955 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:24:49.921456 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:24:49.922343 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:24:49.922712 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:24:49.928356 [debug] [Thread-2 (]: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "1000km"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:24:49.928910 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed995d09-dc8c-44fe-a949-f34c673f8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c56d07b80>]}
[0m12:24:49.929803 [error] [Thread-2 (]: 6 of 10 ERROR creating sql table model public.fact_starships ................... [[31mERROR[0m in 0.15s]
[0m12:24:49.930550 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m12:24:49.930967 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:24:49.931431 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.fact_starships' to be skipped because of status 'error'.  Reason: Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "1000km"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql.
[0m12:24:49.931889 [info ] [Thread-2 (]: 9 of 10 START sql table model public.dim_pokemon_types ......................... [RUN]
[0m12:24:49.933390 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_starships, now model.nerd_facts_dbt.dim_pokemon_types)
[0m12:24:49.937663 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.dim_pokemon_types
[0m12:24:49.940576 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:24:49.941295 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.dim_pokemon_types
[0m12:24:49.932330 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m12:24:49.951675 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup"
[0m12:24:49.958517 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:24:49.958993 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
drop table if exists "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup" cascade
[0m12:24:49.961208 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:24:49.964619 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:24:49.965169 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: BEGIN
[0m12:24:49.965518 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:24:49.969676 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m12:24:49.971073 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: Close
[0m12:24:49.971935 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed995d09-dc8c-44fe-a949-f34c673f8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c56cea140>]}
[0m12:24:49.972615 [info ] [Thread-4 (]: 5 of 10 OK created sql table model public.dim_starship_manufacturers ........... [[32mSELECT 27[0m in 0.20s]
[0m12:24:49.973164 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:24:49.973545 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.fact_pokemon
[0m12:24:49.974016 [info ] [Thread-4 (]: 10 of 10 START sql table model public.fact_pokemon ............................. [RUN]
[0m12:24:49.974957 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_starship_manufacturers, now model.nerd_facts_dbt.fact_pokemon)
[0m12:24:49.975563 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.fact_pokemon
[0m12:24:49.978228 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_pokemon"
[0m12:24:49.992443 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.fact_pokemon
[0m12:24:49.997892 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_pokemon"
[0m12:24:49.998603 [debug] [Thread-2 (]: SQL status: BEGIN in 0.033 seconds
[0m12:24:50.000164 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:24:50.000786 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:24:50.001205 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */

  
    

  create  table "nerd_facts"."public"."dim_pokemon_types__dbt_tmp"
  
  
    as
  
  (
    WITH types AS (
    SELECT DISTINCT
        primary_type,
        COUNT(*) AS num_pokemon
    FROM "nerd_facts"."public"."stg_pokeapi"
    GROUP BY primary_type
)
SELECT * FROM types
  );
  
[0m12:24:50.001726 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: BEGIN
[0m12:24:50.002127 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:24:50.011802 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.010 seconds
[0m12:24:50.017772 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:24:50.021810 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
alter table "nerd_facts"."public"."dim_pokemon_types" rename to "dim_pokemon_types__dbt_backup"
[0m12:24:50.025751 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:24:50.036648 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:24:50.037597 [debug] [Thread-4 (]: SQL status: BEGIN in 0.035 seconds
[0m12:24:50.041896 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
alter table "nerd_facts"."public"."dim_pokemon_types__dbt_tmp" rename to "dim_pokemon_types"
[0m12:24:50.042600 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:24:50.043128 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */

  
    

  create  table "nerd_facts"."public"."fact_pokemon__dbt_tmp"
  
  
    as
  
  (
    WITH pokemon AS (
    SELECT * FROM "nerd_facts"."public"."stg_pokeapi"
)
SELECT
    id,
    pokemon_name,
    height_m,
    weight_kg,
    num_abilities,
    primary_type
FROM pokemon
  );
  
[0m12:24:50.043582 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:24:50.050330 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: COMMIT
[0m12:24:50.050843 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:24:50.051142 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: COMMIT
[0m12:24:50.053609 [debug] [Thread-4 (]: SQL status: SELECT 1302 in 0.009 seconds
[0m12:24:50.057947 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:24:50.058341 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m12:24:50.058794 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
alter table "nerd_facts"."public"."fact_pokemon" rename to "fact_pokemon__dbt_backup"
[0m12:24:50.061395 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."dim_pokemon_types__dbt_backup"
[0m12:24:50.066191 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:24:50.066657 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:24:50.066983 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
drop table if exists "nerd_facts"."public"."dim_pokemon_types__dbt_backup" cascade
[0m12:24:50.070006 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:24:50.073793 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
alter table "nerd_facts"."public"."fact_pokemon__dbt_tmp" rename to "fact_pokemon"
[0m12:24:50.074672 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:24:50.076088 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: Close
[0m12:24:50.076777 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed995d09-dc8c-44fe-a949-f34c673f8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c57aa1f00>]}
[0m12:24:50.077325 [info ] [Thread-2 (]: 9 of 10 OK created sql table model public.dim_pokemon_types .................... [[32mSELECT 1[0m in 0.14s]
[0m12:24:50.077911 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:24:50.081094 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m12:24:50.082774 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: COMMIT
[0m12:24:50.083190 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:24:50.083540 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: COMMIT
[0m12:24:50.089045 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m12:24:50.091577 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."fact_pokemon__dbt_backup"
[0m12:24:50.092445 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:24:50.092822 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
drop table if exists "nerd_facts"."public"."fact_pokemon__dbt_backup" cascade
[0m12:24:50.100107 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m12:24:50.101689 [debug] [Thread-4 (]: On model.nerd_facts_dbt.fact_pokemon: Close
[0m12:24:50.103431 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed995d09-dc8c-44fe-a949-f34c673f8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c55a30910>]}
[0m12:24:50.104266 [info ] [Thread-4 (]: 10 of 10 OK created sql table model public.fact_pokemon ........................ [[32mSELECT 1302[0m in 0.13s]
[0m12:24:50.107375 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.fact_pokemon
[0m12:24:52.460991 [debug] [Thread-1 (]: SQL status: SELECT 11 in 2.587 seconds
[0m12:24:52.465939 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:24:52.466384 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */
alter table "nerd_facts"."public"."dim_netrunner_factions" rename to "dim_netrunner_factions__dbt_backup"
[0m12:24:52.468289 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:24:52.471183 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:24:52.471645 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */
alter table "nerd_facts"."public"."dim_netrunner_factions__dbt_tmp" rename to "dim_netrunner_factions"
[0m12:24:52.472389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:24:52.473917 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: COMMIT
[0m12:24:52.474302 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:24:52.474614 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: COMMIT
[0m12:24:52.485791 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m12:24:52.489064 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."dim_netrunner_factions__dbt_backup"
[0m12:24:52.489821 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:24:52.490178 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */
drop table if exists "nerd_facts"."public"."dim_netrunner_factions__dbt_backup" cascade
[0m12:24:52.494532 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:24:52.495861 [debug] [Thread-1 (]: On model.nerd_facts_dbt.dim_netrunner_factions: Close
[0m12:24:52.497945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed995d09-dc8c-44fe-a949-f34c673f8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c559effa0>]}
[0m12:24:52.498673 [info ] [Thread-1 (]: 7 of 10 OK created sql table model public.dim_netrunner_factions ............... [[32mSELECT 11[0m in 2.71s]
[0m12:24:52.499299 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:24:55.085230 [debug] [Thread-3 (]: SQL status: SELECT 3044070 in 5.208 seconds
[0m12:24:55.088952 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:24:55.089356 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */
alter table "nerd_facts"."public"."fact_netrunner_cards" rename to "fact_netrunner_cards__dbt_backup"
[0m12:24:55.090748 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:24:55.093837 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:24:55.094207 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */
alter table "nerd_facts"."public"."fact_netrunner_cards__dbt_tmp" rename to "fact_netrunner_cards"
[0m12:24:55.094929 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:24:55.096336 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: COMMIT
[0m12:24:55.096673 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:24:55.097006 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: COMMIT
[0m12:24:55.103307 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m12:24:55.106038 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."fact_netrunner_cards__dbt_backup"
[0m12:24:55.106834 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:24:55.107190 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */
drop table if exists "nerd_facts"."public"."fact_netrunner_cards__dbt_backup" cascade
[0m12:24:55.124120 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.017 seconds
[0m12:24:55.125607 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: Close
[0m12:24:55.126414 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed995d09-dc8c-44fe-a949-f34c673f8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c56ce41c0>]}
[0m12:24:55.127189 [info ] [Thread-3 (]: 8 of 10 OK created sql table model public.fact_netrunner_cards ................. [[32mSELECT 3044070[0m in 5.30s]
[0m12:24:55.127904 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:24:55.129575 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:55.130015 [debug] [MainThread]: On master: BEGIN
[0m12:24:55.130399 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:24:55.147894 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m12:24:55.148321 [debug] [MainThread]: On master: COMMIT
[0m12:24:55.148600 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:55.148837 [debug] [MainThread]: On master: COMMIT
[0m12:24:55.149161 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:24:55.149418 [debug] [MainThread]: On master: Close
[0m12:24:55.149889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:55.150123 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_netrunner_factions' was properly closed.
[0m12:24:55.150368 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_pokemon_types' was properly closed.
[0m12:24:55.150572 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_netrunner_cards' was properly closed.
[0m12:24:55.150770 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_pokemon' was properly closed.
[0m12:24:55.151389 [info ] [MainThread]: 
[0m12:24:55.151844 [info ] [MainThread]: Finished running 6 table models, 4 view models in 0 hours 0 minutes and 5.77 seconds (5.77s).
[0m12:24:55.153367 [debug] [MainThread]: Command end result
[0m12:24:55.172671 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:24:55.174270 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:24:55.180221 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m12:24:55.180565 [info ] [MainThread]: 
[0m12:24:55.180968 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:24:55.181284 [info ] [MainThread]: 
[0m12:24:55.181638 [error] [MainThread]:   Database Error in model fact_starships (models/marts/fact_starships.sql)
  invalid input syntax for type integer: "1000km"
  compiled code at target/run/nerd_facts_dbt/models/marts/fact_starships.sql
[0m12:24:55.181926 [info ] [MainThread]: 
[0m12:24:55.182216 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m12:24:55.183810 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.556534, "process_in_blocks": "57408", "process_kernel_time": 0.124055, "process_mem_max_rss": "114352", "process_out_blocks": "3016", "process_user_time": 2.28433}
[0m12:24:55.184179 [debug] [MainThread]: Command `dbt run` failed at 12:24:55.184096 after 6.56 seconds
[0m12:24:55.184479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c58a0c8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c56663ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c56663af0>]}
[0m12:24:55.184803 [debug] [MainThread]: Flushing usage events
[0m12:24:55.759673 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:26:33.650264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5a40c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5b3af850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5b3af8b0>]}


============================== 12:26:33.653390 | 8f702982-6b2d-43c1-afa9-b5c963adfaa7 ==============================
[0m12:26:33.653390 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:26:33.653877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:26:33.796066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f702982-6b2d-43c1-afa9-b5c963adfaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae594b5db0>]}
[0m12:26:33.843790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f702982-6b2d-43c1-afa9-b5c963adfaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5b3af820>]}
[0m12:26:33.844788 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:26:33.921669 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:26:34.034832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:26:34.035516 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/stg_swapi.sql
[0m12:26:34.255569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f702982-6b2d-43c1-afa9-b5c963adfaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae58656170>]}
[0m12:26:34.317536 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:26:34.319857 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:26:34.334990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f702982-6b2d-43c1-afa9-b5c963adfaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5806bf10>]}
[0m12:26:34.335526 [info ] [MainThread]: Found 10 models, 11 sources, 433 macros
[0m12:26:34.335876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f702982-6b2d-43c1-afa9-b5c963adfaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae58068370>]}
[0m12:26:34.337474 [info ] [MainThread]: 
[0m12:26:34.337812 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:26:34.338078 [info ] [MainThread]: 
[0m12:26:34.338503 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:26:34.343560 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m12:26:34.379920 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m12:26:34.380313 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m12:26:34.380571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:34.396533 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m12:26:34.397845 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m12:26:34.401224 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public'
[0m12:26:34.407208 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:26:34.407628 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m12:26:34.407954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:34.421444 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:26:34.421893 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m12:26:34.422238 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:26:34.425407 [debug] [ThreadPool]: SQL status: SELECT 103 in 0.003 seconds
[0m12:26:34.428682 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m12:26:34.429235 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m12:26:34.486928 [debug] [MainThread]: Using postgres connection "master"
[0m12:26:34.487362 [debug] [MainThread]: On master: BEGIN
[0m12:26:34.487675 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:26:34.500244 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:26:34.500678 [debug] [MainThread]: Using postgres connection "master"
[0m12:26:34.501063 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:26:34.509839 [debug] [MainThread]: SQL status: SELECT 34 in 0.008 seconds
[0m12:26:34.515634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f702982-6b2d-43c1-afa9-b5c963adfaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae58657df0>]}
[0m12:26:34.516106 [debug] [MainThread]: On master: ROLLBACK
[0m12:26:34.516593 [debug] [MainThread]: Using postgres connection "master"
[0m12:26:34.516905 [debug] [MainThread]: On master: BEGIN
[0m12:26:34.517405 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:26:34.517705 [debug] [MainThread]: On master: COMMIT
[0m12:26:34.518010 [debug] [MainThread]: Using postgres connection "master"
[0m12:26:34.518295 [debug] [MainThread]: On master: COMMIT
[0m12:26:34.518670 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:26:34.518965 [debug] [MainThread]: On master: Close
[0m12:26:34.522668 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_netrunner
[0m12:26:34.523100 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:26:34.524447 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_pokeapi
[0m12:26:34.525133 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi
[0m12:26:34.523678 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_netrunner .............................. [RUN]
[0m12:26:34.524150 [info ] [Thread-2 (]: 2 of 10 START sql view model public.stg_netrunner_factions ..................... [RUN]
[0m12:26:34.526767 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_nerd_facts, now model.nerd_facts_dbt.stg_netrunner_factions)
[0m12:26:34.524870 [info ] [Thread-3 (]: 3 of 10 START sql view model public.stg_pokeapi ................................ [RUN]
[0m12:26:34.526221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.stg_netrunner)
[0m12:26:34.525566 [info ] [Thread-4 (]: 4 of 10 START sql view model public.stg_swapi .................................. [RUN]
[0m12:26:34.527228 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:26:34.527741 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_pokeapi'
[0m12:26:34.528080 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_netrunner
[0m12:26:34.528533 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi'
[0m12:26:34.535071 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:26:34.535503 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_pokeapi
[0m12:26:34.537451 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:26:34.537907 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi
[0m12:26:34.539879 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:26:34.540502 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_netrunner
[0m12:26:34.542433 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi"
[0m12:26:34.548307 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:26:34.580203 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_pokeapi
[0m12:26:34.579632 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner"
[0m12:26:34.586318 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:26:34.586766 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi
[0m12:26:34.592612 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_pokeapi"
[0m12:26:34.598775 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi"
[0m12:26:34.599204 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:26:34.599988 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:26:34.600434 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:26:34.600781 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:26:34.601135 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: BEGIN
[0m12:26:34.601517 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: BEGIN
[0m12:26:34.601851 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: BEGIN
[0m12:26:34.602201 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: BEGIN
[0m12:26:34.602532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:34.602875 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:26:34.603193 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:26:34.603540 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:26:34.639374 [debug] [Thread-2 (]: SQL status: BEGIN in 0.036 seconds
[0m12:26:34.639900 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:26:34.640223 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */

  create view "nerd_facts"."public"."stg_netrunner_factions__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT DISTINCT code, name
    FROM raw.netrunner_factions
)
SELECT
    code AS faction_code,
    name AS faction_name
FROM raw_data
  );
[0m12:26:34.641955 [debug] [Thread-4 (]: SQL status: BEGIN in 0.038 seconds
[0m12:26:34.642355 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:26:34.642701 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */

  create view "nerd_facts"."public"."stg_swapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.swapi_starships
)
SELECT
    id,
    name AS starship_name,
    model,
    manufacturer,
    
    -- ✅ Extract first number, handle "unknown" values safely
    CASE 
        WHEN lower(max_atmosphering_speed) = 'unknown' THEN NULL  -- ✅ Convert "unknown" to NULL
        ELSE NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '[^0-9]+.*', '', 'g'), '')::INTEGER 
    END AS max_speed,
    
    -- ✅ Convert crew and passengers safely
    NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER AS crew,  
    NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER AS passengers  

FROM raw_data
  );
[0m12:26:34.643320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m12:26:34.643655 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:26:34.643949 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */

  create view "nerd_facts"."public"."stg_netrunner__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.netrunner_cards
)
SELECT
    c.id,
    c.title AS card_name,
    c.faction_code,
    f.name AS faction_name,  
    c.type_code,
    t.name AS type_name,  
    CASE 
        WHEN c.cost IN ('NaN', '') THEN NULL  -- ✅ Replace NaN or empty strings with NULL
        ELSE c.cost::NUMERIC::INTEGER 
    END AS cost,  -- ✅ Convert only valid numbers
    c.text AS description
FROM raw_data c
LEFT JOIN raw.netrunner_factions f ON c.faction_code = f.code
LEFT JOIN raw.netrunner_types t ON c.type_code = t.code
  );
[0m12:26:34.644363 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m12:26:34.651030 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:26:34.651438 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:26:34.651936 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m12:26:34.652298 [debug] [Thread-3 (]: SQL status: BEGIN in 0.049 seconds
[0m12:26:34.652581 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
alter table "nerd_facts"."public"."stg_netrunner_factions" rename to "stg_netrunner_factions__dbt_backup"
[0m12:26:34.655675 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:26:34.659591 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:26:34.661758 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi" rename to "stg_swapi__dbt_backup"
[0m12:26:34.660923 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner" rename to "stg_netrunner__dbt_backup"
[0m12:26:34.661348 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:26:34.660065 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:26:34.662527 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:26:34.669201 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:26:34.665878 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:26:34.666374 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */

  create view "nerd_facts"."public"."stg_pokeapi__dbt_tmp"
    
    
  as (
    WITH raw_data AS (
    SELECT * FROM raw.pokeapi_pokemon
)
SELECT
    id,
    name AS pokemon_name,
    height::NUMERIC / 10.0 AS height_m,
    weight::NUMERIC / 10.0 AS weight_kg,
    base_experience,
    jsonb_array_length(abilities::JSONB) AS num_abilities,  -- ✅ Cast abilities to JSONB
    abilities::JSONB AS abilities_json,  -- ✅ Ensure abilities are stored as JSONB
    (types::JSONB)->0->'type'->>'name' AS primary_type  -- ✅ Ensure types is JSONB before extracting
FROM raw_data
  );
[0m12:26:34.662835 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:26:34.669572 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
alter table "nerd_facts"."public"."stg_netrunner__dbt_tmp" rename to "stg_netrunner"
[0m12:26:34.669970 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
alter table "nerd_facts"."public"."stg_netrunner_factions__dbt_tmp" rename to "stg_netrunner_factions"
[0m12:26:34.673162 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:26:34.673587 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m12:26:34.678512 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:26:34.674958 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
alter table "nerd_facts"."public"."stg_swapi__dbt_tmp" rename to "stg_swapi"
[0m12:26:34.675362 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:26:34.674431 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:26:34.678904 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
alter table "nerd_facts"."public"."stg_pokeapi" rename to "stg_pokeapi__dbt_backup"
[0m12:26:34.690447 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m12:26:34.694879 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:26:34.699529 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: COMMIT
[0m12:26:34.700921 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:26:34.701252 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:26:34.701674 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:26:34.702312 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:26:34.702007 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:26:34.705320 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:26:34.706171 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: COMMIT
[0m12:26:34.705848 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: COMMIT
[0m12:26:34.706533 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: COMMIT
[0m12:26:34.706903 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
alter table "nerd_facts"."public"."stg_pokeapi__dbt_tmp" rename to "stg_pokeapi"
[0m12:26:34.708130 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:26:34.709494 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: COMMIT
[0m12:26:34.709823 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:26:34.710290 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: COMMIT
[0m12:26:34.710649 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m12:26:34.717590 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."stg_swapi__dbt_backup"
[0m12:26:34.718093 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m12:26:34.718455 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m12:26:34.718732 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m12:26:34.722422 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi"
[0m12:26:34.725246 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner_factions__dbt_backup"
[0m12:26:34.727452 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."stg_netrunner__dbt_backup"
[0m12:26:34.729535 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."stg_pokeapi__dbt_backup"
[0m12:26:34.729953 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi"} */
drop view if exists "nerd_facts"."public"."stg_swapi__dbt_backup" cascade
[0m12:26:34.730641 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner_factions"
[0m12:26:34.732485 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner_factions"} */
drop view if exists "nerd_facts"."public"."stg_netrunner_factions__dbt_backup" cascade
[0m12:26:34.731307 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_netrunner"
[0m12:26:34.731990 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_pokeapi"
[0m12:26:34.733298 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_netrunner"} */
drop view if exists "nerd_facts"."public"."stg_netrunner__dbt_backup" cascade
[0m12:26:34.733693 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_pokeapi"} */
drop view if exists "nerd_facts"."public"."stg_pokeapi__dbt_backup" cascade
[0m12:26:34.735187 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:26:34.737620 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi: Close
[0m12:26:34.738072 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:26:34.739855 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_pokeapi: Close
[0m12:26:34.738385 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m12:26:34.743741 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_netrunner_factions: Close
[0m12:26:34.744454 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f702982-6b2d-43c1-afa9-b5c963adfaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae586e7250>]}
[0m12:26:34.745132 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public.stg_swapi ............................. [[32mCREATE VIEW[0m in 0.21s]
[0m12:26:34.745849 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi
[0m12:26:34.746538 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f702982-6b2d-43c1-afa9-b5c963adfaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae534bf1f0>]}
[0m12:26:34.738665 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m12:26:34.747175 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:26:34.749793 [info ] [Thread-4 (]: 5 of 10 START sql table model public.dim_starship_manufacturers ................ [RUN]
[0m12:26:34.748094 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public.stg_pokeapi ........................... [[32mCREATE VIEW[0m in 0.22s]
[0m12:26:34.749330 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_netrunner: Close
[0m12:26:34.751296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f702982-6b2d-43c1-afa9-b5c963adfaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae534bed40>]}
[0m12:26:34.751946 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_netrunner ......................... [[32mCREATE VIEW[0m in 0.23s]
[0m12:26:34.752482 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_netrunner
[0m12:26:34.752858 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.fact_starships
[0m12:26:34.753552 [info ] [Thread-1 (]: 6 of 10 START sql table model public.fact_starships ............................ [RUN]
[0m12:26:34.753977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner, now model.nerd_facts_dbt.fact_starships)
[0m12:26:34.750690 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_pokeapi
[0m12:26:34.754617 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:26:34.747642 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f702982-6b2d-43c1-afa9-b5c963adfaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae58b53490>]}
[0m12:26:34.750214 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi, now model.nerd_facts_dbt.dim_starship_manufacturers)
[0m12:26:34.756179 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:26:34.754268 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.fact_starships
[0m12:26:34.755818 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public.stg_netrunner_factions ................ [[32mCREATE VIEW[0m in 0.22s]
[0m12:26:34.762027 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_netrunner_factions
[0m12:26:34.762398 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:26:34.761376 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_starships"
[0m12:26:34.755161 [info ] [Thread-3 (]: 7 of 10 START sql table model public.fact_netrunner_cards ...................... [RUN]
[0m12:26:34.763544 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_pokeapi, now model.nerd_facts_dbt.fact_netrunner_cards)
[0m12:26:34.763929 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:26:34.762846 [info ] [Thread-2 (]: 8 of 10 START sql table model public.dim_pokemon_types ......................... [RUN]
[0m12:26:34.767588 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_netrunner_factions, now model.nerd_facts_dbt.dim_pokemon_types)
[0m12:26:34.764286 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.fact_starships
[0m12:26:34.767032 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:26:34.767952 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.dim_pokemon_types
[0m12:26:34.758640 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:26:34.789727 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_starships"
[0m12:26:34.790482 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:26:34.793070 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:26:34.793840 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:26:34.794309 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:26:34.799194 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:26:34.803762 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:26:34.804307 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.dim_pokemon_types
[0m12:26:34.804632 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: BEGIN
[0m12:26:34.809278 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:26:34.809719 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:26:34.810178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:34.810739 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:26:34.812492 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: BEGIN
[0m12:26:34.812785 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:26:34.811352 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: BEGIN
[0m12:26:34.813396 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:26:34.811699 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:26:34.814033 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: BEGIN
[0m12:26:34.814310 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:26:34.842485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m12:26:34.843596 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:26:34.843992 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */

  
    

  create  table "nerd_facts"."public"."fact_starships__dbt_tmp"
  
  
    as
  
  (
    WITH starships AS (
    SELECT * FROM "nerd_facts"."public"."stg_swapi"
)
SELECT
    id,
    starship_name,
    model,
    manufacturer,
    max_speed,
    crew,
    passengers
FROM starships
  );
  
[0m12:26:34.843223 [debug] [Thread-4 (]: SQL status: BEGIN in 0.030 seconds
[0m12:26:34.847973 [debug] [Thread-3 (]: SQL status: BEGIN in 0.034 seconds
[0m12:26:34.849686 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:26:34.850059 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */

  
    

  create  table "nerd_facts"."public"."fact_netrunner_cards__dbt_tmp"
  
  
    as
  
  (
    WITH cards AS (
    SELECT * FROM "nerd_facts"."public"."stg_netrunner"
)
SELECT
    c.id,
    c.card_name,
    c.faction_name,  -- ✅ Already included in stg_netrunner
    c.type_name,  -- ✅ Now available in stg_netrunner
    c.cost,
    c.description
FROM cards c
  );
  
[0m12:26:34.848876 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:26:34.850562 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */

  
    

  create  table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp"
  
  
    as
  
  (
    WITH manufacturers AS (
    SELECT DISTINCT
        manufacturer,
        COUNT(*) AS num_starships
    FROM "nerd_facts"."public"."stg_swapi"
    GROUP BY manufacturer
)
SELECT * FROM manufacturers
  );
  
[0m12:26:34.849267 [debug] [Thread-2 (]: SQL status: BEGIN in 0.035 seconds
[0m12:26:34.851108 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:26:34.851560 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */

  
    

  create  table "nerd_facts"."public"."dim_pokemon_types__dbt_tmp"
  
  
    as
  
  (
    WITH types AS (
    SELECT DISTINCT
        primary_type,
        COUNT(*) AS num_pokemon
    FROM "nerd_facts"."public"."stg_pokeapi"
    GROUP BY primary_type
)
SELECT * FROM types
  );
  
[0m12:26:34.865608 [debug] [Thread-1 (]: SQL status: SELECT 36 in 0.021 seconds
[0m12:26:34.868979 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:26:34.869448 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */
alter table "nerd_facts"."public"."fact_starships__dbt_tmp" rename to "fact_starships"
[0m12:26:34.870134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:26:34.874864 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: COMMIT
[0m12:26:34.875279 [debug] [Thread-4 (]: SQL status: SELECT 27 in 0.024 seconds
[0m12:26:34.881114 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:26:34.881622 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.030 seconds
[0m12:26:34.890729 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:26:34.891236 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
alter table "nerd_facts"."public"."dim_pokemon_types" rename to "dim_pokemon_types__dbt_backup"
[0m12:26:34.882093 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers" rename to "dim_starship_manufacturers__dbt_backup"
[0m12:26:34.875812 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:26:34.891881 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: COMMIT
[0m12:26:34.892251 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:26:34.892540 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:26:34.898873 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:26:34.899415 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m12:26:34.902659 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."fact_starships__dbt_backup"
[0m12:26:34.905681 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_starships"
[0m12:26:34.895370 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:26:34.906688 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
alter table "nerd_facts"."public"."dim_pokemon_types__dbt_tmp" rename to "dim_pokemon_types"
[0m12:26:34.899797 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
alter table "nerd_facts"."public"."dim_starship_manufacturers__dbt_tmp" rename to "dim_starship_manufacturers"
[0m12:26:34.906222 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_starships"} */
drop table if exists "nerd_facts"."public"."fact_starships__dbt_backup" cascade
[0m12:26:34.907899 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:26:34.910159 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: COMMIT
[0m12:26:34.910986 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:26:34.911331 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: COMMIT
[0m12:26:34.910619 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:26:34.913143 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:26:34.913563 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:26:34.913919 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: COMMIT
[0m12:26:34.914515 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m12:26:34.918163 [debug] [Thread-2 (]: Applying DROP to: "nerd_facts"."public"."dim_pokemon_types__dbt_backup"
[0m12:26:34.918658 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m12:26:34.924820 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup"
[0m12:26:34.919050 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m12:26:34.927838 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_starships: Close
[0m12:26:34.932220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f702982-6b2d-43c1-afa9-b5c963adfaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae50253400>]}
[0m12:26:34.933337 [info ] [Thread-1 (]: 6 of 10 OK created sql table model public.fact_starships ....................... [[32mSELECT 36[0m in 0.18s]
[0m12:26:34.934208 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.fact_starships
[0m12:26:34.920050 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.dim_pokemon_types"
[0m12:26:34.935388 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_pokemon_types"} */
drop table if exists "nerd_facts"."public"."dim_pokemon_types__dbt_backup" cascade
[0m12:26:34.934785 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.fact_pokemon
[0m12:26:34.936196 [info ] [Thread-1 (]: 9 of 10 START sql table model public.fact_pokemon .............................. [RUN]
[0m12:26:34.936878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.fact_starships, now model.nerd_facts_dbt.fact_pokemon)
[0m12:26:34.937391 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.fact_pokemon
[0m12:26:34.941410 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.fact_pokemon"
[0m12:26:34.925994 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_starship_manufacturers"
[0m12:26:34.942086 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_starship_manufacturers"} */
drop table if exists "nerd_facts"."public"."dim_starship_manufacturers__dbt_backup" cascade
[0m12:26:34.944041 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.008 seconds
[0m12:26:34.946512 [debug] [Thread-2 (]: On model.nerd_facts_dbt.dim_pokemon_types: Close
[0m12:26:34.947905 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f702982-6b2d-43c1-afa9-b5c963adfaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae50244940>]}
[0m12:26:34.947035 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:26:34.949780 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_starship_manufacturers: Close
[0m12:26:34.953096 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f702982-6b2d-43c1-afa9-b5c963adfaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae533cb610>]}
[0m12:26:34.954262 [info ] [Thread-4 (]: 5 of 10 OK created sql table model public.dim_starship_manufacturers ........... [[32mSELECT 27[0m in 0.20s]
[0m12:26:34.954755 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.dim_starship_manufacturers
[0m12:26:34.953741 [info ] [Thread-2 (]: 8 of 10 OK created sql table model public.dim_pokemon_types .................... [[32mSELECT 1[0m in 0.18s]
[0m12:26:34.955659 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.dim_pokemon_types
[0m12:26:34.955110 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:26:34.956229 [info ] [Thread-4 (]: 10 of 10 START sql table model public.dim_netrunner_factions ................... [RUN]
[0m12:26:34.956681 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.dim_starship_manufacturers, now model.nerd_facts_dbt.dim_netrunner_factions)
[0m12:26:34.956995 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:26:34.960016 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:26:34.957417 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.fact_pokemon
[0m12:26:34.964978 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.fact_pokemon"
[0m12:26:34.966134 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:26:34.965596 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:26:34.971575 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:26:34.966474 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_pokemon: BEGIN
[0m12:26:34.972377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:34.973552 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:26:34.974047 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: BEGIN
[0m12:26:34.974518 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:26:34.992551 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m12:26:34.999878 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:26:35.000450 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */

  
    

  create  table "nerd_facts"."public"."dim_netrunner_factions__dbt_tmp"
  
  
    as
  
  (
    WITH factions AS (
    SELECT DISTINCT ON (f.faction_name)
        f.faction_name,
        COUNT(*) OVER (PARTITION BY f.faction_name) AS num_cards
    FROM "nerd_facts"."public"."stg_netrunner" n
    LEFT JOIN "nerd_facts"."public"."stg_netrunner_factions" f ON n.faction_code = f.faction_code
)
SELECT * FROM factions
  );
  
[0m12:26:35.000967 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m12:26:35.005678 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:26:35.006109 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */

  
    

  create  table "nerd_facts"."public"."fact_pokemon__dbt_tmp"
  
  
    as
  
  (
    WITH pokemon AS (
    SELECT * FROM "nerd_facts"."public"."stg_pokeapi"
)
SELECT
    id,
    pokemon_name,
    height_m,
    weight_kg,
    num_abilities,
    primary_type
FROM pokemon
  );
  
[0m12:26:35.015633 [debug] [Thread-1 (]: SQL status: SELECT 1302 in 0.009 seconds
[0m12:26:35.022953 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:26:35.023454 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
alter table "nerd_facts"."public"."fact_pokemon" rename to "fact_pokemon__dbt_backup"
[0m12:26:35.025632 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:26:35.028591 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:26:35.029022 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
alter table "nerd_facts"."public"."fact_pokemon__dbt_tmp" rename to "fact_pokemon"
[0m12:26:35.029700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:26:35.031063 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_pokemon: COMMIT
[0m12:26:35.031432 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:26:35.031773 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_pokemon: COMMIT
[0m12:26:35.038588 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m12:26:35.042807 [debug] [Thread-1 (]: Applying DROP to: "nerd_facts"."public"."fact_pokemon__dbt_backup"
[0m12:26:35.043931 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.fact_pokemon"
[0m12:26:35.044478 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_pokemon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_pokemon"} */
drop table if exists "nerd_facts"."public"."fact_pokemon__dbt_backup" cascade
[0m12:26:35.054708 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m12:26:35.056726 [debug] [Thread-1 (]: On model.nerd_facts_dbt.fact_pokemon: Close
[0m12:26:35.057764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f702982-6b2d-43c1-afa9-b5c963adfaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae534bed40>]}
[0m12:26:35.058670 [info ] [Thread-1 (]: 9 of 10 OK created sql table model public.fact_pokemon ......................... [[32mSELECT 1302[0m in 0.12s]
[0m12:26:35.059406 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.fact_pokemon
[0m12:26:37.773455 [debug] [Thread-4 (]: SQL status: SELECT 11 in 2.772 seconds
[0m12:26:37.787143 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:26:37.788178 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */
alter table "nerd_facts"."public"."dim_netrunner_factions" rename to "dim_netrunner_factions__dbt_backup"
[0m12:26:37.799303 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m12:26:37.802210 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:26:37.802576 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */
alter table "nerd_facts"."public"."dim_netrunner_factions__dbt_tmp" rename to "dim_netrunner_factions"
[0m12:26:37.803236 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:26:37.804610 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: COMMIT
[0m12:26:37.805020 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:26:37.805337 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: COMMIT
[0m12:26:37.819200 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m12:26:37.822145 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."dim_netrunner_factions__dbt_backup"
[0m12:26:37.822889 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.dim_netrunner_factions"
[0m12:26:37.823195 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.dim_netrunner_factions"} */
drop table if exists "nerd_facts"."public"."dim_netrunner_factions__dbt_backup" cascade
[0m12:26:37.830208 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m12:26:37.831578 [debug] [Thread-4 (]: On model.nerd_facts_dbt.dim_netrunner_factions: Close
[0m12:26:37.832274 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f702982-6b2d-43c1-afa9-b5c963adfaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae50244940>]}
[0m12:26:37.832843 [info ] [Thread-4 (]: 10 of 10 OK created sql table model public.dim_netrunner_factions .............. [[32mSELECT 11[0m in 2.88s]
[0m12:26:37.833994 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.dim_netrunner_factions
[0m12:26:40.145268 [debug] [Thread-3 (]: SQL status: SELECT 3044070 in 5.295 seconds
[0m12:26:40.149620 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:26:40.150071 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */
alter table "nerd_facts"."public"."fact_netrunner_cards" rename to "fact_netrunner_cards__dbt_backup"
[0m12:26:40.150897 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:26:40.153965 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:26:40.154352 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */
alter table "nerd_facts"."public"."fact_netrunner_cards__dbt_tmp" rename to "fact_netrunner_cards"
[0m12:26:40.155099 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:26:40.156800 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: COMMIT
[0m12:26:40.157201 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:26:40.157561 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: COMMIT
[0m12:26:40.165673 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m12:26:40.168716 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."fact_netrunner_cards__dbt_backup"
[0m12:26:40.169915 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.fact_netrunner_cards"
[0m12:26:40.170425 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.fact_netrunner_cards"} */
drop table if exists "nerd_facts"."public"."fact_netrunner_cards__dbt_backup" cascade
[0m12:26:40.197320 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.026 seconds
[0m12:26:40.198888 [debug] [Thread-3 (]: On model.nerd_facts_dbt.fact_netrunner_cards: Close
[0m12:26:40.199760 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f702982-6b2d-43c1-afa9-b5c963adfaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae586e4640>]}
[0m12:26:40.200559 [info ] [Thread-3 (]: 7 of 10 OK created sql table model public.fact_netrunner_cards ................. [[32mSELECT 3044070[0m in 5.44s]
[0m12:26:40.201283 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.fact_netrunner_cards
[0m12:26:40.203200 [debug] [MainThread]: Using postgres connection "master"
[0m12:26:40.203662 [debug] [MainThread]: On master: BEGIN
[0m12:26:40.203987 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:26:40.221774 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m12:26:40.222254 [debug] [MainThread]: On master: COMMIT
[0m12:26:40.222608 [debug] [MainThread]: Using postgres connection "master"
[0m12:26:40.222908 [debug] [MainThread]: On master: COMMIT
[0m12:26:40.223306 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:26:40.223633 [debug] [MainThread]: On master: Close
[0m12:26:40.224311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:40.224710 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_pokemon_types' was properly closed.
[0m12:26:40.225035 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_pokemon' was properly closed.
[0m12:26:40.225343 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.fact_netrunner_cards' was properly closed.
[0m12:26:40.225677 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.dim_netrunner_factions' was properly closed.
[0m12:26:40.227699 [info ] [MainThread]: 
[0m12:26:40.228368 [info ] [MainThread]: Finished running 6 table models, 4 view models in 0 hours 0 minutes and 5.89 seconds (5.89s).
[0m12:26:40.230184 [debug] [MainThread]: Command end result
[0m12:26:40.254093 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m12:26:40.255686 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m12:26:40.261701 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m12:26:40.262031 [info ] [MainThread]: 
[0m12:26:40.262358 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:26:40.262615 [info ] [MainThread]: 
[0m12:26:40.262875 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m12:26:40.267490 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.6686187, "process_in_blocks": "59432", "process_kernel_time": 0.155013, "process_mem_max_rss": "113784", "process_out_blocks": "3016", "process_user_time": 2.313108}
[0m12:26:40.267889 [debug] [MainThread]: Command `dbt run` succeeded at 12:26:40.267802 after 6.67 seconds
[0m12:26:40.268190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5a40c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5a28d660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae586319f0>]}
[0m12:26:40.268503 [debug] [MainThread]: Flushing usage events
[0m12:26:40.762913 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:25:35.320519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9843388e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9832efd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9832efdf0>]}


============================== 13:25:35.324145 | b5d2253b-928b-4b62-8e6d-d52dfa572d6e ==============================
[0m13:25:35.324145 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:25:35.324704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:25:35.419693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5d2253b-928b-4b62-8e6d-d52dfa572d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc98530e710>]}
[0m13:25:35.433449 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qrurt0hy'
[0m13:25:35.433988 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:25:35.589086 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:25:35.589721 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:25:35.641362 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:25:35.651983 [info ] [MainThread]: Updating lock file in file path: /home/janne/nerd-facts-dbt/dbt_project/package-lock.yml
[0m13:25:35.653668 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0xyozk5n'
[0m13:25:35.657489 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:25:35.935628 [info ] [MainThread]: Installed from version 0.9.2
[0m13:25:35.936020 [info ] [MainThread]: Updated version available: 1.3.0
[0m13:25:35.936356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b5d2253b-928b-4b62-8e6d-d52dfa572d6e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9841fd0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9832950f0>]}
[0m13:25:35.936663 [info ] [MainThread]: 
[0m13:25:35.936920 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m13:25:35.938340 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.664305, "process_in_blocks": "36064", "process_kernel_time": 0.089272, "process_mem_max_rss": "90088", "process_out_blocks": "2728", "process_user_time": 1.154457}
[0m13:25:35.938724 [debug] [MainThread]: Command `dbt deps` succeeded at 13:25:35.938644 after 0.66 seconds
[0m13:25:35.938994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9843388e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9841fd0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9852b5360>]}
[0m13:25:35.939286 [debug] [MainThread]: Flushing usage events
[0m13:25:36.357017 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:25:51.564841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f252b9c8910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f252c845ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f252c845a50>]}


============================== 13:25:51.567282 | 5c4ff10c-9552-4730-9d8a-45eef440e78d ==============================
[0m13:25:51.567282 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:25:51.567839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:25:51.724361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c4ff10c-9552-4730-9d8a-45eef440e78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f252c9a2740>]}
[0m13:25:51.776734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c4ff10c-9552-4730-9d8a-45eef440e78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f252a06e230>]}
[0m13:25:51.786418 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:25:51.868314 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:25:51.946346 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:25:51.946774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5c4ff10c-9552-4730-9d8a-45eef440e78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f252b1559c0>]}
[0m13:25:53.147091 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nerd_facts_dbt.dim_characters' (models/marts/core/dim_characters.sql) depends on a node named 'stg_swapi_people' which was not found
[0m13:25:53.148238 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.62798, "process_in_blocks": "7840", "process_kernel_time": 0.088041, "process_mem_max_rss": "106876", "process_out_blocks": "8", "process_user_time": 2.437424}
[0m13:25:53.148655 [debug] [MainThread]: Command `dbt test` failed at 13:25:53.148564 after 1.63 seconds
[0m13:25:53.148979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f252b9c8910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25296e5270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25296e7fd0>]}
[0m13:25:53.149315 [debug] [MainThread]: Flushing usage events
[0m13:25:53.529817 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:30:00.821779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a76a08b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a66525c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a6652620>]}


============================== 13:30:00.823902 | 08635454-8000-4afc-8422-e60846e48203 ==============================
[0m13:30:00.823902 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:30:00.824392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:30:00.954584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08635454-8000-4afc-8422-e60846e48203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a6737f70>]}
[0m13:30:01.002472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08635454-8000-4afc-8422-e60846e48203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a5d23670>]}
[0m13:30:01.003151 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:30:01.079313 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:30:01.152352 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:30:01.152783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '08635454-8000-4afc-8422-e60846e48203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a5ba8220>]}
[0m13:30:02.334437 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nerd_facts_dbt.fct_power_ratings' (models/marts/core/fct_power_ratings.sql) depends on a node named 'fct_sw_characters' which was not found
[0m13:30:02.335354 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.56194, "process_in_blocks": "0", "process_kernel_time": 0.10415, "process_mem_max_rss": "106556", "process_out_blocks": "16", "process_user_time": 2.414187}
[0m13:30:02.335801 [debug] [MainThread]: Command `dbt test` failed at 13:30:02.335706 after 1.56 seconds
[0m13:30:02.336110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a76a08b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a52ac460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a5383e20>]}
[0m13:30:02.336417 [debug] [MainThread]: Flushing usage events
[0m13:30:02.744685 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:33:33.485446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90d078910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90c035a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90c035a20>]}


============================== 13:33:33.487501 | ac2e2576-fac1-4cf1-b50b-6799fbc7393d ==============================
[0m13:33:33.487501 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:33:33.487976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:33:33.624793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac2e2576-fac1-4cf1-b50b-6799fbc7393d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90e05e740>]}
[0m13:33:33.682842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac2e2576-fac1-4cf1-b50b-6799fbc7393d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90c1125c0>]}
[0m13:33:33.683687 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:33:33.775267 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:33:33.856842 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:33:33.857380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ac2e2576-fac1-4cf1-b50b-6799fbc7393d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90c8259c0>]}
[0m13:33:35.084055 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nerd_facts_dbt.relationships_stg_swapi_max_speed__speed__ref_valid_speed_ranges_.f14be6e201' (models/staging/swapi/stg_swapi.yml) depends on a node named 'valid_speed_ranges' in package '' which was not found
[0m13:33:35.172648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac2e2576-fac1-4cf1-b50b-6799fbc7393d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90ab95960>]}
[0m13:33:35.298891 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m13:33:35.301198 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m13:33:35.392374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac2e2576-fac1-4cf1-b50b-6799fbc7393d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90dec6830>]}
[0m13:33:35.392858 [info ] [MainThread]: Found 16 models, 3 data tests, 11 sources, 630 macros
[0m13:33:35.393181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac2e2576-fac1-4cf1-b50b-6799fbc7393d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90dec69b0>]}
[0m13:33:35.394722 [info ] [MainThread]: 
[0m13:33:35.395036 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:33:35.395310 [info ] [MainThread]: 
[0m13:33:35.395736 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:33:35.399826 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public'
[0m13:33:35.434736 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m13:33:35.435116 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m13:33:35.435367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:35.449581 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m13:33:35.450027 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m13:33:35.450324 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:33:35.453151 [debug] [ThreadPool]: SQL status: SELECT 104 in 0.003 seconds
[0m13:33:35.457243 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m13:33:35.457786 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m13:33:35.473836 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:35.474182 [debug] [MainThread]: On master: BEGIN
[0m13:33:35.474429 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:33:35.486974 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m13:33:35.487357 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:35.487685 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:33:35.494936 [debug] [MainThread]: SQL status: SELECT 34 in 0.007 seconds
[0m13:33:35.500102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac2e2576-fac1-4cf1-b50b-6799fbc7393d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90c113e50>]}
[0m13:33:35.500488 [debug] [MainThread]: On master: ROLLBACK
[0m13:33:35.500901 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:35.501160 [debug] [MainThread]: On master: BEGIN
[0m13:33:35.501572 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:33:35.501811 [debug] [MainThread]: On master: COMMIT
[0m13:33:35.502039 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:35.502250 [debug] [MainThread]: On master: COMMIT
[0m13:33:35.502535 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:33:35.502770 [debug] [MainThread]: On master: Close
[0m13:33:35.505651 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9
[0m13:33:35.506819 [info ] [Thread-1 (]: 1 of 3 START test not_null_stg_swapi_id ........................................ [RUN]
[0m13:33:35.506439 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49
[0m13:33:35.507259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9)
[0m13:33:35.507928 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9
[0m13:33:35.506096 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc
[0m13:33:35.507630 [info ] [Thread-3 (]: 3 of 3 START test unique_stg_swapi_id .......................................... [RUN]
[0m13:33:35.519364 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9"
[0m13:33:35.520388 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49'
[0m13:33:35.521012 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49
[0m13:33:35.519869 [info ] [Thread-2 (]: 2 of 3 START test not_null_stg_swapi_starship_name ............................. [RUN]
[0m13:33:35.528079 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc'
[0m13:33:35.527469 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49"
[0m13:33:35.528411 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc
[0m13:33:35.532498 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc"
[0m13:33:35.528823 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9
[0m13:33:35.533029 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc
[0m13:33:35.533371 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49
[0m13:33:35.546097 [debug] [Thread-1 (]: Writing runtime sql for node "test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9"
[0m13:33:35.548515 [debug] [Thread-2 (]: Writing runtime sql for node "test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc"
[0m13:33:35.550718 [debug] [Thread-3 (]: Writing runtime sql for node "test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49"
[0m13:33:35.551678 [debug] [Thread-2 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc"
[0m13:33:35.552236 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49"
[0m13:33:35.552762 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9"
[0m13:33:35.553772 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9: BEGIN
[0m13:33:35.553382 [debug] [Thread-3 (]: On test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49: BEGIN
[0m13:33:35.554403 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:33:35.554129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:35.553099 [debug] [Thread-2 (]: On test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc: BEGIN
[0m13:33:35.556162 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:33:35.569667 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m13:33:35.570138 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49"
[0m13:33:35.570478 [debug] [Thread-3 (]: On test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "nerd_facts"."public"."stg_swapi"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:33:35.572092 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m13:33:35.575982 [debug] [Thread-3 (]: On test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49: ROLLBACK
[0m13:33:35.576514 [debug] [Thread-3 (]: On test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49: Close
[0m13:33:35.579130 [info ] [Thread-3 (]: 3 of 3 PASS unique_stg_swapi_id ................................................ [[32mPASS[0m in 0.06s]
[0m13:33:35.579870 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49
[0m13:33:35.580207 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m13:33:35.580835 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m13:33:35.581171 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9"
[0m13:33:35.581526 [debug] [Thread-2 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc"
[0m13:33:35.581835 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "nerd_facts"."public"."stg_swapi"
where id is null



      
    ) dbt_internal_test
[0m13:33:35.582176 [debug] [Thread-2 (]: On test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select starship_name
from "nerd_facts"."public"."stg_swapi"
where starship_name is null



      
    ) dbt_internal_test
[0m13:33:35.584379 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:33:35.584769 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:33:35.585978 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9: ROLLBACK
[0m13:33:35.587237 [debug] [Thread-2 (]: On test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc: ROLLBACK
[0m13:33:35.587806 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9: Close
[0m13:33:35.588139 [debug] [Thread-2 (]: On test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc: Close
[0m13:33:35.588858 [info ] [Thread-2 (]: 2 of 3 PASS not_null_stg_swapi_starship_name ................................... [[32mPASS[0m in 0.06s]
[0m13:33:35.589533 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc
[0m13:33:35.592327 [info ] [Thread-1 (]: 1 of 3 PASS not_null_stg_swapi_id .............................................. [[32mPASS[0m in 0.09s]
[0m13:33:35.592891 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9
[0m13:33:35.593981 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:35.594281 [debug] [MainThread]: On master: BEGIN
[0m13:33:35.594523 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:33:35.606847 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m13:33:35.607300 [debug] [MainThread]: On master: COMMIT
[0m13:33:35.607610 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:35.607864 [debug] [MainThread]: On master: COMMIT
[0m13:33:35.608203 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:33:35.608461 [debug] [MainThread]: On master: Close
[0m13:33:35.608913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:33:35.609148 [debug] [MainThread]: Connection 'test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9' was properly closed.
[0m13:33:35.609349 [debug] [MainThread]: Connection 'test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49' was properly closed.
[0m13:33:35.609571 [debug] [MainThread]: Connection 'test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc' was properly closed.
[0m13:33:35.609824 [info ] [MainThread]: 
[0m13:33:35.610207 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m13:33:35.611113 [debug] [MainThread]: Command end result
[0m13:33:35.636693 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m13:33:35.638185 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m13:33:35.643760 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m13:33:35.644108 [info ] [MainThread]: 
[0m13:33:35.644440 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:33:35.644704 [info ] [MainThread]: 
[0m13:33:35.645008 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:33:35.645793 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.2045286, "process_in_blocks": "3760", "process_kernel_time": 0.139582, "process_mem_max_rss": "140360", "process_out_blocks": "4712", "process_user_time": 2.982689}
[0m13:33:35.646133 [debug] [MainThread]: Command `dbt test` succeeded at 13:33:35.646056 after 2.21 seconds
[0m13:33:35.646411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90d078910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90df55120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90ab16920>]}
[0m13:33:35.646705 [debug] [MainThread]: Flushing usage events
[0m13:33:36.045017 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:35:20.562244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca277f4940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca267a9b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca267a9ab0>]}


============================== 13:35:20.564763 | f0d1334c-0a1c-4c62-ba5d-aebd260919ec ==============================
[0m13:35:20.564763 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:35:20.565304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m13:35:20.711682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0d1334c-0a1c-4c62-ba5d-aebd260919ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca287de770>]}
[0m13:35:20.759756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0d1334c-0a1c-4c62-ba5d-aebd260919ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca25ece080>]}
[0m13:35:20.760435 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:35:20.837652 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:35:20.961606 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m13:35:20.962117 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/star_wars/fct_starships.sql
[0m13:35:20.962431 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/pokemon/fct_pokemon.sql
[0m13:35:20.962669 [debug] [MainThread]: Partial parsing: deleted file: nerd_facts_dbt://models/marts/pokemon/fact_pokemon.sql
[0m13:35:20.962879 [debug] [MainThread]: Partial parsing: deleted file: nerd_facts_dbt://models/marts/star_wars/fact_starships.sql
[0m13:35:21.190857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0d1334c-0a1c-4c62-ba5d-aebd260919ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca25924130>]}
[0m13:35:21.275089 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m13:35:21.277412 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m13:35:21.334072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0d1334c-0a1c-4c62-ba5d-aebd260919ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca259b9a80>]}
[0m13:35:21.334797 [info ] [MainThread]: Found 16 models, 3 data tests, 11 sources, 630 macros
[0m13:35:21.335234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0d1334c-0a1c-4c62-ba5d-aebd260919ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca259bb730>]}
[0m13:35:21.337578 [info ] [MainThread]: 
[0m13:35:21.338049 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:35:21.338460 [info ] [MainThread]: 
[0m13:35:21.339077 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:35:21.344586 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public'
[0m13:35:21.376143 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m13:35:21.376563 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m13:35:21.376849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:21.389906 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m13:35:21.390364 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m13:35:21.390704 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:35:21.393556 [debug] [ThreadPool]: SQL status: SELECT 104 in 0.002 seconds
[0m13:35:21.396553 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m13:35:21.397046 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m13:35:21.418537 [debug] [MainThread]: Using postgres connection "master"
[0m13:35:21.419997 [debug] [MainThread]: On master: BEGIN
[0m13:35:21.420355 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:35:21.432781 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m13:35:21.433207 [debug] [MainThread]: Using postgres connection "master"
[0m13:35:21.433615 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:35:21.441396 [debug] [MainThread]: SQL status: SELECT 34 in 0.007 seconds
[0m13:35:21.447192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0d1334c-0a1c-4c62-ba5d-aebd260919ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca28aa27a0>]}
[0m13:35:21.447654 [debug] [MainThread]: On master: ROLLBACK
[0m13:35:21.448104 [debug] [MainThread]: Using postgres connection "master"
[0m13:35:21.448419 [debug] [MainThread]: On master: BEGIN
[0m13:35:21.448897 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:35:21.449198 [debug] [MainThread]: On master: COMMIT
[0m13:35:21.449534 [debug] [MainThread]: Using postgres connection "master"
[0m13:35:21.449795 [debug] [MainThread]: On master: COMMIT
[0m13:35:21.450189 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:35:21.450461 [debug] [MainThread]: On master: Close
[0m13:35:21.452428 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9
[0m13:35:21.452837 [info ] [Thread-1 (]: 1 of 3 START test not_null_stg_swapi_id ........................................ [RUN]
[0m13:35:21.453285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9)
[0m13:35:21.453639 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9
[0m13:35:21.453969 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc
[0m13:35:21.454294 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49
[0m13:35:21.467645 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9"
[0m13:35:21.468139 [info ] [Thread-2 (]: 2 of 3 START test not_null_stg_swapi_starship_name ............................. [RUN]
[0m13:35:21.469148 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc'
[0m13:35:21.469755 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc
[0m13:35:21.468533 [info ] [Thread-3 (]: 3 of 3 START test unique_stg_swapi_id .......................................... [RUN]
[0m13:35:21.475707 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49'
[0m13:35:21.475163 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9
[0m13:35:21.476034 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49
[0m13:35:21.474770 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc"
[0m13:35:21.488087 [debug] [Thread-1 (]: Writing runtime sql for node "test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9"
[0m13:35:21.493800 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49"
[0m13:35:21.494503 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc
[0m13:35:21.497441 [debug] [Thread-2 (]: Writing runtime sql for node "test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc"
[0m13:35:21.498001 [debug] [Thread-2 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc"
[0m13:35:21.498319 [debug] [Thread-2 (]: On test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc: BEGIN
[0m13:35:21.498582 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:35:21.499173 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9"
[0m13:35:21.500752 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9: BEGIN
[0m13:35:21.501197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:21.500415 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49
[0m13:35:21.504184 [debug] [Thread-3 (]: Writing runtime sql for node "test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49"
[0m13:35:21.508965 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49"
[0m13:35:21.509438 [debug] [Thread-3 (]: On test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49: BEGIN
[0m13:35:21.509761 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:35:21.511506 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m13:35:21.511896 [debug] [Thread-2 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc"
[0m13:35:21.512190 [debug] [Thread-2 (]: On test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select starship_name
from "nerd_facts"."public"."stg_swapi"
where starship_name is null



      
    ) dbt_internal_test
[0m13:35:21.513480 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m13:35:21.517399 [debug] [Thread-2 (]: On test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc: ROLLBACK
[0m13:35:21.518011 [debug] [Thread-2 (]: On test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc: Close
[0m13:35:21.522621 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m13:35:21.523020 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9"
[0m13:35:21.523348 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "nerd_facts"."public"."stg_swapi"
where id is null



      
    ) dbt_internal_test
[0m13:35:21.524745 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m13:35:21.525990 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9: ROLLBACK
[0m13:35:21.520792 [info ] [Thread-2 (]: 2 of 3 PASS not_null_stg_swapi_starship_name ................................... [[32mPASS[0m in 0.05s]
[0m13:35:21.526662 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc
[0m13:35:21.527018 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9: Close
[0m13:35:21.528610 [info ] [Thread-1 (]: 1 of 3 PASS not_null_stg_swapi_id .............................................. [[32mPASS[0m in 0.08s]
[0m13:35:21.529136 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9
[0m13:35:21.530851 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m13:35:21.531234 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49"
[0m13:35:21.531549 [debug] [Thread-3 (]: On test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "nerd_facts"."public"."stg_swapi"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:35:21.533165 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m13:35:21.534358 [debug] [Thread-3 (]: On test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49: ROLLBACK
[0m13:35:21.534775 [debug] [Thread-3 (]: On test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49: Close
[0m13:35:21.535338 [info ] [Thread-3 (]: 3 of 3 PASS unique_stg_swapi_id ................................................ [[32mPASS[0m in 0.06s]
[0m13:35:21.535919 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49
[0m13:35:21.538165 [debug] [MainThread]: Using postgres connection "master"
[0m13:35:21.538486 [debug] [MainThread]: On master: BEGIN
[0m13:35:21.538730 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:35:21.551142 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m13:35:21.551542 [debug] [MainThread]: On master: COMMIT
[0m13:35:21.551832 [debug] [MainThread]: Using postgres connection "master"
[0m13:35:21.552073 [debug] [MainThread]: On master: COMMIT
[0m13:35:21.552392 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:35:21.552644 [debug] [MainThread]: On master: Close
[0m13:35:21.553107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:21.553349 [debug] [MainThread]: Connection 'test.nerd_facts_dbt.not_null_stg_swapi_id.0693fbe8b9' was properly closed.
[0m13:35:21.553584 [debug] [MainThread]: Connection 'test.nerd_facts_dbt.not_null_stg_swapi_starship_name.b87d88d1fc' was properly closed.
[0m13:35:21.553780 [debug] [MainThread]: Connection 'test.nerd_facts_dbt.unique_stg_swapi_id.249e5d3f49' was properly closed.
[0m13:35:21.554028 [info ] [MainThread]: 
[0m13:35:21.554406 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m13:35:21.555263 [debug] [MainThread]: Command end result
[0m13:35:21.581945 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m13:35:21.583358 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m13:35:21.589014 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m13:35:21.589333 [info ] [MainThread]: 
[0m13:35:21.589675 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:35:21.589938 [info ] [MainThread]: 
[0m13:35:21.590201 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:35:21.590870 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.0751783, "process_in_blocks": "160", "process_kernel_time": 0.09968, "process_mem_max_rss": "115448", "process_out_blocks": "4152", "process_user_time": 1.933664}
[0m13:35:21.591244 [debug] [MainThread]: Command `dbt test` succeeded at 13:35:21.591130 after 1.08 seconds
[0m13:35:21.591555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca277f4940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca259b5db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca28a47130>]}
[0m13:35:21.591857 [debug] [MainThread]: Flushing usage events
[0m13:35:21.994422 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:24:41.771668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a26ae8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a2795db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a2795dab0>]}


============================== 09:24:41.774515 | e6c3ecd6-f0b9-4bcc-85fd-7d62f4e069ab ==============================
[0m09:24:41.774515 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:24:41.774942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:24:41.930177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6c3ecd6-f0b9-4bcc-85fd-7d62f4e069ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a27ac2770>]}
[0m09:24:41.980749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6c3ecd6-f0b9-4bcc-85fd-7d62f4e069ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a2518a080>]}
[0m09:24:41.981809 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:24:42.063899 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:24:42.212591 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 22 files added, 14 files changed.
[0m09:24:42.213145 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/swapi/stg_swapi_films.sql
[0m09:24:42.213508 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/star_wars/bridge_sw_starships_pilots.sql
[0m09:24:42.213772 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/pokemon/bridge_pokemon_moves.sql
[0m09:24:42.214016 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/netrunner/fct_netrunner_card_power.sql
[0m09:24:42.214249 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/core/dim_locations.sql
[0m09:24:42.214481 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/pokemon/dim_pokemon_abilities.sql
[0m09:24:42.214707 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/swapi/stg_swapi_species.sql
[0m09:24:42.214933 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/pokeapi/stg_pokeapi_abilities.sql
[0m09:24:42.215163 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/swapi/stg_swapi_planets.sql
[0m09:24:42.215438 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/netrunner/dim_netrunner_cards.sql
[0m09:24:42.215662 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/star_wars/dim_sw_films.sql
[0m09:24:42.215886 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/netrunner/stg_netrunner_packs.sql
[0m09:24:42.216107 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/swapi/stg_swapi_vehicles.sql
[0m09:24:42.216334 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/netrunner/stg_netrunner_cards.sql
[0m09:24:42.216552 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/swapi/stg_swapi_starships.sql
[0m09:24:42.216769 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/pokemon/fct_pokemon_matchups.sql
[0m09:24:42.216986 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/star_wars/dim_sw_vehicles.sql
[0m09:24:42.217203 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/pokemon/bridge_pokemon_abilities.sql
[0m09:24:42.217433 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/pokeapi/stg_pokeapi_moves.sql
[0m09:24:42.217667 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/star_wars/dim_sw_planets.sql
[0m09:24:42.217890 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/star_wars/bridge_sw_characters_films.sql
[0m09:24:42.218118 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/pokeapi/stg_pokeapi_items.sql
[0m09:24:42.218556 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/swapi/stg_swapi.yml
[0m09:24:42.218873 [debug] [MainThread]: Partial parsing: deleted file: nerd_facts_dbt://models/staging/pokeapi/stg_pokeapi.sql
[0m09:24:42.219191 [debug] [MainThread]: Partial parsing: deleted file: nerd_facts_dbt://models/staging/netrunner/stg_netrunner.sql
[0m09:24:42.219499 [debug] [MainThread]: Partial parsing: deleted file: nerd_facts_dbt://models/staging/swapi/stg_swapi.sql
[0m09:24:42.219777 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/core/fct_power_ratings.sql
[0m09:24:42.220049 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/swapi/stg_swapi_people.sql
[0m09:24:42.220294 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/netrunner/dim_netrunner_factions.sql
[0m09:24:42.220525 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/pokemon/fct_pokemon.sql
[0m09:24:42.220792 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/pokeapi/stg_pokeapi_types.sql
[0m09:24:42.221069 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/core/dim_characters.sql
[0m09:24:42.221352 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/netrunner/stg_netrunner_factions.sql
[0m09:24:42.221608 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/netrunner/fact_netrunner_cards.sql
[0m09:24:42.221880 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/pokemon/fct_pokemon_stats.sql
[0m09:24:42.222154 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/pokeapi/stg_pokeapi_pokemon.sql
[0m09:24:42.222386 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/pokemon/dim_pokemon_types.sql
[0m09:24:42.222617 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/star_wars/fct_starships.sql
[0m09:24:42.222890 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/star_wars/fct_sw_characters.sql
[0m09:24:42.635597 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_swapi' in the 'models' section of file 'models/staging/swapi/stg_swapi.yml'
[0m09:24:42.779857 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nerd_facts_dbt.bridge_pokemon_moves' (models/marts/pokemon/bridge_pokemon_moves.sql) depends on a node named 'dim_pokemon_moves' which was not found
[0m09:24:42.781569 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.054454, "process_in_blocks": "47600", "process_kernel_time": 0.137266, "process_mem_max_rss": "105172", "process_out_blocks": "24", "process_user_time": 1.901805}
[0m09:24:42.781970 [debug] [MainThread]: Command `dbt test` failed at 09:24:42.781880 after 1.06 seconds
[0m09:24:42.782280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a24c8a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a24bc78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a24c7b190>]}
[0m09:24:42.782588 [debug] [MainThread]: Flushing usage events
[0m09:24:43.197376 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:28:04.388508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd787c4970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd79675b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd79675b10>]}


============================== 09:28:04.390546 | 013cbee8-bd9c-499a-8756-9c4eea2de531 ==============================
[0m09:28:04.390546 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:28:04.390950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:28:04.520757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '013cbee8-bd9c-499a-8756-9c4eea2de531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd797c27a0>]}
[0m09:28:04.569538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '013cbee8-bd9c-499a-8756-9c4eea2de531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd7853f790>]}
[0m09:28:04.570213 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:28:04.649759 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:28:04.779561 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 22 files added, 14 files changed.
[0m09:28:04.780098 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/swapi/stg_swapi_starships.sql
[0m09:28:04.780445 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/swapi/stg_swapi_films.sql
[0m09:28:04.780702 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/netrunner/fct_netrunner_card_power.sql
[0m09:28:04.780985 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/swapi/stg_swapi_planets.sql
[0m09:28:04.781222 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/swapi/stg_swapi_species.sql
[0m09:28:04.781468 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/swapi/stg_swapi_vehicles.sql
[0m09:28:04.781701 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/pokemon/bridge_pokemon_moves.sql
[0m09:28:04.781929 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/core/dim_locations.sql
[0m09:28:04.782163 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/pokemon/fct_pokemon_matchups.sql
[0m09:28:04.782408 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/netrunner/dim_netrunner_cards.sql
[0m09:28:04.782664 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/netrunner/stg_netrunner_cards.sql
[0m09:28:04.782891 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/netrunner/stg_netrunner_packs.sql
[0m09:28:04.783162 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/pokemon/bridge_pokemon_abilities.sql
[0m09:28:04.783421 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/star_wars/bridge_sw_starships_pilots.sql
[0m09:28:04.783660 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/pokeapi/stg_pokeapi_moves.sql
[0m09:28:04.783885 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/star_wars/bridge_sw_characters_films.sql
[0m09:28:04.784110 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/pokemon/dim_pokemon_abilities.sql
[0m09:28:04.784343 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/star_wars/dim_sw_vehicles.sql
[0m09:28:04.784568 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/star_wars/dim_sw_planets.sql
[0m09:28:04.784789 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/pokeapi/stg_pokeapi_abilities.sql
[0m09:28:04.785009 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/star_wars/dim_sw_films.sql
[0m09:28:04.785242 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/pokeapi/stg_pokeapi_items.sql
[0m09:28:04.785841 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/swapi/stg_swapi.yml
[0m09:28:04.786206 [debug] [MainThread]: Partial parsing: deleted file: nerd_facts_dbt://models/staging/pokeapi/stg_pokeapi.sql
[0m09:28:04.786522 [debug] [MainThread]: Partial parsing: deleted file: nerd_facts_dbt://models/staging/netrunner/stg_netrunner.sql
[0m09:28:04.786804 [debug] [MainThread]: Partial parsing: deleted file: nerd_facts_dbt://models/staging/swapi/stg_swapi.sql
[0m09:28:04.787051 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/pokemon/fct_pokemon.sql
[0m09:28:04.787372 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/swapi/stg_swapi_people.sql
[0m09:28:04.787610 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/netrunner/dim_netrunner_factions.sql
[0m09:28:04.787879 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/core/dim_characters.sql
[0m09:28:04.788122 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/netrunner/fact_netrunner_cards.sql
[0m09:28:04.788395 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/pokeapi/stg_pokeapi_pokemon.sql
[0m09:28:04.788667 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/core/fct_power_ratings.sql
[0m09:28:04.788935 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/pokemon/fct_pokemon_stats.sql
[0m09:28:04.789217 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/pokeapi/stg_pokeapi_types.sql
[0m09:28:04.789487 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/star_wars/fct_starships.sql
[0m09:28:04.789758 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/netrunner/stg_netrunner_factions.sql
[0m09:28:04.790029 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/star_wars/fct_sw_characters.sql
[0m09:28:04.790270 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/pokemon/dim_pokemon_types.sql
[0m09:28:05.207225 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_swapi' in the 'models' section of file 'models/staging/swapi/stg_swapi.yml'
[0m09:28:05.390336 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nerd_facts_dbt.bridge_pokemon_moves' (models/marts/pokemon/bridge_pokemon_moves.sql) depends on a node named 'dim_pokemon_moves' which was not found
[0m09:28:05.391218 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.0471883, "process_in_blocks": "0", "process_kernel_time": 0.0998, "process_mem_max_rss": "105360", "process_out_blocks": "24", "process_user_time": 1.892934}
[0m09:28:05.391596 [debug] [MainThread]: Command `dbt test` failed at 09:28:05.391512 after 1.05 seconds
[0m09:28:05.391899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd76d6f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd768d9540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd7698c940>]}
[0m09:28:05.392207 [debug] [MainThread]: Flushing usage events
[0m09:28:05.807172 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:31:53.649912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9819f5c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981ae05a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981ae05a20>]}


============================== 09:31:53.652334 | eb4849e2-97ed-49a1-a9f0-200ed8291335 ==============================
[0m09:31:53.652334 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:31:53.652866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:31:53.788953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb4849e2-97ed-49a1-a9f0-200ed8291335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9818ff73d0>]}
[0m09:31:53.838381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb4849e2-97ed-49a1-a9f0-200ed8291335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981add5870>]}
[0m09:31:53.839193 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:31:53.914739 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:31:54.041193 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 24 files added, 14 files changed.
[0m09:31:54.041742 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/star_wars/dim_sw_vehicles.sql
[0m09:31:54.042046 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/swapi/stg_swapi_starships.sql
[0m09:31:54.042307 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/core/dim_locations.sql
[0m09:31:54.042588 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/swapi/stg_swapi_planets.sql
[0m09:31:54.042824 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/pokemon/dim_pokemon_moves.sql
[0m09:31:54.043073 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/star_wars/bridge_sw_starships_pilots.sql
[0m09:31:54.043312 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/pokeapi/stg_pokeapi_abilities.sql
[0m09:31:54.043547 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/netrunner/stg_netrunner_packs.sql
[0m09:31:54.043809 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/star_wars/bridge_sw_characters_films.sql
[0m09:31:54.044039 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/pokemon/bridge_pokemon_abilities.sql
[0m09:31:54.044264 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/netrunner/fct_netrunner_card_power.sql
[0m09:31:54.044489 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/star_wars/dim_sw_planets.sql
[0m09:31:54.044710 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/swapi/stg_swapi_vehicles.sql
[0m09:31:54.044936 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/swapi/stg_swapi_species.sql
[0m09:31:54.045154 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/pokemon/dim_pokemon_abilities.sql
[0m09:31:54.045374 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/pokeapi/stg_pokeapi_moves.sql
[0m09:31:54.045674 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/star_wars/dim_sw_films.sql
[0m09:31:54.045917 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/pokemon/bridge_pokemon_moves.sql
[0m09:31:54.046136 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/swapi/stg_swapi_films.sql
[0m09:31:54.046366 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/netrunner/dim_netrunner_cards.sql
[0m09:31:54.046593 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/marts/pokemon/fct_pokemon_matchups.sql
[0m09:31:54.046864 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/pokeapi/pokeapi_sources.yml
[0m09:31:54.047101 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/pokeapi/stg_pokeapi_items.sql
[0m09:31:54.047322 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/netrunner/stg_netrunner_cards.sql
[0m09:31:54.047894 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/swapi/stg_swapi.yml
[0m09:31:54.048236 [debug] [MainThread]: Partial parsing: deleted file: nerd_facts_dbt://models/staging/netrunner/stg_netrunner.sql
[0m09:31:54.048555 [debug] [MainThread]: Partial parsing: deleted file: nerd_facts_dbt://models/staging/pokeapi/stg_pokeapi.sql
[0m09:31:54.048829 [debug] [MainThread]: Partial parsing: deleted file: nerd_facts_dbt://models/staging/swapi/stg_swapi.sql
[0m09:31:54.049107 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/star_wars/fct_sw_characters.sql
[0m09:31:54.049347 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/netrunner/dim_netrunner_factions.sql
[0m09:31:54.049613 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/netrunner/fact_netrunner_cards.sql
[0m09:31:54.049889 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/core/dim_characters.sql
[0m09:31:54.050135 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/pokemon/fct_pokemon.sql
[0m09:31:54.050366 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/star_wars/fct_starships.sql
[0m09:31:54.050629 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/core/fct_power_ratings.sql
[0m09:31:54.050896 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/pokeapi/stg_pokeapi_pokemon.sql
[0m09:31:54.051217 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/swapi/stg_swapi_people.sql
[0m09:31:54.051504 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/pokemon/fct_pokemon_stats.sql
[0m09:31:54.051778 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/netrunner/stg_netrunner_factions.sql
[0m09:31:54.052014 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/marts/pokemon/dim_pokemon_types.sql
[0m09:31:54.052285 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/pokeapi/stg_pokeapi_types.sql
[0m09:31:54.530730 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_swapi' in the 'models' section of file 'models/staging/swapi/stg_swapi.yml'
[0m09:31:54.780121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb4849e2-97ed-49a1-a9f0-200ed8291335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9817992470>]}
[0m09:31:54.886679 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m09:31:54.889110 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m09:31:54.972461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb4849e2-97ed-49a1-a9f0-200ed8291335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9818453a30>]}
[0m09:31:54.973131 [info ] [MainThread]: Found 36 models, 36 data tests, 12 sources, 630 macros
[0m09:31:54.973619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb4849e2-97ed-49a1-a9f0-200ed8291335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981797de10>]}
[0m09:31:54.977320 [info ] [MainThread]: 
[0m09:31:54.977731 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:31:54.978059 [info ] [MainThread]: 
[0m09:31:54.978561 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:31:54.984473 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public'
[0m09:31:55.015846 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m09:31:55.016252 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m09:31:55.016577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:31:55.030307 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m09:31:55.030748 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m09:31:55.031094 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:31:55.034053 [debug] [ThreadPool]: SQL status: SELECT 104 in 0.003 seconds
[0m09:31:55.036499 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m09:31:55.036941 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m09:31:55.058571 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:55.059247 [debug] [MainThread]: On master: BEGIN
[0m09:31:55.059761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:31:55.076051 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m09:31:55.076507 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:55.076880 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:31:55.084656 [debug] [MainThread]: SQL status: SELECT 34 in 0.007 seconds
[0m09:31:55.090051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb4849e2-97ed-49a1-a9f0-200ed8291335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9817bc1390>]}
[0m09:31:55.090516 [debug] [MainThread]: On master: ROLLBACK
[0m09:31:55.090988 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:55.091294 [debug] [MainThread]: On master: BEGIN
[0m09:31:55.091793 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:31:55.092082 [debug] [MainThread]: On master: COMMIT
[0m09:31:55.092374 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:55.092643 [debug] [MainThread]: On master: COMMIT
[0m09:31:55.092996 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:31:55.093280 [debug] [MainThread]: On master: Close
[0m09:31:55.098635 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing.2fef0b1acf
[0m09:31:55.099069 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05
[0m09:31:55.099423 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03
[0m09:31:55.099747 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5.de460c4fa4
[0m09:31:55.100149 [info ] [Thread-1 (]: 1 of 36 START test accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing  [RUN]
[0m09:31:55.100669 [info ] [Thread-2 (]: 2 of 36 START test dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1 ... [RUN]
[0m09:31:55.101003 [info ] [Thread-3 (]: 3 of 36 START test dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0  [RUN]
[0m09:31:55.101973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now test.nerd_facts_dbt.accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing.2fef0b1acf)
[0m09:31:55.103387 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing.2fef0b1acf
[0m09:31:55.101321 [info ] [Thread-4 (]: 4 of 36 START test dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5  [RUN]
[0m09:31:55.113515 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5.de460c4fa4'
[0m09:31:55.113903 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5.de460c4fa4
[0m09:31:55.112941 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing.2fef0b1acf"
[0m09:31:55.103021 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03'
[0m09:31:55.102573 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05'
[0m09:31:55.118462 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5.de460c4fa4"
[0m09:31:55.119055 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03
[0m09:31:55.119475 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05
[0m09:31:55.120030 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing.2fef0b1acf
[0m09:31:55.124746 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03"
[0m09:31:55.129861 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05"
[0m09:31:55.130269 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5.de460c4fa4
[0m09:31:55.146966 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05
[0m09:31:55.147518 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03
[0m09:31:55.146416 [debug] [Thread-1 (]: Writing runtime sql for node "test.nerd_facts_dbt.accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing.2fef0b1acf"
[0m09:31:55.156139 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing.2fef0b1acf"
[0m09:31:55.152923 [debug] [Thread-2 (]: Writing runtime sql for node "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05"
[0m09:31:55.156508 [debug] [Thread-1 (]: On test.nerd_facts_dbt.accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing.2fef0b1acf: BEGIN
[0m09:31:55.157086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:55.157796 [debug] [Thread-2 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05"
[0m09:31:55.158214 [debug] [Thread-2 (]: On test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05: BEGIN
[0m09:31:55.158601 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:31:55.150171 [debug] [Thread-4 (]: Writing runtime sql for node "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5.de460c4fa4"
[0m09:31:55.160539 [debug] [Thread-4 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5.de460c4fa4"
[0m09:31:55.161042 [debug] [Thread-4 (]: On test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5.de460c4fa4: BEGIN
[0m09:31:55.161500 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:31:55.155479 [debug] [Thread-3 (]: Writing runtime sql for node "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03"
[0m09:31:55.173814 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03"
[0m09:31:55.174477 [debug] [Thread-3 (]: On test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03: BEGIN
[0m09:31:55.174961 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:31:55.189677 [debug] [Thread-4 (]: SQL status: BEGIN in 0.028 seconds
[0m09:31:55.190106 [debug] [Thread-4 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5.de460c4fa4"
[0m09:31:55.190438 [debug] [Thread-4 (]: On test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5.de460c4fa4: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5.de460c4fa4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "nerd_facts"."public"."stg_swapi_starships"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not hyperdrive_rating >= 0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not hyperdrive_rating <= 10
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m09:31:55.191069 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m09:31:55.191547 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing.2fef0b1acf"
[0m09:31:55.191894 [debug] [Thread-1 (]: On test.nerd_facts_dbt.accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing.2fef0b1acf: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing.2fef0b1acf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        manufacturer as value_field,
        count(*) as n_records

    from "nerd_facts"."public"."stg_swapi_starships"
    group by manufacturer

)

select *
from all_values
where value_field not in (
    'Kuat Drive Yards','Corellian Engineering Corporation','Sienar Fleet Systems','Cygnus Spaceworks','Incom Corporation','Koensayr Manufacturing'
)



      
    ) dbt_internal_test
[0m09:31:55.193237 [debug] [Thread-2 (]: SQL status: BEGIN in 0.035 seconds
[0m09:31:55.194053 [debug] [Thread-2 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05"
[0m09:31:55.193576 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_starships" does not exist
LINE 11:   from "nerd_facts"."public"."stg_swapi_starships"
                ^

[0m09:31:55.195525 [debug] [Thread-4 (]: On test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5.de460c4fa4: ROLLBACK
[0m09:31:55.194667 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m09:31:55.195041 [debug] [Thread-2 (]: On test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "nerd_facts"."public"."stg_swapi_films"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not episode_id >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not episode_id <= 9
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m09:31:55.195952 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03"
[0m09:31:55.197258 [debug] [Thread-3 (]: On test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "nerd_facts"."public"."stg_swapi_planets"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not surface_water >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not surface_water <= 100
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m09:31:55.196326 [debug] [Thread-4 (]: On test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5.de460c4fa4: Close
[0m09:31:55.199623 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_planets" does not exist
LINE 11:   from "nerd_facts"."public"."stg_swapi_planets"
                ^

[0m09:31:55.194400 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_starships" does not exist
LINE 17:     from "nerd_facts"."public"."stg_swapi_starships"
                  ^

[0m09:31:55.199993 [debug] [Thread-3 (]: On test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03: ROLLBACK
[0m09:31:55.196931 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_films" does not exist
LINE 11:   from "nerd_facts"."public"."stg_swapi_films"
                ^

[0m09:31:55.200605 [debug] [Thread-1 (]: On test.nerd_facts_dbt.accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing.2fef0b1acf: ROLLBACK
[0m09:31:55.201161 [debug] [Thread-2 (]: On test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05: ROLLBACK
[0m09:31:55.201596 [debug] [Thread-3 (]: On test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03: Close
[0m09:31:55.203077 [debug] [Thread-2 (]: On test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05: Close
[0m09:31:55.202080 [debug] [Thread-1 (]: On test.nerd_facts_dbt.accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing.2fef0b1acf: Close
[0m09:31:55.209836 [debug] [Thread-4 (]: Database Error in test dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5 (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 11:   from "nerd_facts"."public"."stg_swapi_starships"
                  ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_accepted_range_stg_s_dd0ad6923fc838f5a7ce83233328b8a5.sql
[0m09:31:55.210557 [debug] [Thread-1 (]: Database Error in test accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 17:     from "nerd_facts"."public"."stg_swapi_starships"
                    ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/accepted_values_stg_swapi_star_f3359b21d1586e66ef9d2b69269f94d5.sql
[0m09:31:55.211246 [debug] [Thread-2 (]: Database Error in test dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1 (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_films" does not exist
  LINE 11:   from "nerd_facts"."public"."stg_swapi_films"
                  ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.sql
[0m09:31:55.211856 [debug] [Thread-3 (]: Database Error in test dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0 (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_planets" does not exist
  LINE 11:   from "nerd_facts"."public"."stg_swapi_planets"
                  ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_accepted_range_stg_s_dc3789df0cd4354ea093aa3d5ed78748.sql
[0m09:31:55.212323 [error] [Thread-4 (]: 4 of 36 ERROR dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5  [[31mERROR[0m in 0.10s]
[0m09:31:55.212891 [error] [Thread-1 (]: 1 of 36 ERROR accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing  [[31mERROR[0m in 0.11s]
[0m09:31:55.214317 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5.de460c4fa4
[0m09:31:55.215511 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0.8f9d0183b8
[0m09:31:55.216321 [info ] [Thread-4 (]: 5 of 36 START test dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0  [RUN]
[0m09:31:55.215107 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing.2fef0b1acf
[0m09:31:55.213325 [error] [Thread-2 (]: 2 of 36 ERROR dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1 ........ [[31mERROR[0m in 0.11s]
[0m09:31:55.215955 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5.de460c4fa4' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5 (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 11:   from "nerd_facts"."public"."stg_swapi_starships"
                  ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_accepted_range_stg_s_dd0ad6923fc838f5a7ce83233328b8a5.sql.
[0m09:31:55.216819 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5.de460c4fa4, now test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0.8f9d0183b8)
[0m09:31:55.213860 [error] [Thread-3 (]: 3 of 36 ERROR dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0 . [[31mERROR[0m in 0.11s]
[0m09:31:55.217254 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL.4849ab31ba
[0m09:31:55.217784 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05
[0m09:31:55.218735 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing.2fef0b1acf' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 17:     from "nerd_facts"."public"."stg_swapi_starships"
                    ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/accepted_values_stg_swapi_star_f3359b21d1586e66ef9d2b69269f94d5.sql.
[0m09:31:55.219629 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03
[0m09:31:55.219142 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0.8f9d0183b8
[0m09:31:55.220374 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL.8339feb5a2
[0m09:31:55.220860 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1 (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_films" does not exist
  LINE 11:   from "nerd_facts"."public"."stg_swapi_films"
                  ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.sql.
[0m09:31:55.227441 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0 (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_planets" does not exist
  LINE 11:   from "nerd_facts"."public"."stg_swapi_planets"
                  ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_accepted_range_stg_s_dc3789df0cd4354ea093aa3d5ed78748.sql.
[0m09:31:55.221352 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL.c35df747e6
[0m09:31:55.226282 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0.8f9d0183b8"
[0m09:31:55.226811 [info ] [Thread-2 (]: 7 of 36 START test dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL  [RUN]
[0m09:31:55.220013 [info ] [Thread-1 (]: 6 of 36 START test dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL  [RUN]
[0m09:31:55.227934 [info ] [Thread-3 (]: 8 of 36 START test dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL  [RUN]
[0m09:31:55.229629 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0.a9aca03c03, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL.c35df747e6)
[0m09:31:55.229085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing.2fef0b1acf, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL.4849ab31ba)
[0m09:31:55.228654 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.a5d4199e05, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL.8339feb5a2)
[0m09:31:55.230038 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0.8f9d0183b8
[0m09:31:55.230342 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL.c35df747e6
[0m09:31:55.230666 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL.4849ab31ba
[0m09:31:55.231010 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL.8339feb5a2
[0m09:31:55.233715 [debug] [Thread-4 (]: Writing runtime sql for node "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0.8f9d0183b8"
[0m09:31:55.238337 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL.c35df747e6"
[0m09:31:55.243075 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL.4849ab31ba"
[0m09:31:55.249113 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL.4849ab31ba
[0m09:31:55.247716 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL.8339feb5a2"
[0m09:31:55.252227 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL.8339feb5a2
[0m09:31:55.251676 [debug] [Thread-1 (]: Writing runtime sql for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL.4849ab31ba"
[0m09:31:55.248475 [debug] [Thread-4 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0.8f9d0183b8"
[0m09:31:55.255574 [debug] [Thread-2 (]: Writing runtime sql for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL.8339feb5a2"
[0m09:31:55.255937 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL.c35df747e6
[0m09:31:55.256689 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL.4849ab31ba"
[0m09:31:55.257021 [debug] [Thread-4 (]: On test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0.8f9d0183b8: BEGIN
[0m09:31:55.257585 [debug] [Thread-2 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL.8339feb5a2"
[0m09:31:55.260254 [debug] [Thread-3 (]: Writing runtime sql for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL.c35df747e6"
[0m09:31:55.260747 [debug] [Thread-1 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL.4849ab31ba: BEGIN
[0m09:31:55.261145 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:31:55.261547 [debug] [Thread-2 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL.8339feb5a2: BEGIN
[0m09:31:55.263172 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:31:55.262599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:55.262258 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL.c35df747e6"
[0m09:31:55.268939 [debug] [Thread-3 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL.c35df747e6: BEGIN
[0m09:31:55.270205 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:31:55.297784 [debug] [Thread-4 (]: SQL status: BEGIN in 0.037 seconds
[0m09:31:55.298420 [debug] [Thread-4 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0.8f9d0183b8"
[0m09:31:55.298931 [debug] [Thread-4 (]: On test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0.8f9d0183b8: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0.8f9d0183b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "nerd_facts"."public"."stg_swapi_starships"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not max_atmosphering_speed >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not max_atmosphering_speed <= 2000
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m09:31:55.301666 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_starships" does not exist
LINE 11:   from "nerd_facts"."public"."stg_swapi_starships"
                ^

[0m09:31:55.305672 [debug] [Thread-4 (]: On test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0.8f9d0183b8: ROLLBACK
[0m09:31:55.306537 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m09:31:55.306912 [debug] [Thread-3 (]: SQL status: BEGIN in 0.037 seconds
[0m09:31:55.308642 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL.c35df747e6"
[0m09:31:55.307894 [debug] [Thread-4 (]: On test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0.8f9d0183b8: Close
[0m09:31:55.310277 [debug] [Thread-4 (]: Database Error in test dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0 (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 11:   from "nerd_facts"."public"."stg_swapi_starships"
                  ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_accepted_range_stg_s_0010594815da93a571a43e6dd43c6422.sql
[0m09:31:55.310993 [error] [Thread-4 (]: 5 of 36 ERROR dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0  [[31mERROR[0m in 0.09s]
[0m09:31:55.307492 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m09:31:55.308279 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL.4849ab31ba"
[0m09:31:55.308990 [debug] [Thread-3 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL.c35df747e6: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL.c35df747e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as (
    select * from "nerd_facts"."public"."stg_swapi_starships" where 1=1
)

select
    *
from meet_condition

where not(crew >= 1 OR IS NULL)


      
    ) dbt_internal_test
[0m09:31:55.311836 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0.8f9d0183b8
[0m09:31:55.312236 [debug] [Thread-2 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL.8339feb5a2"
[0m09:31:55.312639 [debug] [Thread-1 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL.4849ab31ba: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL.4849ab31ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as (
    select * from "nerd_facts"."public"."stg_swapi_starships" where 1=1
)

select
    *
from meet_condition

where not(MGLT >= 0 OR IS NULL)


      
    ) dbt_internal_test
[0m09:31:55.313647 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0.8f9d0183b8' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0 (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 11:   from "nerd_facts"."public"."stg_swapi_starships"
                  ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_accepted_range_stg_s_0010594815da93a571a43e6dd43c6422.sql.
[0m09:31:55.315095 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "NULL"
LINE 17: where not(MGLT >= 0 OR IS NULL)
                                   ^

[0m09:31:55.314034 [debug] [Thread-2 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL.8339feb5a2: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL.8339feb5a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as (
    select * from "nerd_facts"."public"."stg_swapi_starships" where 1=1
)

select
    *
from meet_condition

where not(cargo_capacity >= 0 OR IS NULL)


      
    ) dbt_internal_test
[0m09:31:55.314363 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "NULL"
LINE 17: where not(crew >= 1 OR IS NULL)
                                   ^

[0m09:31:55.315471 [debug] [Thread-1 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL.4849ab31ba: ROLLBACK
[0m09:31:55.316780 [debug] [Thread-1 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL.4849ab31ba: Close
[0m09:31:55.315955 [debug] [Thread-3 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL.c35df747e6: ROLLBACK
[0m09:31:55.316324 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "NULL"
LINE 17: where not(cargo_capacity >= 0 OR IS NULL)
                                             ^

[0m09:31:55.317365 [debug] [Thread-2 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL.8339feb5a2: ROLLBACK
[0m09:31:55.317965 [debug] [Thread-3 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL.c35df747e6: Close
[0m09:31:55.320663 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL (models/staging/swapi/stg_swapi.yml)
  syntax error at or near "NULL"
  LINE 17: where not(MGLT >= 0 OR IS NULL)
                                     ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_cfc3b86b042a82b903ed54f0c8725d53.sql
[0m09:31:55.313219 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_.2b12d505ec
[0m09:31:55.321206 [debug] [Thread-2 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL.8339feb5a2: Close
[0m09:31:55.324350 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL (models/staging/swapi/stg_swapi.yml)
  syntax error at or near "NULL"
  LINE 17: where not(cargo_capacity >= 0 OR IS NULL)
                                               ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_4acb3b26b03e1d062250ec156d7d150d.sql
[0m09:31:55.322634 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL (models/staging/swapi/stg_swapi.yml)
  syntax error at or near "NULL"
  LINE 17: where not(crew >= 1 OR IS NULL)
                                     ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_d125afcd2334724d94f609b49be6617c.sql
[0m09:31:55.321904 [error] [Thread-1 (]: 6 of 36 ERROR dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL  [[31mERROR[0m in 0.09s]
[0m09:31:55.326348 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL.4849ab31ba
[0m09:31:55.326766 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL.1915ec346c
[0m09:31:55.327171 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL.4849ab31ba' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL (models/staging/swapi/stg_swapi.yml)
  syntax error at or near "NULL"
  LINE 17: where not(MGLT >= 0 OR IS NULL)
                                     ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_cfc3b86b042a82b903ed54f0c8725d53.sql.
[0m09:31:55.323074 [info ] [Thread-4 (]: 9 of 36 START test dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_  [RUN]
[0m09:31:55.325058 [error] [Thread-2 (]: 7 of 36 ERROR dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL  [[31mERROR[0m in 0.10s]
[0m09:31:55.328404 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0.8f9d0183b8, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_.2b12d505ec)
[0m09:31:55.325591 [error] [Thread-3 (]: 8 of 36 ERROR dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL  [[31mERROR[0m in 0.10s]
[0m09:31:55.327554 [info ] [Thread-1 (]: 10 of 36 START test dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL  [RUN]
[0m09:31:55.329148 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL.8339feb5a2
[0m09:31:55.329563 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_.2b12d505ec
[0m09:31:55.330054 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL.c35df747e6
[0m09:31:55.330475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL.4849ab31ba, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL.1915ec346c)
[0m09:31:55.330868 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL.ec823ef959
[0m09:31:55.331263 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL.8339feb5a2' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL (models/staging/swapi/stg_swapi.yml)
  syntax error at or near "NULL"
  LINE 17: where not(cargo_capacity >= 0 OR IS NULL)
                                               ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_4acb3b26b03e1d062250ec156d7d150d.sql.
[0m09:31:55.336013 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_.2b12d505ec"
[0m09:31:55.336521 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL.176b315457
[0m09:31:55.336909 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL.1915ec346c
[0m09:31:55.337836 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL.c35df747e6' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL (models/staging/swapi/stg_swapi.yml)
  syntax error at or near "NULL"
  LINE 17: where not(crew >= 1 OR IS NULL)
                                     ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_d125afcd2334724d94f609b49be6617c.sql.
[0m09:31:55.337299 [info ] [Thread-2 (]: 11 of 36 START test dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL  [RUN]
[0m09:31:55.342810 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL.1915ec346c"
[0m09:31:55.338476 [info ] [Thread-3 (]: 12 of 36 START test dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL  [RUN]
[0m09:31:55.344609 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL.c35df747e6, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL.176b315457)
[0m09:31:55.343998 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_.2b12d505ec
[0m09:31:55.348217 [debug] [Thread-4 (]: Writing runtime sql for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_.2b12d505ec"
[0m09:31:55.345124 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL.1915ec346c
[0m09:31:55.345514 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL.176b315457
[0m09:31:55.348837 [debug] [Thread-4 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_.2b12d505ec"
[0m09:31:55.343578 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL.8339feb5a2, now test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL.ec823ef959)
[0m09:31:55.352016 [debug] [Thread-1 (]: Writing runtime sql for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL.1915ec346c"
[0m09:31:55.356582 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL.176b315457"
[0m09:31:55.357076 [debug] [Thread-4 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_.2b12d505ec: BEGIN
[0m09:31:55.357524 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL.ec823ef959
[0m09:31:55.358180 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL.1915ec346c"
[0m09:31:55.364077 [debug] [Thread-1 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL.1915ec346c: BEGIN
[0m09:31:55.364432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:55.363631 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL.ec823ef959"
[0m09:31:55.358697 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:31:55.359159 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL.176b315457
[0m09:31:55.373983 [debug] [Thread-3 (]: Writing runtime sql for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL.176b315457"
[0m09:31:55.374823 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL.ec823ef959
[0m09:31:55.385011 [debug] [Thread-2 (]: Writing runtime sql for node "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL.ec823ef959"
[0m09:31:55.385613 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL.176b315457"
[0m09:31:55.386243 [debug] [Thread-3 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL.176b315457: BEGIN
[0m09:31:55.386712 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:31:55.387178 [debug] [Thread-2 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL.ec823ef959"
[0m09:31:55.387813 [debug] [Thread-2 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL.ec823ef959: BEGIN
[0m09:31:55.388270 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:31:55.401738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m09:31:55.405646 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL.1915ec346c"
[0m09:31:55.406131 [debug] [Thread-4 (]: SQL status: BEGIN in 0.047 seconds
[0m09:31:55.406657 [debug] [Thread-1 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL.1915ec346c: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL.1915ec346c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as (
    select * from "nerd_facts"."public"."stg_swapi_starships" where 1=1
)

select
    *
from meet_condition

where not(length > 0 OR IS NULL)


      
    ) dbt_internal_test
[0m09:31:55.407245 [debug] [Thread-4 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_.2b12d505ec"
[0m09:31:55.407819 [debug] [Thread-4 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_.2b12d505ec: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_.2b12d505ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as (
    select * from "nerd_facts"."public"."stg_swapi_starships" where 1=1
)

select
    *
from meet_condition

where not(crew::numeric <= passengers::numeric + 50 OR passengers IS NULL OR crew IS NULL OR crew = 'unknown')


      
    ) dbt_internal_test
[0m09:31:55.408281 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "NULL"
LINE 17: where not(length > 0 OR IS NULL)
                                    ^

[0m09:31:55.408849 [debug] [Thread-1 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL.1915ec346c: ROLLBACK
[0m09:31:55.409278 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_starships" does not exist
LINE 10:     select * from "nerd_facts"."public"."stg_swapi_starships...
                           ^

[0m09:31:55.409838 [debug] [Thread-4 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_.2b12d505ec: ROLLBACK
[0m09:31:55.410340 [debug] [Thread-1 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL.1915ec346c: Close
[0m09:31:55.410940 [debug] [Thread-4 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_.2b12d505ec: Close
[0m09:31:55.415120 [debug] [Thread-4 (]: Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_ (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 10:     select * from "nerd_facts"."public"."stg_swapi_starships...
                             ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_b661521dc2474e27ea156eaf895ee132.sql
[0m09:31:55.415928 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL (models/staging/swapi/stg_swapi.yml)
  syntax error at or near "NULL"
  LINE 17: where not(length > 0 OR IS NULL)
                                      ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_be8f4b71c2f17ad203558d2f702bf73e.sql
[0m09:31:55.416609 [error] [Thread-4 (]: 9 of 36 ERROR dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_  [[31mERROR[0m in 0.09s]
[0m09:31:55.417198 [error] [Thread-1 (]: 10 of 36 ERROR dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL  [[31mERROR[0m in 0.09s]
[0m09:31:55.419049 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_.2b12d505ec
[0m09:31:55.419613 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL.1915ec346c
[0m09:31:55.421129 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_films_id.4e52f2f208
[0m09:31:55.421873 [info ] [Thread-1 (]: 14 of 36 START test not_null_stg_swapi_films_id ................................ [RUN]
[0m09:31:55.420672 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_.2b12d505ec' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_ (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 10:     select * from "nerd_facts"."public"."stg_swapi_starships...
                             ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_b661521dc2474e27ea156eaf895ee132.sql.
[0m09:31:55.420039 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696
[0m09:31:55.421450 [debug] [Thread-2 (]: SQL status: BEGIN in 0.033 seconds
[0m09:31:55.422412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL.1915ec346c, now test.nerd_facts_dbt.not_null_stg_swapi_films_id.4e52f2f208)
[0m09:31:55.423945 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_films_id.4e52f2f208
[0m09:31:55.422905 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL.1915ec346c' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL (models/staging/swapi/stg_swapi.yml)
  syntax error at or near "NULL"
  LINE 17: where not(length > 0 OR IS NULL)
                                      ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_be8f4b71c2f17ad203558d2f702bf73e.sql.
[0m09:31:55.423570 [debug] [Thread-2 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL.ec823ef959"
[0m09:31:55.420326 [debug] [Thread-3 (]: SQL status: BEGIN in 0.034 seconds
[0m09:31:55.423277 [info ] [Thread-4 (]: 13 of 36 START test not_null_stg_swapi_films_episode_id ........................ [RUN]
[0m09:31:55.431903 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_.2b12d505ec, now test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696)
[0m09:31:55.431077 [debug] [Thread-2 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL.ec823ef959: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL.ec823ef959"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as (
    select * from "nerd_facts"."public"."stg_swapi_starships" where 1=1
)

select
    *
from meet_condition

where not(max_atmosphering_speed >= 0 OR IS NULL)


      
    ) dbt_internal_test
[0m09:31:55.430432 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_films_id.4e52f2f208"
[0m09:31:55.432935 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_films_id.4e52f2f208
[0m09:31:55.432227 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696
[0m09:31:55.431503 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL.176b315457"
[0m09:31:55.439684 [debug] [Thread-3 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL.176b315457: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL.176b315457"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as (
    select * from "nerd_facts"."public"."stg_swapi_starships" where 1=1
)

select
    *
from meet_condition

where not(passengers >= 0 OR IS NULL)


      
    ) dbt_internal_test
[0m09:31:55.435126 [debug] [Thread-1 (]: Writing runtime sql for node "test.nerd_facts_dbt.not_null_stg_swapi_films_id.4e52f2f208"
[0m09:31:55.439201 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696"
[0m09:31:55.440476 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_films_id.4e52f2f208"
[0m09:31:55.440898 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "NULL"
LINE 17: where not(passengers >= 0 OR IS NULL)
                                         ^

[0m09:31:55.441806 [debug] [Thread-3 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL.176b315457: ROLLBACK
[0m09:31:55.441344 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_films_id.4e52f2f208: BEGIN
[0m09:31:55.442552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:55.442125 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696
[0m09:31:55.435487 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "NULL"
LINE 17: where not(max_atmosphering_speed >= 0 OR IS NULL)
                                                     ^

[0m09:31:55.443015 [debug] [Thread-3 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL.176b315457: Close
[0m09:31:55.454610 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL (models/staging/swapi/stg_swapi.yml)
  syntax error at or near "NULL"
  LINE 17: where not(passengers >= 0 OR IS NULL)
                                           ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_af273654177cfdc91478abd436a54b83.sql
[0m09:31:55.450835 [debug] [Thread-2 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL.ec823ef959: ROLLBACK
[0m09:31:55.455394 [error] [Thread-3 (]: 12 of 36 ERROR dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL  [[31mERROR[0m in 0.11s]
[0m09:31:55.456759 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL.176b315457
[0m09:31:55.456098 [debug] [Thread-2 (]: On test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL.ec823ef959: Close
[0m09:31:55.457279 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74
[0m09:31:55.457886 [info ] [Thread-3 (]: 15 of 36 START test not_null_stg_swapi_films_release_date ...................... [RUN]
[0m09:31:55.458598 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL.176b315457, now test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74)
[0m09:31:55.459103 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74
[0m09:31:55.450347 [debug] [Thread-4 (]: Writing runtime sql for node "test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696"
[0m09:31:55.466035 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74"
[0m09:31:55.466842 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL (models/staging/swapi/stg_swapi.yml)
  syntax error at or near "NULL"
  LINE 17: where not(max_atmosphering_speed >= 0 OR IS NULL)
                                                       ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_f96fcbd14ddc641df073db37ee15bc56.sql
[0m09:31:55.467303 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL.176b315457' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL (models/staging/swapi/stg_swapi.yml)
  syntax error at or near "NULL"
  LINE 17: where not(passengers >= 0 OR IS NULL)
                                           ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_af273654177cfdc91478abd436a54b83.sql.
[0m09:31:55.467915 [debug] [Thread-4 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696"
[0m09:31:55.469730 [debug] [Thread-4 (]: On test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696: BEGIN
[0m09:31:55.470255 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:31:55.468608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m09:31:55.469054 [error] [Thread-2 (]: 11 of 36 ERROR dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL  [[31mERROR[0m in 0.13s]
[0m09:31:55.473013 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL.ec823ef959
[0m09:31:55.473578 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_films_title.4f45458548
[0m09:31:55.474105 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL.ec823ef959' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL (models/staging/swapi/stg_swapi.yml)
  syntax error at or near "NULL"
  LINE 17: where not(max_atmosphering_speed >= 0 OR IS NULL)
                                                       ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_f96fcbd14ddc641df073db37ee15bc56.sql.
[0m09:31:55.474558 [info ] [Thread-2 (]: 16 of 36 START test not_null_stg_swapi_films_title ............................. [RUN]
[0m09:31:55.475350 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL.ec823ef959, now test.nerd_facts_dbt.not_null_stg_swapi_films_title.4f45458548)
[0m09:31:55.475787 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_films_title.4f45458548
[0m09:31:55.481686 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_films_title.4f45458548"
[0m09:31:55.482377 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_films_title.4f45458548
[0m09:31:55.471826 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_films_id.4e52f2f208"
[0m09:31:55.487580 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_films_id.4e52f2f208: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.not_null_stg_swapi_films_id.4e52f2f208"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "nerd_facts"."public"."stg_swapi_films"
where id is null



      
    ) dbt_internal_test
[0m09:31:55.470656 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74
[0m09:31:55.491173 [debug] [Thread-3 (]: Writing runtime sql for node "test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74"
[0m09:31:55.491541 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_films" does not exist
LINE 14: from "nerd_facts"."public"."stg_swapi_films"
              ^

[0m09:31:55.492124 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_films_id.4e52f2f208: ROLLBACK
[0m09:31:55.493040 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74"
[0m09:31:55.492481 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m09:31:55.487027 [debug] [Thread-2 (]: Writing runtime sql for node "test.nerd_facts_dbt.not_null_stg_swapi_films_title.4f45458548"
[0m09:31:55.494789 [debug] [Thread-2 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_films_title.4f45458548"
[0m09:31:55.493798 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_films_id.4e52f2f208: Close
[0m09:31:55.496319 [debug] [Thread-1 (]: Database Error in test not_null_stg_swapi_films_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_films" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_films"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_films_id.sql
[0m09:31:55.496939 [error] [Thread-1 (]: 14 of 36 ERROR not_null_stg_swapi_films_id ..................................... [[31mERROR[0m in 0.07s]
[0m09:31:55.497697 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_films_id.4e52f2f208
[0m09:31:55.493383 [debug] [Thread-3 (]: On test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74: BEGIN
[0m09:31:55.498543 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.not_null_stg_swapi_films_id.4e52f2f208' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_swapi_films_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_films" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_films"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_films_id.sql.
[0m09:31:55.498913 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:31:55.498139 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_people_id.7a1b515eed
[0m09:31:55.499875 [info ] [Thread-1 (]: 17 of 36 START test not_null_stg_swapi_people_id ............................... [RUN]
[0m09:31:55.500538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_films_id.4e52f2f208, now test.nerd_facts_dbt.not_null_stg_swapi_people_id.7a1b515eed)
[0m09:31:55.500986 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_people_id.7a1b515eed
[0m09:31:55.506850 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_people_id.7a1b515eed"
[0m09:31:55.507583 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_people_id.7a1b515eed
[0m09:31:55.495133 [debug] [Thread-2 (]: On test.nerd_facts_dbt.not_null_stg_swapi_films_title.4f45458548: BEGIN
[0m09:31:55.511643 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:31:55.494254 [debug] [Thread-4 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696"
[0m09:31:55.512602 [debug] [Thread-4 (]: On test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select episode_id
from "nerd_facts"."public"."stg_swapi_films"
where episode_id is null



      
    ) dbt_internal_test
[0m09:31:55.513747 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_films" does not exist
LINE 14: from "nerd_facts"."public"."stg_swapi_films"
              ^

[0m09:31:55.514199 [debug] [Thread-4 (]: On test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696: ROLLBACK
[0m09:31:55.515302 [debug] [Thread-4 (]: On test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696: Close
[0m09:31:55.516576 [debug] [Thread-4 (]: Database Error in test not_null_stg_swapi_films_episode_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_films" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_films"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_films_episode_id.sql
[0m09:31:55.517182 [error] [Thread-4 (]: 13 of 36 ERROR not_null_stg_swapi_films_episode_id ............................. [[31mERROR[0m in 0.09s]
[0m09:31:55.518168 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696
[0m09:31:55.518658 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f
[0m09:31:55.519230 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_swapi_films_episode_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_films" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_films"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_films_episode_id.sql.
[0m09:31:55.519691 [info ] [Thread-4 (]: 18 of 36 START test not_null_stg_swapi_people_name ............................. [RUN]
[0m09:31:55.511168 [debug] [Thread-1 (]: Writing runtime sql for node "test.nerd_facts_dbt.not_null_stg_swapi_people_id.7a1b515eed"
[0m09:31:55.520474 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_films_episode_id.bc98d1b696, now test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f)
[0m09:31:55.531507 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f
[0m09:31:55.522173 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_people_id.7a1b515eed"
[0m09:31:55.536214 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f"
[0m09:31:55.536954 [debug] [Thread-3 (]: SQL status: BEGIN in 0.038 seconds
[0m09:31:55.538248 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74"
[0m09:31:55.537791 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_people_id.7a1b515eed: BEGIN
[0m09:31:55.538592 [debug] [Thread-3 (]: On test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from "nerd_facts"."public"."stg_swapi_films"
where release_date is null



      
    ) dbt_internal_test
[0m09:31:55.537452 [debug] [Thread-2 (]: SQL status: BEGIN in 0.026 seconds
[0m09:31:55.539063 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f
[0m09:31:55.539391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:55.539847 [debug] [Thread-2 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_films_title.4f45458548"
[0m09:31:55.540245 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_films" does not exist
LINE 14: from "nerd_facts"."public"."stg_swapi_films"
              ^

[0m09:31:55.544849 [debug] [Thread-3 (]: On test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74: ROLLBACK
[0m09:31:55.544360 [debug] [Thread-2 (]: On test.nerd_facts_dbt.not_null_stg_swapi_films_title.4f45458548: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.not_null_stg_swapi_films_title.4f45458548"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select title
from "nerd_facts"."public"."stg_swapi_films"
where title is null



      
    ) dbt_internal_test
[0m09:31:55.543687 [debug] [Thread-4 (]: Writing runtime sql for node "test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f"
[0m09:31:55.546821 [debug] [Thread-3 (]: On test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74: Close
[0m09:31:55.549165 [debug] [Thread-3 (]: Database Error in test not_null_stg_swapi_films_release_date (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_films" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_films"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_films_release_date.sql
[0m09:31:55.549835 [error] [Thread-3 (]: 15 of 36 ERROR not_null_stg_swapi_films_release_date ........................... [[31mERROR[0m in 0.09s]
[0m09:31:55.550572 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74
[0m09:31:55.552904 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_planets_id.1980954ad2
[0m09:31:55.547696 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_films" does not exist
LINE 14: from "nerd_facts"."public"."stg_swapi_films"
              ^

[0m09:31:55.553532 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_swapi_films_release_date (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_films" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_films"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_films_release_date.sql.
[0m09:31:55.554518 [debug] [Thread-2 (]: On test.nerd_facts_dbt.not_null_stg_swapi_films_title.4f45458548: ROLLBACK
[0m09:31:55.554036 [info ] [Thread-3 (]: 19 of 36 START test not_null_stg_swapi_planets_id .............................. [RUN]
[0m09:31:55.555465 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_films_release_date.6599c8fb74, now test.nerd_facts_dbt.not_null_stg_swapi_planets_id.1980954ad2)
[0m09:31:55.555927 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_planets_id.1980954ad2
[0m09:31:55.566510 [debug] [Thread-2 (]: On test.nerd_facts_dbt.not_null_stg_swapi_films_title.4f45458548: Close
[0m09:31:55.567532 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_planets_id.1980954ad2"
[0m09:31:55.568259 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_planets_id.1980954ad2
[0m09:31:55.572604 [debug] [Thread-3 (]: Writing runtime sql for node "test.nerd_facts_dbt.not_null_stg_swapi_planets_id.1980954ad2"
[0m09:31:55.573445 [debug] [Thread-4 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f"
[0m09:31:55.575456 [debug] [Thread-4 (]: On test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f: BEGIN
[0m09:31:55.575893 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:31:55.574567 [debug] [Thread-2 (]: Database Error in test not_null_stg_swapi_films_title (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_films" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_films"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_films_title.sql
[0m09:31:55.577942 [error] [Thread-2 (]: 16 of 36 ERROR not_null_stg_swapi_films_title .................................. [[31mERROR[0m in 0.10s]
[0m09:31:55.578694 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_films_title.4f45458548
[0m09:31:55.579184 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78
[0m09:31:55.579696 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.not_null_stg_swapi_films_title.4f45458548' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_swapi_films_title (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_films" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_films"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_films_title.sql.
[0m09:31:55.584318 [info ] [Thread-2 (]: 20 of 36 START test not_null_stg_swapi_planets_name ............................ [RUN]
[0m09:31:55.594190 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_films_title.4f45458548, now test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78)
[0m09:31:55.594576 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78
[0m09:31:55.598783 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78"
[0m09:31:55.599669 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m09:31:55.600182 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_planets_id.1980954ad2"
[0m09:31:55.601660 [debug] [Thread-3 (]: On test.nerd_facts_dbt.not_null_stg_swapi_planets_id.1980954ad2: BEGIN
[0m09:31:55.601923 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:31:55.601306 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_people_id.7a1b515eed"
[0m09:31:55.602363 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_people_id.7a1b515eed: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.not_null_stg_swapi_people_id.7a1b515eed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "nerd_facts"."public"."stg_swapi_people"
where id is null



      
    ) dbt_internal_test
[0m09:31:55.601026 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m09:31:55.603153 [debug] [Thread-4 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f"
[0m09:31:55.604067 [debug] [Thread-4 (]: On test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "nerd_facts"."public"."stg_swapi_people"
where name is null



      
    ) dbt_internal_test
[0m09:31:55.600642 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78
[0m09:31:55.606502 [debug] [Thread-2 (]: Writing runtime sql for node "test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78"
[0m09:31:55.607096 [debug] [Thread-2 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78"
[0m09:31:55.607452 [debug] [Thread-2 (]: On test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78: BEGIN
[0m09:31:55.607745 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:31:55.608757 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_people" does not exist
LINE 14: from "nerd_facts"."public"."stg_swapi_people"
              ^

[0m09:31:55.609068 [debug] [Thread-4 (]: On test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f: ROLLBACK
[0m09:31:55.603737 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_people" does not exist
LINE 14: from "nerd_facts"."public"."stg_swapi_people"
              ^

[0m09:31:55.609399 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_people_id.7a1b515eed: ROLLBACK
[0m09:31:55.609781 [debug] [Thread-4 (]: On test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f: Close
[0m09:31:55.610581 [debug] [Thread-4 (]: Database Error in test not_null_stg_swapi_people_name (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_people" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_people"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_people_name.sql
[0m09:31:55.611514 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_people_id.7a1b515eed: Close
[0m09:31:55.614259 [debug] [Thread-1 (]: Database Error in test not_null_stg_swapi_people_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_people" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_people"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_people_id.sql
[0m09:31:55.611010 [error] [Thread-4 (]: 18 of 36 ERROR not_null_stg_swapi_people_name .................................. [[31mERROR[0m in 0.09s]
[0m09:31:55.615367 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f
[0m09:31:55.615686 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_species_id.09ea9d15a8
[0m09:31:55.616516 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_swapi_people_name (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_people" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_people"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_people_name.sql.
[0m09:31:55.614796 [error] [Thread-1 (]: 17 of 36 ERROR not_null_stg_swapi_people_id .................................... [[31mERROR[0m in 0.11s]
[0m09:31:55.617509 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_people_id.7a1b515eed
[0m09:31:55.617820 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221
[0m09:31:55.618140 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.not_null_stg_swapi_people_id.7a1b515eed' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_swapi_people_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_people" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_people"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_people_id.sql.
[0m09:31:55.617012 [info ] [Thread-4 (]: 21 of 36 START test not_null_stg_swapi_species_id .............................. [RUN]
[0m09:31:55.619303 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_people_name.f39acc5c3f, now test.nerd_facts_dbt.not_null_stg_swapi_species_id.09ea9d15a8)
[0m09:31:55.619644 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_species_id.09ea9d15a8
[0m09:31:55.624377 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_species_id.09ea9d15a8"
[0m09:31:55.618531 [info ] [Thread-1 (]: 22 of 36 START test not_null_stg_swapi_species_name ............................ [RUN]
[0m09:31:55.626278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_people_id.7a1b515eed, now test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221)
[0m09:31:55.626592 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221
[0m09:31:55.625737 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m09:31:55.631081 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_planets_id.1980954ad2"
[0m09:31:55.631373 [debug] [Thread-3 (]: On test.nerd_facts_dbt.not_null_stg_swapi_planets_id.1980954ad2: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.not_null_stg_swapi_planets_id.1980954ad2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "nerd_facts"."public"."stg_swapi_planets"
where id is null



      
    ) dbt_internal_test
[0m09:31:55.632024 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_planets" does not exist
LINE 14: from "nerd_facts"."public"."stg_swapi_planets"
              ^

[0m09:31:55.632351 [debug] [Thread-3 (]: On test.nerd_facts_dbt.not_null_stg_swapi_planets_id.1980954ad2: ROLLBACK
[0m09:31:55.632790 [debug] [Thread-3 (]: On test.nerd_facts_dbt.not_null_stg_swapi_planets_id.1980954ad2: Close
[0m09:31:55.633682 [debug] [Thread-2 (]: SQL status: BEGIN in 0.026 seconds
[0m09:31:55.634007 [debug] [Thread-2 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78"
[0m09:31:55.634298 [debug] [Thread-2 (]: On test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "nerd_facts"."public"."stg_swapi_planets"
where name is null



      
    ) dbt_internal_test
[0m09:31:55.630687 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221"
[0m09:31:55.634952 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_planets" does not exist
LINE 14: from "nerd_facts"."public"."stg_swapi_planets"
              ^

[0m09:31:55.635722 [debug] [Thread-3 (]: Database Error in test not_null_stg_swapi_planets_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_planets" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_planets"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_planets_id.sql
[0m09:31:55.636497 [debug] [Thread-2 (]: On test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78: ROLLBACK
[0m09:31:55.636964 [error] [Thread-3 (]: 19 of 36 ERROR not_null_stg_swapi_planets_id ................................... [[31mERROR[0m in 0.08s]
[0m09:31:55.637609 [debug] [Thread-2 (]: On test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78: Close
[0m09:31:55.638061 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_planets_id.1980954ad2
[0m09:31:55.638941 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_starships_id.7ec0941917
[0m09:31:55.639284 [info ] [Thread-3 (]: 23 of 36 START test not_null_stg_swapi_starships_id ............................ [RUN]
[0m09:31:55.639811 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_planets_id.1980954ad2, now test.nerd_facts_dbt.not_null_stg_swapi_starships_id.7ec0941917)
[0m09:31:55.640169 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_starships_id.7ec0941917
[0m09:31:55.640505 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221
[0m09:31:55.638361 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_species_id.09ea9d15a8
[0m09:31:55.648190 [debug] [Thread-1 (]: Writing runtime sql for node "test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221"
[0m09:31:55.645080 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.not_null_stg_swapi_planets_id.1980954ad2' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_swapi_planets_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_planets" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_planets"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_planets_id.sql.
[0m09:31:55.645811 [debug] [Thread-2 (]: Database Error in test not_null_stg_swapi_planets_name (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_planets" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_planets"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_planets_name.sql
[0m09:31:55.644270 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_starships_id.7ec0941917"
[0m09:31:55.650546 [debug] [Thread-4 (]: Writing runtime sql for node "test.nerd_facts_dbt.not_null_stg_swapi_species_id.09ea9d15a8"
[0m09:31:55.651740 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_starships_id.7ec0941917
[0m09:31:55.654241 [debug] [Thread-3 (]: Writing runtime sql for node "test.nerd_facts_dbt.not_null_stg_swapi_starships_id.7ec0941917"
[0m09:31:55.654751 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_starships_id.7ec0941917"
[0m09:31:55.655065 [debug] [Thread-3 (]: On test.nerd_facts_dbt.not_null_stg_swapi_starships_id.7ec0941917: BEGIN
[0m09:31:55.655325 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:31:55.655830 [debug] [Thread-4 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_species_id.09ea9d15a8"
[0m09:31:55.656701 [debug] [Thread-4 (]: On test.nerd_facts_dbt.not_null_stg_swapi_species_id.09ea9d15a8: BEGIN
[0m09:31:55.657285 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:31:55.658480 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221"
[0m09:31:55.658911 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221: BEGIN
[0m09:31:55.659229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:55.651306 [error] [Thread-2 (]: 20 of 36 ERROR not_null_stg_swapi_planets_name ................................. [[31mERROR[0m in 0.06s]
[0m09:31:55.661393 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78
[0m09:31:55.661840 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_starships_max_atmosphering_speed.9fc07f34cf
[0m09:31:55.662315 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_swapi_planets_name (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_planets" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_planets"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_planets_name.sql.
[0m09:31:55.662666 [info ] [Thread-2 (]: 24 of 36 START test not_null_stg_swapi_starships_max_atmosphering_speed ........ [RUN]
[0m09:31:55.666076 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_planets_name.290277cf78, now test.nerd_facts_dbt.not_null_stg_swapi_starships_max_atmosphering_speed.9fc07f34cf)
[0m09:31:55.667266 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_starships_max_atmosphering_speed.9fc07f34cf
[0m09:31:55.724366 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_starships_max_atmosphering_speed.9fc07f34cf"
[0m09:31:55.725547 [debug] [Thread-3 (]: SQL status: BEGIN in 0.070 seconds
[0m09:31:55.725866 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_starships_id.7ec0941917"
[0m09:31:55.726148 [debug] [Thread-3 (]: On test.nerd_facts_dbt.not_null_stg_swapi_starships_id.7ec0941917: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.not_null_stg_swapi_starships_id.7ec0941917"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "nerd_facts"."public"."stg_swapi_starships"
where id is null



      
    ) dbt_internal_test
[0m09:31:55.724921 [debug] [Thread-4 (]: SQL status: BEGIN in 0.068 seconds
[0m09:31:55.726522 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_starships_max_atmosphering_speed.9fc07f34cf
[0m09:31:55.726840 [debug] [Thread-4 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_species_id.09ea9d15a8"
[0m09:31:55.729865 [debug] [Thread-4 (]: On test.nerd_facts_dbt.not_null_stg_swapi_species_id.09ea9d15a8: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.not_null_stg_swapi_species_id.09ea9d15a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "nerd_facts"."public"."stg_swapi_species"
where id is null



      
    ) dbt_internal_test
[0m09:31:55.729478 [debug] [Thread-2 (]: Writing runtime sql for node "test.nerd_facts_dbt.not_null_stg_swapi_starships_max_atmosphering_speed.9fc07f34cf"
[0m09:31:55.727143 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_starships" does not exist
LINE 14: from "nerd_facts"."public"."stg_swapi_starships"
              ^

[0m09:31:55.730550 [debug] [Thread-3 (]: On test.nerd_facts_dbt.not_null_stg_swapi_starships_id.7ec0941917: ROLLBACK
[0m09:31:55.731030 [debug] [Thread-3 (]: On test.nerd_facts_dbt.not_null_stg_swapi_starships_id.7ec0941917: Close
[0m09:31:55.731441 [debug] [Thread-2 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_starships_max_atmosphering_speed.9fc07f34cf"
[0m09:31:55.731763 [debug] [Thread-2 (]: On test.nerd_facts_dbt.not_null_stg_swapi_starships_max_atmosphering_speed.9fc07f34cf: BEGIN
[0m09:31:55.732055 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:31:55.733233 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_species" does not exist
LINE 14: from "nerd_facts"."public"."stg_swapi_species"
              ^

[0m09:31:55.733628 [debug] [Thread-4 (]: On test.nerd_facts_dbt.not_null_stg_swapi_species_id.09ea9d15a8: ROLLBACK
[0m09:31:55.734530 [debug] [Thread-3 (]: Database Error in test not_null_stg_swapi_starships_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_starships"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_starships_id.sql
[0m09:31:55.735372 [debug] [Thread-4 (]: On test.nerd_facts_dbt.not_null_stg_swapi_species_id.09ea9d15a8: Close
[0m09:31:55.737537 [debug] [Thread-1 (]: SQL status: BEGIN in 0.078 seconds
[0m09:31:55.737914 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221"
[0m09:31:55.738201 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "nerd_facts"."public"."stg_swapi_species"
where name is null



      
    ) dbt_internal_test
[0m09:31:55.739067 [debug] [Thread-4 (]: Database Error in test not_null_stg_swapi_species_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_species" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_species"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_species_id.sql
[0m09:31:55.734967 [error] [Thread-3 (]: 23 of 36 ERROR not_null_stg_swapi_starships_id ................................. [[31mERROR[0m in 0.10s]
[0m09:31:55.740029 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_starships_id.7ec0941917
[0m09:31:55.740335 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5
[0m09:31:55.740714 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.not_null_stg_swapi_starships_id.7ec0941917' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_swapi_starships_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_starships"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_starships_id.sql.
[0m09:31:55.741407 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_species" does not exist
LINE 14: from "nerd_facts"."public"."stg_swapi_species"
              ^

[0m09:31:55.742009 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221: ROLLBACK
[0m09:31:55.739513 [error] [Thread-4 (]: 21 of 36 ERROR not_null_stg_swapi_species_id ................................... [[31mERROR[0m in 0.12s]
[0m09:31:55.742501 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_species_id.09ea9d15a8
[0m09:31:55.742803 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_vehicles_id.fb013dcb6d
[0m09:31:55.743186 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.not_null_stg_swapi_species_id.09ea9d15a8' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_swapi_species_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_species" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_species"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_species_id.sql.
[0m09:31:55.741090 [info ] [Thread-3 (]: 25 of 36 START test not_null_stg_swapi_starships_name .......................... [RUN]
[0m09:31:55.744515 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_starships_id.7ec0941917, now test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5)
[0m09:31:55.744802 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5
[0m09:31:55.744038 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221: Close
[0m09:31:55.749921 [debug] [Thread-1 (]: Database Error in test not_null_stg_swapi_species_name (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_species" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_species"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_species_name.sql
[0m09:31:55.743610 [info ] [Thread-4 (]: 26 of 36 START test not_null_stg_swapi_vehicles_id ............................. [RUN]
[0m09:31:55.750794 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_species_id.09ea9d15a8, now test.nerd_facts_dbt.not_null_stg_swapi_vehicles_id.fb013dcb6d)
[0m09:31:55.751194 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_vehicles_id.fb013dcb6d
[0m09:31:55.755346 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_vehicles_id.fb013dcb6d"
[0m09:31:55.751592 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m09:31:55.748764 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5"
[0m09:31:55.750397 [error] [Thread-1 (]: 22 of 36 ERROR not_null_stg_swapi_species_name ................................. [[31mERROR[0m in 0.12s]
[0m09:31:55.756230 [debug] [Thread-2 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_starships_max_atmosphering_speed.9fc07f34cf"
[0m09:31:55.756559 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_vehicles_id.fb013dcb6d
[0m09:31:55.757090 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221
[0m09:31:55.757681 [debug] [Thread-2 (]: On test.nerd_facts_dbt.not_null_stg_swapi_starships_max_atmosphering_speed.9fc07f34cf: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.not_null_stg_swapi_starships_max_atmosphering_speed.9fc07f34cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select max_atmosphering_speed
from "nerd_facts"."public"."stg_swapi_starships"
where max_atmosphering_speed is null



      
    ) dbt_internal_test
[0m09:31:55.757983 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5
[0m09:31:55.763427 [debug] [Thread-3 (]: Writing runtime sql for node "test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5"
[0m09:31:55.760746 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7
[0m09:31:55.761116 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_swapi_species_name (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_species" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_species"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_species_name.sql.
[0m09:31:55.760341 [debug] [Thread-4 (]: Writing runtime sql for node "test.nerd_facts_dbt.not_null_stg_swapi_vehicles_id.fb013dcb6d"
[0m09:31:55.763916 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_starships" does not exist
LINE 14: from "nerd_facts"."public"."stg_swapi_starships"
              ^

[0m09:31:55.764290 [info ] [Thread-1 (]: 27 of 36 START test not_null_stg_swapi_vehicles_name ........................... [RUN]
[0m09:31:55.766167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_species_name.72dd894221, now test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7)
[0m09:31:55.765498 [debug] [Thread-4 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_vehicles_id.fb013dcb6d"
[0m09:31:55.766453 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7
[0m09:31:55.764873 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5"
[0m09:31:55.765820 [debug] [Thread-2 (]: On test.nerd_facts_dbt.not_null_stg_swapi_starships_max_atmosphering_speed.9fc07f34cf: ROLLBACK
[0m09:31:55.766792 [debug] [Thread-4 (]: On test.nerd_facts_dbt.not_null_stg_swapi_vehicles_id.fb013dcb6d: BEGIN
[0m09:31:55.770954 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7"
[0m09:31:55.771479 [debug] [Thread-3 (]: On test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5: BEGIN
[0m09:31:55.772091 [debug] [Thread-2 (]: On test.nerd_facts_dbt.not_null_stg_swapi_starships_max_atmosphering_speed.9fc07f34cf: Close
[0m09:31:55.773969 [debug] [Thread-2 (]: Database Error in test not_null_stg_swapi_starships_max_atmosphering_speed (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_starships"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_starships_max_atmosphering_speed.sql
[0m09:31:55.772857 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7
[0m09:31:55.773125 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:31:55.772395 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:31:55.776790 [debug] [Thread-1 (]: Writing runtime sql for node "test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7"
[0m09:31:55.774409 [error] [Thread-2 (]: 24 of 36 ERROR not_null_stg_swapi_starships_max_atmosphering_speed ............. [[31mERROR[0m in 0.11s]
[0m09:31:55.782228 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_starships_max_atmosphering_speed.9fc07f34cf
[0m09:31:55.782583 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9
[0m09:31:55.782985 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.not_null_stg_swapi_starships_max_atmosphering_speed.9fc07f34cf' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_swapi_starships_max_atmosphering_speed (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_starships"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_starships_max_atmosphering_speed.sql.
[0m09:31:55.777981 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7"
[0m09:31:55.787196 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7: BEGIN
[0m09:31:55.787458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:55.785614 [info ] [Thread-2 (]: 28 of 36 START test source_not_null_pokeapi_moves_id ........................... [RUN]
[0m09:31:55.788193 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_starships_max_atmosphering_speed.9fc07f34cf, now test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9)
[0m09:31:55.788515 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9
[0m09:31:55.792111 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9"
[0m09:31:55.792973 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m09:31:55.799623 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5"
[0m09:31:55.800044 [debug] [Thread-3 (]: On test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "nerd_facts"."public"."stg_swapi_starships"
where name is null



      
    ) dbt_internal_test
[0m09:31:55.800719 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_starships" does not exist
LINE 14: from "nerd_facts"."public"."stg_swapi_starships"
              ^

[0m09:31:55.801064 [debug] [Thread-3 (]: On test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5: ROLLBACK
[0m09:31:55.801587 [debug] [Thread-3 (]: On test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5: Close
[0m09:31:55.804561 [debug] [Thread-3 (]: Database Error in test not_null_stg_swapi_starships_name (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_starships"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_starships_name.sql
[0m09:31:55.806093 [error] [Thread-3 (]: 25 of 36 ERROR not_null_stg_swapi_starships_name ............................... [[31mERROR[0m in 0.06s]
[0m09:31:55.805655 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9
[0m09:31:55.806963 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5
[0m09:31:55.814648 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3
[0m09:31:55.815254 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_swapi_starships_name (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_starships"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_starships_name.sql.
[0m09:31:55.815609 [debug] [Thread-4 (]: SQL status: BEGIN in 0.043 seconds
[0m09:31:55.816486 [debug] [Thread-4 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_vehicles_id.fb013dcb6d"
[0m09:31:55.816866 [debug] [Thread-4 (]: On test.nerd_facts_dbt.not_null_stg_swapi_vehicles_id.fb013dcb6d: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.not_null_stg_swapi_vehicles_id.fb013dcb6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "nerd_facts"."public"."stg_swapi_vehicles"
where id is null



      
    ) dbt_internal_test
[0m09:31:55.816020 [info ] [Thread-3 (]: 29 of 36 START test source_not_null_pokeapi_moves_name ......................... [RUN]
[0m09:31:55.810535 [debug] [Thread-2 (]: Writing runtime sql for node "test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9"
[0m09:31:55.817753 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_starships_name.0962a611d5, now test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3)
[0m09:31:55.818823 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3
[0m09:31:55.818224 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_vehicles" does not exist
LINE 14: from "nerd_facts"."public"."stg_swapi_vehicles"
              ^

[0m09:31:55.824530 [debug] [Thread-4 (]: On test.nerd_facts_dbt.not_null_stg_swapi_vehicles_id.fb013dcb6d: ROLLBACK
[0m09:31:55.819225 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m09:31:55.824062 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3"
[0m09:31:55.825074 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7"
[0m09:31:55.819580 [debug] [Thread-2 (]: Using postgres connection "test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9"
[0m09:31:55.825545 [debug] [Thread-4 (]: On test.nerd_facts_dbt.not_null_stg_swapi_vehicles_id.fb013dcb6d: Close
[0m09:31:55.827021 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3
[0m09:31:55.826423 [debug] [Thread-2 (]: On test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9: BEGIN
[0m09:31:55.826026 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "nerd_facts"."public"."stg_swapi_vehicles"
where name is null



      
    ) dbt_internal_test
[0m09:31:55.831334 [debug] [Thread-3 (]: Writing runtime sql for node "test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3"
[0m09:31:55.832052 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:31:55.832675 [debug] [Thread-4 (]: Database Error in test not_null_stg_swapi_vehicles_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_vehicles" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_vehicles"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_vehicles_id.sql
[0m09:31:55.833481 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_vehicles" does not exist
LINE 14: from "nerd_facts"."public"."stg_swapi_vehicles"
              ^

[0m09:31:55.836326 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7: ROLLBACK
[0m09:31:55.837056 [debug] [Thread-1 (]: On test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7: Close
[0m09:31:55.834269 [error] [Thread-4 (]: 26 of 36 ERROR not_null_stg_swapi_vehicles_id .................................. [[31mERROR[0m in 0.08s]
[0m09:31:55.835582 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3"
[0m09:31:55.846023 [debug] [Thread-3 (]: On test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3: BEGIN
[0m09:31:55.846457 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:31:55.840905 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_vehicles_id.fb013dcb6d
[0m09:31:55.848209 [debug] [Thread-1 (]: Database Error in test not_null_stg_swapi_vehicles_name (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_vehicles" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_vehicles"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_vehicles_name.sql
[0m09:31:55.851701 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.not_null_stg_swapi_vehicles_id.fb013dcb6d' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_swapi_vehicles_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_vehicles" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_vehicles"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_vehicles_id.sql.
[0m09:31:55.852369 [error] [Thread-1 (]: 27 of 36 ERROR not_null_stg_swapi_vehicles_name ................................ [[31mERROR[0m in 0.09s]
[0m09:31:55.853378 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7
[0m09:31:55.853964 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.unique_stg_swapi_films_id.14c2b7f5e2
[0m09:31:55.851115 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11
[0m09:31:55.854495 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_swapi_vehicles_name (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_vehicles" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_vehicles"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_vehicles_name.sql.
[0m09:31:55.855044 [info ] [Thread-1 (]: 31 of 36 START test unique_stg_swapi_films_id .................................. [RUN]
[0m09:31:55.856522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_vehicles_name.f1ef2875b7, now test.nerd_facts_dbt.unique_stg_swapi_films_id.14c2b7f5e2)
[0m09:31:55.857017 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.unique_stg_swapi_films_id.14c2b7f5e2
[0m09:31:55.855547 [info ] [Thread-4 (]: 30 of 36 START test source_unique_pokeapi_moves_id ............................. [RUN]
[0m09:31:55.867101 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.not_null_stg_swapi_vehicles_id.fb013dcb6d, now test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11)
[0m09:31:55.867607 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11
[0m09:31:55.872201 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11"
[0m09:31:55.865907 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_swapi_films_id.14c2b7f5e2"
[0m09:31:55.872940 [debug] [Thread-2 (]: SQL status: BEGIN in 0.041 seconds
[0m09:31:55.873388 [debug] [Thread-3 (]: SQL status: BEGIN in 0.027 seconds
[0m09:31:55.873745 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11
[0m09:31:55.874264 [debug] [Thread-2 (]: Using postgres connection "test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9"
[0m09:31:55.874693 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.unique_stg_swapi_films_id.14c2b7f5e2
[0m09:31:55.880898 [debug] [Thread-1 (]: Writing runtime sql for node "test.nerd_facts_dbt.unique_stg_swapi_films_id.14c2b7f5e2"
[0m09:31:55.878175 [debug] [Thread-2 (]: On test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "pokemon_db"."public"."moves"
where id is null



      
    ) dbt_internal_test
[0m09:31:55.877765 [debug] [Thread-4 (]: Writing runtime sql for node "test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11"
[0m09:31:55.875066 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3"
[0m09:31:55.881791 [debug] [Thread-3 (]: On test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "pokemon_db"."public"."moves"
where name is null



      
    ) dbt_internal_test
[0m09:31:55.882151 [debug] [Thread-2 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "pokemon_db.public.moves"
LINE 14: from "pokemon_db"."public"."moves"
              ^

[0m09:31:55.882827 [debug] [Thread-2 (]: On test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9: ROLLBACK
[0m09:31:55.883311 [debug] [Thread-3 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "pokemon_db.public.moves"
LINE 14: from "pokemon_db"."public"."moves"
              ^

[0m09:31:55.883773 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.unique_stg_swapi_films_id.14c2b7f5e2"
[0m09:31:55.884142 [debug] [Thread-2 (]: On test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9: Close
[0m09:31:55.886357 [debug] [Thread-2 (]: Database Error in test source_not_null_pokeapi_moves_id (models/staging/pokeapi/pokeapi_sources.yml)
  cross-database references are not implemented: "pokemon_db.public.moves"
  LINE 14: from "pokemon_db"."public"."moves"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/pokeapi/pokeapi_sources.yml/source_not_null_pokeapi_moves_id.sql
[0m09:31:55.886983 [error] [Thread-2 (]: 28 of 36 ERROR source_not_null_pokeapi_moves_id ................................ [[31mERROR[0m in 0.10s]
[0m09:31:55.885141 [debug] [Thread-1 (]: On test.nerd_facts_dbt.unique_stg_swapi_films_id.14c2b7f5e2: BEGIN
[0m09:31:55.887721 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9
[0m09:31:55.888636 [debug] [Thread-2 (]: Began running node test.nerd_facts_dbt.unique_stg_swapi_people_id.61c011a764
[0m09:31:55.884846 [debug] [Thread-4 (]: Using postgres connection "test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11"
[0m09:31:55.889883 [debug] [Thread-4 (]: On test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11: BEGIN
[0m09:31:55.884424 [debug] [Thread-3 (]: On test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3: ROLLBACK
[0m09:31:55.889045 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_pokeapi_moves_id (models/staging/pokeapi/pokeapi_sources.yml)
  cross-database references are not implemented: "pokemon_db.public.moves"
  LINE 14: from "pokemon_db"."public"."moves"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/pokeapi/pokeapi_sources.yml/source_not_null_pokeapi_moves_id.sql.
[0m09:31:55.889409 [info ] [Thread-2 (]: 32 of 36 START test unique_stg_swapi_people_id ................................. [RUN]
[0m09:31:55.890898 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_pokeapi_moves_id.c4a229cda9, now test.nerd_facts_dbt.unique_stg_swapi_people_id.61c011a764)
[0m09:31:55.890221 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:31:55.891312 [debug] [Thread-2 (]: Began compiling node test.nerd_facts_dbt.unique_stg_swapi_people_id.61c011a764
[0m09:31:55.888222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:55.891785 [debug] [Thread-3 (]: On test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3: Close
[0m09:31:55.903641 [debug] [Thread-3 (]: Database Error in test source_not_null_pokeapi_moves_name (models/staging/pokeapi/pokeapi_sources.yml)
  cross-database references are not implemented: "pokemon_db.public.moves"
  LINE 14: from "pokemon_db"."public"."moves"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/pokeapi/pokeapi_sources.yml/source_not_null_pokeapi_moves_name.sql
[0m09:31:55.904325 [error] [Thread-3 (]: 29 of 36 ERROR source_not_null_pokeapi_moves_name .............................. [[31mERROR[0m in 0.09s]
[0m09:31:55.905086 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3
[0m09:31:55.905598 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.unique_stg_swapi_planets_id.6c040cab42
[0m09:31:55.906117 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_pokeapi_moves_name (models/staging/pokeapi/pokeapi_sources.yml)
  cross-database references are not implemented: "pokemon_db.public.moves"
  LINE 14: from "pokemon_db"."public"."moves"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/pokeapi/pokeapi_sources.yml/source_not_null_pokeapi_moves_name.sql.
[0m09:31:55.906599 [info ] [Thread-3 (]: 33 of 36 START test unique_stg_swapi_planets_id ................................ [RUN]
[0m09:31:55.907359 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_not_null_pokeapi_moves_name.5721c278f3, now test.nerd_facts_dbt.unique_stg_swapi_planets_id.6c040cab42)
[0m09:31:55.907773 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.unique_stg_swapi_planets_id.6c040cab42
[0m09:31:55.902052 [debug] [Thread-2 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_swapi_people_id.61c011a764"
[0m09:31:55.914303 [debug] [Thread-2 (]: Began executing node test.nerd_facts_dbt.unique_stg_swapi_people_id.61c011a764
[0m09:31:55.917822 [debug] [Thread-2 (]: Writing runtime sql for node "test.nerd_facts_dbt.unique_stg_swapi_people_id.61c011a764"
[0m09:31:55.918517 [debug] [Thread-2 (]: Using postgres connection "test.nerd_facts_dbt.unique_stg_swapi_people_id.61c011a764"
[0m09:31:55.918946 [debug] [Thread-2 (]: On test.nerd_facts_dbt.unique_stg_swapi_people_id.61c011a764: BEGIN
[0m09:31:55.919328 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:31:55.913579 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_swapi_planets_id.6c040cab42"
[0m09:31:55.921186 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.unique_stg_swapi_planets_id.6c040cab42
[0m09:31:55.924747 [debug] [Thread-3 (]: Writing runtime sql for node "test.nerd_facts_dbt.unique_stg_swapi_planets_id.6c040cab42"
[0m09:31:55.925387 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.unique_stg_swapi_planets_id.6c040cab42"
[0m09:31:55.925826 [debug] [Thread-3 (]: On test.nerd_facts_dbt.unique_stg_swapi_planets_id.6c040cab42: BEGIN
[0m09:31:55.926217 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:31:55.934543 [debug] [Thread-4 (]: SQL status: BEGIN in 0.044 seconds
[0m09:31:55.937861 [debug] [Thread-4 (]: Using postgres connection "test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11"
[0m09:31:55.938370 [debug] [Thread-4 (]: On test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "pokemon_db"."public"."moves"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:31:55.939206 [debug] [Thread-4 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "pokemon_db.public.moves"
LINE 15: from "pokemon_db"."public"."moves"
              ^

[0m09:31:55.939574 [debug] [Thread-4 (]: On test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11: ROLLBACK
[0m09:31:55.940568 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m09:31:55.941197 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.unique_stg_swapi_films_id.14c2b7f5e2"
[0m09:31:55.941556 [debug] [Thread-1 (]: On test.nerd_facts_dbt.unique_stg_swapi_films_id.14c2b7f5e2: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.unique_stg_swapi_films_id.14c2b7f5e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "nerd_facts"."public"."stg_swapi_films"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:31:55.940959 [debug] [Thread-4 (]: On test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11: Close
[0m09:31:55.942560 [debug] [Thread-4 (]: Database Error in test source_unique_pokeapi_moves_id (models/staging/pokeapi/pokeapi_sources.yml)
  cross-database references are not implemented: "pokemon_db.public.moves"
  LINE 15: from "pokemon_db"."public"."moves"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/pokeapi/pokeapi_sources.yml/source_unique_pokeapi_moves_id.sql
[0m09:31:55.943085 [error] [Thread-4 (]: 30 of 36 ERROR source_unique_pokeapi_moves_id .................................. [[31mERROR[0m in 0.08s]
[0m09:31:55.943608 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11
[0m09:31:55.943979 [debug] [Thread-4 (]: Began running node test.nerd_facts_dbt.unique_stg_swapi_species_id.d223d89b92
[0m09:31:55.944365 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11' to be skipped because of status 'error'.  Reason: Database Error in test source_unique_pokeapi_moves_id (models/staging/pokeapi/pokeapi_sources.yml)
  cross-database references are not implemented: "pokemon_db.public.moves"
  LINE 15: from "pokemon_db"."public"."moves"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/pokeapi/pokeapi_sources.yml/source_unique_pokeapi_moves_id.sql.
[0m09:31:55.944761 [info ] [Thread-4 (]: 34 of 36 START test unique_stg_swapi_species_id ................................ [RUN]
[0m09:31:55.948070 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.source_unique_pokeapi_moves_id.d93d417c11, now test.nerd_facts_dbt.unique_stg_swapi_species_id.d223d89b92)
[0m09:31:55.948410 [debug] [Thread-4 (]: Began compiling node test.nerd_facts_dbt.unique_stg_swapi_species_id.d223d89b92
[0m09:31:55.945199 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_films" does not exist
LINE 15: from "nerd_facts"."public"."stg_swapi_films"
              ^

[0m09:31:55.951942 [debug] [Thread-4 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_swapi_species_id.d223d89b92"
[0m09:31:55.953266 [debug] [Thread-1 (]: On test.nerd_facts_dbt.unique_stg_swapi_films_id.14c2b7f5e2: ROLLBACK
[0m09:31:55.953967 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m09:31:55.954351 [debug] [Thread-2 (]: SQL status: BEGIN in 0.035 seconds
[0m09:31:55.955232 [debug] [Thread-1 (]: On test.nerd_facts_dbt.unique_stg_swapi_films_id.14c2b7f5e2: Close
[0m09:31:55.956785 [debug] [Thread-1 (]: Database Error in test unique_stg_swapi_films_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_films" does not exist
  LINE 15: from "nerd_facts"."public"."stg_swapi_films"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/unique_stg_swapi_films_id.sql
[0m09:31:55.957201 [error] [Thread-1 (]: 31 of 36 ERROR unique_stg_swapi_films_id ....................................... [[31mERROR[0m in 0.10s]
[0m09:31:55.957793 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.unique_stg_swapi_films_id.14c2b7f5e2
[0m09:31:55.955940 [debug] [Thread-4 (]: Began executing node test.nerd_facts_dbt.unique_stg_swapi_species_id.d223d89b92
[0m09:31:55.958177 [debug] [Thread-1 (]: Began running node test.nerd_facts_dbt.unique_stg_swapi_starships_id.faa87ea4e7
[0m09:31:55.961743 [info ] [Thread-1 (]: 35 of 36 START test unique_stg_swapi_starships_id .............................. [RUN]
[0m09:31:55.962207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.unique_stg_swapi_films_id.14c2b7f5e2, now test.nerd_facts_dbt.unique_stg_swapi_starships_id.faa87ea4e7)
[0m09:31:55.958586 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.unique_stg_swapi_films_id.14c2b7f5e2' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_swapi_films_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_films" does not exist
  LINE 15: from "nerd_facts"."public"."stg_swapi_films"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/unique_stg_swapi_films_id.sql.
[0m09:31:55.961313 [debug] [Thread-4 (]: Writing runtime sql for node "test.nerd_facts_dbt.unique_stg_swapi_species_id.d223d89b92"
[0m09:31:55.962488 [debug] [Thread-1 (]: Began compiling node test.nerd_facts_dbt.unique_stg_swapi_starships_id.faa87ea4e7
[0m09:31:55.955591 [debug] [Thread-2 (]: Using postgres connection "test.nerd_facts_dbt.unique_stg_swapi_people_id.61c011a764"
[0m09:31:55.954866 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.unique_stg_swapi_planets_id.6c040cab42"
[0m09:31:55.968510 [debug] [Thread-3 (]: On test.nerd_facts_dbt.unique_stg_swapi_planets_id.6c040cab42: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.unique_stg_swapi_planets_id.6c040cab42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "nerd_facts"."public"."stg_swapi_planets"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:31:55.967746 [debug] [Thread-2 (]: On test.nerd_facts_dbt.unique_stg_swapi_people_id.61c011a764: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.unique_stg_swapi_people_id.61c011a764"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "nerd_facts"."public"."stg_swapi_people"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:31:55.968174 [debug] [Thread-4 (]: Using postgres connection "test.nerd_facts_dbt.unique_stg_swapi_species_id.d223d89b92"
[0m09:31:55.967197 [debug] [Thread-1 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_swapi_starships_id.faa87ea4e7"
[0m09:31:55.969216 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_planets" does not exist
LINE 15: from "nerd_facts"."public"."stg_swapi_planets"
              ^

[0m09:31:55.969580 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_people" does not exist
LINE 15: from "nerd_facts"."public"."stg_swapi_people"
              ^

[0m09:31:55.969854 [debug] [Thread-4 (]: On test.nerd_facts_dbt.unique_stg_swapi_species_id.d223d89b92: BEGIN
[0m09:31:55.970416 [debug] [Thread-3 (]: On test.nerd_facts_dbt.unique_stg_swapi_planets_id.6c040cab42: ROLLBACK
[0m09:31:55.970717 [debug] [Thread-1 (]: Began executing node test.nerd_facts_dbt.unique_stg_swapi_starships_id.faa87ea4e7
[0m09:31:55.971344 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:31:55.971041 [debug] [Thread-2 (]: On test.nerd_facts_dbt.unique_stg_swapi_people_id.61c011a764: ROLLBACK
[0m09:31:55.973652 [debug] [Thread-1 (]: Writing runtime sql for node "test.nerd_facts_dbt.unique_stg_swapi_starships_id.faa87ea4e7"
[0m09:31:55.974045 [debug] [Thread-3 (]: On test.nerd_facts_dbt.unique_stg_swapi_planets_id.6c040cab42: Close
[0m09:31:55.974901 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.unique_stg_swapi_starships_id.faa87ea4e7"
[0m09:31:55.978041 [debug] [Thread-1 (]: On test.nerd_facts_dbt.unique_stg_swapi_starships_id.faa87ea4e7: BEGIN
[0m09:31:55.978333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:55.980405 [debug] [Thread-3 (]: Database Error in test unique_stg_swapi_planets_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_planets" does not exist
  LINE 15: from "nerd_facts"."public"."stg_swapi_planets"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/unique_stg_swapi_planets_id.sql
[0m09:31:55.980955 [error] [Thread-3 (]: 33 of 36 ERROR unique_stg_swapi_planets_id ..................................... [[31mERROR[0m in 0.07s]
[0m09:31:55.981607 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.unique_stg_swapi_planets_id.6c040cab42
[0m09:31:55.981950 [debug] [Thread-3 (]: Began running node test.nerd_facts_dbt.unique_stg_swapi_vehicles_id.8b524818ea
[0m09:31:55.983067 [info ] [Thread-3 (]: 36 of 36 START test unique_stg_swapi_vehicles_id ............................... [RUN]
[0m09:31:55.982332 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.unique_stg_swapi_planets_id.6c040cab42' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_swapi_planets_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_planets" does not exist
  LINE 15: from "nerd_facts"."public"."stg_swapi_planets"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/unique_stg_swapi_planets_id.sql.
[0m09:31:55.983679 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nerd_facts_dbt.unique_stg_swapi_planets_id.6c040cab42, now test.nerd_facts_dbt.unique_stg_swapi_vehicles_id.8b524818ea)
[0m09:31:55.989647 [debug] [Thread-3 (]: Began compiling node test.nerd_facts_dbt.unique_stg_swapi_vehicles_id.8b524818ea
[0m09:31:55.977555 [debug] [Thread-2 (]: On test.nerd_facts_dbt.unique_stg_swapi_people_id.61c011a764: Close
[0m09:31:55.994782 [debug] [Thread-2 (]: Database Error in test unique_stg_swapi_people_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_people" does not exist
  LINE 15: from "nerd_facts"."public"."stg_swapi_people"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/unique_stg_swapi_people_id.sql
[0m09:31:55.995288 [error] [Thread-2 (]: 32 of 36 ERROR unique_stg_swapi_people_id ...................................... [[31mERROR[0m in 0.10s]
[0m09:31:55.996042 [debug] [Thread-2 (]: Finished running node test.nerd_facts_dbt.unique_stg_swapi_people_id.61c011a764
[0m09:31:55.993854 [debug] [Thread-3 (]: Writing injected SQL for node "test.nerd_facts_dbt.unique_stg_swapi_vehicles_id.8b524818ea"
[0m09:31:55.996574 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.unique_stg_swapi_people_id.61c011a764' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_swapi_people_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_people" does not exist
  LINE 15: from "nerd_facts"."public"."stg_swapi_people"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/unique_stg_swapi_people_id.sql.
[0m09:31:55.997394 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m09:31:55.998032 [debug] [Thread-1 (]: Using postgres connection "test.nerd_facts_dbt.unique_stg_swapi_starships_id.faa87ea4e7"
[0m09:31:55.997770 [debug] [Thread-3 (]: Began executing node test.nerd_facts_dbt.unique_stg_swapi_vehicles_id.8b524818ea
[0m09:31:55.998353 [debug] [Thread-1 (]: On test.nerd_facts_dbt.unique_stg_swapi_starships_id.faa87ea4e7: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.unique_stg_swapi_starships_id.faa87ea4e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "nerd_facts"."public"."stg_swapi_starships"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:31:56.001187 [debug] [Thread-3 (]: Writing runtime sql for node "test.nerd_facts_dbt.unique_stg_swapi_vehicles_id.8b524818ea"
[0m09:31:56.001634 [debug] [Thread-4 (]: SQL status: BEGIN in 0.030 seconds
[0m09:31:56.002435 [debug] [Thread-4 (]: Using postgres connection "test.nerd_facts_dbt.unique_stg_swapi_species_id.d223d89b92"
[0m09:31:56.002767 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_starships" does not exist
LINE 15: from "nerd_facts"."public"."stg_swapi_starships"
              ^

[0m09:31:56.003864 [debug] [Thread-1 (]: On test.nerd_facts_dbt.unique_stg_swapi_starships_id.faa87ea4e7: ROLLBACK
[0m09:31:56.003499 [debug] [Thread-4 (]: On test.nerd_facts_dbt.unique_stg_swapi_species_id.d223d89b92: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.unique_stg_swapi_species_id.d223d89b92"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "nerd_facts"."public"."stg_swapi_species"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:31:56.003199 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.unique_stg_swapi_vehicles_id.8b524818ea"
[0m09:31:56.004760 [debug] [Thread-3 (]: On test.nerd_facts_dbt.unique_stg_swapi_vehicles_id.8b524818ea: BEGIN
[0m09:31:56.005313 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:31:56.005055 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_species" does not exist
LINE 15: from "nerd_facts"."public"."stg_swapi_species"
              ^

[0m09:31:56.004399 [debug] [Thread-1 (]: On test.nerd_facts_dbt.unique_stg_swapi_starships_id.faa87ea4e7: Close
[0m09:31:56.006866 [debug] [Thread-1 (]: Database Error in test unique_stg_swapi_starships_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 15: from "nerd_facts"."public"."stg_swapi_starships"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/unique_stg_swapi_starships_id.sql
[0m09:31:56.007418 [error] [Thread-1 (]: 35 of 36 ERROR unique_stg_swapi_starships_id ................................... [[31mERROR[0m in 0.05s]
[0m09:31:56.008125 [debug] [Thread-1 (]: Finished running node test.nerd_facts_dbt.unique_stg_swapi_starships_id.faa87ea4e7
[0m09:31:56.005774 [debug] [Thread-4 (]: On test.nerd_facts_dbt.unique_stg_swapi_species_id.d223d89b92: ROLLBACK
[0m09:31:56.008869 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.unique_stg_swapi_starships_id.faa87ea4e7' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_swapi_starships_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 15: from "nerd_facts"."public"."stg_swapi_starships"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/unique_stg_swapi_starships_id.sql.
[0m09:31:56.012033 [debug] [Thread-4 (]: On test.nerd_facts_dbt.unique_stg_swapi_species_id.d223d89b92: Close
[0m09:31:56.020669 [debug] [Thread-4 (]: Database Error in test unique_stg_swapi_species_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_species" does not exist
  LINE 15: from "nerd_facts"."public"."stg_swapi_species"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/unique_stg_swapi_species_id.sql
[0m09:31:56.021177 [error] [Thread-4 (]: 34 of 36 ERROR unique_stg_swapi_species_id ..................................... [[31mERROR[0m in 0.07s]
[0m09:31:56.021663 [debug] [Thread-4 (]: Finished running node test.nerd_facts_dbt.unique_stg_swapi_species_id.d223d89b92
[0m09:31:56.022280 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.unique_stg_swapi_species_id.d223d89b92' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_swapi_species_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_species" does not exist
  LINE 15: from "nerd_facts"."public"."stg_swapi_species"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/unique_stg_swapi_species_id.sql.
[0m09:31:56.022644 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m09:31:56.023116 [debug] [Thread-3 (]: Using postgres connection "test.nerd_facts_dbt.unique_stg_swapi_vehicles_id.8b524818ea"
[0m09:31:56.023447 [debug] [Thread-3 (]: On test.nerd_facts_dbt.unique_stg_swapi_vehicles_id.8b524818ea: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "test.nerd_facts_dbt.unique_stg_swapi_vehicles_id.8b524818ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "nerd_facts"."public"."stg_swapi_vehicles"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:31:56.024063 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.stg_swapi_vehicles" does not exist
LINE 15: from "nerd_facts"."public"."stg_swapi_vehicles"
              ^

[0m09:31:56.024372 [debug] [Thread-3 (]: On test.nerd_facts_dbt.unique_stg_swapi_vehicles_id.8b524818ea: ROLLBACK
[0m09:31:56.024838 [debug] [Thread-3 (]: On test.nerd_facts_dbt.unique_stg_swapi_vehicles_id.8b524818ea: Close
[0m09:31:56.025750 [debug] [Thread-3 (]: Database Error in test unique_stg_swapi_vehicles_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_vehicles" does not exist
  LINE 15: from "nerd_facts"."public"."stg_swapi_vehicles"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/unique_stg_swapi_vehicles_id.sql
[0m09:31:56.026226 [error] [Thread-3 (]: 36 of 36 ERROR unique_stg_swapi_vehicles_id .................................... [[31mERROR[0m in 0.04s]
[0m09:31:56.026913 [debug] [Thread-3 (]: Finished running node test.nerd_facts_dbt.unique_stg_swapi_vehicles_id.8b524818ea
[0m09:31:56.027489 [debug] [Thread-7 (]: Marking all children of 'test.nerd_facts_dbt.unique_stg_swapi_vehicles_id.8b524818ea' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_swapi_vehicles_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_vehicles" does not exist
  LINE 15: from "nerd_facts"."public"."stg_swapi_vehicles"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/unique_stg_swapi_vehicles_id.sql.
[0m09:31:56.028790 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:56.029165 [debug] [MainThread]: On master: BEGIN
[0m09:31:56.029478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:31:56.042421 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:31:56.042823 [debug] [MainThread]: On master: COMMIT
[0m09:31:56.043105 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:56.043333 [debug] [MainThread]: On master: COMMIT
[0m09:31:56.043667 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:31:56.043909 [debug] [MainThread]: On master: Close
[0m09:31:56.044366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:31:56.044592 [debug] [MainThread]: Connection 'test.nerd_facts_dbt.unique_stg_swapi_starships_id.faa87ea4e7' was properly closed.
[0m09:31:56.044788 [debug] [MainThread]: Connection 'test.nerd_facts_dbt.unique_stg_swapi_people_id.61c011a764' was properly closed.
[0m09:31:56.044978 [debug] [MainThread]: Connection 'test.nerd_facts_dbt.unique_stg_swapi_vehicles_id.8b524818ea' was properly closed.
[0m09:31:56.045168 [debug] [MainThread]: Connection 'test.nerd_facts_dbt.unique_stg_swapi_species_id.d223d89b92' was properly closed.
[0m09:31:56.045470 [info ] [MainThread]: 
[0m09:31:56.045828 [info ] [MainThread]: Finished running 36 data tests in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m09:31:56.050109 [debug] [MainThread]: Command end result
[0m09:31:56.095099 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m09:31:56.097147 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m09:31:56.104014 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m09:31:56.104386 [info ] [MainThread]: 
[0m09:31:56.104719 [info ] [MainThread]: [31mCompleted with 36 errors, 0 partial successes, and 0 warnings:[0m
[0m09:31:56.104997 [info ] [MainThread]: 
[0m09:31:56.105308 [error] [MainThread]:   Database Error in test dbt_utils_accepted_range_stg_swapi_starships_hyperdrive_rating__10__0_5 (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 11:   from "nerd_facts"."public"."stg_swapi_starships"
                  ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_accepted_range_stg_s_dd0ad6923fc838f5a7ce83233328b8a5.sql
[0m09:31:56.105584 [info ] [MainThread]: 
[0m09:31:56.105884 [error] [MainThread]:   Database Error in test accepted_values_stg_swapi_starships_manufacturer__Kuat_Drive_Yards__Corellian_Engineering_Corporation__Sienar_Fleet_Systems__Cygnus_Spaceworks__Incom_Corporation__Koensayr_Manufacturing (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 17:     from "nerd_facts"."public"."stg_swapi_starships"
                    ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/accepted_values_stg_swapi_star_f3359b21d1586e66ef9d2b69269f94d5.sql
[0m09:31:56.106132 [info ] [MainThread]: 
[0m09:31:56.106441 [error] [MainThread]:   Database Error in test dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1 (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_films" does not exist
  LINE 11:   from "nerd_facts"."public"."stg_swapi_films"
                  ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_accepted_range_stg_swapi_films_episode_id__9__1.sql
[0m09:31:56.106681 [info ] [MainThread]: 
[0m09:31:56.106974 [error] [MainThread]:   Database Error in test dbt_utils_accepted_range_stg_swapi_planets_surface_water__100__0 (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_planets" does not exist
  LINE 11:   from "nerd_facts"."public"."stg_swapi_planets"
                  ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_accepted_range_stg_s_dc3789df0cd4354ea093aa3d5ed78748.sql
[0m09:31:56.107249 [info ] [MainThread]: 
[0m09:31:56.107553 [error] [MainThread]:   Database Error in test dbt_utils_accepted_range_stg_swapi_starships_max_atmosphering_speed__2000__0 (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 11:   from "nerd_facts"."public"."stg_swapi_starships"
                  ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_accepted_range_stg_s_0010594815da93a571a43e6dd43c6422.sql
[0m09:31:56.107798 [info ] [MainThread]: 
[0m09:31:56.108074 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_MGLT___0_OR_IS_NULL (models/staging/swapi/stg_swapi.yml)
  syntax error at or near "NULL"
  LINE 17: where not(MGLT >= 0 OR IS NULL)
                                     ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_cfc3b86b042a82b903ed54f0c8725d53.sql
[0m09:31:56.108312 [info ] [MainThread]: 
[0m09:31:56.108607 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_cargo_capacity___0_OR_IS_NULL (models/staging/swapi/stg_swapi.yml)
  syntax error at or near "NULL"
  LINE 17: where not(cargo_capacity >= 0 OR IS NULL)
                                               ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_4acb3b26b03e1d062250ec156d7d150d.sql
[0m09:31:56.108846 [info ] [MainThread]: 
[0m09:31:56.109118 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_crew___1_OR_IS_NULL (models/staging/swapi/stg_swapi.yml)
  syntax error at or near "NULL"
  LINE 17: where not(crew >= 1 OR IS NULL)
                                     ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_d125afcd2334724d94f609b49be6617c.sql
[0m09:31:56.109371 [info ] [MainThread]: 
[0m09:31:56.109678 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_crew_numeric_passengers_numeric_50_OR_passengers_IS_NULL_OR_crew_IS_NULL_OR_crew_unknown_ (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 10:     select * from "nerd_facts"."public"."stg_swapi_starships...
                             ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_b661521dc2474e27ea156eaf895ee132.sql
[0m09:31:56.109930 [info ] [MainThread]: 
[0m09:31:56.110208 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_length___0_OR_IS_NULL (models/staging/swapi/stg_swapi.yml)
  syntax error at or near "NULL"
  LINE 17: where not(length > 0 OR IS NULL)
                                      ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_be8f4b71c2f17ad203558d2f702bf73e.sql
[0m09:31:56.110450 [info ] [MainThread]: 
[0m09:31:56.110739 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_passengers___0_OR_IS_NULL (models/staging/swapi/stg_swapi.yml)
  syntax error at or near "NULL"
  LINE 17: where not(passengers >= 0 OR IS NULL)
                                           ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_af273654177cfdc91478abd436a54b83.sql
[0m09:31:56.111019 [info ] [MainThread]: 
[0m09:31:56.111294 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_swapi_starships_max_atmosphering_speed___0_OR_IS_NULL (models/staging/swapi/stg_swapi.yml)
  syntax error at or near "NULL"
  LINE 17: where not(max_atmosphering_speed >= 0 OR IS NULL)
                                                       ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/dbt_utils_expression_is_true_s_f96fcbd14ddc641df073db37ee15bc56.sql
[0m09:31:56.111530 [info ] [MainThread]: 
[0m09:31:56.111814 [error] [MainThread]:   Database Error in test not_null_stg_swapi_films_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_films" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_films"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_films_id.sql
[0m09:31:56.112047 [info ] [MainThread]: 
[0m09:31:56.112308 [error] [MainThread]:   Database Error in test not_null_stg_swapi_films_episode_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_films" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_films"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_films_episode_id.sql
[0m09:31:56.112535 [info ] [MainThread]: 
[0m09:31:56.112794 [error] [MainThread]:   Database Error in test not_null_stg_swapi_films_release_date (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_films" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_films"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_films_release_date.sql
[0m09:31:56.113029 [info ] [MainThread]: 
[0m09:31:56.113288 [error] [MainThread]:   Database Error in test not_null_stg_swapi_films_title (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_films" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_films"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_films_title.sql
[0m09:31:56.113524 [info ] [MainThread]: 
[0m09:31:56.113782 [error] [MainThread]:   Database Error in test not_null_stg_swapi_people_name (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_people" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_people"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_people_name.sql
[0m09:31:56.114002 [info ] [MainThread]: 
[0m09:31:56.114267 [error] [MainThread]:   Database Error in test not_null_stg_swapi_people_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_people" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_people"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_people_id.sql
[0m09:31:56.114507 [info ] [MainThread]: 
[0m09:31:56.114768 [error] [MainThread]:   Database Error in test not_null_stg_swapi_planets_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_planets" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_planets"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_planets_id.sql
[0m09:31:56.115019 [info ] [MainThread]: 
[0m09:31:56.115367 [error] [MainThread]:   Database Error in test not_null_stg_swapi_planets_name (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_planets" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_planets"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_planets_name.sql
[0m09:31:56.115677 [info ] [MainThread]: 
[0m09:31:56.116038 [error] [MainThread]:   Database Error in test not_null_stg_swapi_starships_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_starships"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_starships_id.sql
[0m09:31:56.116370 [info ] [MainThread]: 
[0m09:31:56.116740 [error] [MainThread]:   Database Error in test not_null_stg_swapi_species_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_species" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_species"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_species_id.sql
[0m09:31:56.117049 [info ] [MainThread]: 
[0m09:31:56.117389 [error] [MainThread]:   Database Error in test not_null_stg_swapi_species_name (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_species" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_species"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_species_name.sql
[0m09:31:56.117642 [info ] [MainThread]: 
[0m09:31:56.117923 [error] [MainThread]:   Database Error in test not_null_stg_swapi_starships_max_atmosphering_speed (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_starships"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_starships_max_atmosphering_speed.sql
[0m09:31:56.118157 [info ] [MainThread]: 
[0m09:31:56.118426 [error] [MainThread]:   Database Error in test not_null_stg_swapi_starships_name (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_starships"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_starships_name.sql
[0m09:31:56.118653 [info ] [MainThread]: 
[0m09:31:56.118912 [error] [MainThread]:   Database Error in test not_null_stg_swapi_vehicles_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_vehicles" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_vehicles"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_vehicles_id.sql
[0m09:31:56.119182 [info ] [MainThread]: 
[0m09:31:56.119441 [error] [MainThread]:   Database Error in test not_null_stg_swapi_vehicles_name (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_vehicles" does not exist
  LINE 14: from "nerd_facts"."public"."stg_swapi_vehicles"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/not_null_stg_swapi_vehicles_name.sql
[0m09:31:56.119663 [info ] [MainThread]: 
[0m09:31:56.119925 [error] [MainThread]:   Database Error in test source_not_null_pokeapi_moves_id (models/staging/pokeapi/pokeapi_sources.yml)
  cross-database references are not implemented: "pokemon_db.public.moves"
  LINE 14: from "pokemon_db"."public"."moves"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/pokeapi/pokeapi_sources.yml/source_not_null_pokeapi_moves_id.sql
[0m09:31:56.120154 [info ] [MainThread]: 
[0m09:31:56.120428 [error] [MainThread]:   Database Error in test source_not_null_pokeapi_moves_name (models/staging/pokeapi/pokeapi_sources.yml)
  cross-database references are not implemented: "pokemon_db.public.moves"
  LINE 14: from "pokemon_db"."public"."moves"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/pokeapi/pokeapi_sources.yml/source_not_null_pokeapi_moves_name.sql
[0m09:31:56.120654 [info ] [MainThread]: 
[0m09:31:56.120916 [error] [MainThread]:   Database Error in test source_unique_pokeapi_moves_id (models/staging/pokeapi/pokeapi_sources.yml)
  cross-database references are not implemented: "pokemon_db.public.moves"
  LINE 15: from "pokemon_db"."public"."moves"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/pokeapi/pokeapi_sources.yml/source_unique_pokeapi_moves_id.sql
[0m09:31:56.121139 [info ] [MainThread]: 
[0m09:31:56.121404 [error] [MainThread]:   Database Error in test unique_stg_swapi_films_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_films" does not exist
  LINE 15: from "nerd_facts"."public"."stg_swapi_films"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/unique_stg_swapi_films_id.sql
[0m09:31:56.121656 [info ] [MainThread]: 
[0m09:31:56.121914 [error] [MainThread]:   Database Error in test unique_stg_swapi_planets_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_planets" does not exist
  LINE 15: from "nerd_facts"."public"."stg_swapi_planets"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/unique_stg_swapi_planets_id.sql
[0m09:31:56.122140 [info ] [MainThread]: 
[0m09:31:56.122396 [error] [MainThread]:   Database Error in test unique_stg_swapi_people_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_people" does not exist
  LINE 15: from "nerd_facts"."public"."stg_swapi_people"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/unique_stg_swapi_people_id.sql
[0m09:31:56.122627 [info ] [MainThread]: 
[0m09:31:56.122884 [error] [MainThread]:   Database Error in test unique_stg_swapi_starships_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_starships" does not exist
  LINE 15: from "nerd_facts"."public"."stg_swapi_starships"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/unique_stg_swapi_starships_id.sql
[0m09:31:56.123140 [info ] [MainThread]: 
[0m09:31:56.123401 [error] [MainThread]:   Database Error in test unique_stg_swapi_species_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_species" does not exist
  LINE 15: from "nerd_facts"."public"."stg_swapi_species"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/unique_stg_swapi_species_id.sql
[0m09:31:56.123623 [info ] [MainThread]: 
[0m09:31:56.123880 [error] [MainThread]:   Database Error in test unique_stg_swapi_vehicles_id (models/staging/swapi/stg_swapi.yml)
  relation "public.stg_swapi_vehicles" does not exist
  LINE 15: from "nerd_facts"."public"."stg_swapi_vehicles"
                ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi.yml/unique_stg_swapi_vehicles_id.sql
[0m09:31:56.124126 [info ] [MainThread]: 
[0m09:31:56.124364 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=36 SKIP=0 TOTAL=36
[0m09:31:56.125081 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.5198264, "process_in_blocks": "5528", "process_kernel_time": 0.135284, "process_mem_max_rss": "122124", "process_out_blocks": "8176", "process_user_time": 3.463321}
[0m09:31:56.125455 [debug] [MainThread]: Command `dbt test` failed at 09:31:56.125341 after 2.52 seconds
[0m09:31:56.125758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9819f5c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9818453a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981a3f8cd0>]}
[0m09:31:56.126062 [debug] [MainThread]: Flushing usage events
[0m09:31:56.526691 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:37:58.479703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8330789a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc833ed1a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc833ed19f0>]}


============================== 09:37:58.481788 | 3354c9e2-65b3-4b0a-ac7a-a9284122545c ==============================
[0m09:37:58.481788 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:37:58.482232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models staging.swapi.*', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:37:58.609712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3354c9e2-65b3-4b0a-ac7a-a9284122545c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8323ddf30>]}
[0m09:37:58.658693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3354c9e2-65b3-4b0a-ac7a-a9284122545c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8316fe650>]}
[0m09:37:58.659382 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:37:58.734474 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:37:58.873233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 6 files changed.
[0m09:37:58.874096 [debug] [MainThread]: Partial parsing: added file: nerd_facts_dbt://models/staging/swapi/swapi_sources.yml
[0m09:37:58.874619 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/swapi/stg_swapi_planets.sql
[0m09:37:58.875075 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/swapi/stg_swapi_vehicles.sql
[0m09:37:58.875489 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/swapi/stg_swapi_films.sql
[0m09:37:58.875888 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/swapi/stg_swapi_species.sql
[0m09:37:58.876331 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/swapi/stg_swapi_starships.sql
[0m09:37:58.876744 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/swapi/stg_swapi_people.sql
[0m09:37:59.479594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3354c9e2-65b3-4b0a-ac7a-a9284122545c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc830ba8130>]}
[0m09:37:59.570727 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m09:37:59.572844 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m09:37:59.585411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3354c9e2-65b3-4b0a-ac7a-a9284122545c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83129ead0>]}
[0m09:37:59.585929 [info ] [MainThread]: Found 36 models, 38 data tests, 18 sources, 630 macros
[0m09:37:59.586264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3354c9e2-65b3-4b0a-ac7a-a9284122545c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83129c6a0>]}
[0m09:37:59.588699 [info ] [MainThread]: 
[0m09:37:59.589047 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:37:59.589308 [info ] [MainThread]: 
[0m09:37:59.589738 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:37:59.594147 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m09:37:59.622290 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m09:37:59.622722 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m09:37:59.623024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:37:59.636463 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m09:37:59.637553 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m09:37:59.640321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_public)
[0m09:37:59.645921 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m09:37:59.646266 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m09:37:59.646515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:37:59.658833 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m09:37:59.659219 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m09:37:59.659486 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:37:59.662212 [debug] [ThreadPool]: SQL status: SELECT 104 in 0.002 seconds
[0m09:37:59.664445 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m09:37:59.664857 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m09:37:59.682790 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:59.683185 [debug] [MainThread]: On master: BEGIN
[0m09:37:59.683428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:37:59.695743 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:37:59.696133 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:59.696435 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:37:59.703928 [debug] [MainThread]: SQL status: SELECT 34 in 0.007 seconds
[0m09:37:59.709257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3354c9e2-65b3-4b0a-ac7a-a9284122545c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8317506a0>]}
[0m09:37:59.709693 [debug] [MainThread]: On master: ROLLBACK
[0m09:37:59.710204 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:59.710597 [debug] [MainThread]: On master: BEGIN
[0m09:37:59.711305 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:37:59.711647 [debug] [MainThread]: On master: COMMIT
[0m09:37:59.711917 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:59.712180 [debug] [MainThread]: On master: COMMIT
[0m09:37:59.712527 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:37:59.712773 [debug] [MainThread]: On master: Close
[0m09:37:59.715728 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_swapi_films
[0m09:37:59.716227 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_swapi_people
[0m09:37:59.716735 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_planets
[0m09:37:59.717213 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_swapi_films ............................. [RUN]
[0m09:37:59.717628 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi_species
[0m09:37:59.718062 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_swapi_people ............................ [RUN]
[0m09:37:59.718444 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_swapi_planets ........................... [RUN]
[0m09:37:59.718999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.stg_swapi_films)
[0m09:37:59.719397 [info ] [Thread-4 (]: 4 of 6 START sql view model public.stg_swapi_species ........................... [RUN]
[0m09:37:59.719873 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_people'
[0m09:37:59.720323 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_planets'
[0m09:37:59.720654 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_films
[0m09:37:59.721084 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_species'
[0m09:37:59.721465 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_people
[0m09:37:59.721758 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_planets
[0m09:37:59.729126 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_films"
[0m09:37:59.729566 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_species
[0m09:37:59.733308 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_people"
[0m09:37:59.736911 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m09:37:59.740184 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_species"
[0m09:37:59.740630 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_swapi_films
[0m09:37:59.741376 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi_species
[0m09:37:59.741691 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_swapi_people
[0m09:37:59.742098 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_planets
[0m09:37:59.787650 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_people"
[0m09:37:59.788732 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_species"
[0m09:37:59.793898 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m09:37:59.795680 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_films"
[0m09:37:59.796357 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m09:37:59.798021 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_people: BEGIN
[0m09:37:59.798290 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:37:59.797698 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m09:37:59.799248 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_planets: BEGIN
[0m09:37:59.799541 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:37:59.800692 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_species"
[0m09:37:59.801024 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_species: BEGIN
[0m09:37:59.801303 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:37:59.797306 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_films"
[0m09:37:59.802324 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_films: BEGIN
[0m09:37:59.802626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:37:59.820066 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m09:37:59.820598 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_films"
[0m09:37:59.822039 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_films"} */

  create view "nerd_facts"."public"."stg_swapi_films__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_films
  Description: Standardizes Star Wars film data from SWAPI
  Source: raw.swapi_films
  
  Notes:
  - Adds derived fields for easier analysis (release_year, trilogy)
  - Extracts counts from related entities (characters, planets, species)
  - Converts dates to proper DATE types and adds chronological ordering
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        episode_id,
        title,
        director,
        producer,
        release_date,
        opening_crawl,
        TRY_CAST(characters AS jsonb) AS characters,
        TRY_CAST(planets AS jsonb) AS planets,
        TRY_CAST(starships AS jsonb) AS starships,
        TRY_CAST(vehicles AS jsonb) AS vehicles,
        TRY_CAST(species AS jsonb) AS species,
        created,
        edited,
        url
    FROM "nerd_facts"."raw"."films"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    episode_id,
    title AS film_title,
    
    -- Creative team
    director,
    producer,
    
    -- Standardize dates and add derived time fields
    CASE 
        WHEN release_date IS NULL OR release_date = '' THEN NULL
        ELSE TO_DATE(release_date, 'YYYY-MM-DD') 
    END AS release_date,
    
    EXTRACT(YEAR FROM TO_DATE(release_date, 'YYYY-MM-DD')) AS release_year,
    
    -- Story elements
    opening_crawl,
    
    -- Derived chronological order (story timeline vs. release order)
    CASE episode_id
        WHEN 1 THEN 1  -- The Phantom Menace
        WHEN 2 THEN 2  -- Attack of the Clones
        WHEN 3 THEN 3  -- Revenge of the Sith
        WHEN 4 THEN 4  -- A New Hope
        WHEN 5 THEN 5  -- Empire Strikes Back
        WHEN 6 THEN 6  -- Return of the Jedi
        WHEN 7 THEN 7  -- The Force Awakens
        WHEN 8 THEN 8  -- The Last Jedi
        WHEN 9 THEN 9  -- The Rise of Skywalker
        ELSE 99        -- Unknown/other
    END AS chronological_order,
    
    -- Trilogy classification
    CASE
        WHEN episode_id BETWEEN 1 AND 3 THEN 'Prequel Trilogy'
        WHEN episode_id BETWEEN 4 AND 6 THEN 'Original Trilogy'
        WHEN episode_id BETWEEN 7 AND 9 THEN 'Sequel Trilogy'
        ELSE 'Anthology'
    END AS trilogy,
    
    -- Entity counts
    COALESCE(jsonb_array_length(characters), 0) AS character_count,
    COALESCE(jsonb_array_length(planets), 0) AS planet_count,
    COALESCE(jsonb_array_length(starships), 0) AS starship_count,
    COALESCE(jsonb_array_length(vehicles), 0) AS vehicle_count,
    COALESCE(jsonb_array_length(species), 0) AS species_count,
    
    -- Word count of opening crawl (approximate)
    ARRAY_LENGTH(STRING_TO_ARRAY(REGEXP_REPLACE(opening_crawl, '\r|\n', ' ', 'g'), ' '), 1) AS opening_crawl_word_count,
    
    -- API metadata with proper handling
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Data tracking
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
ORDER BY episode_id
  );
[0m09:37:59.823221 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "AS"
LINE 30:         TRY_CAST(characters AS jsonb) AS characters,
                                     ^

[0m09:37:59.823781 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_films: ROLLBACK
[0m09:37:59.824362 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_films: Close
[0m09:37:59.828531 [debug] [Thread-1 (]: Database Error in model stg_swapi_films (models/staging/swapi/stg_swapi_films.sql)
  syntax error at or near "AS"
  LINE 30:         TRY_CAST(characters AS jsonb) AS characters,
                                       ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_films.sql
[0m09:37:59.830636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3354c9e2-65b3-4b0a-ac7a-a9284122545c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83129c580>]}
[0m09:37:59.831399 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model public.stg_swapi_films .................... [[31mERROR[0m in 0.11s]
[0m09:37:59.832100 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_swapi_films
[0m09:37:59.832513 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_swapi_starships
[0m09:37:59.833776 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_films' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_films (models/staging/swapi/stg_swapi_films.sql)
  syntax error at or near "AS"
  LINE 30:         TRY_CAST(characters AS jsonb) AS characters,
                                       ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_films.sql.
[0m09:37:59.834257 [info ] [Thread-1 (]: 5 of 6 START sql view model public.stg_swapi_starships ......................... [RUN]
[0m09:37:59.835441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_films, now model.nerd_facts_dbt.stg_swapi_starships)
[0m09:37:59.835834 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_starships
[0m09:37:59.883192 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m09:37:59.883704 [debug] [Thread-3 (]: SQL status: BEGIN in 0.084 seconds
[0m09:37:59.884432 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m09:37:59.884856 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */

  create view "nerd_facts"."public"."stg_swapi_planets__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_planets
  Description: Standardizes Star Wars planet data from SWAPI
  Source: raw.swapi_planets
  
  Notes:
  - Numeric fields are cleaned and converted to proper types
  - Population is handled with appropriate NULL values
  - Derived planet classifications are added for analysis
  - Climate and terrain are standardized for consistency
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        rotation_period,
        orbital_period,
        diameter,
        climate,
        gravity,
        terrain,
        surface_water,
        population,
        TRY_CAST(residents AS jsonb) AS residents,
        TRY_CAST(films AS jsonb) AS films,
        created,
        edited,
        CURRENT_TIMESTAMP AS _loaded_at
    FROM "nerd_facts"."raw"."planets"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name AS planet_name,  -- Fixed typo from "panet_name"
    
    -- Physical characteristics with proper typing
    CASE 
        WHEN rotation_period IS NULL OR lower(rotation_period) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(rotation_period, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS rotation_period,
    
    CASE 
        WHEN orbital_period IS NULL OR lower(orbital_period) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(orbital_period, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS orbital_period,
    
    CASE 
        WHEN diameter IS NULL OR lower(diameter) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(diameter, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS diameter,
    
    -- Environment attributes
    LOWER(COALESCE(climate, 'unknown')) AS climate,
    LOWER(COALESCE(gravity, 'unknown')) AS gravity,
    LOWER(COALESCE(terrain, 'unknown')) AS terrain,
    
    CASE 
        WHEN surface_water IS NULL OR lower(surface_water) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(surface_water, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS surface_water,
    
    -- Population with proper handling
    CASE 
        WHEN population IS NULL OR lower(population) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(population, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS population,
    
    -- Entity counts
    COALESCE(jsonb_array_length(residents), 0) AS resident_count,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    residents,
    films,
    
    -- Derived classifications
    CASE
        WHEN lower(climate) LIKE '%temperate%' THEN TRUE
        ELSE FALSE
    END AS is_temperate,
    
    CASE
        WHEN lower(terrain) LIKE '%forest%' OR 
             lower(terrain) LIKE '%jungle%' OR
             lower(terrain) LIKE '%grasslands%' THEN TRUE
        ELSE FALSE
    END AS has_vegetation,
    
    CASE
        WHEN lower(terrain) LIKE '%ocean%' OR 
             lower(terrain) LIKE '%water%' OR
             (surface_water IS NOT NULL AND surface_water::NUMERIC > 50) THEN TRUE
        ELSE FALSE
    END AS is_water_world,
    
    CASE
        WHEN lower(terrain) LIKE '%desert%' OR 
             lower(climate) LIKE '%arid%' OR
             (surface_water IS NOT NULL AND surface_water::NUMERIC < 5) THEN TRUE
        ELSE FALSE
    END AS is_desert_world,
    
    -- Planet habitability score (0-100)
    CASE
        WHEN lower(climate) LIKE '%temperate%' THEN
            CASE
                WHEN lower(terrain) LIKE '%forest%' OR 
                     lower(terrain) LIKE '%grasslands%' THEN 90
                ELSE 75
            END
        WHEN lower(climate) LIKE '%tropical%' OR lower(climate) LIKE '%humid%' THEN 65
        WHEN lower(climate) LIKE '%arid%' OR lower(climate) LIKE '%hot%' THEN 35
        WHEN lower(climate) LIKE '%frozen%' OR lower(climate) LIKE '%frigid%' THEN 15
        ELSE 50
    END AS habitability_score,
    
    -- Notable planet flag
    CASE
        WHEN name IN ('Tatooine', 'Alderaan', 'Yavin IV', 'Hoth', 'Dagobah', 
                      'Bespin', 'Endor', 'Naboo', 'Coruscant', 'Kamino', 'Geonosis') 
        THEN TRUE
        ELSE FALSE
    END AS is_notable_planet,
    
    -- API metadata
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking fields
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:37:59.885328 [debug] [Thread-2 (]: SQL status: BEGIN in 0.087 seconds
[0m09:37:59.885876 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_swapi_starships
[0m09:37:59.886275 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m09:37:59.891745 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */

  create view "nerd_facts"."public"."stg_swapi_people__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_people
  Description: Standardizes Star Wars character data from SWAPI
  Source: raw.swapi_people
  
  Notes:
  - Species and homeworld are extracted from JSON references
  - Force sensitivity is derived from character appearances and names
  - Physical attributes are cleaned and converted to proper numeric types
  - Additional derived fields are added for character analysis
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        height,
        mass,
        hair_color,
        skin_color,
        eye_color,
        birth_year,
        gender,
        homeworld,
        films,
        species,
        vehicles,
        starships,
        created,
        edited,
        url
    FROM "nerd_facts"."raw"."people"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name,
    
    -- Extract species information with improved error handling
    CASE 
        WHEN species IS NULL OR jsonb_array_length(species) = 0 THEN 'Human'  -- Default to Human if no species
        WHEN jsonb_typeof(species) != 'array' THEN 'Unknown'  -- Handle unexpected JSON type
        ELSE COALESCE(SPLIT_PART(species->0->>'url', '/', 6), 'Unknown')  -- Extract ID from URL
    END AS species,
    
    -- Extract homeworld ID with error handling
    CASE
        WHEN homeworld IS NULL THEN NULL
        WHEN jsonb_typeof(homeworld) != 'object' THEN NULL
        ELSE NULLIF(SPLIT_PART(homeworld->>'url', '/', 6), '')
    END AS homeworld_id,
    
    -- Clean numeric values with comprehensive error handling
    CASE 
        WHEN height IS NULL OR lower(height) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(height, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS height_cm,
    
    CASE 
        WHEN mass IS NULL OR lower(mass) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(mass, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS mass_kg,
    
    -- Calculate BMI if both height and mass are available
    CASE
        WHEN height IS NOT NULL AND mass IS NOT NULL 
             AND NULLIF(REGEXP_REPLACE(height, '[^0-9\.]', '', 'g'), '') != ''
             AND NULLIF(REGEXP_REPLACE(mass, '[^0-9\.]', '', 'g'), '') != ''
             AND height::NUMERIC > 0
        THEN (NULLIF(REGEXP_REPLACE(mass, '[^0-9\.]', '', 'g'), '')::NUMERIC) / 
             POWER((NULLIF(REGEXP_REPLACE(height, '[^0-9\.]', '', 'g'), '')::NUMERIC / 100), 2)
        ELSE NULL
    END AS bmi,
    
    -- Character physical attributes with standardized colors
    LOWER(COALESCE(hair_color, 'unknown')) AS hair_color,
    LOWER(COALESCE(skin_color, 'unknown')) AS skin_color,
    LOWER(COALESCE(eye_color, 'unknown')) AS eye_color,
    birth_year,
    LOWER(COALESCE(gender, 'unknown')) AS gender,
    
    -- Force-user related fields with expanded detection
    CASE
        -- Check film appearances
        WHEN films @> '[{"title": "Return of the Jedi"}]' 
             OR films @> '[{"title": "The Empire Strikes Back"}]'
             OR films @> '[{"title": "Revenge of the Sith"}]'
        -- Explicit Jedi/Sith list
        OR LOWER(name) IN ('luke skywalker', 'darth vader', 'obi-wan kenobi', 'yoda', 
                          'emperor palpatine', 'count dooku', 'qui-gon jinn', 'mace windu',
                          'rey', 'kylo ren')
        THEN TRUE
        ELSE FALSE
    END AS force_sensitive,
    
    -- Force rating for known powerful force users
    CASE
        WHEN LOWER(name) IN ('yoda', 'emperor palpatine', 'darth vader', 'luke skywalker') THEN 5
        WHEN LOWER(name) IN ('obi-wan kenobi', 'mace windu', 'kylo ren', 'rey') THEN 4
        WHEN LOWER(name) IN ('qui-gon jinn', 'count dooku') THEN 3
        WHEN force_sensitive THEN 2
        ELSE NULL
    END AS force_rating,
    
    -- Entity counts with error handling
    COALESCE(jsonb_array_length(starships), 0) AS ships_piloted,
    COALESCE(jsonb_array_length(vehicles), 0) AS vehicles_operated,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    films,
    starships,
    vehicles,
    
    -- Era classification
    CASE
        WHEN films @> '[{"title": "The Phantom Menace"}]' 
             OR films @> '[{"title": "Attack of the Clones"}]'
             OR films @> '[{"title": "Revenge of the Sith"}]'
        THEN 'Prequel Era'
        WHEN films @> '[{"title": "A New Hope"}]'
             OR films @> '[{"title": "The Empire Strikes Back"}]'
             OR films @> '[{"title": "Return of the Jedi"}]'
        THEN 'Original Trilogy Era'
        WHEN films @> '[{"title": "The Force Awakens"}]'
             OR films @> '[{"title": "The Last Jedi"}]'
        THEN 'Sequel Era'
        ELSE 'Unknown Era'
    END AS character_era,
    
    -- API metadata with proper handling
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking fields
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:37:59.891177 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m09:37:59.886614 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "AS"
LINE 34:         TRY_CAST(residents AS jsonb) AS residents,
                                    ^

[0m09:37:59.892926 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_planets: ROLLBACK
[0m09:37:59.892374 [debug] [Thread-4 (]: SQL status: BEGIN in 0.091 seconds
[0m09:37:59.893282 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "raw.people" does not exist
LINE 41:     FROM "nerd_facts"."raw"."people"
                  ^

[0m09:37:59.894639 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_people: ROLLBACK
[0m09:37:59.893657 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_planets: Close
[0m09:37:59.895545 [debug] [Thread-3 (]: Database Error in model stg_swapi_planets (models/staging/swapi/stg_swapi_planets.sql)
  syntax error at or near "AS"
  LINE 34:         TRY_CAST(residents AS jsonb) AS residents,
                                      ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_planets.sql
[0m09:37:59.896000 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3354c9e2-65b3-4b0a-ac7a-a9284122545c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83129c1f0>]}
[0m09:37:59.893988 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_species"
[0m09:37:59.897585 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_species"} */

  create view "nerd_facts"."public"."stg_swapi_species__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_species
  Description: Standardizes Star Wars species data from SWAPI
  Source: raw.swapi_species
  
  Notes:
  - Numeric fields are cleaned and converted to proper types
  - Color fields are parsed for analysis
  - Homeworld references are extracted
  - Additional derived fields help with species classification
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        classification,
        designation,
        average_height,
        average_lifespan,
        eye_colors,
        hair_colors,
        skin_colors,
        homeworld,
        language,
        TRY_CAST(people AS jsonb) AS people,
        TRY_CAST(films AS jsonb) AS films,
        created,
        edited,
        CURRENT_TIMESTAMP AS _loaded_at
    FROM "nerd_facts"."raw"."species"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name AS species_name,
    
    -- Species classification
    LOWER(COALESCE(classification, 'unknown')) AS classification,
    LOWER(COALESCE(designation, 'unknown')) AS designation,
    
    -- Physical characteristics with proper typing
    CASE 
        WHEN average_height IS NULL OR LOWER(average_height) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(average_height, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS average_height_cm,
    
    CASE 
        WHEN average_lifespan IS NULL OR LOWER(average_lifespan) = 'unknown' 
            OR LOWER(average_lifespan) = 'indefinite' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(average_lifespan, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS average_lifespan_years,
    
    -- Special case for indefinite lifespan
    CASE 
        WHEN LOWER(average_lifespan) = 'indefinite' THEN TRUE
        ELSE FALSE
    END AS has_indefinite_lifespan,
    
    -- Language
    LOWER(COALESCE(language, 'unknown')) AS language,
    
    -- Color attributes - standardized to arrays
    CASE 
        WHEN eye_colors IS NULL OR eye_colors = '' THEN NULL
        ELSE STRING_TO_ARRAY(LOWER(eye_colors), ', ') 
    END AS eye_colors_array,
    
    CASE 
        WHEN hair_colors IS NULL OR hair_colors = '' THEN NULL
        ELSE STRING_TO_ARRAY(LOWER(hair_colors), ', ') 
    END AS hair_colors_array,
    
    CASE 
        WHEN skin_colors IS NULL OR skin_colors = '' THEN NULL
        ELSE STRING_TO_ARRAY(LOWER(skin_colors), ', ') 
    END AS skin_colors_array,
    
    -- Extract homeworld with error handling
    CASE
        WHEN homeworld IS NULL THEN NULL
        WHEN homeworld = 'null' THEN NULL
        ELSE NULLIF(SPLIT_PART(homeworld->>'url', '/', 6), '')
    END AS homeworld_id,
    
    -- Entity counts
    COALESCE(jsonb_array_length(people), 0) AS character_count,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    people,
    films,
    
    -- Derived species classifications
    CASE
        WHEN LOWER(classification) IN ('mammal', 'amphibian', 'reptile', 'bird') THEN TRUE
        ELSE FALSE
    END AS is_organic,
    
    CASE
        WHEN LOWER(classification) = 'artificial' OR LOWER(name) = 'droid' THEN TRUE
        ELSE FALSE
    END AS is_artificial,
    
    -- Intelligence estimation (approximate)
    CASE
        WHEN LOWER(designation) = 'sentient' THEN 'High'
        WHEN LOWER(designation) = 'semi-sentient' THEN 'Moderate'
        ELSE 'Unknown'
    END AS intelligence_level,
    
    -- Longevity classification
    CASE
        WHEN LOWER(average_lifespan) = 'indefinite' THEN 'Immortal'
        WHEN average_lifespan::NUMERIC > 500 THEN 'Very Long-Lived'
        WHEN average_lifespan::NUMERIC > 100 THEN 'Long-Lived'
        WHEN average_lifespan::NUMERIC > 70 THEN 'Standard'
        WHEN average_lifespan::NUMERIC > 0 THEN 'Short-Lived'
        ELSE 'Unknown'
    END AS longevity_class,
    
    -- Notable species flag
    CASE
        WHEN name IN ('Human', 'Wookiee', 'Droid', 'Hutt', 'Ewok', 'Gungan', 
                     'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yoda\'s species') 
        THEN TRUE
        ELSE FALSE
    END AS is_notable_species,
    
    -- API metadata
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking fields
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:37:59.897094 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_people: Close
[0m09:37:59.898820 [debug] [Thread-2 (]: Database Error in model stg_swapi_people (models/staging/swapi/stg_swapi_people.sql)
  relation "raw.people" does not exist
  LINE 41:     FROM "nerd_facts"."raw"."people"
                    ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_people.sql
[0m09:37:59.899335 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3354c9e2-65b3-4b0a-ac7a-a9284122545c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc823c654e0>]}
[0m09:37:59.896542 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_swapi_planets .................. [[31mERROR[0m in 0.18s]
[0m09:37:59.894319 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m09:37:59.901009 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "AS"
LINE 35:         TRY_CAST(people AS jsonb) AS people,
                                 ^

[0m09:37:59.902242 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_species: ROLLBACK
[0m09:37:59.901483 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_planets
[0m09:37:59.901916 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_starships: BEGIN
[0m09:37:59.902713 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_vehicles
[0m09:37:59.904212 [info ] [Thread-3 (]: 6 of 6 START sql view model public.stg_swapi_vehicles .......................... [RUN]
[0m09:37:59.903128 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_planets' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_planets (models/staging/swapi/stg_swapi_planets.sql)
  syntax error at or near "AS"
  LINE 34:         TRY_CAST(residents AS jsonb) AS residents,
                                      ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_planets.sql.
[0m09:37:59.903514 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_species: Close
[0m09:37:59.903800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:37:59.904700 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_planets, now model.nerd_facts_dbt.stg_swapi_vehicles)
[0m09:37:59.905972 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_vehicles
[0m09:37:59.899951 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_swapi_people ................... [[31mERROR[0m in 0.18s]
[0m09:37:59.911427 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_swapi_people
[0m09:37:59.911879 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_people' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_people (models/staging/swapi/stg_swapi_people.sql)
  relation "raw.people" does not exist
  LINE 41:     FROM "nerd_facts"."raw"."people"
                    ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_people.sql.
[0m09:37:59.910090 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:37:59.910883 [debug] [Thread-4 (]: Database Error in model stg_swapi_species (models/staging/swapi/stg_swapi_species.sql)
  syntax error at or near "AS"
  LINE 35:         TRY_CAST(people AS jsonb) AS people,
                                   ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_species.sql
[0m09:37:59.912631 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3354c9e2-65b3-4b0a-ac7a-a9284122545c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc823ccbc40>]}
[0m09:37:59.913076 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_vehicles
[0m09:37:59.919656 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:37:59.913601 [error] [Thread-4 (]: 4 of 6 ERROR creating sql view model public.stg_swapi_species .................. [[31mERROR[0m in 0.19s]
[0m09:37:59.920339 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi_species
[0m09:37:59.920822 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_species' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_species (models/staging/swapi/stg_swapi_species.sql)
  syntax error at or near "AS"
  LINE 35:         TRY_CAST(people AS jsonb) AS people,
                                   ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_species.sql.
[0m09:37:59.921405 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m09:37:59.921815 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:37:59.922190 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m09:37:59.922521 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: BEGIN
[0m09:37:59.922942 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */

  create view "nerd_facts"."public"."stg_swapi_starships__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_starships
  Description: Standardizes Star Wars starship data from SWAPI
  Source: raw.swapi_starships
  
  Notes:
  - Numeric fields are cleaned and converted to proper types
  - Speeds and capacities have proper error handling
  - Pilot and film references are extracted as counts
  - Additional derived fields help with starship classification
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        model,
        manufacturer,
        cost_in_credits,
        length,
        max_atmosphering_speed,
        crew,
        passengers,
        cargo_capacity,
        consumables,
        hyperdrive_rating,
        MGLT,
        starship_class,
        pilots,
        films,
        created,
        edited,
        url
    FROM raw.swapi_starships
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name AS starship_name,
    model,
    manufacturer,
    starship_class,
    
    -- Technical specifications with improved error handling
    CASE 
        WHEN lower(cost_in_credits) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(cost_in_credits, '[^0-9]', '', 'g'), '')::NUMERIC
    END AS cost_in_credits,
    
    CASE 
        WHEN lower(length) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(length, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS length_m,
    
    CASE 
        WHEN lower(max_atmosphering_speed) = 'unknown' THEN NULL
        WHEN lower(max_atmosphering_speed) = 'n/a' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '[^0-9]+.*', '', 'g'), '')::INTEGER 
    END AS max_speed,
    
    CASE
        WHEN lower(hyperdrive_rating) = 'unknown' THEN NULL
        WHEN lower(hyperdrive_rating) = 'n/a' THEN NULL
        ELSE NULLIF(hyperdrive_rating, '')::NUMERIC
    END AS hyperdrive_rating,
    
    CASE
        WHEN lower(MGLT) = 'unknown' THEN NULL
        WHEN lower(MGLT) = 'n/a' THEN NULL
        ELSE NULLIF(MGLT, '')::INTEGER
    END AS mglt,
    
    -- Capacity information
    NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER AS crew_count,
    NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER AS passenger_capacity,
    
    CASE 
        WHEN lower(cargo_capacity) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(cargo_capacity, '[^0-9]', '', 'g'), '')::NUMERIC
    END AS cargo_capacity,
    
    consumables,
    
    -- Entity counts with error handling
    COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    pilots,
    films,
    
    -- Derived ship classification
    CASE
        WHEN lower(starship_class) IN ('corvette', 'frigate', 'star destroyer', 'dreadnought')
            OR lower(name) LIKE '%star destroyer%' THEN 'Military'
        WHEN lower(starship_class) IN ('transport', 'freighter', 'yacht') 
            OR lower(name) LIKE '%transport%' THEN 'Commercial'
        WHEN lower(starship_class) IN ('starfighter', 'bomber', 'assault ship')
            OR lower(name) LIKE '%fighter%' THEN 'Starfighter'
        ELSE 'Other'
    END AS ship_purpose,
    
    -- Size classification
    CASE
        WHEN length::NUMERIC < 30 THEN 'Small'
        WHEN length::NUMERIC < 100 THEN 'Medium'
        WHEN length::NUMERIC < 500 THEN 'Large'
        WHEN length::NUMERIC < 1000 THEN 'Very Large'
        WHEN length::NUMERIC >= 1000 THEN 'Capital'
        ELSE 'Unknown'
    END AS ship_size,
    
    -- Notable ship flag
    CASE
        WHEN name IN ('Millennium Falcon', 'Death Star', 'Star Destroyer', 
                     'X-wing', 'TIE Advanced x1', 'Executor', 'Slave 1') 
        THEN TRUE
        ELSE FALSE
    END AS is_notable_ship,
    
    -- Total capacity (crew + passengers)
    COALESCE(
        NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER, 0
    ) + 
    COALESCE(
        NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER, 0
    ) AS total_capacity,
    
    -- API metadata
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking field
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:37:59.923435 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:37:59.924685 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function jsonb_array_length(text) does not exist
LINE 96:     COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m09:37:59.925056 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_starships: ROLLBACK
[0m09:37:59.925522 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_starships: Close
[0m09:37:59.928701 [debug] [Thread-1 (]: Database Error in model stg_swapi_starships (models/staging/swapi/stg_swapi_starships.sql)
  function jsonb_array_length(text) does not exist
  LINE 96:     COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_starships.sql
[0m09:37:59.929448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3354c9e2-65b3-4b0a-ac7a-a9284122545c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8321149d0>]}
[0m09:37:59.930015 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model public.stg_swapi_starships ................ [[31mERROR[0m in 0.09s]
[0m09:37:59.930577 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_swapi_starships
[0m09:37:59.931058 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_starships' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_starships (models/staging/swapi/stg_swapi_starships.sql)
  function jsonb_array_length(text) does not exist
  LINE 96:     COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_starships.sql.
[0m09:37:59.937537 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m09:37:59.937925 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:37:59.938359 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_vehicles"} */

  create view "nerd_facts"."public"."stg_swapi_vehicles__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_vehicles
  Description: Standardizes Star Wars vehicle data from SWAPI
  Source: raw.swapi_vehicles
  
  Notes:
  - Numeric fields are cleaned and converted to proper types
  - Speeds and capacities have proper error handling
  - Pilot and film references are extracted as counts
  - Additional derived fields help with vehicle classification
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        model,
        manufacturer,
        NULLIF(cost_in_credits, 'unknown') AS cost_in_credits,
        NULLIF(length, 'unknown') AS length,
        NULLIF(max_atmosphering_speed, 'unknown') AS max_atmosphering_speed,
        NULLIF(crew, 'unknown') AS crew,
        NULLIF(passengers, 'unknown') AS passengers,
        NULLIF(cargo_capacity, 'unknown') AS cargo_capacity,
        consumables,
        vehicle_class,
        TRY_CAST(pilots AS jsonb) AS pilots,
        TRY_CAST(films AS jsonb) AS films,
        created,
        edited,
        CURRENT_TIMESTAMP AS _loaded_at
    FROM "nerd_facts"."raw"."vehicles"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name AS vehicle_name,
    model,
    manufacturer,
    vehicle_class,
    
    -- Technical specifications with proper error handling
    CASE 
        WHEN lower(cost_in_credits) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(cost_in_credits, '[^0-9]', '', 'g'), '')::NUMERIC
    END AS cost_in_credits,
    
    CASE 
        WHEN lower(length) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(length, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS length_m,
    
    CASE 
        WHEN lower(max_atmosphering_speed) = 'unknown' THEN NULL
        WHEN lower(max_atmosphering_speed) = 'n/a' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '[^0-9]+.*', '', 'g'), '')::INTEGER 
    END AS max_speed,
    
    -- Capacity information with proper type conversion
    CASE 
        WHEN lower(crew) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER
    END AS crew_count,
    
    CASE 
        WHEN lower(passengers) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER
    END AS passenger_capacity,
    
    CASE 
        WHEN lower(cargo_capacity) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(cargo_capacity, '[^0-9]', '', 'g'), '')::NUMERIC
    END AS cargo_capacity,
    
    consumables,
    
    -- Entity counts with error handling
    COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    pilots,
    films,
    
    -- Derived vehicle classifications
    CASE
        WHEN lower(vehicle_class) IN ('assault', 'combat', 'battle') 
             OR lower(name) LIKE '%fighter%' 
             OR lower(name) LIKE '%tank%'
             OR lower(name) LIKE '%cannon%' THEN 'Military'
        WHEN lower(vehicle_class) IN ('transport', 'cargo', 'container') 
             OR lower(name) LIKE '%transport%'
             OR lower(name) LIKE '%freighter%' THEN 'Transport'
        WHEN lower(vehicle_class) IN ('speeder', 'airspeeder', 'swoop', 'landspeeder') 
             OR lower(name) LIKE '%speeder%' THEN 'Personal'
        ELSE 'Other'
    END AS vehicle_purpose,
    
    -- Size classification
    CASE
        WHEN length IS NULL THEN 'Unknown'
        WHEN length::NUMERIC < 10 THEN 'Small'
        WHEN length::NUMERIC < 25 THEN 'Medium'
        WHEN length::NUMERIC < 100 THEN 'Large'
        ELSE 'Very Large'
    END AS vehicle_size,
    
    -- Terrain capability
    CASE
        WHEN lower(vehicle_class) LIKE '%walker%' 
             OR lower(name) LIKE '%walker%' THEN 'Ground Only'
        WHEN lower(vehicle_class) LIKE '%speeder%'
             OR lower(name) LIKE '%speeder%' THEN 'Ground & Low Altitude'
        WHEN lower(vehicle_class) LIKE '%airspeeder%'
             OR lower(name) LIKE '%airspeeder%' THEN 'Aerial'
        ELSE 'Unknown'
    END AS terrain_capability,
    
    -- Notable vehicle flag
    CASE
        WHEN name IN ('AT-AT', 'AT-ST', 'Snowspeeder', 'Speeder bike',
                     'Sand Crawler', 'TIE bomber', 'Imperial Speeder Bike') 
        THEN TRUE
        ELSE FALSE
    END AS is_notable_vehicle,
    
    -- Total capacity (crew + passengers)
    COALESCE(
        NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER, 0
    ) + 
    COALESCE(
        NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER, 0
    ) AS total_capacity,
    
    -- API metadata
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking fields
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:37:59.939218 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "AS"
LINE 36:         TRY_CAST(pilots AS jsonb) AS pilots,
                                 ^

[0m09:37:59.939597 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: ROLLBACK
[0m09:37:59.940085 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: Close
[0m09:37:59.942159 [debug] [Thread-3 (]: Database Error in model stg_swapi_vehicles (models/staging/swapi/stg_swapi_vehicles.sql)
  syntax error at or near "AS"
  LINE 36:         TRY_CAST(pilots AS jsonb) AS pilots,
                                   ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_vehicles.sql
[0m09:37:59.942668 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3354c9e2-65b3-4b0a-ac7a-a9284122545c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83319b190>]}
[0m09:37:59.943312 [error] [Thread-3 (]: 6 of 6 ERROR creating sql view model public.stg_swapi_vehicles ................. [[31mERROR[0m in 0.04s]
[0m09:37:59.943884 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_vehicles
[0m09:37:59.944295 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_vehicles' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_vehicles (models/staging/swapi/stg_swapi_vehicles.sql)
  syntax error at or near "AS"
  LINE 36:         TRY_CAST(pilots AS jsonb) AS pilots,
                                   ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_vehicles.sql.
[0m09:37:59.945413 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:59.945759 [debug] [MainThread]: On master: BEGIN
[0m09:37:59.945997 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:37:59.958390 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:37:59.958861 [debug] [MainThread]: On master: COMMIT
[0m09:37:59.959194 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:59.959439 [debug] [MainThread]: On master: COMMIT
[0m09:37:59.959756 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:37:59.960009 [debug] [MainThread]: On master: Close
[0m09:37:59.960471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:37:59.960705 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_starships' was properly closed.
[0m09:37:59.960903 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_people' was properly closed.
[0m09:37:59.961091 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_vehicles' was properly closed.
[0m09:37:59.961274 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_species' was properly closed.
[0m09:37:59.961592 [info ] [MainThread]: 
[0m09:37:59.962059 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m09:37:59.963183 [debug] [MainThread]: Command end result
[0m09:38:00.003780 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m09:38:00.005546 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m09:38:00.011397 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m09:38:00.011868 [info ] [MainThread]: 
[0m09:38:00.012311 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m09:38:00.012620 [info ] [MainThread]: 
[0m09:38:00.012938 [error] [MainThread]:   Database Error in model stg_swapi_films (models/staging/swapi/stg_swapi_films.sql)
  syntax error at or near "AS"
  LINE 30:         TRY_CAST(characters AS jsonb) AS characters,
                                       ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_films.sql
[0m09:38:00.013198 [info ] [MainThread]: 
[0m09:38:00.013506 [error] [MainThread]:   Database Error in model stg_swapi_planets (models/staging/swapi/stg_swapi_planets.sql)
  syntax error at or near "AS"
  LINE 34:         TRY_CAST(residents AS jsonb) AS residents,
                                      ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_planets.sql
[0m09:38:00.013779 [info ] [MainThread]: 
[0m09:38:00.014061 [error] [MainThread]:   Database Error in model stg_swapi_people (models/staging/swapi/stg_swapi_people.sql)
  relation "raw.people" does not exist
  LINE 41:     FROM "nerd_facts"."raw"."people"
                    ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_people.sql
[0m09:38:00.014302 [info ] [MainThread]: 
[0m09:38:00.014578 [error] [MainThread]:   Database Error in model stg_swapi_species (models/staging/swapi/stg_swapi_species.sql)
  syntax error at or near "AS"
  LINE 35:         TRY_CAST(people AS jsonb) AS people,
                                   ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_species.sql
[0m09:38:00.014859 [info ] [MainThread]: 
[0m09:38:00.015146 [error] [MainThread]:   Database Error in model stg_swapi_starships (models/staging/swapi/stg_swapi_starships.sql)
  function jsonb_array_length(text) does not exist
  LINE 96:     COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_starships.sql
[0m09:38:00.015390 [info ] [MainThread]: 
[0m09:38:00.015671 [error] [MainThread]:   Database Error in model stg_swapi_vehicles (models/staging/swapi/stg_swapi_vehicles.sql)
  syntax error at or near "AS"
  LINE 36:         TRY_CAST(pilots AS jsonb) AS pilots,
                                   ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_vehicles.sql
[0m09:38:00.015932 [info ] [MainThread]: 
[0m09:38:00.016188 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m09:38:00.016940 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5797119, "process_in_blocks": "104", "process_kernel_time": 0.120734, "process_mem_max_rss": "119652", "process_out_blocks": "7624", "process_user_time": 2.420776}
[0m09:38:00.017394 [debug] [MainThread]: Command `dbt run` failed at 09:38:00.017308 after 1.58 seconds
[0m09:38:00.017747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8330789a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc830ba9450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc832f14340>]}
[0m09:38:00.018069 [debug] [MainThread]: Flushing usage events
[0m09:38:00.508991 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:43:50.533893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a96548940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9739d990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9739d930>]}


============================== 09:43:50.535963 | a4093926-145f-4bb8-89cc-28668c9031f8 ==============================
[0m09:43:50.535963 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:43:50.536398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models staging.swapi.*', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:43:50.663867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4093926-145f-4bb8-89cc-28668c9031f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a955f7c40>]}
[0m09:43:50.711703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4093926-145f-4bb8-89cc-28668c9031f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a973c4430>]}
[0m09:43:50.712386 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:43:50.791510 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:43:50.926447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m09:43:50.927451 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/swapi/stg_swapi_starships.sql
[0m09:43:50.928039 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/swapi/stg_swapi_vehicles.sql
[0m09:43:50.928491 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/swapi/stg_swapi_planets.sql
[0m09:43:50.928947 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/swapi/stg_swapi_films.sql
[0m09:43:50.929370 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/swapi/stg_swapi_species.sql
[0m09:43:51.520411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4093926-145f-4bb8-89cc-28668c9031f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a946213f0>]}
[0m09:43:51.630397 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m09:43:51.632581 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m09:43:51.646266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4093926-145f-4bb8-89cc-28668c9031f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a94c90820>]}
[0m09:43:51.646802 [info ] [MainThread]: Found 36 models, 38 data tests, 18 sources, 630 macros
[0m09:43:51.647153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4093926-145f-4bb8-89cc-28668c9031f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a94c91db0>]}
[0m09:43:51.649158 [info ] [MainThread]: 
[0m09:43:51.649497 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:43:51.649760 [info ] [MainThread]: 
[0m09:43:51.650159 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:43:51.654354 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m09:43:51.682635 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m09:43:51.683027 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m09:43:51.683284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:43:51.696530 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m09:43:51.697611 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m09:43:51.700490 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_public)
[0m09:43:51.706016 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m09:43:51.706347 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m09:43:51.706589 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:43:51.719003 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m09:43:51.719392 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m09:43:51.719657 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:43:51.722410 [debug] [ThreadPool]: SQL status: SELECT 104 in 0.002 seconds
[0m09:43:51.724698 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m09:43:51.725102 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m09:43:51.743282 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:51.743695 [debug] [MainThread]: On master: BEGIN
[0m09:43:51.743945 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:43:51.756598 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:43:51.757051 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:51.757451 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:43:51.765100 [debug] [MainThread]: SQL status: SELECT 34 in 0.007 seconds
[0m09:43:51.770780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4093926-145f-4bb8-89cc-28668c9031f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a94bcdc30>]}
[0m09:43:51.771212 [debug] [MainThread]: On master: ROLLBACK
[0m09:43:51.771658 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:51.771963 [debug] [MainThread]: On master: BEGIN
[0m09:43:51.772447 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:43:51.772744 [debug] [MainThread]: On master: COMMIT
[0m09:43:51.773040 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:51.773318 [debug] [MainThread]: On master: COMMIT
[0m09:43:51.773699 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:43:51.773992 [debug] [MainThread]: On master: Close
[0m09:43:51.777703 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_swapi_films
[0m09:43:51.778286 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_swapi_films ............................. [RUN]
[0m09:43:51.778907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.stg_swapi_films)
[0m09:43:51.780274 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_films
[0m09:43:51.779654 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_planets
[0m09:43:51.790202 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_swapi_planets ........................... [RUN]
[0m09:43:51.791057 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_planets'
[0m09:43:51.789663 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_films"
[0m09:43:51.791399 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_planets
[0m09:43:51.795489 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m09:43:51.779290 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_swapi_people
[0m09:43:51.779963 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi_species
[0m09:43:51.796167 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_planets
[0m09:43:51.796660 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_swapi_people ............................ [RUN]
[0m09:43:51.797268 [info ] [Thread-4 (]: 4 of 6 START sql view model public.stg_swapi_species ........................... [RUN]
[0m09:43:51.832950 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_species'
[0m09:43:51.824715 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_people'
[0m09:43:51.832351 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m09:43:51.833352 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_species
[0m09:43:51.838351 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_species"
[0m09:43:51.833780 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_people
[0m09:43:51.797874 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_swapi_films
[0m09:43:51.843334 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_people"
[0m09:43:51.843853 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi_species
[0m09:43:51.850246 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_films"
[0m09:43:51.855962 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m09:43:51.856567 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_species"
[0m09:43:51.858244 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_species"
[0m09:43:51.858944 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_species: BEGIN
[0m09:43:51.859254 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:43:51.858615 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_films"
[0m09:43:51.857087 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_swapi_people
[0m09:43:51.857628 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_planets: BEGIN
[0m09:43:51.868074 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:43:51.860207 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_films: BEGIN
[0m09:43:51.869551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:51.872173 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_people"
[0m09:43:51.879960 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m09:43:51.880616 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_people: BEGIN
[0m09:43:51.881092 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:43:51.896369 [debug] [Thread-4 (]: SQL status: BEGIN in 0.037 seconds
[0m09:43:51.896934 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_species"
[0m09:43:51.897594 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_species"} */

  create view "nerd_facts"."public"."stg_swapi_species__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_species
  Description: Standardizes Star Wars species data from SWAPI
  Source: raw.swapi_species
  
  Notes:
  - Numeric fields are cleaned and converted to proper types
  - Color fields are parsed for analysis
  - Homeworld references are extracted
  - Additional derived fields help with species classification
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        classification,
        designation,
        average_height,
        average_lifespan,
        eye_colors,
        hair_colors,
        skin_colors,
        homeworld,
        language,
        CASE WHEN people IS NULL OR people = '' THEN NULL::jsonb ELSE people::jsonb END AS people,
        CASE WHEN films IS NULL OR films = '' THEN NULL::jsonb ELSE films::jsonb END AS films,
        created,
        edited,
        CURRENT_TIMESTAMP AS _loaded_at
    FROM "nerd_facts"."raw"."species"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name AS species_name,
    
    -- Species classification
    LOWER(COALESCE(classification, 'unknown')) AS classification,
    LOWER(COALESCE(designation, 'unknown')) AS designation,
    
    -- Physical characteristics with proper typing
    CASE 
        WHEN average_height IS NULL OR LOWER(average_height) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(average_height, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS average_height_cm,
    
    CASE 
        WHEN average_lifespan IS NULL OR LOWER(average_lifespan) = 'unknown' 
            OR LOWER(average_lifespan) = 'indefinite' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(average_lifespan, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS average_lifespan_years,
    
    -- Special case for indefinite lifespan
    CASE 
        WHEN LOWER(average_lifespan) = 'indefinite' THEN TRUE
        ELSE FALSE
    END AS has_indefinite_lifespan,
    
    -- Language
    LOWER(COALESCE(language, 'unknown')) AS language,
    
    -- Color attributes - standardized to arrays
    CASE 
        WHEN eye_colors IS NULL OR eye_colors = '' THEN NULL
        ELSE STRING_TO_ARRAY(LOWER(eye_colors), ', ') 
    END AS eye_colors_array,
    
    CASE 
        WHEN hair_colors IS NULL OR hair_colors = '' THEN NULL
        ELSE STRING_TO_ARRAY(LOWER(hair_colors), ', ') 
    END AS hair_colors_array,
    
    CASE 
        WHEN skin_colors IS NULL OR skin_colors = '' THEN NULL
        ELSE STRING_TO_ARRAY(LOWER(skin_colors), ', ') 
    END AS skin_colors_array,
    
    -- Extract homeworld with error handling
    CASE
        WHEN homeworld IS NULL THEN NULL
        WHEN homeworld = 'null' THEN NULL
        ELSE NULLIF(SPLIT_PART(homeworld->>'url', '/', 6), '')
    END AS homeworld_id,
    
    -- Entity counts
    COALESCE(jsonb_array_length(people), 0) AS character_count,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    people,
    films,
    
    -- Derived species classifications
    CASE
        WHEN LOWER(classification) IN ('mammal', 'amphibian', 'reptile', 'bird') THEN TRUE
        ELSE FALSE
    END AS is_organic,
    
    CASE
        WHEN LOWER(classification) = 'artificial' OR LOWER(name) = 'droid' THEN TRUE
        ELSE FALSE
    END AS is_artificial,
    
    -- Intelligence estimation (approximate)
    CASE
        WHEN LOWER(designation) = 'sentient' THEN 'High'
        WHEN LOWER(designation) = 'semi-sentient' THEN 'Moderate'
        ELSE 'Unknown'
    END AS intelligence_level,
    
    -- Longevity classification
    CASE
        WHEN LOWER(average_lifespan) = 'indefinite' THEN 'Immortal'
        WHEN average_lifespan::NUMERIC > 500 THEN 'Very Long-Lived'
        WHEN average_lifespan::NUMERIC > 100 THEN 'Long-Lived'
        WHEN average_lifespan::NUMERIC > 70 THEN 'Standard'
        WHEN average_lifespan::NUMERIC > 0 THEN 'Short-Lived'
        ELSE 'Unknown'
    END AS longevity_class,
    
    -- Notable species flag
    CASE
        WHEN name IN ('Human', 'Wookiee', 'Droid', 'Hutt', 'Ewok', 'Gungan', 
                     'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yoda\'s species') 
        THEN TRUE
        ELSE FALSE
    END AS is_notable_species,
    
    -- API metadata
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking fields
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:43:51.898840 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m09:43:51.899263 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m09:43:51.899834 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */

  create view "nerd_facts"."public"."stg_swapi_planets__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_planets
  Description: Standardizes Star Wars planet data from SWAPI
  Source: raw.swapi_planets
  
  Notes:
  - Numeric fields are cleaned and converted to proper types
  - Population is handled with appropriate NULL values
  - Derived planet classifications are added for analysis
  - Climate and terrain are standardized for consistency
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        rotation_period,
        orbital_period,
        diameter,
        climate,
        gravity,
        terrain,
        surface_water,
        population,
        CASE WHEN residents IS NULL OR residents = '' THEN NULL::jsonb ELSE residents::jsonb END AS residents,
        CASE WHEN films IS NULL OR films = '' THEN NULL::jsonb ELSE films::jsonb END AS films,
        created,
        edited,
        CURRENT_TIMESTAMP AS _loaded_at
    FROM "nerd_facts"."raw"."planets"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name AS planet_name,  -- Fixed typo from "panet_name"
    
    -- Physical characteristics with proper typing
    CASE 
        WHEN rotation_period IS NULL OR lower(rotation_period) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(rotation_period, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS rotation_period,
    
    CASE 
        WHEN orbital_period IS NULL OR lower(orbital_period) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(orbital_period, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS orbital_period,
    
    CASE 
        WHEN diameter IS NULL OR lower(diameter) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(diameter, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS diameter,
    
    -- Environment attributes
    LOWER(COALESCE(climate, 'unknown')) AS climate,
    LOWER(COALESCE(gravity, 'unknown')) AS gravity,
    LOWER(COALESCE(terrain, 'unknown')) AS terrain,
    
    CASE 
        WHEN surface_water IS NULL OR lower(surface_water) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(surface_water, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS surface_water,
    
    -- Population with proper handling
    CASE 
        WHEN population IS NULL OR lower(population) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(population, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS population,
    
    -- Entity counts
    COALESCE(jsonb_array_length(residents), 0) AS resident_count,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    residents,
    films,
    
    -- Derived classifications
    CASE
        WHEN lower(climate) LIKE '%temperate%' THEN TRUE
        ELSE FALSE
    END AS is_temperate,
    
    CASE
        WHEN lower(terrain) LIKE '%forest%' OR 
             lower(terrain) LIKE '%jungle%' OR
             lower(terrain) LIKE '%grasslands%' THEN TRUE
        ELSE FALSE
    END AS has_vegetation,
    
    CASE
        WHEN lower(terrain) LIKE '%ocean%' OR 
             lower(terrain) LIKE '%water%' OR
             (surface_water IS NOT NULL AND surface_water::NUMERIC > 50) THEN TRUE
        ELSE FALSE
    END AS is_water_world,
    
    CASE
        WHEN lower(terrain) LIKE '%desert%' OR 
             lower(climate) LIKE '%arid%' OR
             (surface_water IS NOT NULL AND surface_water::NUMERIC < 5) THEN TRUE
        ELSE FALSE
    END AS is_desert_world,
    
    -- Planet habitability score (0-100)
    CASE
        WHEN lower(climate) LIKE '%temperate%' THEN
            CASE
                WHEN lower(terrain) LIKE '%forest%' OR 
                     lower(terrain) LIKE '%grasslands%' THEN 90
                ELSE 75
            END
        WHEN lower(climate) LIKE '%tropical%' OR lower(climate) LIKE '%humid%' THEN 65
        WHEN lower(climate) LIKE '%arid%' OR lower(climate) LIKE '%hot%' THEN 35
        WHEN lower(climate) LIKE '%frozen%' OR lower(climate) LIKE '%frigid%' THEN 15
        ELSE 50
    END AS habitability_score,
    
    -- Notable planet flag
    CASE
        WHEN name IN ('Tatooine', 'Alderaan', 'Yavin IV', 'Hoth', 'Dagobah', 
                      'Bespin', 'Endor', 'Naboo', 'Coruscant', 'Kamino', 'Geonosis') 
        THEN TRUE
        ELSE FALSE
    END AS is_notable_planet,
    
    -- API metadata
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking fields
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:43:51.901091 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "raw.planets" does not exist
LINE 39:     FROM "nerd_facts"."raw"."planets"
                  ^

[0m09:43:51.901571 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_planets: ROLLBACK
[0m09:43:51.902200 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "lek"
LINE 136: ...                    'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yod...
                                                               ^

[0m09:43:51.902661 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_species: ROLLBACK
[0m09:43:51.903279 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_planets: Close
[0m09:43:51.906227 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_species: Close
[0m09:43:51.911172 [debug] [Thread-4 (]: Database Error in model stg_swapi_species (models/staging/swapi/stg_swapi_species.sql)
  syntax error at or near "lek"
  LINE 136: ...                    'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yod...
                                                                 ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_species.sql
[0m09:43:51.912393 [debug] [Thread-3 (]: Database Error in model stg_swapi_planets (models/staging/swapi/stg_swapi_planets.sql)
  relation "raw.planets" does not exist
  LINE 39:     FROM "nerd_facts"."raw"."planets"
                    ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_planets.sql
[0m09:43:51.913393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m09:43:51.913873 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_films"
[0m09:43:51.914447 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_films"} */

  create view "nerd_facts"."public"."stg_swapi_films__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_films
  Description: Standardizes Star Wars film data from SWAPI
  Source: raw.swapi_films
  
  Notes:
  - Adds derived fields for easier analysis (release_year, trilogy)
  - Extracts counts from related entities (characters, planets, species)
  - Converts dates to proper DATE types and adds chronological ordering
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        episode_id,
        title,
        director,
        producer,
        release_date,
        opening_crawl,
        -- Replace TRY_CAST with PostgreSQL-friendly safe casting
        CASE WHEN characters IS NULL OR characters = '' THEN NULL::jsonb 
             ELSE characters::jsonb END AS characters,
        CASE WHEN planets IS NULL OR planets = '' THEN NULL::jsonb 
             ELSE planets::jsonb END AS planets,
        CASE WHEN starships IS NULL OR starships = '' THEN NULL::jsonb 
             ELSE starships::jsonb END AS starships,
        CASE WHEN vehicles IS NULL OR vehicles = '' THEN NULL::jsonb 
             ELSE vehicles::jsonb END AS vehicles,
        CASE WHEN species IS NULL OR species = '' THEN NULL::jsonb 
             ELSE species::jsonb END AS species,
        created,
        edited,
        url
    FROM "nerd_facts"."raw"."films"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    episode_id,
    title AS film_title,
    
    -- Creative team
    director,
    producer,
    
    -- Standardize dates and add derived time fields
    CASE 
        WHEN release_date IS NULL OR release_date = '' THEN NULL
        ELSE TO_DATE(release_date, 'YYYY-MM-DD') 
    END AS release_date,
    
    EXTRACT(YEAR FROM TO_DATE(release_date, 'YYYY-MM-DD')) AS release_year,
    
    -- Story elements
    opening_crawl,
    
    -- Derived chronological order (story timeline vs. release order)
    CASE episode_id
        WHEN 1 THEN 1  -- The Phantom Menace
        WHEN 2 THEN 2  -- Attack of the Clones
        WHEN 3 THEN 3  -- Revenge of the Sith
        WHEN 4 THEN 4  -- A New Hope
        WHEN 5 THEN 5  -- Empire Strikes Back
        WHEN 6 THEN 6  -- Return of the Jedi
        WHEN 7 THEN 7  -- The Force Awakens
        WHEN 8 THEN 8  -- The Last Jedi
        WHEN 9 THEN 9  -- The Rise of Skywalker
        ELSE 99        -- Unknown/other
    END AS chronological_order,
    
    -- Trilogy classification
    CASE
        WHEN episode_id BETWEEN 1 AND 3 THEN 'Prequel Trilogy'
        WHEN episode_id BETWEEN 4 AND 6 THEN 'Original Trilogy'
        WHEN episode_id BETWEEN 7 AND 9 THEN 'Sequel Trilogy'
        ELSE 'Anthology'
    END AS trilogy,
    
    -- Entity counts
    COALESCE(jsonb_array_length(characters), 0) AS character_count,
    COALESCE(jsonb_array_length(planets), 0) AS planet_count,
    COALESCE(jsonb_array_length(starships), 0) AS starship_count,
    COALESCE(jsonb_array_length(vehicles), 0) AS vehicle_count,
    COALESCE(jsonb_array_length(species), 0) AS species_count,
    
    -- Word count of opening crawl (approximate)
    ARRAY_LENGTH(STRING_TO_ARRAY(REGEXP_REPLACE(opening_crawl, '\r|\n', ' ', 'g'), ' '), 1) AS opening_crawl_word_count,
    
    -- API metadata with proper handling
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Data tracking
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
ORDER BY episode_id
  );
[0m09:43:51.916791 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4093926-145f-4bb8-89cc-28668c9031f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a96666440>]}
[0m09:43:51.917735 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_swapi_planets .................. [[31mERROR[0m in 0.12s]
[0m09:43:51.918553 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.films" does not exist
LINE 44:     FROM "nerd_facts"."raw"."films"
                  ^

[0m09:43:51.920442 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_films: ROLLBACK
[0m09:43:51.919067 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4093926-145f-4bb8-89cc-28668c9031f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8c126260>]}
[0m09:43:51.919981 [debug] [Thread-2 (]: SQL status: BEGIN in 0.039 seconds
[0m09:43:51.921717 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m09:43:51.922851 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */

  create view "nerd_facts"."public"."stg_swapi_people__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_people
  Description: Standardizes Star Wars character data from SWAPI
  Source: raw.swapi_people
  
  Notes:
  - Species and homeworld are extracted from JSON references
  - Force sensitivity is derived from character appearances and names
  - Physical attributes are cleaned and converted to proper numeric types
  - Additional derived fields are added for character analysis
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        height,
        mass,
        hair_color,
        skin_color,
        eye_color,
        birth_year,
        gender,
        homeworld,
        films,
        species,
        vehicles,
        starships,
        created,
        edited,
        url
    FROM "nerd_facts"."raw"."people"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name,
    
    -- Extract species information with improved error handling
    CASE 
        WHEN species IS NULL OR jsonb_array_length(species) = 0 THEN 'Human'  -- Default to Human if no species
        WHEN jsonb_typeof(species) != 'array' THEN 'Unknown'  -- Handle unexpected JSON type
        ELSE COALESCE(SPLIT_PART(species->0->>'url', '/', 6), 'Unknown')  -- Extract ID from URL
    END AS species,
    
    -- Extract homeworld ID with error handling
    CASE
        WHEN homeworld IS NULL THEN NULL
        WHEN jsonb_typeof(homeworld) != 'object' THEN NULL
        ELSE NULLIF(SPLIT_PART(homeworld->>'url', '/', 6), '')
    END AS homeworld_id,
    
    -- Clean numeric values with comprehensive error handling
    CASE 
        WHEN height IS NULL OR lower(height) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(height, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS height_cm,
    
    CASE 
        WHEN mass IS NULL OR lower(mass) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(mass, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS mass_kg,
    
    -- Calculate BMI if both height and mass are available
    CASE
        WHEN height IS NOT NULL AND mass IS NOT NULL 
             AND NULLIF(REGEXP_REPLACE(height, '[^0-9\.]', '', 'g'), '') != ''
             AND NULLIF(REGEXP_REPLACE(mass, '[^0-9\.]', '', 'g'), '') != ''
             AND height::NUMERIC > 0
        THEN (NULLIF(REGEXP_REPLACE(mass, '[^0-9\.]', '', 'g'), '')::NUMERIC) / 
             POWER((NULLIF(REGEXP_REPLACE(height, '[^0-9\.]', '', 'g'), '')::NUMERIC / 100), 2)
        ELSE NULL
    END AS bmi,
    
    -- Character physical attributes with standardized colors
    LOWER(COALESCE(hair_color, 'unknown')) AS hair_color,
    LOWER(COALESCE(skin_color, 'unknown')) AS skin_color,
    LOWER(COALESCE(eye_color, 'unknown')) AS eye_color,
    birth_year,
    LOWER(COALESCE(gender, 'unknown')) AS gender,
    
    -- Force-user related fields with expanded detection
    CASE
        -- Check film appearances
        WHEN films @> '[{"title": "Return of the Jedi"}]' 
             OR films @> '[{"title": "The Empire Strikes Back"}]'
             OR films @> '[{"title": "Revenge of the Sith"}]'
        -- Explicit Jedi/Sith list
        OR LOWER(name) IN ('luke skywalker', 'darth vader', 'obi-wan kenobi', 'yoda', 
                          'emperor palpatine', 'count dooku', 'qui-gon jinn', 'mace windu',
                          'rey', 'kylo ren')
        THEN TRUE
        ELSE FALSE
    END AS force_sensitive,
    
    -- Force rating for known powerful force users
    CASE
        WHEN LOWER(name) IN ('yoda', 'emperor palpatine', 'darth vader', 'luke skywalker') THEN 5
        WHEN LOWER(name) IN ('obi-wan kenobi', 'mace windu', 'kylo ren', 'rey') THEN 4
        WHEN LOWER(name) IN ('qui-gon jinn', 'count dooku') THEN 3
        WHEN force_sensitive THEN 2
        ELSE NULL
    END AS force_rating,
    
    -- Entity counts with error handling
    COALESCE(jsonb_array_length(starships), 0) AS ships_piloted,
    COALESCE(jsonb_array_length(vehicles), 0) AS vehicles_operated,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    films,
    starships,
    vehicles,
    
    -- Era classification
    CASE
        WHEN films @> '[{"title": "The Phantom Menace"}]' 
             OR films @> '[{"title": "Attack of the Clones"}]'
             OR films @> '[{"title": "Revenge of the Sith"}]'
        THEN 'Prequel Era'
        WHEN films @> '[{"title": "A New Hope"}]'
             OR films @> '[{"title": "The Empire Strikes Back"}]'
             OR films @> '[{"title": "Return of the Jedi"}]'
        THEN 'Original Trilogy Era'
        WHEN films @> '[{"title": "The Force Awakens"}]'
             OR films @> '[{"title": "The Last Jedi"}]'
        THEN 'Sequel Era'
        ELSE 'Unknown Era'
    END AS character_era,
    
    -- API metadata with proper handling
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking fields
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:43:51.922219 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_films: Close
[0m09:43:51.924376 [debug] [Thread-1 (]: Database Error in model stg_swapi_films (models/staging/swapi/stg_swapi_films.sql)
  relation "raw.films" does not exist
  LINE 44:     FROM "nerd_facts"."raw"."films"
                    ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_films.sql
[0m09:43:51.924965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4093926-145f-4bb8-89cc-28668c9031f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a945c1600>]}
[0m09:43:51.919600 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_planets
[0m09:43:51.926266 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_starships
[0m09:43:51.921243 [error] [Thread-4 (]: 4 of 6 ERROR creating sql view model public.stg_swapi_species .................. [[31mERROR[0m in 0.08s]
[0m09:43:51.926784 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_planets' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_planets (models/staging/swapi/stg_swapi_planets.sql)
  relation "raw.planets" does not exist
  LINE 39:     FROM "nerd_facts"."raw"."planets"
                    ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_planets.sql.
[0m09:43:51.927596 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "raw.people" does not exist
LINE 41:     FROM "nerd_facts"."raw"."people"
                  ^

[0m09:43:51.928046 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi_species
[0m09:43:51.925683 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model public.stg_swapi_films .................... [[31mERROR[0m in 0.15s]
[0m09:43:51.930485 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_swapi_films
[0m09:43:51.927225 [info ] [Thread-3 (]: 5 of 6 START sql view model public.stg_swapi_starships ......................... [RUN]
[0m09:43:51.930907 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_planets, now model.nerd_facts_dbt.stg_swapi_starships)
[0m09:43:51.929967 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_species' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_species (models/staging/swapi/stg_swapi_species.sql)
  syntax error at or near "lek"
  LINE 136: ...                    'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yod...
                                                                 ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_species.sql.
[0m09:43:51.931700 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_films' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_films (models/staging/swapi/stg_swapi_films.sql)
  relation "raw.films" does not exist
  LINE 44:     FROM "nerd_facts"."raw"."films"
                    ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_films.sql.
[0m09:43:51.931206 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_starships
[0m09:43:51.934766 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m09:43:51.929126 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_people: ROLLBACK
[0m09:43:51.929540 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi_vehicles
[0m09:43:51.935450 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_starships
[0m09:43:51.936368 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_people: Close
[0m09:43:51.935964 [info ] [Thread-4 (]: 6 of 6 START sql view model public.stg_swapi_vehicles .......................... [RUN]
[0m09:43:51.947083 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_species, now model.nerd_facts_dbt.stg_swapi_vehicles)
[0m09:43:51.947625 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_vehicles
[0m09:43:51.946367 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m09:43:51.952095 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:43:51.953235 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m09:43:51.953922 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: BEGIN
[0m09:43:51.954472 [debug] [Thread-2 (]: Database Error in model stg_swapi_people (models/staging/swapi/stg_swapi_people.sql)
  relation "raw.people" does not exist
  LINE 41:     FROM "nerd_facts"."raw"."people"
                    ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_people.sql
[0m09:43:51.955677 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4093926-145f-4bb8-89cc-28668c9031f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8c149e40>]}
[0m09:43:51.955197 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:43:51.956281 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_swapi_people ................... [[31mERROR[0m in 0.13s]
[0m09:43:51.957092 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_swapi_people
[0m09:43:51.954867 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi_vehicles
[0m09:43:51.957714 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_people' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_people (models/staging/swapi/stg_swapi_people.sql)
  relation "raw.people" does not exist
  LINE 41:     FROM "nerd_facts"."raw"."people"
                    ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_people.sql.
[0m09:43:51.966142 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:43:51.966994 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:43:51.967462 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: BEGIN
[0m09:43:51.967870 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:43:51.980736 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m09:43:51.981359 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m09:43:51.982089 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */

  create view "nerd_facts"."public"."stg_swapi_starships__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_starships
  Description: Standardizes Star Wars starship data from SWAPI
  Source: raw.swapi_starships
  
  Notes:
  - Numeric fields are cleaned and converted to proper types
  - Speeds and capacities have proper error handling
  - Pilot and film references are extracted as counts
  - Additional derived fields help with starship classification
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        model,
        manufacturer,
        cost_in_credits,
        length,
        max_atmosphering_speed,
        crew,
        passengers,
        cargo_capacity,
        consumables,
        hyperdrive_rating,
        MGLT,
        starship_class,
        pilots,
        films,
        created,
        edited,
        url
    FROM raw.swapi_starships
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name AS starship_name,
    model,
    manufacturer,
    starship_class,
    
    -- Technical specifications with improved error handling
    CASE 
        WHEN lower(cost_in_credits) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(cost_in_credits, '[^0-9]', '', 'g'), '')::NUMERIC
    END AS cost_in_credits,
    
    CASE 
        WHEN lower(length) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(length, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS length_m,
    
    CASE 
        WHEN lower(max_atmosphering_speed) = 'unknown' THEN NULL
        WHEN lower(max_atmosphering_speed) = 'n/a' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '[^0-9]+.*', '', 'g'), '')::INTEGER 
    END AS max_speed,
    
    CASE
        WHEN lower(hyperdrive_rating) = 'unknown' THEN NULL
        WHEN lower(hyperdrive_rating) = 'n/a' THEN NULL
        ELSE NULLIF(hyperdrive_rating, '')::NUMERIC
    END AS hyperdrive_rating,
    
    CASE
        WHEN lower(MGLT) = 'unknown' THEN NULL
        WHEN lower(MGLT) = 'n/a' THEN NULL
        ELSE NULLIF(MGLT, '')::INTEGER
    END AS mglt,
    
    -- Capacity information
    NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER AS crew_count,
    NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER AS passenger_capacity,
    
    CASE 
        WHEN lower(cargo_capacity) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(cargo_capacity, '[^0-9]', '', 'g'), '')::NUMERIC
    END AS cargo_capacity,
    
    consumables,
    
    -- Entity counts with error handling
    COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    CASE WHEN pilots IS NULL OR pilots = '' THEN NULL::jsonb ELSE pilots::jsonb END AS pilots,
    CASE WHEN films IS NULL OR films = '' THEN NULL::jsonb ELSE films::jsonb END AS films,
    
    -- Derived ship classification
    CASE
        WHEN lower(starship_class) IN ('corvette', 'frigate', 'star destroyer', 'dreadnought')
            OR lower(name) LIKE '%star destroyer%' THEN 'Military'
        WHEN lower(starship_class) IN ('transport', 'freighter', 'yacht') 
            OR lower(name) LIKE '%transport%' THEN 'Commercial'
        WHEN lower(starship_class) IN ('starfighter', 'bomber', 'assault ship')
            OR lower(name) LIKE '%fighter%' THEN 'Starfighter'
        ELSE 'Other'
    END AS ship_purpose,
    
    -- Size classification
    CASE
        WHEN length::NUMERIC < 30 THEN 'Small'
        WHEN length::NUMERIC < 100 THEN 'Medium'
        WHEN length::NUMERIC < 500 THEN 'Large'
        WHEN length::NUMERIC < 1000 THEN 'Very Large'
        WHEN length::NUMERIC >= 1000 THEN 'Capital'
        ELSE 'Unknown'
    END AS ship_size,
    
    -- Notable ship flag
    CASE
        WHEN name IN ('Millennium Falcon', 'Death Star', 'Star Destroyer', 
                     'X-wing', 'TIE Advanced x1', 'Executor', 'Slave 1') 
        THEN TRUE
        ELSE FALSE
    END AS is_notable_ship,
    
    -- Total capacity (crew + passengers)
    COALESCE(
        NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER, 0
    ) + 
    COALESCE(
        NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER, 0
    ) AS total_capacity,
    
    -- API metadata
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking field
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:43:51.983986 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function jsonb_array_length(text) does not exist
LINE 96:     COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m09:43:51.984492 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: ROLLBACK
[0m09:43:51.985131 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: Close
[0m09:43:51.988735 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m09:43:51.989419 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:43:51.990099 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_vehicles"} */

  create view "nerd_facts"."public"."stg_swapi_vehicles__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_vehicles
  Description: Standardizes Star Wars vehicle data from SWAPI
  Source: raw.swapi_vehicles
  
  Notes:
  - Numeric fields are cleaned and converted to proper types
  - Speeds and capacities have proper error handling
  - Pilot and film references are extracted as counts
  - Additional derived fields help with vehicle classification
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        model,
        manufacturer,
        NULLIF(cost_in_credits, 'unknown') AS cost_in_credits,
        NULLIF(length, 'unknown') AS length,
        NULLIF(max_atmosphering_speed, 'unknown') AS max_atmosphering_speed,
        NULLIF(crew, 'unknown') AS crew,
        NULLIF(passengers, 'unknown') AS passengers,
        NULLIF(cargo_capacity, 'unknown') AS cargo_capacity,
        consumables,
        vehicle_class,
        CASE WHEN pilots IS NULL OR pilots = '' THEN NULL::jsonb ELSE pilots::jsonb END AS pilots,
        CASE WHEN films IS NULL OR films = '' THEN NULL::jsonb ELSE films::jsonb END AS films,
        created,
        edited,
        CURRENT_TIMESTAMP AS _loaded_at
    FROM "nerd_facts"."raw"."vehicles"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name AS vehicle_name,
    model,
    manufacturer,
    vehicle_class,
    
    -- Technical specifications with proper error handling
    CASE 
        WHEN lower(cost_in_credits) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(cost_in_credits, '[^0-9]', '', 'g'), '')::NUMERIC
    END AS cost_in_credits,
    
    CASE 
        WHEN lower(length) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(length, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS length_m,
    
    CASE 
        WHEN lower(max_atmosphering_speed) = 'unknown' THEN NULL
        WHEN lower(max_atmosphering_speed) = 'n/a' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '[^0-9]+.*', '', 'g'), '')::INTEGER 
    END AS max_speed,
    
    -- Capacity information with proper type conversion
    CASE 
        WHEN lower(crew) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER
    END AS crew_count,
    
    CASE 
        WHEN lower(passengers) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER
    END AS passenger_capacity,
    
    CASE 
        WHEN lower(cargo_capacity) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(cargo_capacity, '[^0-9]', '', 'g'), '')::NUMERIC
    END AS cargo_capacity,
    
    consumables,
    
    -- Entity counts with error handling
    COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    pilots,
    films,
    
    -- Derived vehicle classifications
    CASE
        WHEN lower(vehicle_class) IN ('assault', 'combat', 'battle') 
             OR lower(name) LIKE '%fighter%' 
             OR lower(name) LIKE '%tank%'
             OR lower(name) LIKE '%cannon%' THEN 'Military'
        WHEN lower(vehicle_class) IN ('transport', 'cargo', 'container') 
             OR lower(name) LIKE '%transport%'
             OR lower(name) LIKE '%freighter%' THEN 'Transport'
        WHEN lower(vehicle_class) IN ('speeder', 'airspeeder', 'swoop', 'landspeeder') 
             OR lower(name) LIKE '%speeder%' THEN 'Personal'
        ELSE 'Other'
    END AS vehicle_purpose,
    
    -- Size classification
    CASE
        WHEN length IS NULL THEN 'Unknown'
        WHEN length::NUMERIC < 10 THEN 'Small'
        WHEN length::NUMERIC < 25 THEN 'Medium'
        WHEN length::NUMERIC < 100 THEN 'Large'
        ELSE 'Very Large'
    END AS vehicle_size,
    
    -- Terrain capability
    CASE
        WHEN lower(vehicle_class) LIKE '%walker%' 
             OR lower(name) LIKE '%walker%' THEN 'Ground Only'
        WHEN lower(vehicle_class) LIKE '%speeder%'
             OR lower(name) LIKE '%speeder%' THEN 'Ground & Low Altitude'
        WHEN lower(vehicle_class) LIKE '%airspeeder%'
             OR lower(name) LIKE '%airspeeder%' THEN 'Aerial'
        ELSE 'Unknown'
    END AS terrain_capability,
    
    -- Notable vehicle flag
    CASE
        WHEN name IN ('AT-AT', 'AT-ST', 'Snowspeeder', 'Speeder bike',
                     'Sand Crawler', 'TIE bomber', 'Imperial Speeder Bike') 
        THEN TRUE
        ELSE FALSE
    END AS is_notable_vehicle,
    
    -- Total capacity (crew + passengers)
    COALESCE(
        NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER, 0
    ) + 
    COALESCE(
        NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER, 0
    ) AS total_capacity,
    
    -- API metadata
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking fields
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:43:51.991444 [debug] [Thread-3 (]: Database Error in model stg_swapi_starships (models/staging/swapi/stg_swapi_starships.sql)
  function jsonb_array_length(text) does not exist
  LINE 96:     COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_starships.sql
[0m09:43:51.991839 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "raw.vehicles" does not exist
LINE 41:     FROM "nerd_facts"."raw"."vehicles"
                  ^

[0m09:43:51.992313 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4093926-145f-4bb8-89cc-28668c9031f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a96666440>]}
[0m09:43:51.992678 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: ROLLBACK
[0m09:43:51.993321 [error] [Thread-3 (]: 5 of 6 ERROR creating sql view model public.stg_swapi_starships ................ [[31mERROR[0m in 0.06s]
[0m09:43:51.993979 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: Close
[0m09:43:51.995634 [debug] [Thread-4 (]: Database Error in model stg_swapi_vehicles (models/staging/swapi/stg_swapi_vehicles.sql)
  relation "raw.vehicles" does not exist
  LINE 41:     FROM "nerd_facts"."raw"."vehicles"
                    ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_vehicles.sql
[0m09:43:51.996365 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4093926-145f-4bb8-89cc-28668c9031f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8c1171f0>]}
[0m09:43:51.994451 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_starships
[0m09:43:51.997994 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_starships' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_starships (models/staging/swapi/stg_swapi_starships.sql)
  function jsonb_array_length(text) does not exist
  LINE 96:     COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_starships.sql.
[0m09:43:51.997099 [error] [Thread-4 (]: 6 of 6 ERROR creating sql view model public.stg_swapi_vehicles ................. [[31mERROR[0m in 0.05s]
[0m09:43:51.998725 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi_vehicles
[0m09:43:51.999191 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_vehicles' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_vehicles (models/staging/swapi/stg_swapi_vehicles.sql)
  relation "raw.vehicles" does not exist
  LINE 41:     FROM "nerd_facts"."raw"."vehicles"
                    ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_vehicles.sql.
[0m09:43:52.000355 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:52.000657 [debug] [MainThread]: On master: BEGIN
[0m09:43:52.000915 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:43:52.013514 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:43:52.013971 [debug] [MainThread]: On master: COMMIT
[0m09:43:52.014322 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:52.014641 [debug] [MainThread]: On master: COMMIT
[0m09:43:52.015050 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:43:52.015362 [debug] [MainThread]: On master: Close
[0m09:43:52.015986 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:43:52.016341 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_films' was properly closed.
[0m09:43:52.016671 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_starships' was properly closed.
[0m09:43:52.016979 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_people' was properly closed.
[0m09:43:52.017271 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_vehicles' was properly closed.
[0m09:43:52.017757 [info ] [MainThread]: 
[0m09:43:52.018240 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m09:43:52.019516 [debug] [MainThread]: Command end result
[0m09:43:52.110188 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m09:43:52.111760 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m09:43:52.118632 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m09:43:52.119079 [info ] [MainThread]: 
[0m09:43:52.119494 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m09:43:52.119837 [info ] [MainThread]: 
[0m09:43:52.120218 [error] [MainThread]:   Database Error in model stg_swapi_planets (models/staging/swapi/stg_swapi_planets.sql)
  relation "raw.planets" does not exist
  LINE 39:     FROM "nerd_facts"."raw"."planets"
                    ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_planets.sql
[0m09:43:52.120543 [info ] [MainThread]: 
[0m09:43:52.120910 [error] [MainThread]:   Database Error in model stg_swapi_species (models/staging/swapi/stg_swapi_species.sql)
  syntax error at or near "lek"
  LINE 136: ...                    'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yod...
                                                                 ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_species.sql
[0m09:43:52.121245 [info ] [MainThread]: 
[0m09:43:52.121633 [error] [MainThread]:   Database Error in model stg_swapi_films (models/staging/swapi/stg_swapi_films.sql)
  relation "raw.films" does not exist
  LINE 44:     FROM "nerd_facts"."raw"."films"
                    ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_films.sql
[0m09:43:52.121957 [info ] [MainThread]: 
[0m09:43:52.122313 [error] [MainThread]:   Database Error in model stg_swapi_people (models/staging/swapi/stg_swapi_people.sql)
  relation "raw.people" does not exist
  LINE 41:     FROM "nerd_facts"."raw"."people"
                    ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_people.sql
[0m09:43:52.122616 [info ] [MainThread]: 
[0m09:43:52.122994 [error] [MainThread]:   Database Error in model stg_swapi_starships (models/staging/swapi/stg_swapi_starships.sql)
  function jsonb_array_length(text) does not exist
  LINE 96:     COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_starships.sql
[0m09:43:52.123314 [info ] [MainThread]: 
[0m09:43:52.123684 [error] [MainThread]:   Database Error in model stg_swapi_vehicles (models/staging/swapi/stg_swapi_vehicles.sql)
  relation "raw.vehicles" does not exist
  LINE 41:     FROM "nerd_facts"."raw"."vehicles"
                    ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_vehicles.sql
[0m09:43:52.123984 [info ] [MainThread]: 
[0m09:43:52.124311 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m09:43:52.125109 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6356797, "process_in_blocks": "152", "process_kernel_time": 0.095772, "process_mem_max_rss": "118420", "process_out_blocks": "7656", "process_user_time": 2.477436}
[0m09:43:52.125518 [debug] [MainThread]: Command `dbt run` failed at 09:43:52.125434 after 1.64 seconds
[0m09:43:52.125839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a96548940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a94793a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8f3752d0>]}
[0m09:43:52.126208 [debug] [MainThread]: Flushing usage events
[0m09:43:52.629830 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:50:58.612665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d26294940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d252477f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d25247850>]}


============================== 09:50:58.615070 | 0e7625e9-cdf4-489f-a197-f75dd9dd7945 ==============================
[0m09:50:58.615070 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:50:58.615601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models staging.swapi.*', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:50:58.756289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e7625e9-cdf4-489f-a197-f75dd9dd7945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2533fc40>]}
[0m09:50:58.809287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e7625e9-cdf4-489f-a197-f75dd9dd7945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2710c430>]}
[0m09:50:58.810104 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:50:58.892127 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:50:59.019197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:50:59.020659 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/swapi/swapi_sources.yml
[0m09:50:59.617591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e7625e9-cdf4-489f-a197-f75dd9dd7945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d23ca8a00>]}
[0m09:50:59.711772 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m09:50:59.713979 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m09:50:59.727988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e7625e9-cdf4-489f-a197-f75dd9dd7945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d23c7c970>]}
[0m09:50:59.728548 [info ] [MainThread]: Found 36 models, 38 data tests, 18 sources, 630 macros
[0m09:50:59.728884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e7625e9-cdf4-489f-a197-f75dd9dd7945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d23c7d1b0>]}
[0m09:50:59.731047 [info ] [MainThread]: 
[0m09:50:59.731410 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:50:59.731672 [info ] [MainThread]: 
[0m09:50:59.732072 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:50:59.736178 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m09:50:59.764084 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m09:50:59.764514 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m09:50:59.764799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:59.777978 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m09:50:59.779111 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m09:50:59.783842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_public)
[0m09:50:59.789335 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m09:50:59.789703 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m09:50:59.789948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:59.802267 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m09:50:59.802725 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m09:50:59.803073 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:50:59.805788 [debug] [ThreadPool]: SQL status: SELECT 104 in 0.002 seconds
[0m09:50:59.808177 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m09:50:59.808607 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m09:50:59.824887 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:59.825237 [debug] [MainThread]: On master: BEGIN
[0m09:50:59.825510 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:50:59.837852 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:50:59.838221 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:59.838515 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:50:59.846095 [debug] [MainThread]: SQL status: SELECT 34 in 0.007 seconds
[0m09:50:59.850780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e7625e9-cdf4-489f-a197-f75dd9dd7945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d23d71c60>]}
[0m09:50:59.851162 [debug] [MainThread]: On master: ROLLBACK
[0m09:50:59.851633 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:59.851902 [debug] [MainThread]: On master: BEGIN
[0m09:50:59.852418 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:50:59.852689 [debug] [MainThread]: On master: COMMIT
[0m09:50:59.852930 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:59.853151 [debug] [MainThread]: On master: COMMIT
[0m09:50:59.853462 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:50:59.853699 [debug] [MainThread]: On master: Close
[0m09:50:59.856465 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_swapi_films
[0m09:50:59.857017 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_swapi_films ............................. [RUN]
[0m09:50:59.857511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.stg_swapi_films)
[0m09:50:59.857822 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_films
[0m09:50:59.864514 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_films"
[0m09:50:59.864928 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_swapi_people
[0m09:50:59.865264 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_planets
[0m09:50:59.865573 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi_species
[0m09:50:59.867243 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_swapi_films
[0m09:50:59.866090 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_swapi_people ............................ [RUN]
[0m09:50:59.883474 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_people'
[0m09:50:59.866895 [info ] [Thread-4 (]: 4 of 6 START sql view model public.stg_swapi_species ........................... [RUN]
[0m09:50:59.866530 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_swapi_planets ........................... [RUN]
[0m09:50:59.899061 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_planets'
[0m09:50:59.898520 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_species'
[0m09:50:59.897996 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_films"
[0m09:50:59.899407 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_planets
[0m09:50:59.903017 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m09:50:59.899701 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_species
[0m09:50:59.889065 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_people
[0m09:50:59.903619 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_planets
[0m09:50:59.906918 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_species"
[0m09:50:59.955302 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_people"
[0m09:50:59.956027 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_films"
[0m09:50:59.962708 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_films: BEGIN
[0m09:50:59.963352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:50:59.961627 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m09:50:59.963049 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi_species
[0m09:50:59.962327 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_swapi_people
[0m09:50:59.977502 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_people"
[0m09:50:59.978441 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m09:50:59.978912 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m09:50:59.980425 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_species"
[0m09:50:59.981028 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_planets: BEGIN
[0m09:50:59.981953 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:50:59.982540 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_species"
[0m09:50:59.981461 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_films"
[0m09:50:59.983512 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_species: BEGIN
[0m09:50:59.985028 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:50:59.984757 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m09:50:59.984155 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_films"} */

  create view "nerd_facts"."public"."stg_swapi_films__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_films
  Description: Standardizes Star Wars film data from SWAPI
  Source: raw.swapi_films
  
  Notes:
  - Adds derived fields for easier analysis (release_year, trilogy)
  - Extracts counts from related entities (characters, planets, species)
  - Converts dates to proper DATE types and adds chronological ordering
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        episode_id,
        title,
        director,
        producer,
        release_date,
        opening_crawl,
        -- Replace TRY_CAST with PostgreSQL-friendly safe casting
        CASE WHEN characters IS NULL OR characters = '' THEN NULL::jsonb 
             ELSE characters::jsonb END AS characters,
        CASE WHEN planets IS NULL OR planets = '' THEN NULL::jsonb 
             ELSE planets::jsonb END AS planets,
        CASE WHEN starships IS NULL OR starships = '' THEN NULL::jsonb 
             ELSE starships::jsonb END AS starships,
        CASE WHEN vehicles IS NULL OR vehicles = '' THEN NULL::jsonb 
             ELSE vehicles::jsonb END AS vehicles,
        CASE WHEN species IS NULL OR species = '' THEN NULL::jsonb 
             ELSE species::jsonb END AS species,
        created,
        edited,
        url
    FROM "nerd_facts"."raw"."swapi_films"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    episode_id,
    title AS film_title,
    
    -- Creative team
    director,
    producer,
    
    -- Standardize dates and add derived time fields
    CASE 
        WHEN release_date IS NULL OR release_date = '' THEN NULL
        ELSE TO_DATE(release_date, 'YYYY-MM-DD') 
    END AS release_date,
    
    EXTRACT(YEAR FROM TO_DATE(release_date, 'YYYY-MM-DD')) AS release_year,
    
    -- Story elements
    opening_crawl,
    
    -- Derived chronological order (story timeline vs. release order)
    CASE episode_id
        WHEN 1 THEN 1  -- The Phantom Menace
        WHEN 2 THEN 2  -- Attack of the Clones
        WHEN 3 THEN 3  -- Revenge of the Sith
        WHEN 4 THEN 4  -- A New Hope
        WHEN 5 THEN 5  -- Empire Strikes Back
        WHEN 6 THEN 6  -- Return of the Jedi
        WHEN 7 THEN 7  -- The Force Awakens
        WHEN 8 THEN 8  -- The Last Jedi
        WHEN 9 THEN 9  -- The Rise of Skywalker
        ELSE 99        -- Unknown/other
    END AS chronological_order,
    
    -- Trilogy classification
    CASE
        WHEN episode_id BETWEEN 1 AND 3 THEN 'Prequel Trilogy'
        WHEN episode_id BETWEEN 4 AND 6 THEN 'Original Trilogy'
        WHEN episode_id BETWEEN 7 AND 9 THEN 'Sequel Trilogy'
        ELSE 'Anthology'
    END AS trilogy,
    
    -- Entity counts
    COALESCE(jsonb_array_length(characters), 0) AS character_count,
    COALESCE(jsonb_array_length(planets), 0) AS planet_count,
    COALESCE(jsonb_array_length(starships), 0) AS starship_count,
    COALESCE(jsonb_array_length(vehicles), 0) AS vehicle_count,
    COALESCE(jsonb_array_length(species), 0) AS species_count,
    
    -- Word count of opening crawl (approximate)
    ARRAY_LENGTH(STRING_TO_ARRAY(REGEXP_REPLACE(opening_crawl, '\r|\n', ' ', 'g'), ' '), 1) AS opening_crawl_word_count,
    
    -- API metadata with proper handling
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Data tracking
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
ORDER BY episode_id
  );
[0m09:50:59.986489 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_people: BEGIN
[0m09:50:59.987613 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "characters" does not exist
LINE 31:         CASE WHEN characters IS NULL OR characters = '' THEN...
                           ^

[0m09:50:59.993943 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_films: ROLLBACK
[0m09:50:59.993544 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:50:59.994445 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_films: Close
[0m09:50:59.996387 [debug] [Thread-1 (]: Database Error in model stg_swapi_films (models/staging/swapi/stg_swapi_films.sql)
  column "characters" does not exist
  LINE 31:         CASE WHEN characters IS NULL OR characters = '' THEN...
                             ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_films.sql
[0m09:51:00.000614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e7625e9-cdf4-489f-a197-f75dd9dd7945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d26544460>]}
[0m09:51:00.001824 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model public.stg_swapi_films .................... [[31mERROR[0m in 0.14s]
[0m09:51:00.003084 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_swapi_films
[0m09:51:00.003500 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_swapi_starships
[0m09:51:00.002529 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m09:51:00.005458 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_films' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_films (models/staging/swapi/stg_swapi_films.sql)
  column "characters" does not exist
  LINE 31:         CASE WHEN characters IS NULL OR characters = '' THEN...
                             ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_films.sql.
[0m09:51:00.010096 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m09:51:00.013026 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m09:51:00.014141 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_species"
[0m09:51:00.014759 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */

  create view "nerd_facts"."public"."stg_swapi_planets__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_planets
  Description: Standardizes Star Wars planet data from SWAPI
  Source: raw.swapi_planets
  
  Notes:
  - Numeric fields are cleaned and converted to proper types
  - Population is handled with appropriate NULL values
  - Derived planet classifications are added for analysis
  - Climate and terrain are standardized for consistency
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        rotation_period,
        orbital_period,
        diameter,
        climate,
        gravity,
        terrain,
        surface_water,
        population,
        CASE WHEN residents IS NULL OR residents = '' THEN NULL::jsonb ELSE residents::jsonb END AS residents,
        CASE WHEN films IS NULL OR films = '' THEN NULL::jsonb ELSE films::jsonb END AS films,
        created,
        edited,
        CURRENT_TIMESTAMP AS _loaded_at
    FROM "nerd_facts"."raw"."swapi_planets"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name AS planet_name,  -- Fixed typo from "panet_name"
    
    -- Physical characteristics with proper typing
    CASE 
        WHEN rotation_period IS NULL OR lower(rotation_period) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(rotation_period, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS rotation_period,
    
    CASE 
        WHEN orbital_period IS NULL OR lower(orbital_period) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(orbital_period, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS orbital_period,
    
    CASE 
        WHEN diameter IS NULL OR lower(diameter) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(diameter, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS diameter,
    
    -- Environment attributes
    LOWER(COALESCE(climate, 'unknown')) AS climate,
    LOWER(COALESCE(gravity, 'unknown')) AS gravity,
    LOWER(COALESCE(terrain, 'unknown')) AS terrain,
    
    CASE 
        WHEN surface_water IS NULL OR lower(surface_water) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(surface_water, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS surface_water,
    
    -- Population with proper handling
    CASE 
        WHEN population IS NULL OR lower(population) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(population, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS population,
    
    -- Entity counts
    COALESCE(jsonb_array_length(residents), 0) AS resident_count,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    residents,
    films,
    
    -- Derived classifications
    CASE
        WHEN lower(climate) LIKE '%temperate%' THEN TRUE
        ELSE FALSE
    END AS is_temperate,
    
    CASE
        WHEN lower(terrain) LIKE '%forest%' OR 
             lower(terrain) LIKE '%jungle%' OR
             lower(terrain) LIKE '%grasslands%' THEN TRUE
        ELSE FALSE
    END AS has_vegetation,
    
    CASE
        WHEN lower(terrain) LIKE '%ocean%' OR 
             lower(terrain) LIKE '%water%' OR
             (surface_water IS NOT NULL AND surface_water::NUMERIC > 50) THEN TRUE
        ELSE FALSE
    END AS is_water_world,
    
    CASE
        WHEN lower(terrain) LIKE '%desert%' OR 
             lower(climate) LIKE '%arid%' OR
             (surface_water IS NOT NULL AND surface_water::NUMERIC < 5) THEN TRUE
        ELSE FALSE
    END AS is_desert_world,
    
    -- Planet habitability score (0-100)
    CASE
        WHEN lower(climate) LIKE '%temperate%' THEN
            CASE
                WHEN lower(terrain) LIKE '%forest%' OR 
                     lower(terrain) LIKE '%grasslands%' THEN 90
                ELSE 75
            END
        WHEN lower(climate) LIKE '%tropical%' OR lower(climate) LIKE '%humid%' THEN 65
        WHEN lower(climate) LIKE '%arid%' OR lower(climate) LIKE '%hot%' THEN 35
        WHEN lower(climate) LIKE '%frozen%' OR lower(climate) LIKE '%frigid%' THEN 15
        ELSE 50
    END AS habitability_score,
    
    -- Notable planet flag
    CASE
        WHEN name IN ('Tatooine', 'Alderaan', 'Yavin IV', 'Hoth', 'Dagobah', 
                      'Bespin', 'Endor', 'Naboo', 'Coruscant', 'Kamino', 'Geonosis') 
        THEN TRUE
        ELSE FALSE
    END AS is_notable_planet,
    
    -- API metadata
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking fields
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:51:00.004007 [info ] [Thread-1 (]: 5 of 6 START sql view model public.stg_swapi_starships ......................... [RUN]
[0m09:51:00.016703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_films, now model.nerd_facts_dbt.stg_swapi_starships)
[0m09:51:00.017633 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_starships
[0m09:51:00.017250 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "residents" does not exist
LINE 34:         CASE WHEN residents IS NULL OR residents = '' THEN N...
                           ^

[0m09:51:00.015811 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_species"} */

  create view "nerd_facts"."public"."stg_swapi_species__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_species
  Description: Standardizes Star Wars species data from SWAPI
  Source: raw.swapi_species
  
  Notes:
  - Numeric fields are cleaned and converted to proper types
  - Color fields are parsed for analysis
  - Homeworld references are extracted
  - Additional derived fields help with species classification
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        classification,
        designation,
        average_height,
        average_lifespan,
        eye_colors,
        hair_colors,
        skin_colors,
        homeworld,
        language,
        CASE WHEN people IS NULL OR people = '' THEN NULL::jsonb ELSE people::jsonb END AS people,
        CASE WHEN films IS NULL OR films = '' THEN NULL::jsonb ELSE films::jsonb END AS films,
        created,
        edited,
        CURRENT_TIMESTAMP AS _loaded_at
    FROM "nerd_facts"."raw"."swapi_species"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name AS species_name,
    
    -- Species classification
    LOWER(COALESCE(classification, 'unknown')) AS classification,
    LOWER(COALESCE(designation, 'unknown')) AS designation,
    
    -- Physical characteristics with proper typing
    CASE 
        WHEN average_height IS NULL OR LOWER(average_height) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(average_height, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS average_height_cm,
    
    CASE 
        WHEN average_lifespan IS NULL OR LOWER(average_lifespan) = 'unknown' 
            OR LOWER(average_lifespan) = 'indefinite' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(average_lifespan, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS average_lifespan_years,
    
    -- Special case for indefinite lifespan
    CASE 
        WHEN LOWER(average_lifespan) = 'indefinite' THEN TRUE
        ELSE FALSE
    END AS has_indefinite_lifespan,
    
    -- Language
    LOWER(COALESCE(language, 'unknown')) AS language,
    
    -- Color attributes - standardized to arrays
    CASE 
        WHEN eye_colors IS NULL OR eye_colors = '' THEN NULL
        ELSE STRING_TO_ARRAY(LOWER(eye_colors), ', ') 
    END AS eye_colors_array,
    
    CASE 
        WHEN hair_colors IS NULL OR hair_colors = '' THEN NULL
        ELSE STRING_TO_ARRAY(LOWER(hair_colors), ', ') 
    END AS hair_colors_array,
    
    CASE 
        WHEN skin_colors IS NULL OR skin_colors = '' THEN NULL
        ELSE STRING_TO_ARRAY(LOWER(skin_colors), ', ') 
    END AS skin_colors_array,
    
    -- Extract homeworld with error handling
    CASE
        WHEN homeworld IS NULL THEN NULL
        WHEN homeworld = 'null' THEN NULL
        ELSE NULLIF(SPLIT_PART(homeworld->>'url', '/', 6), '')
    END AS homeworld_id,
    
    -- Entity counts
    COALESCE(jsonb_array_length(people), 0) AS character_count,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    people,
    films,
    
    -- Derived species classifications
    CASE
        WHEN LOWER(classification) IN ('mammal', 'amphibian', 'reptile', 'bird') THEN TRUE
        ELSE FALSE
    END AS is_organic,
    
    CASE
        WHEN LOWER(classification) = 'artificial' OR LOWER(name) = 'droid' THEN TRUE
        ELSE FALSE
    END AS is_artificial,
    
    -- Intelligence estimation (approximate)
    CASE
        WHEN LOWER(designation) = 'sentient' THEN 'High'
        WHEN LOWER(designation) = 'semi-sentient' THEN 'Moderate'
        ELSE 'Unknown'
    END AS intelligence_level,
    
    -- Longevity classification
    CASE
        WHEN LOWER(average_lifespan) = 'indefinite' THEN 'Immortal'
        WHEN average_lifespan::NUMERIC > 500 THEN 'Very Long-Lived'
        WHEN average_lifespan::NUMERIC > 100 THEN 'Long-Lived'
        WHEN average_lifespan::NUMERIC > 70 THEN 'Standard'
        WHEN average_lifespan::NUMERIC > 0 THEN 'Short-Lived'
        ELSE 'Unknown'
    END AS longevity_class,
    
    -- Notable species flag
    CASE
        WHEN name IN ('Human', 'Wookiee', 'Droid', 'Hutt', 'Ewok', 'Gungan', 
                     'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yoda\'s species') 
        THEN TRUE
        ELSE FALSE
    END AS is_notable_species,
    
    -- API metadata
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking fields
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:51:00.017977 [debug] [Thread-2 (]: SQL status: BEGIN in 0.030 seconds
[0m09:51:00.021681 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m09:51:00.022255 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_planets: ROLLBACK
[0m09:51:00.024798 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_planets: Close
[0m09:51:00.023922 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "lek"
LINE 136: ...                    'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yod...
                                                               ^

[0m09:51:00.025509 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_species: ROLLBACK
[0m09:51:00.023341 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m09:51:00.027164 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */

  create view "nerd_facts"."public"."stg_swapi_people__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_people
  Description: Standardizes Star Wars character data from SWAPI
  Source: raw.swapi_people
  
  Notes:
  - Species and homeworld are extracted from JSON references
  - Force sensitivity is derived from character appearances and names
  - Physical attributes are cleaned and converted to proper numeric types
  - Additional derived fields are added for character analysis
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        height,
        mass,
        hair_color,
        skin_color,
        eye_color,
        birth_year,
        gender,
        homeworld,
        films,
        species,
        vehicles,
        starships,
        created,
        edited,
        url
    FROM "nerd_facts"."raw"."swapi_people"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name,
    
    -- Extract species information with improved error handling
    CASE 
        WHEN species IS NULL OR jsonb_array_length(species) = 0 THEN 'Human'  -- Default to Human if no species
        WHEN jsonb_typeof(species) != 'array' THEN 'Unknown'  -- Handle unexpected JSON type
        ELSE COALESCE(SPLIT_PART(species->0->>'url', '/', 6), 'Unknown')  -- Extract ID from URL
    END AS species,
    
    -- Extract homeworld ID with error handling
    CASE
        WHEN homeworld IS NULL THEN NULL
        WHEN jsonb_typeof(homeworld) != 'object' THEN NULL
        ELSE NULLIF(SPLIT_PART(homeworld->>'url', '/', 6), '')
    END AS homeworld_id,
    
    -- Clean numeric values with comprehensive error handling
    CASE 
        WHEN height IS NULL OR lower(height) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(height, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS height_cm,
    
    CASE 
        WHEN mass IS NULL OR lower(mass) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(mass, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS mass_kg,
    
    -- Calculate BMI if both height and mass are available
    CASE
        WHEN height IS NOT NULL AND mass IS NOT NULL 
             AND NULLIF(REGEXP_REPLACE(height, '[^0-9\.]', '', 'g'), '') != ''
             AND NULLIF(REGEXP_REPLACE(mass, '[^0-9\.]', '', 'g'), '') != ''
             AND height::NUMERIC > 0
        THEN (NULLIF(REGEXP_REPLACE(mass, '[^0-9\.]', '', 'g'), '')::NUMERIC) / 
             POWER((NULLIF(REGEXP_REPLACE(height, '[^0-9\.]', '', 'g'), '')::NUMERIC / 100), 2)
        ELSE NULL
    END AS bmi,
    
    -- Character physical attributes with standardized colors
    LOWER(COALESCE(hair_color, 'unknown')) AS hair_color,
    LOWER(COALESCE(skin_color, 'unknown')) AS skin_color,
    LOWER(COALESCE(eye_color, 'unknown')) AS eye_color,
    birth_year,
    LOWER(COALESCE(gender, 'unknown')) AS gender,
    
    -- Force-user related fields with expanded detection
    CASE
        -- Check film appearances
        WHEN films @> '[{"title": "Return of the Jedi"}]' 
             OR films @> '[{"title": "The Empire Strikes Back"}]'
             OR films @> '[{"title": "Revenge of the Sith"}]'
        -- Explicit Jedi/Sith list
        OR LOWER(name) IN ('luke skywalker', 'darth vader', 'obi-wan kenobi', 'yoda', 
                          'emperor palpatine', 'count dooku', 'qui-gon jinn', 'mace windu',
                          'rey', 'kylo ren')
        THEN TRUE
        ELSE FALSE
    END AS force_sensitive,
    
    -- Force rating for known powerful force users
    CASE
        WHEN LOWER(name) IN ('yoda', 'emperor palpatine', 'darth vader', 'luke skywalker') THEN 5
        WHEN LOWER(name) IN ('obi-wan kenobi', 'mace windu', 'kylo ren', 'rey') THEN 4
        WHEN LOWER(name) IN ('qui-gon jinn', 'count dooku') THEN 3
        WHEN force_sensitive THEN 2
        ELSE NULL
    END AS force_rating,
    
    -- Entity counts with error handling
    COALESCE(jsonb_array_length(starships), 0) AS ships_piloted,
    COALESCE(jsonb_array_length(vehicles), 0) AS vehicles_operated,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    films,
    starships,
    vehicles,
    
    -- Era classification
    CASE
        WHEN films @> '[{"title": "The Phantom Menace"}]' 
             OR films @> '[{"title": "Attack of the Clones"}]'
             OR films @> '[{"title": "Revenge of the Sith"}]'
        THEN 'Prequel Era'
        WHEN films @> '[{"title": "A New Hope"}]'
             OR films @> '[{"title": "The Empire Strikes Back"}]'
             OR films @> '[{"title": "Return of the Jedi"}]'
        THEN 'Original Trilogy Era'
        WHEN films @> '[{"title": "The Force Awakens"}]'
             OR films @> '[{"title": "The Last Jedi"}]'
        THEN 'Sequel Era'
        ELSE 'Unknown Era'
    END AS character_era,
    
    -- API metadata with proper handling
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking fields
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:51:00.026256 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_swapi_starships
[0m09:51:00.028432 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_species: Close
[0m09:51:00.037009 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m09:51:00.037498 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "films" does not exist
LINE 34:         films,
                 ^

[0m09:51:00.041774 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_people: ROLLBACK
[0m09:51:00.041219 [debug] [Thread-4 (]: Database Error in model stg_swapi_species (models/staging/swapi/stg_swapi_species.sql)
  syntax error at or near "lek"
  LINE 136: ...                    'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yod...
                                                                 ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_species.sql
[0m09:51:00.040470 [debug] [Thread-3 (]: Database Error in model stg_swapi_planets (models/staging/swapi/stg_swapi_planets.sql)
  column "residents" does not exist
  LINE 34:         CASE WHEN residents IS NULL OR residents = '' THEN N...
                             ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_planets.sql
[0m09:51:00.043734 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e7625e9-cdf4-489f-a197-f75dd9dd7945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d23b38820>]}
[0m09:51:00.043184 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e7625e9-cdf4-489f-a197-f75dd9dd7945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d23b398d0>]}
[0m09:51:00.042619 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_people: Close
[0m09:51:00.046772 [debug] [Thread-2 (]: Database Error in model stg_swapi_people (models/staging/swapi/stg_swapi_people.sql)
  column "films" does not exist
  LINE 34:         films,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_people.sql
[0m09:51:00.047531 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e7625e9-cdf4-489f-a197-f75dd9dd7945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d255fbdc0>]}
[0m09:51:00.044657 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_swapi_planets .................. [[31mERROR[0m in 0.14s]
[0m09:51:00.048921 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_planets
[0m09:51:00.045363 [error] [Thread-4 (]: 4 of 6 ERROR creating sql view model public.stg_swapi_species .................. [[31mERROR[0m in 0.14s]
[0m09:51:00.049398 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_vehicles
[0m09:51:00.049955 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m09:51:00.050373 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_planets' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_planets (models/staging/swapi/stg_swapi_planets.sql)
  column "residents" does not exist
  LINE 34:         CASE WHEN residents IS NULL OR residents = '' THEN N...
                             ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_planets.sql.
[0m09:51:00.048349 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_swapi_people ................... [[31mERROR[0m in 0.16s]
[0m09:51:00.050950 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi_species
[0m09:51:00.051424 [info ] [Thread-3 (]: 6 of 6 START sql view model public.stg_swapi_vehicles .......................... [RUN]
[0m09:51:00.053246 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_planets, now model.nerd_facts_dbt.stg_swapi_vehicles)
[0m09:51:00.052388 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_swapi_people
[0m09:51:00.052846 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_species' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_species (models/staging/swapi/stg_swapi_species.sql)
  syntax error at or near "lek"
  LINE 136: ...                    'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yod...
                                                                 ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_species.sql.
[0m09:51:00.051840 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_starships: BEGIN
[0m09:51:00.054407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:00.054067 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_people' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_people (models/staging/swapi/stg_swapi_people.sql)
  column "films" does not exist
  LINE 34:         films,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_people.sql.
[0m09:51:00.053578 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_vehicles
[0m09:51:00.058062 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:51:00.058638 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_vehicles
[0m09:51:00.064323 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:51:00.065187 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:51:00.065611 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: BEGIN
[0m09:51:00.065916 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:51:00.073036 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m09:51:00.073504 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m09:51:00.073910 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */

  create view "nerd_facts"."public"."stg_swapi_starships__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_starships
  Description: Standardizes Star Wars starship data from SWAPI
  Source: raw.swapi_starships
  
  Notes:
  - Numeric fields are cleaned and converted to proper types
  - Speeds and capacities have proper error handling
  - Pilot and film references are extracted as counts
  - Additional derived fields help with starship classification
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        model,
        manufacturer,
        cost_in_credits,
        length,
        max_atmosphering_speed,
        crew,
        passengers,
        cargo_capacity,
        consumables,
        hyperdrive_rating,
        MGLT,
        starship_class,
        pilots,
        films,
        created,
        edited,
        url
    FROM raw.swapi_starships
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name AS starship_name,
    model,
    manufacturer,
    starship_class,
    
    -- Technical specifications with improved error handling
    CASE 
        WHEN lower(cost_in_credits) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(cost_in_credits, '[^0-9]', '', 'g'), '')::NUMERIC
    END AS cost_in_credits,
    
    CASE 
        WHEN lower(length) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(length, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS length_m,
    
    CASE 
        WHEN lower(max_atmosphering_speed) = 'unknown' THEN NULL
        WHEN lower(max_atmosphering_speed) = 'n/a' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '[^0-9]+.*', '', 'g'), '')::INTEGER 
    END AS max_speed,
    
    CASE
        WHEN lower(hyperdrive_rating) = 'unknown' THEN NULL
        WHEN lower(hyperdrive_rating) = 'n/a' THEN NULL
        ELSE NULLIF(hyperdrive_rating, '')::NUMERIC
    END AS hyperdrive_rating,
    
    CASE
        WHEN lower(MGLT) = 'unknown' THEN NULL
        WHEN lower(MGLT) = 'n/a' THEN NULL
        ELSE NULLIF(MGLT, '')::INTEGER
    END AS mglt,
    
    -- Capacity information
    NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER AS crew_count,
    NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER AS passenger_capacity,
    
    CASE 
        WHEN lower(cargo_capacity) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(cargo_capacity, '[^0-9]', '', 'g'), '')::NUMERIC
    END AS cargo_capacity,
    
    consumables,
    
    -- Entity counts with error handling
    COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    CASE WHEN pilots IS NULL OR pilots = '' THEN NULL::jsonb ELSE pilots::jsonb END AS pilots,
    CASE WHEN films IS NULL OR films = '' THEN NULL::jsonb ELSE films::jsonb END AS films,
    
    -- Derived ship classification
    CASE
        WHEN lower(starship_class) IN ('corvette', 'frigate', 'star destroyer', 'dreadnought')
            OR lower(name) LIKE '%star destroyer%' THEN 'Military'
        WHEN lower(starship_class) IN ('transport', 'freighter', 'yacht') 
            OR lower(name) LIKE '%transport%' THEN 'Commercial'
        WHEN lower(starship_class) IN ('starfighter', 'bomber', 'assault ship')
            OR lower(name) LIKE '%fighter%' THEN 'Starfighter'
        ELSE 'Other'
    END AS ship_purpose,
    
    -- Size classification
    CASE
        WHEN length::NUMERIC < 30 THEN 'Small'
        WHEN length::NUMERIC < 100 THEN 'Medium'
        WHEN length::NUMERIC < 500 THEN 'Large'
        WHEN length::NUMERIC < 1000 THEN 'Very Large'
        WHEN length::NUMERIC >= 1000 THEN 'Capital'
        ELSE 'Unknown'
    END AS ship_size,
    
    -- Notable ship flag
    CASE
        WHEN name IN ('Millennium Falcon', 'Death Star', 'Star Destroyer', 
                     'X-wing', 'TIE Advanced x1', 'Executor', 'Slave 1') 
        THEN TRUE
        ELSE FALSE
    END AS is_notable_ship,
    
    -- Total capacity (crew + passengers)
    COALESCE(
        NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER, 0
    ) + 
    COALESCE(
        NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER, 0
    ) AS total_capacity,
    
    -- API metadata
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking field
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:51:00.075242 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function jsonb_array_length(text) does not exist
LINE 96:     COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m09:51:00.075595 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_starships: ROLLBACK
[0m09:51:00.076009 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_starships: Close
[0m09:51:00.078682 [debug] [Thread-1 (]: Database Error in model stg_swapi_starships (models/staging/swapi/stg_swapi_starships.sql)
  function jsonb_array_length(text) does not exist
  LINE 96:     COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_starships.sql
[0m09:51:00.079433 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m09:51:00.080173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e7625e9-cdf4-489f-a197-f75dd9dd7945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d26544460>]}
[0m09:51:00.080691 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:51:00.081980 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_vehicles"} */

  create view "nerd_facts"."public"."stg_swapi_vehicles__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_vehicles
  Description: Standardizes Star Wars vehicle data from SWAPI
  Source: raw.swapi_vehicles
  
  Notes:
  - Numeric fields are cleaned and converted to proper types
  - Speeds and capacities have proper error handling
  - Pilot and film references are extracted as counts
  - Additional derived fields help with vehicle classification
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        model,
        manufacturer,
        NULLIF(cost_in_credits, 'unknown') AS cost_in_credits,
        NULLIF(length, 'unknown') AS length,
        NULLIF(max_atmosphering_speed, 'unknown') AS max_atmosphering_speed,
        NULLIF(crew, 'unknown') AS crew,
        NULLIF(passengers, 'unknown') AS passengers,
        NULLIF(cargo_capacity, 'unknown') AS cargo_capacity,
        consumables,
        vehicle_class,
        CASE WHEN pilots IS NULL OR pilots = '' THEN NULL::jsonb ELSE pilots::jsonb END AS pilots,
        CASE WHEN films IS NULL OR films = '' THEN NULL::jsonb ELSE films::jsonb END AS films,
        created,
        edited,
        CURRENT_TIMESTAMP AS _loaded_at
    FROM "nerd_facts"."raw"."swapi_vehicles"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name AS vehicle_name,
    model,
    manufacturer,
    vehicle_class,
    
    -- Technical specifications with proper error handling
    CASE 
        WHEN lower(cost_in_credits) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(cost_in_credits, '[^0-9]', '', 'g'), '')::NUMERIC
    END AS cost_in_credits,
    
    CASE 
        WHEN lower(length) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(length, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS length_m,
    
    CASE 
        WHEN lower(max_atmosphering_speed) = 'unknown' THEN NULL
        WHEN lower(max_atmosphering_speed) = 'n/a' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '[^0-9]+.*', '', 'g'), '')::INTEGER 
    END AS max_speed,
    
    -- Capacity information with proper type conversion
    CASE 
        WHEN lower(crew) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER
    END AS crew_count,
    
    CASE 
        WHEN lower(passengers) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER
    END AS passenger_capacity,
    
    CASE 
        WHEN lower(cargo_capacity) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(cargo_capacity, '[^0-9]', '', 'g'), '')::NUMERIC
    END AS cargo_capacity,
    
    consumables,
    
    -- Entity counts with error handling
    COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    pilots,
    films,
    
    -- Derived vehicle classifications
    CASE
        WHEN lower(vehicle_class) IN ('assault', 'combat', 'battle') 
             OR lower(name) LIKE '%fighter%' 
             OR lower(name) LIKE '%tank%'
             OR lower(name) LIKE '%cannon%' THEN 'Military'
        WHEN lower(vehicle_class) IN ('transport', 'cargo', 'container') 
             OR lower(name) LIKE '%transport%'
             OR lower(name) LIKE '%freighter%' THEN 'Transport'
        WHEN lower(vehicle_class) IN ('speeder', 'airspeeder', 'swoop', 'landspeeder') 
             OR lower(name) LIKE '%speeder%' THEN 'Personal'
        ELSE 'Other'
    END AS vehicle_purpose,
    
    -- Size classification
    CASE
        WHEN length IS NULL THEN 'Unknown'
        WHEN length::NUMERIC < 10 THEN 'Small'
        WHEN length::NUMERIC < 25 THEN 'Medium'
        WHEN length::NUMERIC < 100 THEN 'Large'
        ELSE 'Very Large'
    END AS vehicle_size,
    
    -- Terrain capability
    CASE
        WHEN lower(vehicle_class) LIKE '%walker%' 
             OR lower(name) LIKE '%walker%' THEN 'Ground Only'
        WHEN lower(vehicle_class) LIKE '%speeder%'
             OR lower(name) LIKE '%speeder%' THEN 'Ground & Low Altitude'
        WHEN lower(vehicle_class) LIKE '%airspeeder%'
             OR lower(name) LIKE '%airspeeder%' THEN 'Aerial'
        ELSE 'Unknown'
    END AS terrain_capability,
    
    -- Notable vehicle flag
    CASE
        WHEN name IN ('AT-AT', 'AT-ST', 'Snowspeeder', 'Speeder bike',
                     'Sand Crawler', 'TIE bomber', 'Imperial Speeder Bike') 
        THEN TRUE
        ELSE FALSE
    END AS is_notable_vehicle,
    
    -- Total capacity (crew + passengers)
    COALESCE(
        NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER, 0
    ) + 
    COALESCE(
        NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER, 0
    ) AS total_capacity,
    
    -- API metadata
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking fields
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:51:00.081473 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model public.stg_swapi_starships ................ [[31mERROR[0m in 0.06s]
[0m09:51:00.082812 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_swapi_starships
[0m09:51:00.083359 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_starships' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_starships (models/staging/swapi/stg_swapi_starships.sql)
  function jsonb_array_length(text) does not exist
  LINE 96:     COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_starships.sql.
[0m09:51:00.087296 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:51:00.092785 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:51:00.093163 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_vehicles"} */
alter table "nerd_facts"."public"."stg_swapi_vehicles__dbt_tmp" rename to "stg_swapi_vehicles"
[0m09:51:00.094048 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:51:00.106198 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: COMMIT
[0m09:51:00.106643 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:51:00.106985 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: COMMIT
[0m09:51:00.113247 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m09:51:00.119429 [debug] [Thread-3 (]: Applying DROP to: "nerd_facts"."public"."stg_swapi_vehicles__dbt_backup"
[0m09:51:00.122916 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:51:00.123278 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_vehicles"} */
drop view if exists "nerd_facts"."public"."stg_swapi_vehicles__dbt_backup" cascade
[0m09:51:00.123840 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:51:00.125806 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: Close
[0m09:51:00.128247 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e7625e9-cdf4-489f-a197-f75dd9dd7945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d274e6ce0>]}
[0m09:51:00.128861 [info ] [Thread-3 (]: 6 of 6 OK created sql view model public.stg_swapi_vehicles ..................... [[32mCREATE VIEW[0m in 0.07s]
[0m09:51:00.129379 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_vehicles
[0m09:51:00.130542 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:00.130857 [debug] [MainThread]: On master: BEGIN
[0m09:51:00.131097 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:51:00.143624 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:51:00.144042 [debug] [MainThread]: On master: COMMIT
[0m09:51:00.144327 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:00.144572 [debug] [MainThread]: On master: COMMIT
[0m09:51:00.144896 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:51:00.145151 [debug] [MainThread]: On master: Close
[0m09:51:00.145634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:51:00.145883 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_starships' was properly closed.
[0m09:51:00.146089 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_people' was properly closed.
[0m09:51:00.146280 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_species' was properly closed.
[0m09:51:00.146465 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_vehicles' was properly closed.
[0m09:51:00.146778 [info ] [MainThread]: 
[0m09:51:00.147181 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m09:51:00.148253 [debug] [MainThread]: Command end result
[0m09:51:00.187708 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m09:51:00.189335 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m09:51:00.195050 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m09:51:00.195452 [info ] [MainThread]: 
[0m09:51:00.195822 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m09:51:00.196090 [info ] [MainThread]: 
[0m09:51:00.196386 [error] [MainThread]:   Database Error in model stg_swapi_films (models/staging/swapi/stg_swapi_films.sql)
  column "characters" does not exist
  LINE 31:         CASE WHEN characters IS NULL OR characters = '' THEN...
                             ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_films.sql
[0m09:51:00.196636 [info ] [MainThread]: 
[0m09:51:00.196915 [error] [MainThread]:   Database Error in model stg_swapi_planets (models/staging/swapi/stg_swapi_planets.sql)
  column "residents" does not exist
  LINE 34:         CASE WHEN residents IS NULL OR residents = '' THEN N...
                             ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_planets.sql
[0m09:51:00.197169 [info ] [MainThread]: 
[0m09:51:00.197463 [error] [MainThread]:   Database Error in model stg_swapi_species (models/staging/swapi/stg_swapi_species.sql)
  syntax error at or near "lek"
  LINE 136: ...                    'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yod...
                                                                 ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_species.sql
[0m09:51:00.197706 [info ] [MainThread]: 
[0m09:51:00.197974 [error] [MainThread]:   Database Error in model stg_swapi_people (models/staging/swapi/stg_swapi_people.sql)
  column "films" does not exist
  LINE 34:         films,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_people.sql
[0m09:51:00.198204 [info ] [MainThread]: 
[0m09:51:00.198471 [error] [MainThread]:   Database Error in model stg_swapi_starships (models/staging/swapi/stg_swapi_starships.sql)
  function jsonb_array_length(text) does not exist
  LINE 96:     COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_starships.sql
[0m09:51:00.198717 [info ] [MainThread]: 
[0m09:51:00.198980 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=5 SKIP=0 TOTAL=6
[0m09:51:00.199663 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.635151, "process_in_blocks": "16", "process_kernel_time": 0.119727, "process_mem_max_rss": "120488", "process_out_blocks": "7648", "process_user_time": 2.4305}
[0m09:51:00.199983 [debug] [MainThread]: Command `dbt run` failed at 09:51:00.199910 after 1.64 seconds
[0m09:51:00.200266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d26294940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2533fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d26156e00>]}
[0m09:51:00.200566 [debug] [MainThread]: Flushing usage events
[0m09:51:00.690475 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:54:15.116073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76eea5c8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ef8a9900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ef8a98a0>]}


============================== 09:54:15.118639 | cc2df04b-eacd-4a9c-a28a-48441cb7390e ==============================
[0m09:54:15.118639 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:54:15.119107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models staging.swapi.*', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:54:15.259421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc2df04b-eacd-4a9c-a28a-48441cb7390e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ee9217e0>]}
[0m09:54:15.313331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc2df04b-eacd-4a9c-a28a-48441cb7390e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ef8ddc00>]}
[0m09:54:15.314034 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:54:15.392407 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:54:15.524590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:54:15.525366 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/swapi/stg_swapi_films.sql
[0m09:54:15.934890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc2df04b-eacd-4a9c-a28a-48441cb7390e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ed1300d0>]}
[0m09:54:16.038808 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m09:54:16.041042 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m09:54:16.055644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc2df04b-eacd-4a9c-a28a-48441cb7390e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ed157370>]}
[0m09:54:16.056247 [info ] [MainThread]: Found 36 models, 38 data tests, 18 sources, 630 macros
[0m09:54:16.056647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc2df04b-eacd-4a9c-a28a-48441cb7390e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ed1561a0>]}
[0m09:54:16.059210 [info ] [MainThread]: 
[0m09:54:16.059624 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:54:16.059954 [info ] [MainThread]: 
[0m09:54:16.060452 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:54:16.064768 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m09:54:16.105474 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m09:54:16.105931 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m09:54:16.106249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:16.120020 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m09:54:16.121084 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m09:54:16.124703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nerd_facts, now list_nerd_facts_public)
[0m09:54:16.129959 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m09:54:16.130307 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m09:54:16.130547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:54:16.142856 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m09:54:16.143239 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m09:54:16.143504 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:54:16.146251 [debug] [ThreadPool]: SQL status: SELECT 105 in 0.002 seconds
[0m09:54:16.149061 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m09:54:16.149518 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m09:54:16.166983 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:16.167383 [debug] [MainThread]: On master: BEGIN
[0m09:54:16.167627 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:54:16.180668 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:54:16.181061 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:16.181364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:54:16.188629 [debug] [MainThread]: SQL status: SELECT 35 in 0.007 seconds
[0m09:54:16.193671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc2df04b-eacd-4a9c-a28a-48441cb7390e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ec57d5a0>]}
[0m09:54:16.194058 [debug] [MainThread]: On master: ROLLBACK
[0m09:54:16.194484 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:16.194793 [debug] [MainThread]: On master: BEGIN
[0m09:54:16.195326 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:54:16.195591 [debug] [MainThread]: On master: COMMIT
[0m09:54:16.195832 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:16.196051 [debug] [MainThread]: On master: COMMIT
[0m09:54:16.196415 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:54:16.196688 [debug] [MainThread]: On master: Close
[0m09:54:16.200339 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_swapi_films
[0m09:54:16.200769 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_swapi_people
[0m09:54:16.201142 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_planets
[0m09:54:16.201624 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_swapi_films ............................. [RUN]
[0m09:54:16.202020 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi_species
[0m09:54:16.203740 [info ] [Thread-4 (]: 4 of 6 START sql view model public.stg_swapi_species ........................... [RUN]
[0m09:54:16.204172 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_species'
[0m09:54:16.203326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.stg_swapi_films)
[0m09:54:16.204447 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_species
[0m09:54:16.202770 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_swapi_planets ........................... [RUN]
[0m09:54:16.202444 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_swapi_people ............................ [RUN]
[0m09:54:16.213134 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_people'
[0m09:54:16.210884 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_planets'
[0m09:54:16.212624 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_species"
[0m09:54:16.214397 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi_species
[0m09:54:16.204741 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_films
[0m09:54:16.213824 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_planets
[0m09:54:16.213478 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_people
[0m09:54:16.222506 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_films"
[0m09:54:16.226296 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m09:54:16.240923 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_people"
[0m09:54:16.257010 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_species"
[0m09:54:16.257803 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_planets
[0m09:54:16.258335 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_swapi_films
[0m09:54:16.264249 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m09:54:16.264817 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_swapi_people
[0m09:54:16.269925 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_films"
[0m09:54:16.270622 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_species"
[0m09:54:16.276331 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m09:54:16.276641 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_people"
[0m09:54:16.277323 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_planets: BEGIN
[0m09:54:16.277804 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:54:16.277031 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_species: BEGIN
[0m09:54:16.279714 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:54:16.279356 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m09:54:16.280728 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_people: BEGIN
[0m09:54:16.281157 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:54:16.278726 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_films"
[0m09:54:16.281849 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_films: BEGIN
[0m09:54:16.282162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:16.296795 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m09:54:16.297218 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m09:54:16.297659 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */

  create view "nerd_facts"."public"."stg_swapi_planets__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_planets
  Description: Standardizes Star Wars planet data from SWAPI
  Source: raw.swapi_planets
  
  Notes:
  - Numeric fields are cleaned and converted to proper types
  - Population is handled with appropriate NULL values
  - Derived planet classifications are added for analysis
  - Climate and terrain are standardized for consistency
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        rotation_period,
        orbital_period,
        diameter,
        climate,
        gravity,
        terrain,
        surface_water,
        population,
        CASE WHEN residents IS NULL OR residents = '' THEN NULL::jsonb ELSE residents::jsonb END AS residents,
        CASE WHEN films IS NULL OR films = '' THEN NULL::jsonb ELSE films::jsonb END AS films,
        created,
        edited,
        CURRENT_TIMESTAMP AS _loaded_at
    FROM "nerd_facts"."raw"."swapi_planets"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name AS planet_name,  -- Fixed typo from "panet_name"
    
    -- Physical characteristics with proper typing
    CASE 
        WHEN rotation_period IS NULL OR lower(rotation_period) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(rotation_period, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS rotation_period,
    
    CASE 
        WHEN orbital_period IS NULL OR lower(orbital_period) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(orbital_period, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS orbital_period,
    
    CASE 
        WHEN diameter IS NULL OR lower(diameter) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(diameter, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS diameter,
    
    -- Environment attributes
    LOWER(COALESCE(climate, 'unknown')) AS climate,
    LOWER(COALESCE(gravity, 'unknown')) AS gravity,
    LOWER(COALESCE(terrain, 'unknown')) AS terrain,
    
    CASE 
        WHEN surface_water IS NULL OR lower(surface_water) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(surface_water, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS surface_water,
    
    -- Population with proper handling
    CASE 
        WHEN population IS NULL OR lower(population) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(population, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS population,
    
    -- Entity counts
    COALESCE(jsonb_array_length(residents), 0) AS resident_count,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    residents,
    films,
    
    -- Derived classifications
    CASE
        WHEN lower(climate) LIKE '%temperate%' THEN TRUE
        ELSE FALSE
    END AS is_temperate,
    
    CASE
        WHEN lower(terrain) LIKE '%forest%' OR 
             lower(terrain) LIKE '%jungle%' OR
             lower(terrain) LIKE '%grasslands%' THEN TRUE
        ELSE FALSE
    END AS has_vegetation,
    
    CASE
        WHEN lower(terrain) LIKE '%ocean%' OR 
             lower(terrain) LIKE '%water%' OR
             (surface_water IS NOT NULL AND surface_water::NUMERIC > 50) THEN TRUE
        ELSE FALSE
    END AS is_water_world,
    
    CASE
        WHEN lower(terrain) LIKE '%desert%' OR 
             lower(climate) LIKE '%arid%' OR
             (surface_water IS NOT NULL AND surface_water::NUMERIC < 5) THEN TRUE
        ELSE FALSE
    END AS is_desert_world,
    
    -- Planet habitability score (0-100)
    CASE
        WHEN lower(climate) LIKE '%temperate%' THEN
            CASE
                WHEN lower(terrain) LIKE '%forest%' OR 
                     lower(terrain) LIKE '%grasslands%' THEN 90
                ELSE 75
            END
        WHEN lower(climate) LIKE '%tropical%' OR lower(climate) LIKE '%humid%' THEN 65
        WHEN lower(climate) LIKE '%arid%' OR lower(climate) LIKE '%hot%' THEN 35
        WHEN lower(climate) LIKE '%frozen%' OR lower(climate) LIKE '%frigid%' THEN 15
        ELSE 50
    END AS habitability_score,
    
    -- Notable planet flag
    CASE
        WHEN name IN ('Tatooine', 'Alderaan', 'Yavin IV', 'Hoth', 'Dagobah', 
                      'Bespin', 'Endor', 'Naboo', 'Coruscant', 'Kamino', 'Geonosis') 
        THEN TRUE
        ELSE FALSE
    END AS is_notable_planet,
    
    -- API metadata
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking fields
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:54:16.298696 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "residents" does not exist
LINE 34:         CASE WHEN residents IS NULL OR residents = '' THEN N...
                           ^

[0m09:54:16.299037 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_planets: ROLLBACK
[0m09:54:16.299468 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_planets: Close
[0m09:54:16.307754 [debug] [Thread-3 (]: Database Error in model stg_swapi_planets (models/staging/swapi/stg_swapi_planets.sql)
  column "residents" does not exist
  LINE 34:         CASE WHEN residents IS NULL OR residents = '' THEN N...
                             ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_planets.sql
[0m09:54:16.309058 [debug] [Thread-4 (]: SQL status: BEGIN in 0.029 seconds
[0m09:54:16.310559 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m09:54:16.312054 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2df04b-eacd-4a9c-a28a-48441cb7390e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e462bca0>]}
[0m09:54:16.312590 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_species"
[0m09:54:16.312911 [debug] [Thread-2 (]: SQL status: BEGIN in 0.032 seconds
[0m09:54:16.313235 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_films"
[0m09:54:16.315281 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_films"} */

  create view "nerd_facts"."public"."stg_swapi_films__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_films
  Description: Standardizes Star Wars film data from SWAPI
  Source: raw.swapi_films
  
  Notes:
  - Adds derived fields for easier analysis (release_year, trilogy)
  - Extracts counts from related entities (characters, planets, species)
  - Converts dates to proper DATE types and adds chronological ordering
*/

-- First, let's check what columns actually exist in the source table
WITH column_check AS (
    SELECT 
        column_name 
    FROM information_schema.columns 
    WHERE table_schema = 'raw' 
    AND table_name = 'swapi_films'
),

raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        episode_id,
        title,
        director,
        producer,
        release_date,
        opening_crawl,
        
        -- Dynamically handle character data - could be "characters" or "people"
        CASE 
            -- Handle case where column is named "characters"
            WHEN EXISTS (SELECT 1 FROM column_check WHERE column_name = 'characters') 
            THEN 
                CASE WHEN characters IS NULL OR characters = '' THEN NULL::jsonb 
                ELSE characters::jsonb END
            -- Handle case where column is named "people" 
            WHEN EXISTS (SELECT 1 FROM column_check WHERE column_name = 'people')
            THEN
                CASE WHEN people IS NULL OR people = '' THEN NULL::jsonb 
                ELSE people::jsonb END
            -- Fallback to empty array
            ELSE '[]'::jsonb
        END AS characters,
        
        -- Additional fields with safer access
        CASE WHEN planets IS NULL OR planets = '' THEN NULL::jsonb 
             ELSE planets::jsonb END AS planets,
        CASE WHEN starships IS NULL OR starships = '' THEN NULL::jsonb 
             ELSE starships::jsonb END AS starships,
        CASE WHEN vehicles IS NULL OR vehicles = '' THEN NULL::jsonb 
             ELSE vehicles::jsonb END AS vehicles,
        CASE WHEN species IS NULL OR species = '' THEN NULL::jsonb 
             ELSE species::jsonb END AS species,
        created,
        edited,
        url
    FROM "nerd_facts"."raw"."swapi_films"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    episode_id,
    title AS film_title,
    
    -- Creative team
    director,
    producer,
    
    -- Standardize dates and add derived time fields
    CASE 
        WHEN release_date IS NULL OR release_date = '' THEN NULL
        ELSE TO_DATE(release_date, 'YYYY-MM-DD') 
    END AS release_date,
    
    EXTRACT(YEAR FROM TO_DATE(release_date, 'YYYY-MM-DD')) AS release_year,
    
    -- Story elements
    opening_crawl,
    
    -- Derived chronological order (story timeline vs. release order)
    CASE episode_id
        WHEN 1 THEN 1  -- The Phantom Menace
        WHEN 2 THEN 2  -- Attack of the Clones
        WHEN 3 THEN 3  -- Revenge of the Sith
        WHEN 4 THEN 4  -- A New Hope
        WHEN 5 THEN 5  -- Empire Strikes Back
        WHEN 6 THEN 6  -- Return of the Jedi
        WHEN 7 THEN 7  -- The Force Awakens
        WHEN 8 THEN 8  -- The Last Jedi
        WHEN 9 THEN 9  -- The Rise of Skywalker
        ELSE 99        -- Unknown/other
    END AS chronological_order,
    
    -- Trilogy classification
    CASE
        WHEN episode_id BETWEEN 1 AND 3 THEN 'Prequel Trilogy'
        WHEN episode_id BETWEEN 4 AND 6 THEN 'Original Trilogy'
        WHEN episode_id BETWEEN 7 AND 9 THEN 'Sequel Trilogy'
        ELSE 'Anthology'
    END AS trilogy,
    
    -- Entity counts with safer access
    COALESCE(jsonb_array_length(characters), 0) AS character_count,
    COALESCE(jsonb_array_length(planets), 0) AS planet_count,
    COALESCE(jsonb_array_length(starships), 0) AS starship_count,
    COALESCE(jsonb_array_length(vehicles), 0) AS vehicle_count,
    COALESCE(jsonb_array_length(species), 0) AS species_count,
    
    -- Word count of opening crawl (approximate)
    ARRAY_LENGTH(STRING_TO_ARRAY(REGEXP_REPLACE(COALESCE(opening_crawl, ''), '\r|\n', ' ', 'g'), ' '), 1) AS opening_crawl_word_count,
    
    -- API metadata with proper handling
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Data tracking
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
ORDER BY episode_id
  );
[0m09:54:16.313813 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_swapi_planets .................. [[31mERROR[0m in 0.10s]
[0m09:54:16.314281 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_species"} */

  create view "nerd_facts"."public"."stg_swapi_species__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_species
  Description: Standardizes Star Wars species data from SWAPI
  Source: raw.swapi_species
  
  Notes:
  - Numeric fields are cleaned and converted to proper types
  - Color fields are parsed for analysis
  - Homeworld references are extracted
  - Additional derived fields help with species classification
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        classification,
        designation,
        average_height,
        average_lifespan,
        eye_colors,
        hair_colors,
        skin_colors,
        homeworld,
        language,
        CASE WHEN people IS NULL OR people = '' THEN NULL::jsonb ELSE people::jsonb END AS people,
        CASE WHEN films IS NULL OR films = '' THEN NULL::jsonb ELSE films::jsonb END AS films,
        created,
        edited,
        CURRENT_TIMESTAMP AS _loaded_at
    FROM "nerd_facts"."raw"."swapi_species"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name AS species_name,
    
    -- Species classification
    LOWER(COALESCE(classification, 'unknown')) AS classification,
    LOWER(COALESCE(designation, 'unknown')) AS designation,
    
    -- Physical characteristics with proper typing
    CASE 
        WHEN average_height IS NULL OR LOWER(average_height) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(average_height, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS average_height_cm,
    
    CASE 
        WHEN average_lifespan IS NULL OR LOWER(average_lifespan) = 'unknown' 
            OR LOWER(average_lifespan) = 'indefinite' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(average_lifespan, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS average_lifespan_years,
    
    -- Special case for indefinite lifespan
    CASE 
        WHEN LOWER(average_lifespan) = 'indefinite' THEN TRUE
        ELSE FALSE
    END AS has_indefinite_lifespan,
    
    -- Language
    LOWER(COALESCE(language, 'unknown')) AS language,
    
    -- Color attributes - standardized to arrays
    CASE 
        WHEN eye_colors IS NULL OR eye_colors = '' THEN NULL
        ELSE STRING_TO_ARRAY(LOWER(eye_colors), ', ') 
    END AS eye_colors_array,
    
    CASE 
        WHEN hair_colors IS NULL OR hair_colors = '' THEN NULL
        ELSE STRING_TO_ARRAY(LOWER(hair_colors), ', ') 
    END AS hair_colors_array,
    
    CASE 
        WHEN skin_colors IS NULL OR skin_colors = '' THEN NULL
        ELSE STRING_TO_ARRAY(LOWER(skin_colors), ', ') 
    END AS skin_colors_array,
    
    -- Extract homeworld with error handling
    CASE
        WHEN homeworld IS NULL THEN NULL
        WHEN homeworld = 'null' THEN NULL
        ELSE NULLIF(SPLIT_PART(homeworld->>'url', '/', 6), '')
    END AS homeworld_id,
    
    -- Entity counts
    COALESCE(jsonb_array_length(people), 0) AS character_count,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    people,
    films,
    
    -- Derived species classifications
    CASE
        WHEN LOWER(classification) IN ('mammal', 'amphibian', 'reptile', 'bird') THEN TRUE
        ELSE FALSE
    END AS is_organic,
    
    CASE
        WHEN LOWER(classification) = 'artificial' OR LOWER(name) = 'droid' THEN TRUE
        ELSE FALSE
    END AS is_artificial,
    
    -- Intelligence estimation (approximate)
    CASE
        WHEN LOWER(designation) = 'sentient' THEN 'High'
        WHEN LOWER(designation) = 'semi-sentient' THEN 'Moderate'
        ELSE 'Unknown'
    END AS intelligence_level,
    
    -- Longevity classification
    CASE
        WHEN LOWER(average_lifespan) = 'indefinite' THEN 'Immortal'
        WHEN average_lifespan::NUMERIC > 500 THEN 'Very Long-Lived'
        WHEN average_lifespan::NUMERIC > 100 THEN 'Long-Lived'
        WHEN average_lifespan::NUMERIC > 70 THEN 'Standard'
        WHEN average_lifespan::NUMERIC > 0 THEN 'Short-Lived'
        ELSE 'Unknown'
    END AS longevity_class,
    
    -- Notable species flag
    CASE
        WHEN name IN ('Human', 'Wookiee', 'Droid', 'Hutt', 'Ewok', 'Gungan', 
                     'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yoda\'s species') 
        THEN TRUE
        ELSE FALSE
    END AS is_notable_species,
    
    -- API metadata
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking fields
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:54:16.317724 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_planets
[0m09:54:16.318647 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_starships
[0m09:54:16.318270 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "characters" does not exist
LINE 45:                 CASE WHEN characters IS NULL OR characters =...
                                   ^

[0m09:54:16.319084 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_planets' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_planets (models/staging/swapi/stg_swapi_planets.sql)
  column "residents" does not exist
  LINE 34:         CASE WHEN residents IS NULL OR residents = '' THEN N...
                             ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_planets.sql.
[0m09:54:16.314807 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m09:54:16.319432 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "lek"
LINE 136: ...                    'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yod...
                                                               ^

[0m09:54:16.319830 [info ] [Thread-3 (]: 5 of 6 START sql view model public.stg_swapi_starships ......................... [RUN]
[0m09:54:16.320291 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_films: ROLLBACK
[0m09:54:16.321251 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */

  create view "nerd_facts"."public"."stg_swapi_people__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_people
  Description: Standardizes Star Wars character data from SWAPI
  Source: raw.swapi_people
  
  Notes:
  - Species and homeworld are extracted from JSON references
  - Force sensitivity is derived from character appearances and names
  - Physical attributes are cleaned and converted to proper numeric types
  - Additional derived fields are added for character analysis
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        height,
        mass,
        hair_color,
        skin_color,
        eye_color,
        birth_year,
        gender,
        homeworld,
        films,
        species,
        vehicles,
        starships,
        created,
        edited,
        url
    FROM "nerd_facts"."raw"."swapi_people"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name,
    
    -- Extract species information with improved error handling
    CASE 
        WHEN species IS NULL OR jsonb_array_length(species) = 0 THEN 'Human'  -- Default to Human if no species
        WHEN jsonb_typeof(species) != 'array' THEN 'Unknown'  -- Handle unexpected JSON type
        ELSE COALESCE(SPLIT_PART(species->0->>'url', '/', 6), 'Unknown')  -- Extract ID from URL
    END AS species,
    
    -- Extract homeworld ID with error handling
    CASE
        WHEN homeworld IS NULL THEN NULL
        WHEN jsonb_typeof(homeworld) != 'object' THEN NULL
        ELSE NULLIF(SPLIT_PART(homeworld->>'url', '/', 6), '')
    END AS homeworld_id,
    
    -- Clean numeric values with comprehensive error handling
    CASE 
        WHEN height IS NULL OR lower(height) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(height, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS height_cm,
    
    CASE 
        WHEN mass IS NULL OR lower(mass) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(mass, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS mass_kg,
    
    -- Calculate BMI if both height and mass are available
    CASE
        WHEN height IS NOT NULL AND mass IS NOT NULL 
             AND NULLIF(REGEXP_REPLACE(height, '[^0-9\.]', '', 'g'), '') != ''
             AND NULLIF(REGEXP_REPLACE(mass, '[^0-9\.]', '', 'g'), '') != ''
             AND height::NUMERIC > 0
        THEN (NULLIF(REGEXP_REPLACE(mass, '[^0-9\.]', '', 'g'), '')::NUMERIC) / 
             POWER((NULLIF(REGEXP_REPLACE(height, '[^0-9\.]', '', 'g'), '')::NUMERIC / 100), 2)
        ELSE NULL
    END AS bmi,
    
    -- Character physical attributes with standardized colors
    LOWER(COALESCE(hair_color, 'unknown')) AS hair_color,
    LOWER(COALESCE(skin_color, 'unknown')) AS skin_color,
    LOWER(COALESCE(eye_color, 'unknown')) AS eye_color,
    birth_year,
    LOWER(COALESCE(gender, 'unknown')) AS gender,
    
    -- Force-user related fields with expanded detection
    CASE
        -- Check film appearances
        WHEN films @> '[{"title": "Return of the Jedi"}]' 
             OR films @> '[{"title": "The Empire Strikes Back"}]'
             OR films @> '[{"title": "Revenge of the Sith"}]'
        -- Explicit Jedi/Sith list
        OR LOWER(name) IN ('luke skywalker', 'darth vader', 'obi-wan kenobi', 'yoda', 
                          'emperor palpatine', 'count dooku', 'qui-gon jinn', 'mace windu',
                          'rey', 'kylo ren')
        THEN TRUE
        ELSE FALSE
    END AS force_sensitive,
    
    -- Force rating for known powerful force users
    CASE
        WHEN LOWER(name) IN ('yoda', 'emperor palpatine', 'darth vader', 'luke skywalker') THEN 5
        WHEN LOWER(name) IN ('obi-wan kenobi', 'mace windu', 'kylo ren', 'rey') THEN 4
        WHEN LOWER(name) IN ('qui-gon jinn', 'count dooku') THEN 3
        WHEN force_sensitive THEN 2
        ELSE NULL
    END AS force_rating,
    
    -- Entity counts with error handling
    COALESCE(jsonb_array_length(starships), 0) AS ships_piloted,
    COALESCE(jsonb_array_length(vehicles), 0) AS vehicles_operated,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    films,
    starships,
    vehicles,
    
    -- Era classification
    CASE
        WHEN films @> '[{"title": "The Phantom Menace"}]' 
             OR films @> '[{"title": "Attack of the Clones"}]'
             OR films @> '[{"title": "Revenge of the Sith"}]'
        THEN 'Prequel Era'
        WHEN films @> '[{"title": "A New Hope"}]'
             OR films @> '[{"title": "The Empire Strikes Back"}]'
             OR films @> '[{"title": "Return of the Jedi"}]'
        THEN 'Original Trilogy Era'
        WHEN films @> '[{"title": "The Force Awakens"}]'
             OR films @> '[{"title": "The Last Jedi"}]'
        THEN 'Sequel Era'
        ELSE 'Unknown Era'
    END AS character_era,
    
    -- API metadata with proper handling
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking fields
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:54:16.321807 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_species: ROLLBACK
[0m09:54:16.322246 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_planets, now model.nerd_facts_dbt.stg_swapi_starships)
[0m09:54:16.322836 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_films: Close
[0m09:54:16.325342 [debug] [Thread-1 (]: Database Error in model stg_swapi_films (models/staging/swapi/stg_swapi_films.sql)
  column "characters" does not exist
  LINE 45:                 CASE WHEN characters IS NULL OR characters =...
                                     ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_films.sql
[0m09:54:16.325828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2df04b-eacd-4a9c-a28a-48441cb7390e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e77c2320>]}
[0m09:54:16.323837 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_species: Close
[0m09:54:16.327349 [debug] [Thread-4 (]: Database Error in model stg_swapi_species (models/staging/swapi/stg_swapi_species.sql)
  syntax error at or near "lek"
  LINE 136: ...                    'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yod...
                                                                 ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_species.sql
[0m09:54:16.327799 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2df04b-eacd-4a9c-a28a-48441cb7390e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e778c040>]}
[0m09:54:16.324231 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_starships
[0m09:54:16.324517 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "films" does not exist
LINE 34:         films,
                 ^

[0m09:54:16.331305 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m09:54:16.332401 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_starships
[0m09:54:16.328301 [error] [Thread-4 (]: 4 of 6 ERROR creating sql view model public.stg_swapi_species .................. [[31mERROR[0m in 0.12s]
[0m09:54:16.331898 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_people: ROLLBACK
[0m09:54:16.326378 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model public.stg_swapi_films .................... [[31mERROR[0m in 0.12s]
[0m09:54:16.337476 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi_species
[0m09:54:16.336970 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m09:54:16.338159 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_swapi_films
[0m09:54:16.338571 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_people: Close
[0m09:54:16.341108 [debug] [Thread-2 (]: Database Error in model stg_swapi_people (models/staging/swapi/stg_swapi_people.sql)
  column "films" does not exist
  LINE 34:         films,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_people.sql
[0m09:54:16.339341 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_species' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_species (models/staging/swapi/stg_swapi_species.sql)
  syntax error at or near "lek"
  LINE 136: ...                    'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yod...
                                                                 ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_species.sql.
[0m09:54:16.341792 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_films' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_films (models/staging/swapi/stg_swapi_films.sql)
  column "characters" does not exist
  LINE 45:                 CASE WHEN characters IS NULL OR characters =...
                                     ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_films.sql.
[0m09:54:16.340075 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m09:54:16.338953 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi_vehicles
[0m09:54:16.342250 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: BEGIN
[0m09:54:16.343441 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:54:16.343007 [info ] [Thread-4 (]: 6 of 6 START sql view model public.stg_swapi_vehicles .......................... [RUN]
[0m09:54:16.343943 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_species, now model.nerd_facts_dbt.stg_swapi_vehicles)
[0m09:54:16.344249 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_vehicles
[0m09:54:16.342543 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2df04b-eacd-4a9c-a28a-48441cb7390e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e463e8f0>]}
[0m09:54:16.349516 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_swapi_people ................... [[31mERROR[0m in 0.13s]
[0m09:54:16.350137 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_swapi_people
[0m09:54:16.348688 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:54:16.350640 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_people' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_people (models/staging/swapi/stg_swapi_people.sql)
  column "films" does not exist
  LINE 34:         films,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_people.sql.
[0m09:54:16.351385 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi_vehicles
[0m09:54:16.356305 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:54:16.356957 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m09:54:16.357316 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m09:54:16.357765 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */

  create view "nerd_facts"."public"."stg_swapi_starships__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_starships
  Description: Standardizes Star Wars starship data from SWAPI
  Source: raw.swapi_starships
  
  Notes:
  - Numeric fields are cleaned and converted to proper types
  - Speeds and capacities have proper error handling
  - Pilot and film references are extracted as counts
  - Additional derived fields help with starship classification
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        model,
        manufacturer,
        cost_in_credits,
        length,
        max_atmosphering_speed,
        crew,
        passengers,
        cargo_capacity,
        consumables,
        hyperdrive_rating,
        MGLT,
        starship_class,
        pilots,
        films,
        created,
        edited,
        url
    FROM raw.swapi_starships
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name AS starship_name,
    model,
    manufacturer,
    starship_class,
    
    -- Technical specifications with improved error handling
    CASE 
        WHEN lower(cost_in_credits) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(cost_in_credits, '[^0-9]', '', 'g'), '')::NUMERIC
    END AS cost_in_credits,
    
    CASE 
        WHEN lower(length) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(length, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS length_m,
    
    CASE 
        WHEN lower(max_atmosphering_speed) = 'unknown' THEN NULL
        WHEN lower(max_atmosphering_speed) = 'n/a' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '[^0-9]+.*', '', 'g'), '')::INTEGER 
    END AS max_speed,
    
    CASE
        WHEN lower(hyperdrive_rating) = 'unknown' THEN NULL
        WHEN lower(hyperdrive_rating) = 'n/a' THEN NULL
        ELSE NULLIF(hyperdrive_rating, '')::NUMERIC
    END AS hyperdrive_rating,
    
    CASE
        WHEN lower(MGLT) = 'unknown' THEN NULL
        WHEN lower(MGLT) = 'n/a' THEN NULL
        ELSE NULLIF(MGLT, '')::INTEGER
    END AS mglt,
    
    -- Capacity information
    NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER AS crew_count,
    NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER AS passenger_capacity,
    
    CASE 
        WHEN lower(cargo_capacity) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(cargo_capacity, '[^0-9]', '', 'g'), '')::NUMERIC
    END AS cargo_capacity,
    
    consumables,
    
    -- Entity counts with error handling
    COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    CASE WHEN pilots IS NULL OR pilots = '' THEN NULL::jsonb ELSE pilots::jsonb END AS pilots,
    CASE WHEN films IS NULL OR films = '' THEN NULL::jsonb ELSE films::jsonb END AS films,
    
    -- Derived ship classification
    CASE
        WHEN lower(starship_class) IN ('corvette', 'frigate', 'star destroyer', 'dreadnought')
            OR lower(name) LIKE '%star destroyer%' THEN 'Military'
        WHEN lower(starship_class) IN ('transport', 'freighter', 'yacht') 
            OR lower(name) LIKE '%transport%' THEN 'Commercial'
        WHEN lower(starship_class) IN ('starfighter', 'bomber', 'assault ship')
            OR lower(name) LIKE '%fighter%' THEN 'Starfighter'
        ELSE 'Other'
    END AS ship_purpose,
    
    -- Size classification
    CASE
        WHEN length::NUMERIC < 30 THEN 'Small'
        WHEN length::NUMERIC < 100 THEN 'Medium'
        WHEN length::NUMERIC < 500 THEN 'Large'
        WHEN length::NUMERIC < 1000 THEN 'Very Large'
        WHEN length::NUMERIC >= 1000 THEN 'Capital'
        ELSE 'Unknown'
    END AS ship_size,
    
    -- Notable ship flag
    CASE
        WHEN name IN ('Millennium Falcon', 'Death Star', 'Star Destroyer', 
                     'X-wing', 'TIE Advanced x1', 'Executor', 'Slave 1') 
        THEN TRUE
        ELSE FALSE
    END AS is_notable_ship,
    
    -- Total capacity (crew + passengers)
    COALESCE(
        NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER, 0
    ) + 
    COALESCE(
        NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER, 0
    ) AS total_capacity,
    
    -- API metadata
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking field
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:54:16.358332 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:54:16.358676 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: BEGIN
[0m09:54:16.359015 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:54:16.359448 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function jsonb_array_length(text) does not exist
LINE 96:     COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m09:54:16.359902 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: ROLLBACK
[0m09:54:16.360907 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_starships: Close
[0m09:54:16.366047 [debug] [Thread-3 (]: Database Error in model stg_swapi_starships (models/staging/swapi/stg_swapi_starships.sql)
  function jsonb_array_length(text) does not exist
  LINE 96:     COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_starships.sql
[0m09:54:16.366582 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2df04b-eacd-4a9c-a28a-48441cb7390e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e462bca0>]}
[0m09:54:16.367174 [error] [Thread-3 (]: 5 of 6 ERROR creating sql view model public.stg_swapi_starships ................ [[31mERROR[0m in 0.04s]
[0m09:54:16.367668 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_starships
[0m09:54:16.368077 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_starships' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_starships (models/staging/swapi/stg_swapi_starships.sql)
  function jsonb_array_length(text) does not exist
  LINE 96:     COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_starships.sql.
[0m09:54:16.373192 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m09:54:16.373692 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:54:16.374191 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_vehicles"} */

  create view "nerd_facts"."public"."stg_swapi_vehicles__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_vehicles
  Description: Standardizes Star Wars vehicle data from SWAPI
  Source: raw.swapi_vehicles
  
  Notes:
  - Numeric fields are cleaned and converted to proper types
  - Speeds and capacities have proper error handling
  - Pilot and film references are extracted as counts
  - Additional derived fields help with vehicle classification
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        model,
        manufacturer,
        NULLIF(cost_in_credits, 'unknown') AS cost_in_credits,
        NULLIF(length, 'unknown') AS length,
        NULLIF(max_atmosphering_speed, 'unknown') AS max_atmosphering_speed,
        NULLIF(crew, 'unknown') AS crew,
        NULLIF(passengers, 'unknown') AS passengers,
        NULLIF(cargo_capacity, 'unknown') AS cargo_capacity,
        consumables,
        vehicle_class,
        CASE WHEN pilots IS NULL OR pilots = '' THEN NULL::jsonb ELSE pilots::jsonb END AS pilots,
        CASE WHEN films IS NULL OR films = '' THEN NULL::jsonb ELSE films::jsonb END AS films,
        created,
        edited,
        CURRENT_TIMESTAMP AS _loaded_at
    FROM "nerd_facts"."raw"."swapi_vehicles"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name AS vehicle_name,
    model,
    manufacturer,
    vehicle_class,
    
    -- Technical specifications with proper error handling
    CASE 
        WHEN lower(cost_in_credits) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(cost_in_credits, '[^0-9]', '', 'g'), '')::NUMERIC
    END AS cost_in_credits,
    
    CASE 
        WHEN lower(length) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(length, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS length_m,
    
    CASE 
        WHEN lower(max_atmosphering_speed) = 'unknown' THEN NULL
        WHEN lower(max_atmosphering_speed) = 'n/a' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '[^0-9]+.*', '', 'g'), '')::INTEGER 
    END AS max_speed,
    
    -- Capacity information with proper type conversion
    CASE 
        WHEN lower(crew) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER
    END AS crew_count,
    
    CASE 
        WHEN lower(passengers) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER
    END AS passenger_capacity,
    
    CASE 
        WHEN lower(cargo_capacity) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(cargo_capacity, '[^0-9]', '', 'g'), '')::NUMERIC
    END AS cargo_capacity,
    
    consumables,
    
    -- Entity counts with error handling
    COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    pilots,
    films,
    
    -- Derived vehicle classifications
    CASE
        WHEN lower(vehicle_class) IN ('assault', 'combat', 'battle') 
             OR lower(name) LIKE '%fighter%' 
             OR lower(name) LIKE '%tank%'
             OR lower(name) LIKE '%cannon%' THEN 'Military'
        WHEN lower(vehicle_class) IN ('transport', 'cargo', 'container') 
             OR lower(name) LIKE '%transport%'
             OR lower(name) LIKE '%freighter%' THEN 'Transport'
        WHEN lower(vehicle_class) IN ('speeder', 'airspeeder', 'swoop', 'landspeeder') 
             OR lower(name) LIKE '%speeder%' THEN 'Personal'
        ELSE 'Other'
    END AS vehicle_purpose,
    
    -- Size classification
    CASE
        WHEN length IS NULL THEN 'Unknown'
        WHEN length::NUMERIC < 10 THEN 'Small'
        WHEN length::NUMERIC < 25 THEN 'Medium'
        WHEN length::NUMERIC < 100 THEN 'Large'
        ELSE 'Very Large'
    END AS vehicle_size,
    
    -- Terrain capability
    CASE
        WHEN lower(vehicle_class) LIKE '%walker%' 
             OR lower(name) LIKE '%walker%' THEN 'Ground Only'
        WHEN lower(vehicle_class) LIKE '%speeder%'
             OR lower(name) LIKE '%speeder%' THEN 'Ground & Low Altitude'
        WHEN lower(vehicle_class) LIKE '%airspeeder%'
             OR lower(name) LIKE '%airspeeder%' THEN 'Aerial'
        ELSE 'Unknown'
    END AS terrain_capability,
    
    -- Notable vehicle flag
    CASE
        WHEN name IN ('AT-AT', 'AT-ST', 'Snowspeeder', 'Speeder bike',
                     'Sand Crawler', 'TIE bomber', 'Imperial Speeder Bike') 
        THEN TRUE
        ELSE FALSE
    END AS is_notable_vehicle,
    
    -- Total capacity (crew + passengers)
    COALESCE(
        NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER, 0
    ) + 
    COALESCE(
        NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER, 0
    ) AS total_capacity,
    
    -- API metadata
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking fields
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:54:16.378427 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:54:16.384268 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:54:16.384698 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_vehicles"} */
alter table "nerd_facts"."public"."stg_swapi_vehicles" rename to "stg_swapi_vehicles__dbt_backup"
[0m09:54:16.385718 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:54:16.388367 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:54:16.388721 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_vehicles"} */
alter table "nerd_facts"."public"."stg_swapi_vehicles__dbt_tmp" rename to "stg_swapi_vehicles"
[0m09:54:16.389585 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:54:16.402182 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: COMMIT
[0m09:54:16.402620 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:54:16.402956 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: COMMIT
[0m09:54:16.409454 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m09:54:16.414645 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."stg_swapi_vehicles__dbt_backup"
[0m09:54:16.418057 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:54:16.418385 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_vehicles"} */
drop view if exists "nerd_facts"."public"."stg_swapi_vehicles__dbt_backup" cascade
[0m09:54:16.421645 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:54:16.423735 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: Close
[0m09:54:16.424370 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc2df04b-eacd-4a9c-a28a-48441cb7390e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e77fbd60>]}
[0m09:54:16.424894 [info ] [Thread-4 (]: 6 of 6 OK created sql view model public.stg_swapi_vehicles ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m09:54:16.425484 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi_vehicles
[0m09:54:16.426713 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:16.427046 [debug] [MainThread]: On master: BEGIN
[0m09:54:16.427304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:54:16.439422 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:54:16.439860 [debug] [MainThread]: On master: COMMIT
[0m09:54:16.440155 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:16.440398 [debug] [MainThread]: On master: COMMIT
[0m09:54:16.440724 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:54:16.440977 [debug] [MainThread]: On master: Close
[0m09:54:16.441461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:54:16.441727 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_films' was properly closed.
[0m09:54:16.441958 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_vehicles' was properly closed.
[0m09:54:16.442182 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_starships' was properly closed.
[0m09:54:16.442407 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_people' was properly closed.
[0m09:54:16.442728 [info ] [MainThread]: 
[0m09:54:16.443185 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m09:54:16.444384 [debug] [MainThread]: Command end result
[0m09:54:16.527085 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m09:54:16.528580 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m09:54:16.534138 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m09:54:16.534476 [info ] [MainThread]: 
[0m09:54:16.534795 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m09:54:16.535101 [info ] [MainThread]: 
[0m09:54:16.535410 [error] [MainThread]:   Database Error in model stg_swapi_planets (models/staging/swapi/stg_swapi_planets.sql)
  column "residents" does not exist
  LINE 34:         CASE WHEN residents IS NULL OR residents = '' THEN N...
                             ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_planets.sql
[0m09:54:16.535667 [info ] [MainThread]: 
[0m09:54:16.535944 [error] [MainThread]:   Database Error in model stg_swapi_species (models/staging/swapi/stg_swapi_species.sql)
  syntax error at or near "lek"
  LINE 136: ...                    'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yod...
                                                                 ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_species.sql
[0m09:54:16.536183 [info ] [MainThread]: 
[0m09:54:16.536458 [error] [MainThread]:   Database Error in model stg_swapi_films (models/staging/swapi/stg_swapi_films.sql)
  column "characters" does not exist
  LINE 45:                 CASE WHEN characters IS NULL OR characters =...
                                     ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_films.sql
[0m09:54:16.536694 [info ] [MainThread]: 
[0m09:54:16.536959 [error] [MainThread]:   Database Error in model stg_swapi_people (models/staging/swapi/stg_swapi_people.sql)
  column "films" does not exist
  LINE 34:         films,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_people.sql
[0m09:54:16.537189 [info ] [MainThread]: 
[0m09:54:16.537483 [error] [MainThread]:   Database Error in model stg_swapi_starships (models/staging/swapi/stg_swapi_starships.sql)
  function jsonb_array_length(text) does not exist
  LINE 96:     COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_starships.sql
[0m09:54:16.537761 [info ] [MainThread]: 
[0m09:54:16.538015 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=5 SKIP=0 TOTAL=6
[0m09:54:16.538702 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4649856, "process_in_blocks": "3520", "process_kernel_time": 0.091797, "process_mem_max_rss": "118916", "process_out_blocks": "7696", "process_user_time": 2.310514}
[0m09:54:16.539066 [debug] [MainThread]: Command `dbt run` failed at 09:54:16.538987 after 1.47 seconds
[0m09:54:16.539356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76eea5c8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ecca07f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76efd08cd0>]}
[0m09:54:16.539646 [debug] [MainThread]: Flushing usage events
[0m09:54:17.037692 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:56:57.515708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5410818940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5411661990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5411661930>]}


============================== 09:56:57.517765 | f6bf1b47-d554-4a69-a28f-32f4a758609e ==============================
[0m09:56:57.517765 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:56:57.518178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/janne/nerd-facts-dbt/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/janne/nerd-facts-dbt/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models staging.swapi.*', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:56:57.645923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6bf1b47-d554-4a69-a28f-32f4a758609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f540f8c3c40>]}
[0m09:56:57.693409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6bf1b47-d554-4a69-a28f-32f4a758609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5411688430>]}
[0m09:56:57.694116 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:56:57.769971 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:56:57.902066 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:56:57.902799 [debug] [MainThread]: Partial parsing: updated file: nerd_facts_dbt://models/staging/swapi/stg_swapi_planets.sql
[0m09:56:58.318802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6bf1b47-d554-4a69-a28f-32f4a758609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f540eeed5a0>]}
[0m09:56:58.422728 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m09:56:58.425240 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m09:56:58.440563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6bf1b47-d554-4a69-a28f-32f4a758609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f540f8c00a0>]}
[0m09:56:58.441177 [info ] [MainThread]: Found 36 models, 38 data tests, 18 sources, 630 macros
[0m09:56:58.441597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6bf1b47-d554-4a69-a28f-32f4a758609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f540ef0fa90>]}
[0m09:56:58.444118 [info ] [MainThread]: 
[0m09:56:58.444506 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:56:58.444843 [info ] [MainThread]: 
[0m09:56:58.445449 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:56:58.449769 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts'
[0m09:56:58.490655 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts"
[0m09:56:58.491077 [debug] [ThreadPool]: On list_nerd_facts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts"} */

    select distinct nspname from pg_namespace
  
[0m09:56:58.491395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:58.504899 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m09:56:58.506042 [debug] [ThreadPool]: On list_nerd_facts: Close
[0m09:56:58.512157 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nerd_facts_public'
[0m09:56:58.517871 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m09:56:58.518240 [debug] [ThreadPool]: On list_nerd_facts_public: BEGIN
[0m09:56:58.518548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:58.531797 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m09:56:58.532231 [debug] [ThreadPool]: Using postgres connection "list_nerd_facts_public"
[0m09:56:58.532570 [debug] [ThreadPool]: On list_nerd_facts_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "list_nerd_facts_public"} */
select
      'nerd_facts' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nerd_facts' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:56:58.536016 [debug] [ThreadPool]: SQL status: SELECT 105 in 0.003 seconds
[0m09:56:58.539079 [debug] [ThreadPool]: On list_nerd_facts_public: ROLLBACK
[0m09:56:58.539554 [debug] [ThreadPool]: On list_nerd_facts_public: Close
[0m09:56:58.558249 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:58.558639 [debug] [MainThread]: On master: BEGIN
[0m09:56:58.558946 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:56:58.572859 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m09:56:58.573478 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:58.574005 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:56:58.581941 [debug] [MainThread]: SQL status: SELECT 35 in 0.007 seconds
[0m09:56:58.587179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6bf1b47-d554-4a69-a28f-32f4a758609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f540ed92c80>]}
[0m09:56:58.587649 [debug] [MainThread]: On master: ROLLBACK
[0m09:56:58.588091 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:58.588378 [debug] [MainThread]: On master: BEGIN
[0m09:56:58.588845 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:56:58.589128 [debug] [MainThread]: On master: COMMIT
[0m09:56:58.589412 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:58.589710 [debug] [MainThread]: On master: COMMIT
[0m09:56:58.590085 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:56:58.590375 [debug] [MainThread]: On master: Close
[0m09:56:58.594143 [debug] [Thread-1 (]: Began running node model.nerd_facts_dbt.stg_swapi_films
[0m09:56:58.594585 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_swapi_people
[0m09:56:58.594932 [debug] [Thread-3 (]: Began running node model.nerd_facts_dbt.stg_swapi_planets
[0m09:56:58.595248 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi_species
[0m09:56:58.595730 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_swapi_films ............................. [RUN]
[0m09:56:58.596199 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_swapi_people ............................ [RUN]
[0m09:56:58.598281 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_nerd_facts, now model.nerd_facts_dbt.stg_swapi_people)
[0m09:56:58.597331 [info ] [Thread-4 (]: 4 of 6 START sql view model public.stg_swapi_species ........................... [RUN]
[0m09:56:58.598619 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_people
[0m09:56:58.596697 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_swapi_planets ........................... [RUN]
[0m09:56:58.597878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nerd_facts_public, now model.nerd_facts_dbt.stg_swapi_films)
[0m09:56:58.599071 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_species'
[0m09:56:58.607994 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_people"
[0m09:56:58.608545 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nerd_facts_dbt.stg_swapi_planets'
[0m09:56:58.608934 [debug] [Thread-1 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_films
[0m09:56:58.609289 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_species
[0m09:56:58.609825 [debug] [Thread-3 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_planets
[0m09:56:58.614327 [debug] [Thread-1 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_films"
[0m09:56:58.614938 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_swapi_people
[0m09:56:58.618756 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_species"
[0m09:56:58.622765 [debug] [Thread-3 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m09:56:58.644552 [debug] [Thread-3 (]: Began executing node model.nerd_facts_dbt.stg_swapi_planets
[0m09:56:58.650863 [debug] [Thread-1 (]: Began executing node model.nerd_facts_dbt.stg_swapi_films
[0m09:56:58.664409 [debug] [Thread-3 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_planets"
[0m09:56:58.667700 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_people"
[0m09:56:58.673409 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi_species
[0m09:56:58.673846 [debug] [Thread-1 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_films"
[0m09:56:58.679192 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_species"
[0m09:56:58.680528 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m09:56:58.680864 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_people: BEGIN
[0m09:56:58.681243 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:56:58.682313 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_species"
[0m09:56:58.682657 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_species: BEGIN
[0m09:56:58.682988 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:56:58.681650 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_films"
[0m09:56:58.684662 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_films: BEGIN
[0m09:56:58.685038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:58.679917 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m09:56:58.686397 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_planets: BEGIN
[0m09:56:58.686721 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:56:58.709108 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m09:56:58.709654 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_people"
[0m09:56:58.710294 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_people: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_people"} */

  create view "nerd_facts"."public"."stg_swapi_people__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_people
  Description: Standardizes Star Wars character data from SWAPI
  Source: raw.swapi_people
  
  Notes:
  - Species and homeworld are extracted from JSON references
  - Force sensitivity is derived from character appearances and names
  - Physical attributes are cleaned and converted to proper numeric types
  - Additional derived fields are added for character analysis
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        height,
        mass,
        hair_color,
        skin_color,
        eye_color,
        birth_year,
        gender,
        homeworld,
        films,
        species,
        vehicles,
        starships,
        created,
        edited,
        url
    FROM "nerd_facts"."raw"."swapi_people"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name,
    
    -- Extract species information with improved error handling
    CASE 
        WHEN species IS NULL OR jsonb_array_length(species) = 0 THEN 'Human'  -- Default to Human if no species
        WHEN jsonb_typeof(species) != 'array' THEN 'Unknown'  -- Handle unexpected JSON type
        ELSE COALESCE(SPLIT_PART(species->0->>'url', '/', 6), 'Unknown')  -- Extract ID from URL
    END AS species,
    
    -- Extract homeworld ID with error handling
    CASE
        WHEN homeworld IS NULL THEN NULL
        WHEN jsonb_typeof(homeworld) != 'object' THEN NULL
        ELSE NULLIF(SPLIT_PART(homeworld->>'url', '/', 6), '')
    END AS homeworld_id,
    
    -- Clean numeric values with comprehensive error handling
    CASE 
        WHEN height IS NULL OR lower(height) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(height, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS height_cm,
    
    CASE 
        WHEN mass IS NULL OR lower(mass) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(mass, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS mass_kg,
    
    -- Calculate BMI if both height and mass are available
    CASE
        WHEN height IS NOT NULL AND mass IS NOT NULL 
             AND NULLIF(REGEXP_REPLACE(height, '[^0-9\.]', '', 'g'), '') != ''
             AND NULLIF(REGEXP_REPLACE(mass, '[^0-9\.]', '', 'g'), '') != ''
             AND height::NUMERIC > 0
        THEN (NULLIF(REGEXP_REPLACE(mass, '[^0-9\.]', '', 'g'), '')::NUMERIC) / 
             POWER((NULLIF(REGEXP_REPLACE(height, '[^0-9\.]', '', 'g'), '')::NUMERIC / 100), 2)
        ELSE NULL
    END AS bmi,
    
    -- Character physical attributes with standardized colors
    LOWER(COALESCE(hair_color, 'unknown')) AS hair_color,
    LOWER(COALESCE(skin_color, 'unknown')) AS skin_color,
    LOWER(COALESCE(eye_color, 'unknown')) AS eye_color,
    birth_year,
    LOWER(COALESCE(gender, 'unknown')) AS gender,
    
    -- Force-user related fields with expanded detection
    CASE
        -- Check film appearances
        WHEN films @> '[{"title": "Return of the Jedi"}]' 
             OR films @> '[{"title": "The Empire Strikes Back"}]'
             OR films @> '[{"title": "Revenge of the Sith"}]'
        -- Explicit Jedi/Sith list
        OR LOWER(name) IN ('luke skywalker', 'darth vader', 'obi-wan kenobi', 'yoda', 
                          'emperor palpatine', 'count dooku', 'qui-gon jinn', 'mace windu',
                          'rey', 'kylo ren')
        THEN TRUE
        ELSE FALSE
    END AS force_sensitive,
    
    -- Force rating for known powerful force users
    CASE
        WHEN LOWER(name) IN ('yoda', 'emperor palpatine', 'darth vader', 'luke skywalker') THEN 5
        WHEN LOWER(name) IN ('obi-wan kenobi', 'mace windu', 'kylo ren', 'rey') THEN 4
        WHEN LOWER(name) IN ('qui-gon jinn', 'count dooku') THEN 3
        WHEN force_sensitive THEN 2
        ELSE NULL
    END AS force_rating,
    
    -- Entity counts with error handling
    COALESCE(jsonb_array_length(starships), 0) AS ships_piloted,
    COALESCE(jsonb_array_length(vehicles), 0) AS vehicles_operated,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    films,
    starships,
    vehicles,
    
    -- Era classification
    CASE
        WHEN films @> '[{"title": "The Phantom Menace"}]' 
             OR films @> '[{"title": "Attack of the Clones"}]'
             OR films @> '[{"title": "Revenge of the Sith"}]'
        THEN 'Prequel Era'
        WHEN films @> '[{"title": "A New Hope"}]'
             OR films @> '[{"title": "The Empire Strikes Back"}]'
             OR films @> '[{"title": "Return of the Jedi"}]'
        THEN 'Original Trilogy Era'
        WHEN films @> '[{"title": "The Force Awakens"}]'
             OR films @> '[{"title": "The Last Jedi"}]'
        THEN 'Sequel Era'
        ELSE 'Unknown Era'
    END AS character_era,
    
    -- API metadata with proper handling
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking fields
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:56:58.711255 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m09:56:58.711598 [debug] [Thread-1 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_films"
[0m09:56:58.712624 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_films: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_films"} */

  create view "nerd_facts"."public"."stg_swapi_films__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_films
  Description: Standardizes Star Wars film data from SWAPI
  Source: raw.swapi_films
  
  Notes:
  - Adds derived fields for easier analysis (release_year, trilogy)
  - Extracts counts from related entities (characters, planets, species)
  - Converts dates to proper DATE types and adds chronological ordering
*/

-- First, let's check what columns actually exist in the source table
WITH column_check AS (
    SELECT 
        column_name 
    FROM information_schema.columns 
    WHERE table_schema = 'raw' 
    AND table_name = 'swapi_films'
),

raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        episode_id,
        title,
        director,
        producer,
        release_date,
        opening_crawl,
        
        -- Dynamically handle character data - could be "characters" or "people"
        CASE 
            -- Handle case where column is named "characters"
            WHEN EXISTS (SELECT 1 FROM column_check WHERE column_name = 'characters') 
            THEN 
                CASE WHEN characters IS NULL OR characters = '' THEN NULL::jsonb 
                ELSE characters::jsonb END
            -- Handle case where column is named "people" 
            WHEN EXISTS (SELECT 1 FROM column_check WHERE column_name = 'people')
            THEN
                CASE WHEN people IS NULL OR people = '' THEN NULL::jsonb 
                ELSE people::jsonb END
            -- Fallback to empty array
            ELSE '[]'::jsonb
        END AS characters,
        
        -- Additional fields with safer access
        CASE WHEN planets IS NULL OR planets = '' THEN NULL::jsonb 
             ELSE planets::jsonb END AS planets,
        CASE WHEN starships IS NULL OR starships = '' THEN NULL::jsonb 
             ELSE starships::jsonb END AS starships,
        CASE WHEN vehicles IS NULL OR vehicles = '' THEN NULL::jsonb 
             ELSE vehicles::jsonb END AS vehicles,
        CASE WHEN species IS NULL OR species = '' THEN NULL::jsonb 
             ELSE species::jsonb END AS species,
        created,
        edited,
        url
    FROM "nerd_facts"."raw"."swapi_films"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    episode_id,
    title AS film_title,
    
    -- Creative team
    director,
    producer,
    
    -- Standardize dates and add derived time fields
    CASE 
        WHEN release_date IS NULL OR release_date = '' THEN NULL
        ELSE TO_DATE(release_date, 'YYYY-MM-DD') 
    END AS release_date,
    
    EXTRACT(YEAR FROM TO_DATE(release_date, 'YYYY-MM-DD')) AS release_year,
    
    -- Story elements
    opening_crawl,
    
    -- Derived chronological order (story timeline vs. release order)
    CASE episode_id
        WHEN 1 THEN 1  -- The Phantom Menace
        WHEN 2 THEN 2  -- Attack of the Clones
        WHEN 3 THEN 3  -- Revenge of the Sith
        WHEN 4 THEN 4  -- A New Hope
        WHEN 5 THEN 5  -- Empire Strikes Back
        WHEN 6 THEN 6  -- Return of the Jedi
        WHEN 7 THEN 7  -- The Force Awakens
        WHEN 8 THEN 8  -- The Last Jedi
        WHEN 9 THEN 9  -- The Rise of Skywalker
        ELSE 99        -- Unknown/other
    END AS chronological_order,
    
    -- Trilogy classification
    CASE
        WHEN episode_id BETWEEN 1 AND 3 THEN 'Prequel Trilogy'
        WHEN episode_id BETWEEN 4 AND 6 THEN 'Original Trilogy'
        WHEN episode_id BETWEEN 7 AND 9 THEN 'Sequel Trilogy'
        ELSE 'Anthology'
    END AS trilogy,
    
    -- Entity counts with safer access
    COALESCE(jsonb_array_length(characters), 0) AS character_count,
    COALESCE(jsonb_array_length(planets), 0) AS planet_count,
    COALESCE(jsonb_array_length(starships), 0) AS starship_count,
    COALESCE(jsonb_array_length(vehicles), 0) AS vehicle_count,
    COALESCE(jsonb_array_length(species), 0) AS species_count,
    
    -- Word count of opening crawl (approximate)
    ARRAY_LENGTH(STRING_TO_ARRAY(REGEXP_REPLACE(COALESCE(opening_crawl, ''), '\r|\n', ' ', 'g'), ' '), 1) AS opening_crawl_word_count,
    
    -- API metadata with proper handling
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Data tracking
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
ORDER BY episode_id
  );
[0m09:56:58.711892 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m09:56:58.713178 [debug] [Thread-3 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_planets"
[0m09:56:58.712215 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "films" does not exist
LINE 34:         films,
                 ^

[0m09:56:58.714111 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_people: ROLLBACK
[0m09:56:58.710758 [debug] [Thread-4 (]: SQL status: BEGIN in 0.028 seconds
[0m09:56:58.714613 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_people: Close
[0m09:56:58.713655 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_planets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_planets"} */

  create view "nerd_facts"."public"."stg_swapi_planets__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_planets
  Description: Standardizes Star Wars planet data from SWAPI
  Source: raw.swapi_planets
  
  Notes:
  - Numeric fields are cleaned and converted to proper types
  - Population is handled with appropriate NULL values
  - Derived planet classifications are added for analysis
  - Climate and terrain are standardized for consistency
*/

-- First check what columns actually exist
WITH column_check AS (
    SELECT 
        column_name 
    FROM information_schema.columns 
    WHERE table_schema = 'raw' 
    AND table_name = 'swapi_planets'
),

raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        rotation_period,
        orbital_period,
        diameter,
        climate,
        gravity,
        terrain,
        surface_water,
        population,
        
        -- Handle various possible column names for resident data
        CASE
            -- Check for standard "residents" column
            WHEN EXISTS (SELECT 1 FROM column_check WHERE column_name = 'residents')
            THEN CASE WHEN residents IS NULL OR residents = '' THEN NULL::jsonb ELSE residents::jsonb END
            
            -- Check for alternative "people" column
            WHEN EXISTS (SELECT 1 FROM column_check WHERE column_name = 'people')
            THEN CASE WHEN people IS NULL OR people = '' THEN NULL::jsonb ELSE people::jsonb END
            
            -- Check for alternative "characters" column
            WHEN EXISTS (SELECT 1 FROM column_check WHERE column_name = 'characters')
            THEN CASE WHEN characters IS NULL OR characters = '' THEN NULL::jsonb ELSE characters::jsonb END
            
            -- Default to empty array if no matching column found
            ELSE '[]'::jsonb
        END AS residents,
        
        -- Handle films data with similar approach
        CASE
            WHEN EXISTS (SELECT 1 FROM column_check WHERE column_name = 'films')
            THEN CASE WHEN films IS NULL OR films = '' THEN NULL::jsonb ELSE films::jsonb END
            
            -- Default to empty array if no matching column found
            ELSE '[]'::jsonb
        END AS films,
        
        created,
        edited,
        CURRENT_TIMESTAMP AS _loaded_at
    FROM "nerd_facts"."raw"."swapi_planets"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name AS planet_name,
    
    -- Physical characteristics with proper typing
    CASE 
        WHEN rotation_period IS NULL OR lower(rotation_period) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(rotation_period, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS rotation_period,
    
    CASE 
        WHEN orbital_period IS NULL OR lower(orbital_period) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(orbital_period, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS orbital_period,
    
    CASE 
        WHEN diameter IS NULL OR lower(diameter) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(diameter, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS diameter,
    
    -- Environment attributes
    LOWER(COALESCE(climate, 'unknown')) AS climate,
    LOWER(COALESCE(gravity, 'unknown')) AS gravity,
    LOWER(COALESCE(terrain, 'unknown')) AS terrain,
    
    CASE 
        WHEN surface_water IS NULL OR lower(surface_water) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(surface_water, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS surface_water,
    
    -- Population with proper handling
    CASE 
        WHEN population IS NULL OR lower(population) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(population, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS population,
    
    -- Entity counts
    COALESCE(jsonb_array_length(residents), 0) AS resident_count,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    residents,
    films,
    
    -- Derived classifications
    CASE
        WHEN lower(climate) LIKE '%temperate%' THEN TRUE
        ELSE FALSE
    END AS is_temperate,
    
    CASE
        WHEN lower(terrain) LIKE '%forest%' OR 
             lower(terrain) LIKE '%jungle%' OR
             lower(terrain) LIKE '%grasslands%' THEN TRUE
        ELSE FALSE
    END AS has_vegetation,
    
    CASE
        WHEN lower(terrain) LIKE '%ocean%' OR 
             lower(terrain) LIKE '%water%' OR
             (surface_water IS NOT NULL AND 
              CASE WHEN surface_water ~ '^[0-9\.]+$' 
                   THEN surface_water::NUMERIC > 50 
                   ELSE FALSE 
              END) THEN TRUE
        ELSE FALSE
    END AS is_water_world,
    
    CASE
        WHEN lower(terrain) LIKE '%desert%' OR 
             lower(climate) LIKE '%arid%' OR
             (surface_water IS NOT NULL AND TRY_CAST(surface_water AS NUMERIC) < 5) THEN TRUE
        ELSE FALSE
    END AS is_desert_world,
    
    -- Planet habitability score (0-100)
    CASE
        WHEN lower(climate) LIKE '%temperate%' THEN
            CASE
                WHEN lower(terrain) LIKE '%forest%' OR 
                     lower(terrain) LIKE '%grasslands%' THEN 90
                ELSE 75
            END
        WHEN lower(climate) LIKE '%tropical%' OR lower(climate) LIKE '%humid%' THEN 65
        WHEN lower(climate) LIKE '%arid%' OR lower(climate) LIKE '%hot%' THEN 35
        WHEN lower(climate) LIKE '%frozen%' OR lower(climate) LIKE '%frigid%' THEN 15
        ELSE 50
    END AS habitability_score,
    
    -- Notable planet flag
    CASE
        WHEN name IN ('Tatooine', 'Alderaan', 'Yavin IV', 'Hoth', 'Dagobah', 
                      'Bespin', 'Endor', 'Naboo', 'Coruscant', 'Kamino', 'Geonosis') 
        THEN TRUE
        ELSE FALSE
    END AS is_notable_planet,
    
    -- API metadata
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking fields
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:56:58.714966 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_species"
[0m09:56:58.715269 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "characters" does not exist
LINE 45:                 CASE WHEN characters IS NULL OR characters =...
                                   ^

[0m09:56:58.720872 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_films: ROLLBACK
[0m09:56:58.719802 [debug] [Thread-2 (]: Database Error in model stg_swapi_people (models/staging/swapi/stg_swapi_people.sql)
  column "films" does not exist
  LINE 34:         films,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_people.sql
[0m09:56:58.718587 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "AS"
LINE 150: ...face_water IS NOT NULL AND TRY_CAST(surface_water AS NUMERIC...
                                                               ^

[0m09:56:58.720412 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_species: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_species"} */

  create view "nerd_facts"."public"."stg_swapi_species__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_species
  Description: Standardizes Star Wars species data from SWAPI
  Source: raw.swapi_species
  
  Notes:
  - Numeric fields are cleaned and converted to proper types
  - Color fields are parsed for analysis
  - Homeworld references are extracted
  - Additional derived fields help with species classification
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        classification,
        designation,
        average_height,
        average_lifespan,
        eye_colors,
        hair_colors,
        skin_colors,
        homeworld,
        language,
        CASE WHEN people IS NULL OR people = '' THEN NULL::jsonb ELSE people::jsonb END AS people,
        CASE WHEN films IS NULL OR films = '' THEN NULL::jsonb ELSE films::jsonb END AS films,
        created,
        edited,
        CURRENT_TIMESTAMP AS _loaded_at
    FROM "nerd_facts"."raw"."swapi_species"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name AS species_name,
    
    -- Species classification
    LOWER(COALESCE(classification, 'unknown')) AS classification,
    LOWER(COALESCE(designation, 'unknown')) AS designation,
    
    -- Physical characteristics with proper typing
    CASE 
        WHEN average_height IS NULL OR LOWER(average_height) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(average_height, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS average_height_cm,
    
    CASE 
        WHEN average_lifespan IS NULL OR LOWER(average_lifespan) = 'unknown' 
            OR LOWER(average_lifespan) = 'indefinite' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(average_lifespan, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS average_lifespan_years,
    
    -- Special case for indefinite lifespan
    CASE 
        WHEN LOWER(average_lifespan) = 'indefinite' THEN TRUE
        ELSE FALSE
    END AS has_indefinite_lifespan,
    
    -- Language
    LOWER(COALESCE(language, 'unknown')) AS language,
    
    -- Color attributes - standardized to arrays
    CASE 
        WHEN eye_colors IS NULL OR eye_colors = '' THEN NULL
        ELSE STRING_TO_ARRAY(LOWER(eye_colors), ', ') 
    END AS eye_colors_array,
    
    CASE 
        WHEN hair_colors IS NULL OR hair_colors = '' THEN NULL
        ELSE STRING_TO_ARRAY(LOWER(hair_colors), ', ') 
    END AS hair_colors_array,
    
    CASE 
        WHEN skin_colors IS NULL OR skin_colors = '' THEN NULL
        ELSE STRING_TO_ARRAY(LOWER(skin_colors), ', ') 
    END AS skin_colors_array,
    
    -- Extract homeworld with error handling
    CASE
        WHEN homeworld IS NULL THEN NULL
        WHEN homeworld = 'null' THEN NULL
        ELSE NULLIF(SPLIT_PART(homeworld->>'url', '/', 6), '')
    END AS homeworld_id,
    
    -- Entity counts
    COALESCE(jsonb_array_length(people), 0) AS character_count,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    people,
    films,
    
    -- Derived species classifications
    CASE
        WHEN LOWER(classification) IN ('mammal', 'amphibian', 'reptile', 'bird') THEN TRUE
        ELSE FALSE
    END AS is_organic,
    
    CASE
        WHEN LOWER(classification) = 'artificial' OR LOWER(name) = 'droid' THEN TRUE
        ELSE FALSE
    END AS is_artificial,
    
    -- Intelligence estimation (approximate)
    CASE
        WHEN LOWER(designation) = 'sentient' THEN 'High'
        WHEN LOWER(designation) = 'semi-sentient' THEN 'Moderate'
        ELSE 'Unknown'
    END AS intelligence_level,
    
    -- Longevity classification
    CASE
        WHEN LOWER(average_lifespan) = 'indefinite' THEN 'Immortal'
        WHEN average_lifespan::NUMERIC > 500 THEN 'Very Long-Lived'
        WHEN average_lifespan::NUMERIC > 100 THEN 'Long-Lived'
        WHEN average_lifespan::NUMERIC > 70 THEN 'Standard'
        WHEN average_lifespan::NUMERIC > 0 THEN 'Short-Lived'
        ELSE 'Unknown'
    END AS longevity_class,
    
    -- Notable species flag
    CASE
        WHEN name IN ('Human', 'Wookiee', 'Droid', 'Hutt', 'Ewok', 'Gungan', 
                     'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yoda\'s species') 
        THEN TRUE
        ELSE FALSE
    END AS is_notable_species,
    
    -- API metadata
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking fields
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:56:58.721494 [debug] [Thread-1 (]: On model.nerd_facts_dbt.stg_swapi_films: Close
[0m09:56:58.723356 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6bf1b47-d554-4a69-a28f-32f4a758609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5410936440>]}
[0m09:56:58.723769 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "lek"
LINE 136: ...                    'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yod...
                                                               ^

[0m09:56:58.724252 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_species: ROLLBACK
[0m09:56:58.725144 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_species: Close
[0m09:56:58.726021 [debug] [Thread-4 (]: Database Error in model stg_swapi_species (models/staging/swapi/stg_swapi_species.sql)
  syntax error at or near "lek"
  LINE 136: ...                    'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yod...
                                                                 ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_species.sql
[0m09:56:58.726490 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6bf1b47-d554-4a69-a28f-32f4a758609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f540d605b10>]}
[0m09:56:58.722809 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_planets: ROLLBACK
[0m09:56:58.724821 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_swapi_people ................... [[31mERROR[0m in 0.12s]
[0m09:56:58.729179 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_swapi_people
[0m09:56:58.728036 [debug] [Thread-1 (]: Database Error in model stg_swapi_films (models/staging/swapi/stg_swapi_films.sql)
  column "characters" does not exist
  LINE 45:                 CASE WHEN characters IS NULL OR characters =...
                                     ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_films.sql
[0m09:56:58.730424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6bf1b47-d554-4a69-a28f-32f4a758609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f540e1855d0>]}
[0m09:56:58.727089 [error] [Thread-4 (]: 4 of 6 ERROR creating sql view model public.stg_swapi_species .................. [[31mERROR[0m in 0.13s]
[0m09:56:58.731514 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi_species
[0m09:56:58.730017 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_people' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_people (models/staging/swapi/stg_swapi_people.sql)
  column "films" does not exist
  LINE 34:         films,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_people.sql.
[0m09:56:58.732747 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_species' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_species (models/staging/swapi/stg_swapi_species.sql)
  syntax error at or near "lek"
  LINE 136: ...                    'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yod...
                                                                 ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_species.sql.
[0m09:56:58.728644 [debug] [Thread-3 (]: On model.nerd_facts_dbt.stg_swapi_planets: Close
[0m09:56:58.731882 [debug] [Thread-4 (]: Began running node model.nerd_facts_dbt.stg_swapi_vehicles
[0m09:56:58.735277 [info ] [Thread-4 (]: 6 of 6 START sql view model public.stg_swapi_vehicles .......................... [RUN]
[0m09:56:58.733758 [debug] [Thread-3 (]: Database Error in model stg_swapi_planets (models/staging/swapi/stg_swapi_planets.sql)
  syntax error at or near "AS"
  LINE 150: ...face_water IS NOT NULL AND TRY_CAST(surface_water AS NUMERIC...
                                                                 ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_planets.sql
[0m09:56:58.736310 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6bf1b47-d554-4a69-a28f-32f4a758609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f540c495150>]}
[0m09:56:58.731001 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model public.stg_swapi_films .................... [[31mERROR[0m in 0.13s]
[0m09:56:58.729588 [debug] [Thread-2 (]: Began running node model.nerd_facts_dbt.stg_swapi_starships
[0m09:56:58.737300 [debug] [Thread-1 (]: Finished running node model.nerd_facts_dbt.stg_swapi_films
[0m09:56:58.735839 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_species, now model.nerd_facts_dbt.stg_swapi_vehicles)
[0m09:56:58.738587 [debug] [Thread-4 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_vehicles
[0m09:56:58.738194 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_films' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_films (models/staging/swapi/stg_swapi_films.sql)
  column "characters" does not exist
  LINE 45:                 CASE WHEN characters IS NULL OR characters =...
                                     ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_films.sql.
[0m09:56:58.737783 [info ] [Thread-2 (]: 5 of 6 START sql view model public.stg_swapi_starships ......................... [RUN]
[0m09:56:58.736854 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_swapi_planets .................. [[31mERROR[0m in 0.13s]
[0m09:56:58.743725 [debug] [Thread-3 (]: Finished running node model.nerd_facts_dbt.stg_swapi_planets
[0m09:56:58.742488 [debug] [Thread-4 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:56:58.744184 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_planets' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_planets (models/staging/swapi/stg_swapi_planets.sql)
  syntax error at or near "AS"
  LINE 150: ...face_water IS NOT NULL AND TRY_CAST(surface_water AS NUMERIC...
                                                                 ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_planets.sql.
[0m09:56:58.743200 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nerd_facts_dbt.stg_swapi_people, now model.nerd_facts_dbt.stg_swapi_starships)
[0m09:56:58.744749 [debug] [Thread-4 (]: Began executing node model.nerd_facts_dbt.stg_swapi_vehicles
[0m09:56:58.745111 [debug] [Thread-2 (]: Began compiling node model.nerd_facts_dbt.stg_swapi_starships
[0m09:56:58.749648 [debug] [Thread-4 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:56:58.752419 [debug] [Thread-2 (]: Writing injected SQL for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m09:56:58.753110 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:56:58.753512 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: BEGIN
[0m09:56:58.753787 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:56:58.754415 [debug] [Thread-2 (]: Began executing node model.nerd_facts_dbt.stg_swapi_starships
[0m09:56:58.761132 [debug] [Thread-2 (]: Writing runtime sql for node "model.nerd_facts_dbt.stg_swapi_starships"
[0m09:56:58.762052 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m09:56:58.762461 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_starships: BEGIN
[0m09:56:58.762795 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:56:58.766107 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m09:56:58.766477 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:56:58.766870 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_vehicles"} */

  create view "nerd_facts"."public"."stg_swapi_vehicles__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_vehicles
  Description: Standardizes Star Wars vehicle data from SWAPI
  Source: raw.swapi_vehicles
  
  Notes:
  - Numeric fields are cleaned and converted to proper types
  - Speeds and capacities have proper error handling
  - Pilot and film references are extracted as counts
  - Additional derived fields help with vehicle classification
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        model,
        manufacturer,
        NULLIF(cost_in_credits, 'unknown') AS cost_in_credits,
        NULLIF(length, 'unknown') AS length,
        NULLIF(max_atmosphering_speed, 'unknown') AS max_atmosphering_speed,
        NULLIF(crew, 'unknown') AS crew,
        NULLIF(passengers, 'unknown') AS passengers,
        NULLIF(cargo_capacity, 'unknown') AS cargo_capacity,
        consumables,
        vehicle_class,
        CASE WHEN pilots IS NULL OR pilots = '' THEN NULL::jsonb ELSE pilots::jsonb END AS pilots,
        CASE WHEN films IS NULL OR films = '' THEN NULL::jsonb ELSE films::jsonb END AS films,
        created,
        edited,
        CURRENT_TIMESTAMP AS _loaded_at
    FROM "nerd_facts"."raw"."swapi_vehicles"
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name AS vehicle_name,
    model,
    manufacturer,
    vehicle_class,
    
    -- Technical specifications with proper error handling
    CASE 
        WHEN lower(cost_in_credits) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(cost_in_credits, '[^0-9]', '', 'g'), '')::NUMERIC
    END AS cost_in_credits,
    
    CASE 
        WHEN lower(length) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(length, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS length_m,
    
    CASE 
        WHEN lower(max_atmosphering_speed) = 'unknown' THEN NULL
        WHEN lower(max_atmosphering_speed) = 'n/a' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '[^0-9]+.*', '', 'g'), '')::INTEGER 
    END AS max_speed,
    
    -- Capacity information with proper type conversion
    CASE 
        WHEN lower(crew) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER
    END AS crew_count,
    
    CASE 
        WHEN lower(passengers) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER
    END AS passenger_capacity,
    
    CASE 
        WHEN lower(cargo_capacity) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(cargo_capacity, '[^0-9]', '', 'g'), '')::NUMERIC
    END AS cargo_capacity,
    
    consumables,
    
    -- Entity counts with error handling
    COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    pilots,
    films,
    
    -- Derived vehicle classifications
    CASE
        WHEN lower(vehicle_class) IN ('assault', 'combat', 'battle') 
             OR lower(name) LIKE '%fighter%' 
             OR lower(name) LIKE '%tank%'
             OR lower(name) LIKE '%cannon%' THEN 'Military'
        WHEN lower(vehicle_class) IN ('transport', 'cargo', 'container') 
             OR lower(name) LIKE '%transport%'
             OR lower(name) LIKE '%freighter%' THEN 'Transport'
        WHEN lower(vehicle_class) IN ('speeder', 'airspeeder', 'swoop', 'landspeeder') 
             OR lower(name) LIKE '%speeder%' THEN 'Personal'
        ELSE 'Other'
    END AS vehicle_purpose,
    
    -- Size classification
    CASE
        WHEN length IS NULL THEN 'Unknown'
        WHEN length::NUMERIC < 10 THEN 'Small'
        WHEN length::NUMERIC < 25 THEN 'Medium'
        WHEN length::NUMERIC < 100 THEN 'Large'
        ELSE 'Very Large'
    END AS vehicle_size,
    
    -- Terrain capability
    CASE
        WHEN lower(vehicle_class) LIKE '%walker%' 
             OR lower(name) LIKE '%walker%' THEN 'Ground Only'
        WHEN lower(vehicle_class) LIKE '%speeder%'
             OR lower(name) LIKE '%speeder%' THEN 'Ground & Low Altitude'
        WHEN lower(vehicle_class) LIKE '%airspeeder%'
             OR lower(name) LIKE '%airspeeder%' THEN 'Aerial'
        ELSE 'Unknown'
    END AS terrain_capability,
    
    -- Notable vehicle flag
    CASE
        WHEN name IN ('AT-AT', 'AT-ST', 'Snowspeeder', 'Speeder bike',
                     'Sand Crawler', 'TIE bomber', 'Imperial Speeder Bike') 
        THEN TRUE
        ELSE FALSE
    END AS is_notable_vehicle,
    
    -- Total capacity (crew + passengers)
    COALESCE(
        NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER, 0
    ) + 
    COALESCE(
        NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER, 0
    ) AS total_capacity,
    
    -- API metadata
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking fields
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:56:58.770972 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:56:58.776873 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:56:58.777374 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_vehicles"} */
alter table "nerd_facts"."public"."stg_swapi_vehicles" rename to "stg_swapi_vehicles__dbt_backup"
[0m09:56:58.777765 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m09:56:58.778345 [debug] [Thread-2 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_starships"
[0m09:56:58.778774 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_starships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_starships"} */

  create view "nerd_facts"."public"."stg_swapi_starships__dbt_tmp"
    
    
  as (
    

/*
  Model: stg_swapi_starships
  Description: Standardizes Star Wars starship data from SWAPI
  Source: raw.swapi_starships
  
  Notes:
  - Numeric fields are cleaned and converted to proper types
  - Speeds and capacities have proper error handling
  - Pilot and film references are extracted as counts
  - Additional derived fields help with starship classification
*/

WITH raw_data AS (
    -- Explicitly list columns to prevent issues if source schema changes
    SELECT
        id,
        name,
        model,
        manufacturer,
        cost_in_credits,
        length,
        max_atmosphering_speed,
        crew,
        passengers,
        cargo_capacity,
        consumables,
        hyperdrive_rating,
        MGLT,
        starship_class,
        pilots,
        films,
        created,
        edited,
        url
    FROM raw.swapi_starships
    WHERE id IS NOT NULL
)

SELECT
    -- Primary identifiers
    id,
    name AS starship_name,
    model,
    manufacturer,
    starship_class,
    
    -- Technical specifications with improved error handling
    CASE 
        WHEN lower(cost_in_credits) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(cost_in_credits, '[^0-9]', '', 'g'), '')::NUMERIC
    END AS cost_in_credits,
    
    CASE 
        WHEN lower(length) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(length, '[^0-9\.]', '', 'g'), '')::NUMERIC
    END AS length_m,
    
    CASE 
        WHEN lower(max_atmosphering_speed) = 'unknown' THEN NULL
        WHEN lower(max_atmosphering_speed) = 'n/a' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(max_atmosphering_speed, '[^0-9]+.*', '', 'g'), '')::INTEGER 
    END AS max_speed,
    
    CASE
        WHEN lower(hyperdrive_rating) = 'unknown' THEN NULL
        WHEN lower(hyperdrive_rating) = 'n/a' THEN NULL
        ELSE NULLIF(hyperdrive_rating, '')::NUMERIC
    END AS hyperdrive_rating,
    
    CASE
        WHEN lower(MGLT) = 'unknown' THEN NULL
        WHEN lower(MGLT) = 'n/a' THEN NULL
        ELSE NULLIF(MGLT, '')::INTEGER
    END AS mglt,
    
    -- Capacity information
    NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER AS crew_count,
    NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER AS passenger_capacity,
    
    CASE 
        WHEN lower(cargo_capacity) = 'unknown' THEN NULL
        ELSE NULLIF(REGEXP_REPLACE(cargo_capacity, '[^0-9]', '', 'g'), '')::NUMERIC
    END AS cargo_capacity,
    
    consumables,
    
    -- Entity counts with error handling
    COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
    COALESCE(jsonb_array_length(films), 0) AS film_appearances,
    
    -- Keep raw arrays for downstream usage
    CASE WHEN pilots IS NULL OR pilots = '' THEN NULL::jsonb ELSE pilots::jsonb END AS pilots,
    CASE WHEN films IS NULL OR films = '' THEN NULL::jsonb ELSE films::jsonb END AS films,
    
    -- Derived ship classification
    CASE
        WHEN lower(starship_class) IN ('corvette', 'frigate', 'star destroyer', 'dreadnought')
            OR lower(name) LIKE '%star destroyer%' THEN 'Military'
        WHEN lower(starship_class) IN ('transport', 'freighter', 'yacht') 
            OR lower(name) LIKE '%transport%' THEN 'Commercial'
        WHEN lower(starship_class) IN ('starfighter', 'bomber', 'assault ship')
            OR lower(name) LIKE '%fighter%' THEN 'Starfighter'
        ELSE 'Other'
    END AS ship_purpose,
    
    -- Size classification
    CASE
        WHEN length::NUMERIC < 30 THEN 'Small'
        WHEN length::NUMERIC < 100 THEN 'Medium'
        WHEN length::NUMERIC < 500 THEN 'Large'
        WHEN length::NUMERIC < 1000 THEN 'Very Large'
        WHEN length::NUMERIC >= 1000 THEN 'Capital'
        ELSE 'Unknown'
    END AS ship_size,
    
    -- Notable ship flag
    CASE
        WHEN name IN ('Millennium Falcon', 'Death Star', 'Star Destroyer', 
                     'X-wing', 'TIE Advanced x1', 'Executor', 'Slave 1') 
        THEN TRUE
        ELSE FALSE
    END AS is_notable_ship,
    
    -- Total capacity (crew + passengers)
    COALESCE(
        NULLIF(REGEXP_REPLACE(crew, '[^0-9]', '', 'g'), '')::INTEGER, 0
    ) + 
    COALESCE(
        NULLIF(REGEXP_REPLACE(passengers, '[^0-9]', '', 'g'), '')::INTEGER, 0
    ) AS total_capacity,
    
    -- API metadata
    created::TIMESTAMP AS created_at,
    edited::TIMESTAMP AS updated_at,
    
    -- Add data tracking field
    CURRENT_TIMESTAMP AS dbt_loaded_at
    
FROM raw_data
  );
[0m09:56:58.779224 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:56:58.781988 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:56:58.782348 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_vehicles"} */
alter table "nerd_facts"."public"."stg_swapi_vehicles__dbt_tmp" rename to "stg_swapi_vehicles"
[0m09:56:58.782717 [debug] [Thread-2 (]: Postgres adapter: Postgres error: function jsonb_array_length(text) does not exist
LINE 96:     COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m09:56:58.783137 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_starships: ROLLBACK
[0m09:56:58.783505 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:56:58.783858 [debug] [Thread-2 (]: On model.nerd_facts_dbt.stg_swapi_starships: Close
[0m09:56:58.796704 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: COMMIT
[0m09:56:58.797354 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:56:58.797842 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: COMMIT
[0m09:56:58.798434 [debug] [Thread-2 (]: Database Error in model stg_swapi_starships (models/staging/swapi/stg_swapi_starships.sql)
  function jsonb_array_length(text) does not exist
  LINE 96:     COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_starships.sql
[0m09:56:58.799131 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6bf1b47-d554-4a69-a28f-32f4a758609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f540c4a33a0>]}
[0m09:56:58.799814 [error] [Thread-2 (]: 5 of 6 ERROR creating sql view model public.stg_swapi_starships ................ [[31mERROR[0m in 0.06s]
[0m09:56:58.800505 [debug] [Thread-2 (]: Finished running node model.nerd_facts_dbt.stg_swapi_starships
[0m09:56:58.801002 [debug] [Thread-7 (]: Marking all children of 'model.nerd_facts_dbt.stg_swapi_starships' to be skipped because of status 'error'.  Reason: Database Error in model stg_swapi_starships (models/staging/swapi/stg_swapi_starships.sql)
  function jsonb_array_length(text) does not exist
  LINE 96:     COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_starships.sql.
[0m09:56:58.804818 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m09:56:58.810031 [debug] [Thread-4 (]: Applying DROP to: "nerd_facts"."public"."stg_swapi_vehicles__dbt_backup"
[0m09:56:58.813350 [debug] [Thread-4 (]: Using postgres connection "model.nerd_facts_dbt.stg_swapi_vehicles"
[0m09:56:58.813708 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "nerd_facts_dbt", "target_name": "dev", "node_id": "model.nerd_facts_dbt.stg_swapi_vehicles"} */
drop view if exists "nerd_facts"."public"."stg_swapi_vehicles__dbt_backup" cascade
[0m09:56:58.816970 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:56:58.819070 [debug] [Thread-4 (]: On model.nerd_facts_dbt.stg_swapi_vehicles: Close
[0m09:56:58.821738 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6bf1b47-d554-4a69-a28f-32f4a758609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5411a6ace0>]}
[0m09:56:58.822394 [info ] [Thread-4 (]: 6 of 6 OK created sql view model public.stg_swapi_vehicles ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m09:56:58.822875 [debug] [Thread-4 (]: Finished running node model.nerd_facts_dbt.stg_swapi_vehicles
[0m09:56:58.823968 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:58.824264 [debug] [MainThread]: On master: BEGIN
[0m09:56:58.824498 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:56:58.836951 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:56:58.837362 [debug] [MainThread]: On master: COMMIT
[0m09:56:58.837694 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:58.837937 [debug] [MainThread]: On master: COMMIT
[0m09:56:58.838248 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:56:58.838498 [debug] [MainThread]: On master: Close
[0m09:56:58.838976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:56:58.839251 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_starships' was properly closed.
[0m09:56:58.839490 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_films' was properly closed.
[0m09:56:58.839784 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_vehicles' was properly closed.
[0m09:56:58.840098 [debug] [MainThread]: Connection 'model.nerd_facts_dbt.stg_swapi_planets' was properly closed.
[0m09:56:58.840667 [info ] [MainThread]: 
[0m09:56:58.841232 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m09:56:58.842743 [debug] [MainThread]: Command end result
[0m09:56:58.925931 [debug] [MainThread]: Wrote artifact WritableManifest to /home/janne/nerd-facts-dbt/dbt_project/target/manifest.json
[0m09:56:58.927549 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/janne/nerd-facts-dbt/dbt_project/target/semantic_manifest.json
[0m09:56:58.932915 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/janne/nerd-facts-dbt/dbt_project/target/run_results.json
[0m09:56:58.933287 [info ] [MainThread]: 
[0m09:56:58.933647 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m09:56:58.933915 [info ] [MainThread]: 
[0m09:56:58.934203 [error] [MainThread]:   Database Error in model stg_swapi_people (models/staging/swapi/stg_swapi_people.sql)
  column "films" does not exist
  LINE 34:         films,
                   ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_people.sql
[0m09:56:58.934445 [info ] [MainThread]: 
[0m09:56:58.934718 [error] [MainThread]:   Database Error in model stg_swapi_species (models/staging/swapi/stg_swapi_species.sql)
  syntax error at or near "lek"
  LINE 136: ...                    'Jawa', 'Mon Calamari', 'Twi\'lek', 'Yod...
                                                                 ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_species.sql
[0m09:56:58.934967 [info ] [MainThread]: 
[0m09:56:58.935245 [error] [MainThread]:   Database Error in model stg_swapi_films (models/staging/swapi/stg_swapi_films.sql)
  column "characters" does not exist
  LINE 45:                 CASE WHEN characters IS NULL OR characters =...
                                     ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_films.sql
[0m09:56:58.935480 [info ] [MainThread]: 
[0m09:56:58.935744 [error] [MainThread]:   Database Error in model stg_swapi_planets (models/staging/swapi/stg_swapi_planets.sql)
  syntax error at or near "AS"
  LINE 150: ...face_water IS NOT NULL AND TRY_CAST(surface_water AS NUMERIC...
                                                                 ^
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_planets.sql
[0m09:56:58.935969 [info ] [MainThread]: 
[0m09:56:58.936231 [error] [MainThread]:   Database Error in model stg_swapi_starships (models/staging/swapi/stg_swapi_starships.sql)
  function jsonb_array_length(text) does not exist
  LINE 96:     COALESCE(jsonb_array_length(pilots), 0) AS pilot_count,
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/nerd_facts_dbt/models/staging/swapi/stg_swapi_starships.sql
[0m09:56:58.936471 [info ] [MainThread]: 
[0m09:56:58.936716 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=5 SKIP=0 TOTAL=6
[0m09:56:58.937382 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.464157, "process_in_blocks": "0", "process_kernel_time": 0.091088, "process_mem_max_rss": "119212", "process_out_blocks": "7712", "process_user_time": 2.276113}
[0m09:56:58.937770 [debug] [MainThread]: Command `dbt run` failed at 09:56:58.937688 after 1.46 seconds
[0m09:56:58.938078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5410699660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f540ea5d870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f540d7054e0>]}
[0m09:56:58.938373 [debug] [MainThread]: Flushing usage events
[0m09:56:59.427799 [debug] [MainThread]: An error was encountered while trying to flush usage events
